<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<META NAME="AUTHOR" CONTENT="Trae Luttrell">
<TITLE>Sign Up Report</TITLE>
<META NAME='VERSION' CONTENT='1.0'>
    <META NAME='COPYRIGHT' CONTENT='Solsource'>
    <META NAME='CREATE_DATE' CONTENT="15/Apr/17">
    <META NAME='LAST_UPDATED' CONTENT="15/Aug/17">    
    <link rel="stylesheet" type="text/css" href="http://www.w3schools.com/lib/w3.css"> 
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 
<SCRIPT LANGUAGE="SpeedScript">
/* Create an unnamed pool to store all the widgets created by this procedure.
   This is a good default which assures that this procedure's triggers and
   internal procedures will execute in this procedure's storage, and that
   proper cleanup will occur on deletion of the procedure. */
CREATE WIDGET-POOL.
</SCRIPT>

<style>
/***** ****** W3CSS THEME FOR #66A97C ***** *****/
.w3-theme-l5 {color:#000 !important; background-color:#f6faf7 !important}
.w3-theme-l4 {color:#000 !important; background-color:#e0eee5 !important}
.w3-theme-l3 {color:#000 !important; background-color:#c2dccb !important}
.w3-theme-l2 {color:#000 !important; background-color:#a3cbb0 !important}
.w3-theme-l1 {color:#000 !important; background-color:#84ba96 !important}
.w3-theme-d1 {color:#fff !important; background-color:#589c6e !important}
.w3-theme-d2 {color:#fff !important; background-color:#4e8a62 !important}
.w3-theme-d3 {color:#fff !important; background-color:#447956 !important}
.w3-theme-d4 {color:#fff !important; background-color:#3a684a !important}
.w3-theme-d5 {color:#fff !important; background-color:#31563d !important}

.w3-theme-light {color:#000 !important; background-color:#f6faf7 !important}
.w3-theme-dark {color:#fff !important; background-color:#31563d !important}
.w3-theme-action {color:#fff !important; background-color:#31563d !important}

.w3-theme {color:#fff !important; background-color:#66a97c !important}
.w3-text-theme {color:#66a97c !important}
.w3-border-theme {border-color:#66a97c !important}

.w3-hover-theme:hover {color:#fff !important; background-color:#66a97c !important}
.w3-hover-text-theme {color:#66a97c !important}
.w3-hover-border-theme:hover {border-color:#66a97c !important}

.w3-theme-body {color:#000 !important; background-color:#f1f1f1 !important}
.w3-theme-background {color::#000 !important; background-color:#fff !important}
.w3-theme-accent {color:#fff !important; background-color:#874D74 !important}
.w3-hover-theme-accent:hover {color:#000 !important; background-color:#874D74 !important}
.w3-hover-border-theme-accent:hover {color:#000 !important; background-color:#874D74 !important}

</style>

</HEAD>

<BODY class='w3-theme-body'>
<SCRIPT LANGUAGE="SpeedScript">
  /*------------------------------------------------------------------
    Template Notes: 
        This template is designed to be used with a simple search report.
        It has a link designed to send the user to a more advanced (From
        To) search. The validation act allows you to decide weather the 
        criteria the user is inputting is valid for your table to search
        by (outside date range for example).  Quoted areas are either
        instuctions or place holders for your variables and fields. 
    
  --------------------------------------------------------------------  
    File:           
    Description:
    Created:
        
    ---------------------------------------------------------------  
    Revision History:
    -----------------
    1.0 - written by TRAE LUTTRELL on 15/Apr/17.  Original version.
    1.1 - written by DOUG LUTTRELL on 15/Aug/17.  Changed to work with 
            the new CMC structure (Version 12).  Marked by 1dot1.
                    
  -------------------------------------------------------------------*/

/* ************************* Definitions *************************** */
DEFINE VARIABLE act             AS CHARACTER            NO-UNDO.
DEFINE VARIABLE ITmessages      AS LOGICAL INITIAL NO   NO-UNDO.

DEFINE VARIABLE v-startdate     AS DATE INITIAL 04/17/17 NO-UNDO.   /* This is the thing that you change to change the report.  */
                                                                    /* Should actually be tied to the event_ID.  1dot1.         */
                                                                    
/* ****************** Additional Variables Here ******************** */

/*DEFINE VARIABLE outfile AS CHARACTER FORMAT "x(60)" LABEL "Output File"*/
/*    INITIAL "C:\progress\WRK\SC-unit-peop-mb-R.txt".                   */

/* ************************* Assignments *************************** */
ASSIGN 
    act             = get-value("h-act")
    /* additional variables here */
    .

    
IF act= "" THEN 
    act = "REPORT".

/*IF act = "VALIDATION" THEN DO:                                                               */
/*                                                                                             */
/*    /* add a validation for the search criteria based off of the table(s) you                */
/*    are searching by. */                                                                     */
/*                                                                                             */
/*    FIND /* table */ WHERE /* table_field */ = /* v-field */ NO-LOCK NO-ERROR.               */
/*                                                                                             */
/*    IF AVAILABLE ( /* table */ ) THEN                                                        */
/*                                                                                             */
/*        ASSIGN                                                                               */
/*            act = "SEARCH".                                                                  */
/*                                                                                             */
/*    ELSE DO:                                                                                 */
/*        {&OUT}                                                                               */
/*            "<DIV class='grid_3'> </DIV>" SKIP                                               */
/*            "<DIV class='grid_6'>" SKIP                                                      */
/*                "<h2>Incorrect parameters for table " /* table */ ". Search Again.</h2>" SKIP*/
/*            "</DIV>         <!-- end of grid_6 -->" SKIP                                     */
/*            "<DIV class='grid_3'> </DIV>" SKIP.                                              */
/*        ASSIGN                                                                               */
/*            act = "INITIAL".                                                                 */
/*                                                                                             */
/*    END. /* else do not avail */                                                             */
/*END. /* validation */                                                                        */
        
/* ************************* Main Block *************************** */   

IF ITmessages = YES THEN  
    {&OUT} "<H1>Pre-Case</H1>" skip 
        "act = " act "<br>" skip .

CASE act:
    
    WHEN "Report" THEN DO:
    
/*        DEFINE STREAM outward.                  */
/*                                                */
/*        OUTPUT stream outward to value(outfile).*/
        
        {&OUT}
            "<div class=' w3-content w3-responsive'>" SKIP
            "   <header class='w3-container w3-theme-dark w3-margin-bottom'>" SKIP
            "       <h1>Registration Report</h1>" SKIP
            "   </header>" SKIP
            "   <div class='w3-card-4 w3-content w3-theme-background' style='max-width:1400px;'>" SKIP
            "       <table class='w3-table-all'>" SKIP
            "           <tr class='w3-theme-dark'>" SKIP
            "               <th> ID </th>" SKIP
            "               <th> Last Name </th>" SKIP
            "               <th> First Name </th>" SKIP
            "               <th> Date of Birth </th>" SKIP
            "               <th> Merit Badge Name </th>" SKIP
            "               <th> Period </th>" SKIP
            "               <th> BSA ID </th>" SKIP
            "           </tr>" SKIP.
        
        IF ITmessages = YES THEN  
		    {&OUT} "<H1>About to 4ea. people_shadow, etc.</H1>" skip 
		        "act = " act "<br>" skip .
        
        FOR EACH speop_shadow no-lock,                                                                      /* 1dot1 */
            FIRST people_mstr WHERE people_mstr.people_id = speop_shadow.speop_ID NO-LOCK,                  /* 1dot1 */
            EACH regis_mstr WHERE regis_mstr.regis_people_id = speop_shadow.speop_id NO-LOCK,               /* 1dot1 */
            FIRST sched_mstr WHERE sched_mstr.sched_class_id = regis_mstr.regis_class_ID AND  
                sched_mstr.sched_start_date = v-startdate NO-LOCK,
            FIRST MB_mstr WHERE MB_mstr.mb_bsa_id = sched_mstr.sched_bsa_id NO-LOCK
                BREAK 
                    BY speop_shadow.speop_stake                                                                 /* 1dot1 */
                    BY speop_shadow.speop_ward                                                                  /* 1dot1 */
                    BY people_mstr.people_ID                                                                    /* 1dot1 */
                    BY people_mstr.people_lastname                                                              /* 1dot1 */
                    BY people_mstr.people_firstname                                                             /* 1dot1 */
                    BY MB_mstr.MB_name:
            
            IF FIRST-OF(speop_shadow.speop_ward) THEN DO:                                                       /* 1dot1  */
            
                {&OUT} SKIP(1)
                    "<tr class='w3-theme-accent'>" SKIP
                    "   <th>" speop_shadow.speop_stake " </th>" SKIP                                            /* 1dot1 */
                    "   <th colspan=6>" speop_shadow.speop_ward " </th>" SKIP                                   /* 1dot1 */
                    "</tr>" SKIP.
            
/*                PAGE STREAM outward.                                         */
/*                DISPLAY STREAM outward SKIP(1)                               */
/*                    people_shadow.people_stake FORMAT "x(24)" COLON 10       */
/*                    people_shadow.people_ward FORMAT "x(30)" COLON 50 SKIP(1)*/
/*                        WITH FRAME unithead SIDE-LABELS WIDTH 132.           */
                        
            END.  /** of if first-of people_unit **/
            
            IF FIRST-OF(people_mstr.people_ID) THEN DO:                                                         /* 1dot1 */
            
                {&OUT} 
                    "<tr>" SKIP
                    "   <td>" people_mstr.people_ID "</td>" SKIP                                            /* 1dot1 */
                    "   <td>" people_mstr.people_lastname "</td>" SKIP                                      /* 1dot1 */
                    "   <td>" people_mstr.people_firstname "</td>" SKIP                                     /* 1dot1 */
                    "   <td>" people_mstr.people_DOB "</td>" SKIP
                    "   <td>" MB_mstr.MB_name "</td>" SKIP
                    "   <td>" sched_mstr.sched_period "</td>" SKIP
                    "   <td>" MB_mstr.mb_bsa_id "</td>" SKIP
                    "</tr>" SKIP .
                
/*                DISPLAY STREAM outward                     */
/*                    people_shadow.people_ID                */
/*                    people_shadow.people_lastname          */
/*                    people_shadow.people_firstname         */
/*                    people_shadow.people_dob               */
/*                    /*                                     */
/*                    people_shadow.people_quorum            */
/*                    people_shadow.people_member            */
/*                    */                                     */
/*                        WITH FRAME maindets WIDTH 132 DOWN.*/
/*                                                           */
/*                DOWN STREAM outward WITH FRAME maindets.   */
            
            END. /*** first people_ID ***/
            
            ELSE DO:
            
/*            FOR EACH regis_mstr WHERE regis_mstr.regis_people_id = people_shadow.people_id NO-LOCK,*/
/*                FIRST sched_mstr WHERE sched_mstr.sched_class_id = regis_mstr.regis_class_id AND   */
/*                    sched_mstr.sched_start_date > (03/11/17) NO-LOCK,                              */
/*                FIRST MB_mstr WHERE MB_mstr.mb_bsa_id = sched_mstr.sched_bsa_id NO-LOCK            */
/*                    BREAK BY MB_mstr.mb_name:                                                      */
                
                {&OUT} 
                    "<tr>" SKIP
                    "   <td></td>" SKIP
                    "   <td></td>" SKIP
                    "   <td></td>" SKIP
                    "   <td></td>" SKIP
                    "   <td>" MB_mstr.MB_name "</td>" SKIP
                    "   <td>" sched_mstr.sched_period "</td>" SKIP
                    "   <td>" MB_mstr.mb_bsa_id "</td>" SKIP
                    "</tr>" SKIP.
                    
/*                DISPLAY STREAM outward MB_mstr.mb_name AT 15 sched_mstr.sched_period MB_mstr.mb_bsa_id SKIP*/
/*                    WITH FRAME mbclasses DOWN.                                                             */
/*                DOWN STREAM outward                                                                        */
/*                    WITH FRAME mbclasses.                                                                  */
                
            END.  /** of NOT the first of people_ID **/
                               
        END.  /** of 4ea. people_mstr **/
        
/*        OUTPUT stream outward close.*/
        
    END. /*** report act ***/
    
    OTHERWISE DO: 
    
        {&OUT}
            "<div class='w3-container'>" SKIP
            "<form>" SKIP
            "<div class='w3-card-8 w3-content w3-white' style='max-width:1250px;'>" SKIP
            "    <header class='w3-container w3-red'>" SKIP
            "       <h1>Error</h1>" SKIP
            "    </header>" SKIP
            
            "    <div class='w3-container'>" SKIP
            "       <p>Could not find act '" act "'.</p>" SKIP
            "    </div>" SKIP

            "    <button type='submit' name='h-act' value='' class='w3-btn-block w3-left-align w3-padding-16 w3-hover-red'>Return to Start</BUTTON>" SKIP
            "</div>" SKIP
            "</form>" SKIP
            "</div>" SKIP.
            
    END. /* otherwise */     
        
END CASE.         

/* *********************** End of Script ************************* */
</SCRIPT>
</BODY>
</HTML>