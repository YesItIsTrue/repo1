"cm.ui.common".namespace();cm.ui.common.DraggableConfigOptions=Class.create(cm.ConfigOptions,{active:true,helper:null,helperStyle:"",dragItem:null,containment:"",dragFromClass:""});cm.ui.common.Draggable=Class.create(cm.ui.UILibraryControl,{DragStart:null,DragStop:null,_dragData:null,ConnectTo:function(a){this.getLibraryElement().draggable("option","connectToSortable",a.getLibraryElement())},createEvents:function(){this.DragStart=new cm.event(true);this.DragStop=new cm.event(true)},postAppendTo:function(){this.SetActive(this.GetConfigOptions().active);this.GetHtmlElement().dragItem=this.getDragItem()},configureDefaultOptions:function(){return new cm.ui.common.DraggableConfigOptions()},initializeData:function(){this._dragItem=this},GetData:function(){return this._dragData},Bind:function(a){this._dragData=a},SetActive:function(c){var b=this;this.getLibraryElement().unbind("dragstart");this.getLibraryElement().unbind("dragstop");if(c==true){var a=this.GetConfigOptions();if($$CM.isNull(a.helper)){a.embed({helper:function(d){return jQuery("<div style='"+a.helperStyle+"'></div>")}})}this.getLibraryElement().draggable(a);this.getLibraryElement().bind("dragstart",function(d,e){b.DragStart.fire(b,{});if(!$$CM.isNull(a.dragFromClass)){b.AddClassName(a.dragFromClass)}});this.getLibraryElement().bind("dragstop",function(d,e){b.DragStop.fire(b,{});if(!$$CM.isNull(a.dragFromClass)){b.RemoveClassName(a.dragFromClass)}})}},getDragItem:function(){return this}});"cm.ui.common".namespace();cm.ui.common.FieldsetConfigOptions=Class.create(cm.ui.ComplexControlConfigOptions,{htmlCssVersion:1,cssClass:"",legendLabel:"",legendCssClass:"",isInlineDiv:false});$$FS=cm.ui.common.Fieldset=Class.create(cm.ui.ComplexControl,{_legendControl:null,_formControlArray:null,SelectionChangedEvent:null,configureDefaultOptions:function(){return new cm.ui.common.FieldsetConfigOptions()},render:function(){var a=$$P.fieldset(this.ID());return $$E(a)},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function($super){$super();if(this._cfo.isInlineDiv){this._legendControl=$$P.div(($$CM.isEmpty(this.ID()))?$$CM.uniqueID():"l"+this.ID(),"")}else{this._legendControl=$$P.legend(($$CM.isEmpty(this.ID()))?$$CM.uniqueID():"l"+this.ID(),"")}this.AddChild(this._legendControl);this._legendInnerControl=$$P.span(null,this._cfo.legendLabel);this._legendControl.AddChild(this._legendInnerControl);if($$CM.isEmpty(this._cfo.legendLabel)){this._legendControl.Hide()}if(!$$CM.isNull(this._cfo.isRequired)&&this._cfo.isRequired==true){this._legendInnerControl.AddClassName("cmRequiredField")}if(this.Version()==1){this.AddClassName("cmFieldsetBase");if(!$$CM.isEmpty(this._cfo.cssClass)){this.AddClassName(this._cfo.cssClass)}this._legendControl.AddClassName("cmLegendBase");if(!$$CM.isEmpty(this._cfo.legendCssClass)){this._legendControl.AddClassName(this._cfo.legendCssClass)}if(this._cfo.stretch==true){this.AddClassName("cmHorizontalInput")}else{this.RemoveClassName("cmHorizontalInput")}if(!$$CM.isEmpty(this._cfo.legendInnerControlCssClass)){this._legendInnerControl.AddClassName(this._cfo.legendInnerControlCssClass)}}else{if(!$$CM.isEmpty(this._cfo.cssClass)){this.AddClassName(this._cfo.cssClass)}if(!$$CM.isEmpty(this._cfo.legendCssClass)){this._legendControl.AddClassName(this._cfo.legendCssClass)}if(!$$CM.isEmpty(this._cfo.legendInnerControlCssClass)){this._legendInnerControl.AddClassName(this._cfo.legendInnerControlCssClass)}}this._formControlArray=$A()},createEvents:function(){this.SelectionChangedEvent=new cm.event()},GetTitleControl:function(){return this._legendControl},GetTitleInnerControl:function(){return this._legendInnerControl},GetLegendControl:function(){return this._legendControl},GetLegendInnerControl:function(){return this._legendInnerControl},GetFormControlArray:function(){return this._formControlArray},ResetFormControlArray:function(){this._formControlArray=$A()},SetPlaceholderText:function(a){},SetLabel:function(a){this._legendInnerControl.UpdateInnerHtml(a);this._legendControl.Show()},GetLabel:function(){return this._legendInnerControl.GetInnerHtml()}});cm.ui.common.Fieldset2ConfigOptions=Class.create(cm.ui.common.FieldsetConfigOptions,{htmlCssVersion:2});$$FS2=cm.ui.common.Fieldset2=Class.create(cm.ui.common.Fieldset,{configureDefaultOptions:function(){return new cm.ui.common.Fieldset2ConfigOptions()}});"cm.ui.common".namespace();cm.ui.common.ListEditorDialogControl=Class.create(cm.ui.ComplexControl,{SaveEvent:null,SaveAddEvent:null,CancelEvent:null,initializeUIElements:function($super){$super();this._cmDivControlFooter=$$P.div("ft");this.AddChild(this._cmDivControlFooter);this._cmDivControlFooter.AddClassName("ft");this._btnSave=new $$BTN(null,{text:"Save"});this._cmDivControlFooter.AddChild(this._btnSave);this._btnSave.AddClassName("cmFloatRight cmGoButton");this._btnSaveAdd=new $$BTN(null,{text:"Save + Add Another"});this._cmDivControlFooter.AddChild(this._btnSaveAdd);this._btnSaveAdd.AddClassName("cmFloatRight cmGoButton");this._btnCancel=new $$BTN(null,{text:"Cancel"});this._cmDivControlFooter.AddChild(this._btnCancel);this._btnCancel.AddClassName("cmCancelDeleteButton")},createEvents:function(){this.SaveEvent=new cm.event();this.SaveAddEvent=new cm.event();this.CancelEvent=new cm.event()},wireEvents:function($super){$super();this._btnSave.ClickEvent.subscribe(this.onBtnSaveClick,this);this._btnSaveAdd.ClickEvent.subscribe(this.onBtnSaveAddClick,this);this._btnCancel.ClickEvent.subscribe(this.onBtnCancel,this)},onBtnSaveClick:function(){this.SaveEvent.fire(this,null)},onBtnSaveAddClick:function(){this.SaveAddEvent.fire(this,null)},onBtnCancel:function(){this.CancelEvent.fire(this,null)}});"cm.ui.common".namespace();cm.ui.common.SliderConfigOptions=Class.create(cm.ConfigOptions,{min:0,max:100,vertical:false,step:1,defaultValue:0});$$FSLIDER=cm.ui.common.Slider=Class.create(cm.ui.UILibraryControl,{GetData:function(){return this.getLibraryElement().slider("value")},Bind:function(a){this.getLibraryElement().slider("value",a)},SetMax:function(a){this.getLibraryElement().slider("option","max",a)},configureDefaultOptions:function(){return new cm.ui.common.SliderConfigOptions()},postInitialize:function(){this.getLibraryElement().slider(this.GetConfigOptions())},createEvents:function(){this.AddChangeListener()},wireEvents:function(){var a=this;this.getLibraryElement().bind("slidechange",function(b){a.ChangeEvent.fire(a,b)})},SetEnabled:function(a){if(a==true){this.getLibraryElement().slider("enable")}else{this.getLibraryElement().slider("disable")}},GetTitleControl:function(){}});"cm.ui.common".namespace();cm.ui.common.SwappableConfigOptions=Class.create(cm.ui.common.DraggableConfigOptions,{scope:"swapperDefault",revertDragMode:false,active:true});cm.ui.common.Swappable=Class.create(cm.ui.common.Draggable,{_scope:null,SwapEvent:null,DragOver:null,createEvents:function($super){$super();this.SwapEvent=new cm.event(true);this.DragOver=new cm.event()},initializeData:function(){this._scope=this.GetConfigOptions().scope},SetActive:function($super,c){if(this.GetConfigOptions().revertDragMode==true){$super(c)}else{var b=this;this.getLibraryElement().unbind("drop");this.getLibraryElement().unbind("dropover");if(c==true){var a=this.GetConfigOptions();a.embed({scope:this._scope});this.getLibraryElement().draggable(a);this.getLibraryElement().droppable({hoverClass:"cmSwapHover",scope:this._scope,greedy:true});this.getLibraryElement().bind("drop",function(d,f){if(d.target==b.GetHtmlElement()){var e=f.draggable[0].dragItem;b.SwapEvent.fire(b,e)}});this.getLibraryElement().unbind("dragstart");this.getLibraryElement().unbind("dragstop");this.getLibraryElement().bind("dragstart",function(d,e){b.DragStart.fire(b,{event:d,ui:e})});this.getLibraryElement().bind("dragstop",function(d,e){b.DragStop.fire(b,{event:d,ui:e})});this.getLibraryElement().bind("dropover",function(d,e){b.DragOver.fire(b,{item:e.draggable[0].dragItem,event:d,ui:e})})}}},getDragItem:function(){return this}});"cm.ui.common".namespace();cm.ui.common.Swappable2ConfigOptions=Class.create(cm.ui.common.DraggableConfigOptions,{scope:"swapperDefault",revertDragMode:false,active:true,containment:"",hoverClass:""});cm.ui.common.Swappable2=Class.create(cm.ui.common.Draggable,{_scope:null,SwapEvent:null,createEvents:function($super){$super();this.SwapEvent=new cm.event()},initializeData:function(){this._scope=this.GetConfigOptions().scope},SetActive:function($super,b){this.AddClassName("accept"+this.GetConfigOptions().scope);if(this.GetConfigOptions().revertDragMode==true){$super(b)}else{var a=this;this.getLibraryElement().unbind("drop");if(b==true){this.getLibraryElement().draggable({hoverClass:"cmGroupActivationSwap",containment:this.GetConfigOptions().containment,scroll:true,helper:"clone",zIndex:2000});this.getLibraryElement().droppable({hoverClass:this.GetConfigOptions().hoverClass,scope:this._scope,greedy:false,tolerance:"pointer"});this.getLibraryElement().bind("drop",function(c,e){if(c.target==a.GetHtmlElement()){var d=e.draggable[0].dragItem;d.event=c;a.SwapEvent.fire(a,d)}});this.getLibraryElement().unbind("dragstart");this.getLibraryElement().unbind("dragstop");this.getLibraryElement().bind("dragstart",function(c,d){a.DragStart.fire(a,{})});this.getLibraryElement().bind("dragstop",function(c,d){a.DragStop.fire(a,{})})}}},getDragItem:function(){return this}});"cm.ui.common".namespace();cm.ui.common.FieldsetCheckboxListConfigOptions=Class.create(cm.ui.common.FieldsetConfigOptions,{legendLabel:"",legendCssClass:"cmLegendBasic",listCssClass:"",labelCssClass:"",inputCssClass:"",stretch:false,dataSource:$A(),value:null,__evals:$A(["MULTISELECT"]),__meta:{legendLabel:{displayName:"Label"},legendCssClass:{hidden:true},inputCssClass:{hidden:true},labelCssClass:{hidden:true},dataSource:{fieldEditor:"cm.ui.fieldeditor.SelectFieldEditor",displayName:"Options"},value:{hidden:true}}});$$FSCBL=cm.ui.common.FieldsetCheckboxList=Class.create(cm.ui.common.Fieldset,{configureDefaultOptions:function(){return new cm.ui.common.FieldsetCheckboxListConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions()},initializeUIElements:function($super){$super();if(this.Version()==1){var b=($$CM.isNull(this.ID()))?"":this._id;this._divList=$$P.div("div"+b+"List");this.AddChild(this._divList);this.AddClassName("cmInputFieldset");this.GetLegendControl().AddClassName("cmLegendLabel");this._divList.AddClassName("cmFloatLeft cmGroup")}else{var a=$$P.div(null,null,{classNames:"cmFormControlInputWrapper"});this.AddChild(a);this._divList=$$P.div(null,null,{classNames:"cmFormControlInput"});a.AddChild(this._divList);this._fieldTipControl=$$P.span(null,this.GetConfigOptions().fieldTip,{classNames:"cmFormControlFieldTip"});a.AddChild(this._fieldTipControl);if($$CM.isEmpty(this.GetConfigOptions().fieldTip)){this._fieldTipControl.Hide()}this.AddClassName("cmFormControl");this.AddClassName("cmFormControlFieldsetCheckboxList");this.GetLegendControl().AddClassName("cmFormControlTitleOuter");this.GetLegendInnerControl().AddClassName("cmFormControlTitleInner");if(this.GetConfigOptions().stretch==true){this.AddClassName("cmFormControlStretch")}}if(!$$CM.isEmpty(this._co.listCssClass)){this._divList.AddClassName(this._co.listCssClass)}},postInitialize:function(){this.bindList(this._co.dataSource);if(!$$CM.isNull(this._co.value)){this.Bind(this._co.value)}},bindList:function(a){this._divList.ClearChildControls();this.ResetFormControlArray();this._co.Set("dataSource",a);var b=$$CM.uniqueID();a.each(function(c){c.GroupName=b;this.AddFormCheckbox(c)},this)},GetName:function($super){var a=this._co.legendLabel;if($$CM.isEmpty(a)){a=$super()}return a},GetListControl:function(){return this._divList},AddFormCheckbox:function(a){var c=this.GetFormControlArray().length;var b;if(this.Version()==1){b=new $$FCB("fcb"+a.GroupName+"_"+c,{value:a.ID,label:a.Name,labelClass:this._co.labelCssClass,name:a.GroupName})}else{b=new $$FCB2(null,{value:a.ID,label:a.Name,labelClass:this._co.labelCssClass,name:a.GroupName,classNames:"oneOfMany",isAfter:false})}this._divList.AddChild(b);this.GetFormControlArray().push(b);b.ChangeEvent.subscribe(this.onChange,this)},onChange:function(b,a){this.SelectionChangedEvent.fire(b,a)},onDataUpdated:function(){var a=this.GetBoundData();this.GetFormControlArray().each(function(b){b.Bind(false)},this);if($$CM.isArray(a)&&a.length>0){this.GetFormControlArray().each(function(b){var d=b.GetValue();var c=a.find(function(e){return e+""==d+""},this);b.Bind(!$$CM.isNull(c))},this)}},GetData:function(){var a=$A();this.GetFormControlArray().each(function(b){if(b.IsChecked()==true){var c=b.GetValue();if(!$$CM.isEmpty(c)){a.push(c)}}},this);return a}});cm.ui.common.FieldsetCheckboxList2ConfigOptions=Class.create(cm.ui.common.FieldsetCheckboxListConfigOptions,{htmlCssVersion:2});$$FSCBL2=cm.ui.common.FieldsetCheckboxList2=Class.create(cm.ui.common.FieldsetCheckboxList,{configureDefaultOptions:function(){return new cm.ui.common.FieldsetCheckboxList2ConfigOptions()}});"cm.ui.common".namespace();$$FSL=cm.ui.common.FieldsetList=Class.create(cm.ui.common.Fieldset,{_listControl:null,_formControlArray:null,initializeUIElements:function($super){$super();this._listControl=new cm.ui.utilityControls.Sortable("ul");this.AddChild(this._listControl)},createEvents:function(){this.onSortableListItemChangedEvent=new cm.event()},wireEvents:function($super){$super();this.GetListControl().onSortableListItemChangedEvent.subscribe(this.onSortableListItem_changed,this)},GetInputControl:function(){return this._listControl},GetListControl:function(){return this._listControl},AddListItemControl:function(a){var b=$$P.li(a.ID());this._listControl.AddChild(b);b.AddChild(a)},ActivateSortable:function(){this.GetListControl().Activate()},onSortableListItem_changed:function(a){this.onSortableListItemChangedEvent.fire(this,a)}});"cm.ui.common".namespace();cm.ui.common.FieldsetRadioButtonListConfigOptions=Class.create(cm.ui.common.FieldsetConfigOptions,{legendLabel:"",legendCssClass:"cmLegendBasic",listCssClass:"",labelCssClass:"",titleCssClass:"",inputCssClass:"",stretch:false,value:null,dataSource:$A(),__evals:$A(["GROUP","BOOL"]),__meta:{legendLabel:{displayName:"Label"},legendCssClass:{hidden:true},inputCssClass:{hidden:true},labelCssClass:{hidden:true},dataSource:{fieldEditor:"cm.ui.fieldeditor.SelectFieldEditor",displayName:"Options"},value:{hidden:true}}});$$FSRBL=cm.ui.common.FieldsetRadioButtonList=Class.create(cm.ui.common.Fieldset,{configureDefaultOptions:function(){return new cm.ui.common.FieldsetRadioButtonListConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._randomGroupID=$$CM.uniqueID()},initializeUIElements:function($super){$super();if(this.Version()==1){this.AddClassName("cmInputFieldset");this._legendControl.AddClassName("cmLegendLabel");this._divList=$$P.div("divList_"+this._uniqueID);this.AddChild(this._divList);this._divList.AddClassName("cmClear_ cmFloatLeft cmGroup")}else{var a=$$P.div(null,null,{classNames:"cmFormControlInputWrapper"});this.AddChild(a);this._divList=$$P.div(null,null,{classNames:"cmFormControlInput"});a.AddChild(this._divList);this._fieldTipControl=$$P.span(null,this._co.fieldTip,{classNames:"cmFormControlFieldTip"});a.AddChild(this._fieldTipControl);if($$CM.isEmpty(this._co.fieldTip)){this._fieldTipControl.Hide()}this.AddClassName("cmFormControl");this.AddClassName("cmFormControlFieldsetRadioButtonList");this.GetLegendControl().AddClassName("cmFormControlTitleOuter");this.GetLegendInnerControl().AddClassName("cmFormControlTitleInner");if(this._co.stretch==true){this.AddClassName("cmFormControlStretch")}}if(!$$CM.isEmpty(this._co.listCssClass)){this._divList.AddClassName(this._co.listCssClass)}},postInitialize:function(){this.bindList(this._co.dataSource);if(!$$CM.isNull(this._co.value)){this.Bind(this._co.value)}},bindList:function(a){this._divList.ClearChildControls();this._co.Set("dataSource",a);var b=$$CM.uniqueID();a.each(function(c){c.GroupName=b;this.AddFormRadioButton(c)},this)},GetName:function($super){var a=this._co.legendLabel;if($$CM.isEmpty(a)){a=$super()}return a},GetListControl:function(){return this._divList},AddFormRadioButton:function(a){var d=this.GetFormControlArray().length;var c=this._randomGroupID;if(!$$CM.isEmpty(a.GroupName)){c=a.GroupName}var b;if(this.Version()==1){b=new $$FRB("frb_"+c+"_"+d,{value:a.ID,label:a.Name,name:c,labelClass:a.cssClass,labelCssClass:this._co.labelCssClass,titleCssClass:this._co.titleCssClass,inputCssClass:this._co.inputCssClass})}else{b=new $$FRB2(null,{value:a.ID,label:a.Name,name:c,labelClass:a.cssClass,labelCssClass:this._co.labelCssClass,titleCssClass:this._co.titleCssClass,inputCssClass:this._co.inputCssClass,classNames:"oneOfMany",isAfter:false})}this._divList.AddChild(b);this.GetFormControlArray().push(b);b.ChangeEvent.subscribe(this.onChange,this)},onChange:function(b,a){this.SelectionChangedEvent.fire(b,a)},onDataUpdated:function(){var a=this.GetBoundData();this.GetFormControlArray().each(function(b){b.Bind(false)},this);if(!$$CM.isNull(a)){this.GetFormControlArray().each(function(b){var d=b.GetValue();var c=(a+""==d+"");b.Bind(c==true)},this)}},GetData:function(){var a=null;var b=$A();this.GetFormControlArray().each(function(c){if(c.IsChecked()==true){var d=c.GetValue();if(!$$CM.isEmpty(d)){b.push(d)}}},this);if($$CM.isArray(b)&&b.length>0){a=b[0]}return a},SetTabIndex:function(a){if(!$$CM.isNull(this.GetFormControlArray())){this.GetFormControlArray()[0].SetTabIndex(a)}},SetValidation:function(a){this.Validator.RemoveAll();var d=a;if($$CM.isEmpty(d)&&!$$CM.isEmpty(this._co.label)){d=this._co.label}if($$CM.isNull(d)){var b="";if(!$$CM.isNull(this.GetConfigOptions().groupFieldName)){b=this.GetConfigOptions().groupFieldName+" - "}d=b}var c=(this.GetConfigOptions().required==true)?true:false;this.Validator.addEvaluator($$EVAL.GROUP({FieldName:d,IsRequired:c}))}});cm.ui.common.FieldsetRadioButtonList2ConfigOptions=Class.create(cm.ui.common.FieldsetRadioButtonListConfigOptions,{htmlCssVersion:2});$$FSRBL2=cm.ui.common.FieldsetRadioButtonList2=Class.create(cm.ui.common.FieldsetRadioButtonList,{configureDefaultOptions:function(){return new cm.ui.common.FieldsetRadioButtonList2ConfigOptions()}});$$FSRBLB2=cm.ui.common.FieldsetRadioButtonListBoolean2=Class.create(cm.ui.common.FieldsetRadioButtonList2,{initializeData:function($super){$super();this._co.Set("dataSource",cm.Enums.YesNoMaybe.GetArrayWithout(null,"maybe"))}});"cm.ui.common".namespace();cm.ui.common.FieldsetRadioButtonListBooleanConfigOptions=Class.create(cm.ui.common.FieldsetConfigOptions,{legendLabel:"",legendCssClass:"cmLegendBasic",initialTabIndex:1});$$FSRBLB=cm.ui.common.FieldsetRadioButtonListBoolean=Class.create(cm.ui.common.Fieldset,{configureDefaultOptions:function(){return new cm.ui.common.FieldsetRadioButtonListBooleanConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}},initializeUIElements:function($super){$super();var b=this.ID();this._divList=$$P.div("div"+b+"List");this.AddChild(this._divList);this._divList.AddClassName("cmFloatLeft cmGroup");var d=cm.Enums.YesNoMaybe.GetArrayWithout(null,"maybe");if($$CM.isArray(d)){var a=b+"YesNo"+$$CM.uniqueID();var c=this.GetConfigOptions().initialTabIndex;d.each(function(f){var e={ID:f.ID,Name:f.Name,GroupName:a};this.AddFormRadioButton(e,c);c++},this)}this.AddClassName("cmInputFieldset");this._legendControl.AddClassName("cmLegendLabel")},GetLegendControl:function(){return this._legendControl},GetListControl:function(){return this._divList},AddFormRadioButton:function(a,c){var b=new $$FRB("frb"+a.GroupName+"_"+a.ID,{value:a.ID,label:a.Name,name:a.GroupName});this._divList.AddChild(b);if(!$$CM.isEmpty(this._co.labelCssClass)){b.AddClassName(this._co.labelCssClass)}this.GetFormControlArray().push(b);b.ChangeEvent.subscribe(this.onChange,this);b.SetTabIndex(c)},onChange:function(b,a){this.SelectionChangedEvent.fire(b,a)},IsValid:function(){var a=this.GetFormControlArray().find(function(b){return b.IsChecked()},this);return !$$CM.isNull(a)},ClearFields:function(){this.GetFormControlArray().each(function(a){a.Bind(false)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){a=a+"";a=a.toLowerCase();var b=null;if(a=="1"||a=="yes"||a=="true"){b=this.GetFormControlArray().find(function(c){return c.GetValue()=="1"||c.GetValue()=="yes"||c.GetValue()=="true"},this)}else{if(a=="0"||a=="no"||a=="false"){b=this.GetFormControlArray().find(function(c){return c.GetValue()=="0"||c.GetValue()=="no"||c.GetValue()=="false"},this)}}if(!$$CM.isNull(b)){b.Bind(true)}}},GetData:function(){var a=null;this.GetFormControlArray().each(function(b){if(b.IsChecked()==true){var c=b.GetValue().toLowerCase();a=$$CM.stringToBoolean(c)}},this);return a}});"cm.ui.common".namespace();cm.ui.common.ListEditorDialogCategoryControl=Class.create(cm.ui.ComplexControl,{SaveEvent:null,CancelEvent:null,initializeUIElements:function($super){$super();this._cmDivControlBody=$$P.div("bd");this.AddChild(this._cmDivControlBody);this._cmDivControlBody.AddClassName("bd");this._cmDivControlFooter=$$P.div("ft");this.AddChild(this._cmDivControlFooter);this._cmDivControlFooter.AddClassName("ft");this._btnSave=new $$BTN(null,{text:"Save"});this._cmDivControlFooter.AddChild(this._btnSave);this._btnSave.AddClassName("cmFloatRight cmGoButton");this._btnCancel=new $$BTN(null,{text:"Cancel"});this._cmDivControlFooter.AddChild(this._btnCancel);this._btnCancel.AddClassName("cmCancelDeleteButton")},createEvents:function(){this.SaveEvent=new cm.event();this.CancelEvent=new cm.event()},wireEvents:function($super){$super();this._btnSave.ClickEvent.subscribe(this.onBtnSaveClick,this);this._btnCancel.ClickEvent.subscribe(this.onBtnCancel,this)},onBtnSaveClick:function(){this.SaveEvent.fire(this,null)},onBtnCancel:function(){this.CancelEvent.fire(this,null)},onDataUpdated:function(){var a=this.GetBoundData();if(a.Name){}},GetData:function(){var a=this.GetBoundData();return a},Reset:function(){}});"cm.ui.common".namespace();cm.ui.common.ListEditorDialogContainerControlConfigOptions=Class.create(cm.ConfigOptions,{includeCategory:false});cm.ui.common.ListEditorDialogContainerControl=Class.create(cm.ui.common.ListEditorDialogControl,{configureDefaultOptions:function(){return new cm.ui.common.ListEditorDialogContainerControlConfigOptions()},initializeUIElements:function($super){this._cmDivControlBody=$$P.div("bd");this.AddChild(this._cmDivControlBody);this._cmDivControlBody.AddClassName("bd");if(this.GetConfigOptions().includeCategory==true){var a=$$P.p();this._cmDivControlBody.AddChild(a);this._ddlCategory=new $$FDDL("ddlCategory",{label:"Category"});a.AddChild(this._ddlCategory)}var a=$$P.p();this._cmDivControlBody.AddChild(a);this._txtName=new $$FTXT("txtPositionTitle",{label:"Name"});a.AddChild(this._txtName);$super()},wireEvents:function($super){$super()},onDataUpdated:function(){var a=this.GetBoundData();if(a.Name){this._txtName.Bind(a.Name)}},GetData:function(){var a=this.GetBoundData();a.Name=this._txtName.GetData();return a},Reset:function(){this._txtName.Bind("")}});"cm.ui.common".namespace();cm.ui.common.ListSliderConfigOptions=Class.create(cm.ui.common.SliderConfigOptions,{dataSource:$A(),showCaps:true,showValue:true,htmlCssVersion:1});$$FLSLIDER=cm.ui.common.ListSlider=Class.create(cm.ui.Control,{_leftLabel:null,_rightLabel:null,_valueLabel:null,_dataSource:$A(),GetData:function(){if(this._dataSource.length>0){return this._dataSource[this._slider.GetData()].Name}else{return""}},Bind:function(a){var b=this._dataSource.find(function(c){return c.Name==a});if($$CM.isNull(b)){b=this._dataSource.find(function(c){return c.ID==a})}if(!$$CM.isNull(b)){this._slider.Bind(this._dataSource.indexOf(b))}},bindList:function(a){if($$CM.isArray(a)&&a.length>0){this._leftLabel.UpdateInnerHtml(a[0].Name);this._rightLabel.UpdateInnerHtml(a[a.length-1].Name);this._slider.SetMax(a.length-1);this._dataSource=a}},initializeUIElements:function(){var a=this.GetConfigOptions();var b=a.dataSource;if(this.Version()==1){this.AddClassName("cmFloatLeft w100prct cmSlider")}else{this.AddClassName("cmFormControlListSlider")}this._leftLabel=$$P.span();if(this.Version()==1){this._leftLabel.AddClassName("pb10px mr5prct w14prct cmFloatLeft cmTARight")}else{this._leftLabel.AddClassName("cmFormControlListSliderLabelLeft")}this.AddChild(this._leftLabel);var c=$$P.div();c.AddClassName("cmFormControlListSliderWrapper");if(this.Version()==2){this.AddChild(c)}this._slider=new $$FSLIDER(null,{max:b.length-1});if(this.Version()==1){this._slider.AddClassName("w60prct cmFloatLeft")}else{this._slider.AddClassName("cmFormControlListSliderSlider")}if(this.Version()==1){this.AddChild(this._slider)}else{c.AddChild(this._slider)}if(!$$CM.isNull(a.defaultValue)){this._slider.Bind(a.defaultValue)}this._rightLabel=$$P.span();if(this.Version()==1){this._rightLabel.AddClassName("pb10px ml5prct cmFloatLeft w14prct")}else{this._rightLabel.AddClassName("cmFormControlListSliderLabelRight")}this.AddChild(this._rightLabel);this._valueLabel=$$P.span();this._valueLabel.UpdateInnerHtml("&nbsp;");if(this.Version()==1){this._valueLabel.AddClassName("cmFloatLeft cmClearBoth cmSliderCenter");this.AddChild(this._valueLabel)}else{this._valueLabel.AddClassName("cmFormControlListSliderValue");c.AddChild(this._valueLabel)}if(a.showCaps!=true){this._leftLabel.Hide();this._rightLabel.Hide()}if(a.showValue!=true){this._valueLabel.Hide()}},createEvents:function(){this.AddChangeListener()},wireEvents:function(){this._slider.ChangeEvent.subscribe(this.onSliderChange,this)},configureDefaultOptions:function(){return new cm.ui.common.ListSliderConfigOptions()},onSliderChange:function(c,a){var d=this._slider.GetData();if($$CM.isArray(this._dataSource)&&d>=0&&d<this._dataSource.length){var b=this._dataSource[d];if(!$$CM.isNull(b)){this._valueLabel.UpdateInnerHtml(b.Name)}}this.ChangeEvent.fire(this,this._slider.GetData())}});cm.ui.common.ListSlider2ConfigOptions=Class.create(cm.ui.common.ListSliderConfigOptions,{htmlCssVersion:2});$$FLSLIDER2=cm.ui.common.ListSlider2=Class.create(cm.ui.common.ListSlider,{configureDefaultOptions:function(){return new cm.ui.common.ListSlider2ConfigOptions()}});"cm.ui.common".namespace();cm.ui.common.AdditionalCommentsConfigOptions=Class.create(cm.ConfigOptions,{});$$FADDITIONALCOMMENTS=cm.ui.common.AdditionalComments=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.AdditionalCommentsConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();if(!$$CM.isEmpty(this._cfo.uniqueID)){this._uniqueID=this._cfo.uniqueID}else{this._uniqueID=$$CM.uniqueID()}},initializeUIElements:function(){this.AddClassName("cmFormRow cmAddComments");this._addAdditionalComments=$$P.p("addAdditionalComments_"+this._uniqueID);this.AddChild(this._addAdditionalComments);this._aAddAdditionalComments=$$P.a("aAddAdditionalComments_"+this._uniqueID,"Additional comments");this._addAdditionalComments.AddChild(this._aAddAdditionalComments);this._spanAddAdditionalComments=$$P.span("spanAddAdditionalComments_"+this._uniqueID,"Additional comments");this._addAdditionalComments.AddChild(this._spanAddAdditionalComments);this._spanAddAdditionalComments.Hide();this._txaAdditionalComments=$$P.txa("ftxaAdditionalComments_"+this._uniqueID);this.AddChild(this._txaAdditionalComments);this._txaAdditionalComments.AddClassName("cmFixBoxSize");this._txaAdditionalComments.AssignStyle("width","100%");this._txaAdditionalComments.AssignStyle("margin-top","5px");this._txaAdditionalComments.AssignStyle("margin-bottom","5px");this._txaAdditionalComments.Hide();this._aHideAdditionalComments=$$P.a("aHideAdditionalComments_"+this._uniqueID,"Hide additional comments");this.AddChild(this._aHideAdditionalComments);this._aHideAdditionalComments.AddClassName("cmFormRow");this._aHideAdditionalComments.Hide()},createEvents:function(){this._aAddAdditionalComments.AddClickListener();this._aHideAdditionalComments.AddClickListener()},wireEvents:function($super){$super();this._aAddAdditionalComments.ClickEvent.subscribe(this.onAddAdditionalComments_click,this);this._aHideAdditionalComments.ClickEvent.subscribe(this.onHideAdditionalComments_click,this)},SetTabIndex:function(a){this._txaAdditionalComments.SetTabIndex(a++)},GetData:function(){if(this._txaAdditionalComments.IsVisible()){return $$E(this._txaAdditionalComments).value}return null},onAddAdditionalComments_click:function(){this._aAddAdditionalComments.Hide();this._spanAddAdditionalComments.Show();this._txaAdditionalComments.Show();this._aHideAdditionalComments.Show()},onHideAdditionalComments_click:function(){this._spanAddAdditionalComments.Hide();this._aAddAdditionalComments.Show();this._txaAdditionalComments.Hide();this._aHideAdditionalComments.Hide()}});"cm.ui.common".namespace();cm.ui.common.AddressConfigOptions=Class.create(cm.ConfigOptions,{enabled:true,addressType:1,rowCssClass:"cmFormRow",legendLabel:"",legendCssClass:"cmLegendBasic",controlCssClass:"",controlTitleCssClass:"",controlInputCssClass:"",controlInputSelectCssClass:"",required:false,groupFieldName:"",countryArray:$A(),stateArray:$A(),originalDataEnabled:false,initialTabIndex:1,countryLabel:"Country",cityLabel:"City",addressLabel:"Address",address2Label:"",stateLabel:"State",address2Label:"",zipLabel:"Zip",defaultCountry:"US",columns:true,useDefaultCountryOnReset:true,otherStateRequired:false,stretch:false,htmlCssVersion:1,subTitle:null,supressFieldset:false});$$FADDRESS=cm.ui.common.Address=Class.create(cm.ui.ComplexControl,{CountryChangedEvent:null,configureDefaultOptions:function(){return new cm.ui.common.AddressConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}if($$CM.isEmpty(this._co.rowCssClass)){this._co.rowCssClass="cmFormRow"}this._countryArray=this._co.countryArray;this._stateArray=this._co.stateArray;if(this._countryArray.length<=0&&$$CM.isArray(cm.dao.Lists.Data.CountryArray)&&cm.dao.Lists.Data.CountryArray.length>0){this._countryArray=cm.dao.Lists.Data.CountryArray}if(this._stateArray.length<=0&&$$CM.isArray(cm.dao.Lists.Data.StateArray)&&cm.dao.Lists.Data.StateArray.length>0){this._stateArray=cm.dao.Lists.Data.StateArray}this._defaultCountry=this._co.defaultCountry;if(!$$CM.isEmpty(this._defaultCountry)&&!$$CM.isNull($$CLIENT.Country)){this._defaultCountry=$$CLIENT.Country}this._useDefaultCountryOnReset=this._co.useDefaultCountryOnReset;this._isRequired=(this._co.required==true);this._otherStateRequired=(this._isRequired==true&&this._co.otherStateRequired==true)},initializeUIElements:function(){if(!$$CM.isEmpty(this._co.rowCssClass)){this.AddClassName(this._co.rowCssClass)}if(this._co.supressFieldset==true){this._fsAddress=$$P.div("divAddress_"+this._uniqueID)}else{this._fsAddress=new $$FS("fsAddress_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass})}this.AddChild(this._fsAddress);if(!$$CM.isNull(this._co.subTitle)){this._divSubTitle=$$P.div("divAddressFieldsLeft_"+this._uniqueID);this._fsAddress.AddChild(this._divSubTitle);this._divSubTitle.UpdateInnerHtml(this._co.subTitle)}this._divAddressFields=$$P.div("divAddressFields_"+this._uniqueID);this._fsAddress.AddChild(this._divAddressFields);this._divAddressFields.AddClassName(this._co.rowCssClass);var a="w100prct";if(this._co.columns){a="w50prct"}this._divAddressFieldsLeft=$$P.div("divAddressFieldsLeft_"+this._uniqueID);this._divAddressFields.AddChild(this._divAddressFieldsLeft);this._divAddressFieldsLeft.AddClassName("cmFloatLeft "+a);this._divAddressFieldsLeft.AssignStyle("box-sizing","border-box");this._divAddressFieldsLeft.AssignStyle("-moz-box-sizing","border-box");this._divAddressFieldsRight=$$P.div("divAddressFieldsRight_"+this._uniqueID);this._divAddressFields.AddChild(this._divAddressFieldsRight);this._divAddressFieldsRight.AddClassName("cmFloatRight "+a);this._divAddressFieldsRight.AssignStyle("box-sizing","border-box");this._divAddressFieldsRight.AssignStyle("-moz-box-sizing","border-box");if(this._co.htmlCssVersion==1){this._fddlCountry=new $$FDDL("fddlCountry_"+this._uniqueID,{label:this._co.countryLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct",fieldTip:this._co.countryFieldTip})}else{this._fddlCountry=new $$FDDL2(null,{label:this._co.countryLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddressCountry",fieldTip:this._co.countryFieldTip})}this._divAddressFieldsLeft.AddChild(this._fddlCountry);if(!$$CM.isEmpty(this._co.controlCssClass)){this._fddlCountry.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._fddlCountry.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputSelectCssClass)){this._fddlCountry.GetInputControl().AddClassName(this._co.controlInputSelectCssClass)}else{if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._fddlCountry.GetInputControl().AddClassName(this._co.controlInputCssClass)}}if(this._co.htmlCssVersion==1){this._ftxtAddress1=new $$FTXT("ftxtAddress1_"+this._uniqueID,{label:this._co.addressLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct",maxLength:100})}else{this._ftxtAddress1=new $$FTXT2(null,{label:this._co.addressLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddress1",maxLength:100})}this._divAddressFieldsLeft.AddChild(this._ftxtAddress1);if(!$$CM.isEmpty(this._co.controlCssClass)){this._ftxtAddress1.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._ftxtAddress1.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._ftxtAddress1.GetInputControl().AddClassName(this._co.controlInputCssClass)}if(this._co.htmlCssVersion==1){this._ftxtAddress2=new $$FTXT("ftxtAddress2_"+this._uniqueID,{label:this._co.address2Label,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct",maxLength:100})}else{this._ftxtAddress2=new $$FTXT2(null,{label:this._co.address2Label,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddress2",maxLength:100})}this._divAddressFieldsLeft.AddChild(this._ftxtAddress2);if(!$$CM.isEmpty(this._co.controlCssClass)){this._ftxtAddress2.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._ftxtAddress2.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._ftxtAddress2.GetInputControl().AddClassName(this._co.controlInputCssClass)}if(this._co.htmlCssVersion==1){this._ftxtCity=new $$FTXT("ftxtCity_"+this._uniqueID,{label:this._co.cityLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct",maxLength:100})}else{this._ftxtCity=new $$FTXT2(null,{label:this._co.cityLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddressCity",maxLength:100})}this._divAddressFieldsRight.AddChild(this._ftxtCity);if(!$$CM.isEmpty(this._co.controlCssClass)){this._ftxtCity.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._ftxtCity.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._ftxtCity.GetInputControl().AddClassName(this._co.controlInputCssClass)}if(this._co.htmlCssVersion==1){this._ftxtStateProvince=new $$FTXT("ftxtStateProvince_"+this._uniqueID,{label:this._co.stateLabel,isRequired:this._otherStateRequired,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct",maxLength:100})}else{this._ftxtStateProvince=new $$FTXT2(null,{label:this._co.stateLabel,isRequired:this._otherStateRequired,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddressStateFTXT",maxLength:100})}this._divAddressFieldsRight.AddChild(this._ftxtStateProvince);if(!$$CM.isEmpty(this._co.controlCssClass)){this._ftxtStateProvince.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._ftxtStateProvince.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._ftxtStateProvince.GetInputControl().AddClassName(this._co.controlInputCssClass)}this._ftxtStateProvince.Hide();this._ftxtStateProvince.EnableInputControl(false);if(this._co.htmlCssVersion==1){this._fddlStateProvince=new $$FDDL("fddlStateProvince_"+this._uniqueID,{label:this._co.stateLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct"})}else{this._fddlStateProvince=new $$FDDL2(null,{label:this._co.stateLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddressStateFDDL"})}this._divAddressFieldsRight.AddChild(this._fddlStateProvince);if(!$$CM.isEmpty(this._co.controlCssClass)){this._fddlStateProvince.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._fddlStateProvince.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputSelectCssClass)){this._fddlStateProvince.GetInputControl().AddClassName(this._co.controlInputSelectCssClass)}else{if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._fddlStateProvince.GetInputControl().AddClassName(this._co.controlInputCssClass)}}this._fddlStateProvince.EnableInputControl(false);if(this._co.htmlCssVersion==1){this._ftxtPostalCode=new $$FTXT("ftxtPostalCode_"+this._uniqueID,{label:this._co.zipLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,classNames:"w100prct",maxLength:20})}else{this._ftxtPostalCode=new $$FTXT2(null,{label:this._co.zipLabel,isRequired:this._isRequired,originalDataEnabled:this._co.originalDataEnabled,stretch:this._co.stretch,classNames:"fAddressPostalCode",maxLength:20})}this._divAddressFieldsRight.AddChild(this._ftxtPostalCode);if(!$$CM.isEmpty(this._co.controlCssClass)){this._ftxtPostalCode.AddClassName(this._co.controlCssClass)}if(!$$CM.isEmpty(this._co.controlTitleCssClass)){this._ftxtPostalCode.GetTitleControl().AddClassName(this._co.controlTitleCssClass)}if(!$$CM.isEmpty(this._co.controlInputCssClass)){this._ftxtPostalCode.GetInputControl().AddClassName(this._co.controlInputCssClass)}var b=this.GetConfigOptions().initialTabIndex;this.SetTabIndex(b);this.BindStaticLists()},createEvents:function(){this.CountryChangedEvent=new cm.event();this._ftxtAddress1.AddChangeListener();this._ftxtCity.AddChangeListener();this._ftxtStateProvince.AddChangeListener();this._fddlStateProvince.AddChangeListener();this._ftxtPostalCode.AddChangeListener();this._fddlCountry.AddChangeListener();this.SetValidation()},wireEvents:function($super){$super();this._fddlCountry.ChangeEvent.subscribe(this.onCountryChange,this)},SetTabIndex:function(b){var a=$$CM.isNull(b)?1:b;this._fddlCountry.SetTabIndex(a);this._ftxtAddress1.SetTabIndex(++a);this._ftxtAddress2.SetTabIndex(++a);this._ftxtCity.SetTabIndex(++a);this._ftxtStateProvince.SetTabIndex(++a);this._fddlStateProvince.SetTabIndex(a);this._ftxtPostalCode.SetTabIndex(++a);return a},BindStaticLists:function(){var a="";if(this._useDefaultCountryOnReset){a=this._defaultCountry}this._fddlCountry.bindList(this._countryArray,a,"Select Country");this.onCountryChange()},onCountryChange:function(){var a=this._fddlCountry.GetData();this.onCountryChangeHandler(a,"");if(this.CountryChangedEvent){this.CountryChangedEvent.fire(this,a)}},onCountryChangeHandler:function(b,e){if(this._co.addressType==1){if(!$$CM.isEmpty(b)){var a=b.toLowerCase();if(a=="usa"||a=="united states"){b="US"}}else{if(this._useDefaultCountryOnReset){b=this._co.defaultCountry}}this._fddlCountry.Bind(b);this._fddlStateProvince.RemoveClassName("cmValidationError");if($$CM.isEmpty(b)){$$E(this._fddlStateProvince.GetInputControl()).disabled=true;this._ftxtStateProvince.Hide();if(this._otherStateRequired==true){this._ftxtStateProvince.Validator.Disable()}this._fddlStateProvince.Show();this._fddlStateProvince.EnableInputControl(false);this._fddlStateProvince.Validator.Disable();this._fddlStateProvince.bindList($A(),"","Select State",true)}else{$$E(this._fddlStateProvince.GetInputControl()).disabled=false;var f=this._stateArray.findAll(function(c){return c.CountryCode==b},this);if(f.length==0){this._ftxtStateProvince.Show();this._ftxtStateProvince.EnableInputControl(true);if(this._otherStateRequired==true){this._ftxtStateProvince.Validator.Enable()}this._fddlStateProvince.Hide();this._fddlStateProvince.Validator.Disable();this._fddlStateProvince.EnableInputControl(false);this._ftxtStateProvince.SetLabel("State/Prov.");this._ftxtPostalCode.SetLabel("Postal Code");if(!$$CM.isEmpty(e)){this._ftxtStateProvince.SetValue(e)}}else{this._ftxtStateProvince.Hide();this._ftxtStateProvince.EnableInputControl(false);if(this._otherStateRequired==true){this._ftxtStateProvince.Validator.Disable()}this._fddlStateProvince.Show();this._fddlStateProvince.Validator.Enable();this._fddlStateProvince.EnableInputControl(true);var d="";if(b=="CA"){d="Select Province";this._fddlStateProvince.SetLabel("Province");this._ftxtPostalCode.SetLabel("Postal Code")}else{if(b=="MX"){d="Select State";this._fddlStateProvince.SetLabel("State");this._ftxtPostalCode.SetLabel("Postal Code")}else{if(b=="US"){d="Select State";this._fddlStateProvince.SetLabel("State");this._ftxtPostalCode.SetLabel("Zip")}else{d="Select State/Prov.";this._fddlStateProvince.SetLabel("State/Prov.");this._ftxtPostalCode.SetLabel("Postal Code")}}}this._fddlStateProvince.bindList(f,"",d,true);if(!$$CM.isEmpty(e)){this._fddlStateProvince.setSelectedValue(e)}}}}},SetValidation:function(){var a="";if(!$$CM.isEmpty(this._co.groupFieldName)){a=this._co.groupFieldName+" - "}this._ftxtAddress1.Validator.addEvaluator($$EVAL.STRING({FieldName:a+"Address1",IsRequired:this._co.required}),this._ftxtAddress1.ChangeEvent);this._ftxtCity.Validator.addEvaluator($$EVAL.STRING({FieldName:a+"City",IsRequired:this._co.required}),this._ftxtCity.ChangeEvent);if(this._otherStateRequired==true){this._ftxtStateProvince.Validator.addEvaluator($$EVAL.STRING({FieldName:a+"State/Province",IsRequired:this._co.required}),this._ftxtStateProvince.ChangeEvent)}this._fddlStateProvince.Validator.addEvaluator($$EVAL.STRING({FieldName:a+"State/Province",IsRequired:this._co.required}),this._fddlStateProvince.ChangeEvent);this._ftxtPostalCode.Validator.addEvaluator($$EVAL.STRING({FieldName:a+"Postal Code",IsRequired:this._co.required}),this._ftxtPostalCode.ChangeEvent);this._fddlCountry.Validator.addEvaluator($$EVAL.STRING({FieldName:a+"Country",IsRequired:this._co.required}),this._fddlCountry.ChangeEvent);if(this._co.required==true){this._ftxtAddress1.Validator.Enable();this._ftxtCity.Validator.Enable();if(this._otherStateRequired==true){this._ftxtStateProvince.Validator.Enable()}this._fddlStateProvince.Validator.Enable();this._ftxtPostalCode.Validator.Enable();this._fddlCountry.Validator.Enable()}else{this._ftxtAddress1.Validator.Disable();this._ftxtCity.Validator.Disable();if(this._otherStateRequired==true){this._ftxtStateProvince.Validator.Disable()}this._fddlStateProvince.Validator.Disable();this._ftxtPostalCode.Validator.Disable();this._fddlCountry.Validator.Disable()}if($$E(this._fddlStateProvince.GetInputControl()).disabled==true){this._fddlStateProvince.Validator.Disable()}},CountrySetEnabled:function(a){this._fddlCountry.SetEnabled(a)},CountrySetVisible:function(a){if(a==true){this._fddlCountry.Show()}else{this._fddlCountry.Hide()}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},Reset:function(){this.ClearFields()},ClearFields:function(){this.Validator.Clear();this._ftxtAddress1.Bind(null);this._ftxtAddress2.Bind(null);this._ftxtCity.Bind(null);this._ftxtStateProvince.Bind(null);this._fddlStateProvince.Bind(null);this._ftxtPostalCode.Bind(null);this.BindStaticLists()},BindDefaultCountry:function(){var a=$$CLIENT.Country;if(!$$CM.isEmpty(a)){this._fddlCountry.Bind(a);this.onCountryChange()}},onDataUpdated:function(){var a=this.GetBoundData();this._originalData=a;if(!$$CM.isNull(a)){this._ftxtAddress1.Bind(a.AddressLine1);this._ftxtAddress2.Bind(a.AddressLine2);this._ftxtCity.Bind(a.City);this._ftxtPostalCode.Bind(a.PostalCode);this.onCountryChangeHandler(a.Country,a.StateProvince)}else{this.ClearFields()}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.AddressLine1=this._ftxtAddress1.GetData();a.AddressLine2=this._ftxtAddress2.GetData();a.City=this._ftxtCity.GetData();if($$E(this._fddlStateProvince).visible()==true){a.StateProvince=this._fddlStateProvince.GetData()}else{if($$E(this._ftxtStateProvince).visible()==true){a.StateProvince=this._ftxtStateProvince.GetData()}}a.PostalCode=this._ftxtPostalCode.GetData();a.Country=this._fddlCountry.GetData();a.IsMajorModification=$$CM.addressMajorModification(this._originalData,a);return a}});cm.ui.common.Address2ConfigOptions=Class.create(cm.ui.common.AddressConfigOptions,{htmlCssVersion:2});$$FADDRESS2=cm.ui.common.Address2=Class.create(cm.ui.common.Address,{configureDefaultOptions:function(){return new cm.ui.common.Address2ConfigOptions()}});"cm.ui.common".namespace();$$ADDRESSU=cm.ui.common.AddressUtility={GetCountryArray:function(){var a=FW.Data.GetStore("Lists").Get("CountryArray");return a;this._defaultCountry="";if(!$$CM.isNull($$CLIENT.Country)){this._defaultCountry=$$CLIENT.Country}},GetStateArray:function(){var a=FW.Data.GetStore("Lists").Get("StateArray");return a},GetDefaultCountry:function(){var a="";if(!$$CM.isNull($$CLIENT.Country)){a=$$CLIENT.Country}return a},HandleCountryChange:function(a){if(!$$CM.isNull(a)){var h=a.fddlCountry;var i=a.fddlState;var k=a.ftxtState;var j=a.ftxtPostalCode;var e=a.countryCode;var o=a.stateCode;var l=a.otherStateRequired;var q=a.useDefaultCountryOnReset;var d=this.GetCountryArray();var m=this.GetStateArray();var f=this.GetDefaultCountry();if(!$$CM.isEmpty(e)){var b=e.toLowerCase();if(b=="usa"||b=="united states"){e="US"}}else{if(q){e=f}}if(!$$CM.isNull(h)&&!$$CM.isNull(i)&&!$$CM.isNull(k)){h.Bind(e);i.RemoveClassName("cmValidationError");if($$CM.isEmpty(e)){$$E(i.GetInputControl()).disabled=true;k.Hide();if(l==true){k.Validator.Disable()}i.Show();i.EnableInputControl(false);i.Validator.Disable();i.bindList($A(),"","Select State",true)}else{$$E(i.GetInputControl()).disabled=false;var n=m.findAll(function(c){return c.CountryCode==e},this);if(n.length==0){k.Show();k.EnableInputControl(true);if(l==true){k.Validator.Enable()}i.Hide();i.Validator.Disable();i.EnableInputControl(false);var p="";if(!$$CM.isEmpty(k.GetConfigOptions().labelPrefix)){p=k.GetConfigOptions().labelPrefix+" "}k.SetLabel(p+"State/Prov.");if(!$$CM.isNull(j)){j.SetLabel("Postal Code")}if(!$$CM.isEmpty(o)){k.SetValue(o)}}else{var p="";if(!$$CM.isEmpty(i.GetConfigOptions().labelPrefix)){p=i.GetConfigOptions().labelPrefix+" "}k.Hide();k.EnableInputControl(false);if(l==true){k.Validator.Disable()}i.Show();i.Validator.Enable();i.EnableInputControl(true);var g="";if(e=="CA"){g="Select Province";i.SetLabel(p+"Province");if(!$$CM.isNull(j)){j.SetLabel(p+"Postal Code")}}else{if(e=="MX"){g="Select State";i.SetLabel(p+"State");if(!$$CM.isNull(j)){j.SetLabel(p+"Postal Code")}}else{if(e=="US"){g="Select State";i.SetLabel(p+"State");if(!$$CM.isNull(j)){j.SetLabel(p+"Zip")}}else{g="Select State/Prov.";i.SetLabel(p+"State/Prov.");if(!$$CM.isNull(j)){j.SetLabel(p+"Postal Code")}}}}i.bindList(n,"",g,true);if(!$$CM.isEmpty(o)){i.setSelectedValue(o)}}}}}}};"cm.ui.common".namespace();cm.ui.common.AutoCompleteConfigOptions=Class.create(cm.ConfigOptions,{source:$A(),render:null,cancelSelectValue:false,autoCompleteCss:""});$$AUTO=cm.ui.common.AutoComplete=Class.create(cm.ui.UILibraryControl,{SelectedEvent:null,configureDefaultOptions:function(){return new cm.ui.common.AutoCompleteConfigOptions()},initializeUIElements:function(){var a=this.GetConfigOptions();this._textControl=new $$FTXT(this.ID()+"_actxt",a);this.AddChild(this._textControl);if(!$$CM.isEmpty(a.cssClass)){this._textControl.AddClassName(a.cssClass)}if(!$$CM.isEmpty(a.titleCssClass)){this._textControl.GetTitleControl().AddClassName(a.titleCssClass)}if(!$$CM.isEmpty(a.inputCssClass)){this._textControl.GetInputControl().AddClassName(a.inputCssClass)}if(!$$CM.isEmpty(a.placeholderText)){this._textControl.SetPlaceholderText(a.placeholderText)}},createEvents:function(){this.SelectedEvent=new cm.event()},postInitialize:function(){this._cfo=this.GetConfigOptions();var a=this._cfo.cancelSelectValue;var c=this;this._ac=this.Wrap($$E(this._textControl.GetInputControl())).autocomplete({source:this.GetConfigOptions().source,select:function(d,e){c.onSelected(d,e);if(a){c.ClearValue();return false}}});this._ac.autocomplete("option","autoFocus",true);if(!$$CM.isNull(this.GetConfigOptions().render)==true){var b=this.GetConfigOptions().render;this._ac.data("ui-autocomplete")._renderItem=function(f,e){var d=e.value;return jQuery("<li></li>").data("item.autocomplete",d).append("<a>"+b(d)+"</a>").appendTo(f)}}if(!$$CM.isEmpty(c.GetConfigOptions().autoCompleteCss)){autoCompleteCss=c.GetConfigOptions().autoCompleteCss;c._ac.data().uiAutocomplete.menu.element.addClass(autoCompleteCss)}},onSelected:function(a,b){this.ClearValue();this.SelectedEvent.fire(this,b.item.value)},ClearValue:function(){this.Wrap($$E(this._textControl.GetInputControl())).val("")},Focus:function(){this._textControl.GetInputControl().Focus()},Bind:function(a){this._textControl.Bind(a)}});"cm.ui.common".namespace();cm.ui.common.AutoCompleteConfigOptions=Class.create(cm.ConfigOptions,{appendTo:"body",autoFocusFirstItem:false,delay:300,minLength:1,source:$A(),positionMy:"left top",positionAt:"left bottom",positionOf:null,renderItem:null,renderMenu:null,resizeMenu:null,placeholder:"",width:110,cancelSelectValue:false});$$AUTO2=cm.ui.common.AutoComplete=Class.create(cm.ui.UILibraryControl,{ChangedEvent:null,ClosedEvent:null,CreatedEvent:null,ItemFocusedEvent:null,OpenedEvent:null,SearchCompleteBeforeResultsAreShownEvent:null,BeforeSearch:null,SelectedEvent:null,_open:false,_selectedItem:null,configureDefaultOptions:function(){return new cm.ui.common.AutoCompleteConfigOptions()},render:function(){var a=$$P.txt(this._id);return $$E(a)},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._appendTo=this._cfo.appendTo;this._autoFocus=this._cfo.autoFocus;this._delay=this._cfo.delay;this._minLength=this._cfo.minLength;this._position={my:this._cfo.positionMy,at:this._cfo.positionAt,of:this._cfo.positionOf};this._source=this._cfo.source;this._renderItem=this._cfo.renderItem;this._renderMenu=this._cfo.renderMenu;this._resizeMenu=this._cfo.resizeMenu},initializeUIElements:function(){this.SetAttribute("placeholder",this._cfo.placeholder);if(!$$CM.isNull(this._cfo.width)){this.SetWidth(this._cfo.width)}},createEvents:function($super){$super();this.ChangedEvent=new cm.event();this.ClosedEvent=new cm.event();this.CreatedEvent=new cm.event();this.ItemFocusedEvent=new cm.event();this.OpenedEvent=new cm.event();this.SearchCompleteBeforeResultsAreShownEvent=new cm.event();this.BeforeSearch=new cm.event();this.SelectedEvent=new cm.event();this.AddFocusListener()},wireEvents:function($super){$super();this.FocusEvent.subscribe(this.onFocused,this)},Activate:function(b){var a=this;if(!$$CM.isNull(b)){this._source=b}this.getLibraryElement().autocomplete({appendTo:this._appendTo,autoFocus:this._autoFocus,delay:this._delay,minLength:this._minLength,position:this._position,source:this._source,change:function(c,d){a.onChanged(c,d)},close:function(c,d){a.onClosed(c,d)},create:function(c,d){a.onCreated(c,d)},focus:function(c,d){a.onItemFocused(c,d)},open:function(c,d){a.onOpened(c,d)},response:function(c,d){a.onSearchCompleteBeforeResultsAreShown(c,d)},search:function(c,d){a.onBeforeSearch(c,d)},select:function(c,d){a.onSelected(c,d);if(a._cfo.cancelSelectValue){a.ClearValue();a.Close();return false}}});if(!$$CM.isNull(this._renderItem)){this.getLibraryElement().data("ui-autocomplete")._renderItem=this._renderItem}if(!$$CM.isNull(this._renderMenu)){this.getLibraryElement().data("ui-autocomplete")._renderMenu=this._renderMenu}if(!$$CM.isNull(this._resizeMenu)){this.getLibraryElement().data("ui-autocomplete")._resizeMenu=this._resizeMenu}},Destroy:function(){this.getLibraryElement().autocomplete("destroy")},ClearValue:function(){this._selectedItem=null;this.getLibraryElement().val("")},OpenAll:function(a){this.ClearValue();if(this._open){if(!$$CM.isNull(a)&&a==true){this.Close()}}else{this.getLibraryElement().autocomplete("option","minLength",0);this.getLibraryElement().autocomplete("search","");this.getLibraryElement().autocomplete("option","minLength",this._cfo.minLength)}},Close:function(){this._selectedItem=null;if(this._open){this.getLibraryElement().autocomplete("close")}},SetSource:function(a){this._selectedItem=null;this.getLibraryElement().autocomplete("option","source",a)},Enable:function(){this._selectedItem=null;return this.getLibraryElement().autocomplete("enable")},Disable:function(){this._selectedItem=null;return this.getLibraryElement().autocomplete("disable")},Focus:function(){this.getLibraryElement().focus()},onFocused:function(){this.getLibraryElement().data("ui-autocomplete").search(this.getLibraryElement().val())},Blur:function(){this.getLibraryElement().blur()},Search:function(a){this.getLibraryElement().autocomplete("search",a)},GetValue:function(){return this.getLibraryElement().val()},GetData:function(){var a={};a.ID=0;a.Name="";a.IDAlt=0;if(!$$CM.isNull(this._selectedItem)){a.ID=Number(this._selectedItem.id);a.Name=this._selectedItem.label;a.IDAlt=this._selectedItem.idAlt}return a},Bind:function(a){this.getLibraryElement().val(a)},GetWidget:function(){return this.getLibraryElement().autocomplete("widget")},MenuWrapper:function(){return this.GetWidget()},onChanged:function(a,b){this.ChangedEvent.fire(this,b)},onClosed:function(a,b){this._open=false;this.ClosedEvent.fire(this,b)},onCreated:function(a,b){this.CreatedEvent.fire(this,a)},onItemFocused:function(a,b){this.ItemFocusedEvent.fire(this,a)},onOpened:function(a,b){this._open=true;this.OpenedEvent.fire(this,b)},onSearchCompleteBeforeResultsAreShown:function(a,b){this._selectedItem=null;this.SearchCompleteBeforeResultsAreShownEvent.fire(this,b)},onBeforeSearch:function(a,b){this.BeforeSearch.fire(this,a)},onSelected:function(b,c){this._selectedItem=c.item;var a={};a.Event=b;a.UI=c;a.SelectedItem=this._selectedItem;this.SelectedEvent.fire(this,a)}});"cm.ui.common".namespace();cm.ui.common.AutoCompletePersonConfigOptions=Class.create(cm.ConfigOptions,{placeholderText:"Type name here",autoFocus:true,spanWidth:0,cssClass:"",inputCssClass:"cmAutoCompletePerson",titleCssClass:"mtb0px, ml10px, mr0px",inputWidth:346,cancelSelectValue:true,source:new Array()});cm.ui.common.AutoCompletePerson=Class.create(cm.ui.ComplexControl,{_seasonID:0,configureDefaultOptions:function(){return new cm.ui.common.AutoCompletePersonConfigOptions()},initializeData:function(){this._cfo=this.GetConfigOptions()},initializeUIElements:function(){var a=this;this._cfo.select=function(b,c){};this._cfo.render=function(b){return a.renderPersonAutoCompleteItem(b)};this._ctrAutoComplete=new $$AUTO("ctrPersonAutoComplete",this._cfo);this.AddChild(this._ctrAutoComplete)},createEvents:function($super){$super();this.SelectedEvent=new cm.event()},wireEvents:function($super){this._ctrAutoComplete.SelectedEvent.subscribe(this.onAutoCompleteSelected,this)},SetSeasonID:function(a){this._seasonID=a},personSearchResultArrayGet:function(a){if(!$$CM.isNull(a)&&!$$CM.isNull(a.request)&&!$$CM.isEmpty(a.request.term)){var b=a.request.term.toLowerCase();DAO.Person.PersonSearch({Search:b},{wait:false,scope:this,onSuccess:function(c){var g=a.response;if(!$$CM.isNull(g)){var f=c.data;var e=jQuery.map(f,function(h){return{value:h}});try{g(e)}catch(d){console.log(d)}}}},this)}},onAutoCompleteSelected:function(b,a){this.SelectedEvent.fire(b,a)},renderPersonAutoCompleteItem:function(g){var i=g.Person;var e=$$P.div(null,null,{classNames:"divAutoCompleteSuggestItem"});var a=$$P.div(null,null,{classNames:"ui-menu-item-avatar"});e.AddChild(a);var d=$$P.img(null,i.AvatarURL);a.AddChild(d);var c=i.Name.FullName;g.toString=function(){return c};var h="<strong>"+((c.length>28)?c.substring(0,25)+"...":c)+"</strong> ";var f="";if(!$$CM.isEmpty(i.Gender)){f+=(i.Gender==0?"F":"M")}if(!$$CM.isEmpty(i.Age)){if(!$$CM.isEmpty(f)){f+=" / "}if(!$$CM.isEmpty(i.Age)){f+=i.Age}}if(!$$CM.isEmpty(f)){h+=" ("+f+")"}var b=$$P.div(null,null,{classNames:"ui-menu-item-not-avatar"});e.AddChild(b);a=$$P.div(null,h,{classNames:"ui-menu-item-primary"});b.AddChild(a);var j="";if(!$$CM.isEmpty(g.DivisionName)){j+=g.DivisionName}if(!$$CM.isEmpty(g.BunkNames)){if(!$$CM.isEmpty(j)){j+=" - "}j+=g.BunkNames}a=$$P.div(null,j,{classNames:"ui-menu-item-secondary"});b.AddChild(a);return e.GetHtmlElement().outerHTML},Focus:function(){this._ctrAutoComplete.Focus()},onDataUpdated:function(){var a=this.GetBoundData();this._personList=a}});"cm.ui.common".namespace();cm.ui.common.AutoCompletePersonListConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.common.AutoCompletePersonList=Class.create(cm.ui.ComplexControl,{_seasonID:0,configureDefaultOptions:function(){return new cm.ui.common.AutoCompletePersonListConfigOptions()},initializeData:function(){this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this.AddChild($$P.p("pInstructions","Type a child's name below to tag him or her in the photo",{classNames:"cmBold"}));this._divAutoCompleteContainer=$$P.div();this.AddChild(this._divAutoCompleteContainer);this._divPersonList=$$P.div(null,null,{classNames:"cmPersonListDiv"});this.AddChild(this._divPersonList)},createEvents:function($super){$super();this.PersonAddedEvent=new cm.event();this.PersonRemovedEvent=new cm.event()},wireEvents:function($super){$super()},postInitialize:function($super){$super()},onAutoCompleteSelected:function(b,a){this.PersonAddedEvent.fire(b,a)},onPersonRemoved:function(b,a){this.PersonRemovedEvent.fire(b,a)},SetSeasonID:function(a){this._seasonID=a},BindPersonSource:function(a){this._divAutoCompleteContainer.DestroyChildControls(true);this._ctrAutoComplete=new cm.ui.common.AutoCompletePerson("ctrPersonAutoComplete",{classNames:"mb5px",source:a});this._ctrAutoComplete.SelectedEvent.subscribe(this.onAutoCompleteSelected,this);this._divAutoCompleteContainer.AddChild(this._ctrAutoComplete)},Reset:function(){this._divPersonList.Hide();this._divPersonList.DestroyChildControls(true);this._divPersonList.Show()},Focus:function(){this._ctrAutoComplete.Focus()},onDataUpdated:function(){var a=this.GetBoundData();this.Reset();var b=true;a.each(function(d){var c=new cm.ui.common.AutoCompletePersonListItem(null,{classNames:b?"cmEven":"cmOdd"});c.Bind(d);this._divPersonList.AddChild(c);c.XClicked.subscribe(this.onPersonRemoved,this);b=!b},this)}});cm.ui.common.AutoCompletePersonListItemConfigOptions=Class.create(cm.ConfigOptions,{classNames:""});cm.ui.common.AutoCompletePersonListItem=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.AutoCompletePersonListConfigOptions()},initializeData:function(){this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this.AddClassName("cmPersonListItem");this._spanName=$$P.span();this.AddChild(this._spanName);this._btn=new $$BTN(null,{classNames:"cmPersonListItemBtn cmFloatRight octagonX"});this.AddChild(this._btn)},createEvents:function($super){$super();this.XClicked=new cm.event()},wireEvents:function($super){$super();this._btn.ClickEvent.subscribe(this.onButtonClicked,this)},onButtonClicked:function(b,a){this.XClicked.fire(this,this.GetData())},SetLabel:function(a){this._spanName.UpdateInnerHtml(a)},GetData:function(){return this.GetBoundData()},onDataUpdated:function(){var a=this.GetBoundData();this._listItem=a;if(this._listItem&&this._listItem.Person&&this._listItem.Person.Name&&this._listItem.Person.Name.FullName){this.SetLabel(this._listItem.Person.Name.FullName)}}});"cm.ui.common".namespace();cm.ui.common.AvatarControlControlConfigOptions=Class.create(cm.ConfigOptions,{width:390,isProfilePhoto:false,isPersonFrame:false,isPerson:true,isUserUpgrade:false,isSelf:false,verifyUserOnServerCall:false,forcePath:"",isUPRProfile:false,enableInstructions:true,instructionConclusion:"After updating the photo, press 'Submit Form' to submit this form.",imageCss:"w175px w175px",editCss:"w175px"});cm.ui.common.AvatarControl=Class.create(cm.ui.ComplexControl,{_currentUser:{},_isAvatarChanged:false,configureDefaultOptions:function(){return new cm.ui.common.AvatarControlControlConfigOptions()},initializeData:function($super){$super();this.Initialized=false;this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}var a=$$CLIENT.VersionBranch;this._isUnifiedPersonRecord=(a&1048576)==1048576},initializeDAOs:function($super){$super();this._securityDAO=new cm.dao.Security.DAO()},initializeUIElements:function(){this._divPhotoControlWrapper=$$P.div();this.AddChild(this._divPhotoControlWrapper);this._divInstructions=$$P.div();this._divPhotoControlWrapper.AddChild(this._divInstructions);this._divInstructions.AddClassName("photoControlInstructions");this._divInstructions.Hide();this._pInstructions=$$P.p();this._divInstructions.AddChild(this._pInstructions);this._divPhoto=$$P.div();this._divPhotoControlWrapper.AddChild(this._divPhoto);this._divPhoto.AddClassName("cmFloatRight");this._divPhoto.AddClassName(this._co.imageCss);this._divEdit=$$P.div();this._divPhoto.AddChild(this._divEdit);this._divEdit.AddClassName(this._co.editCss);if(this._co.isProfilePhoto){this._divPhoto.AddClassName("profileDiv");this._divEdit.AddClassName("profileEditDiv");this._divEdit.UpdateInnerHtml("Click Here to Upload")}else{this._divPhoto.AddClassName("avatarDiv");this._divEdit.AddClassName("avatarEditDiv");this._divEdit.UpdateInnerHtml("Upload")}if(this._co.isProfilePhoto&&this._isUnifiedPersonRecord&&this._co.isUPRProfile){this._imgRotateCW=new $$IMG("imgRotateCW",{source:cm.hosts.common+"/system/ui/common/images/blue_rotate_cw.png"});this._divPhoto.AddChild(this._imgRotateCW);this._imgRotateCW.AddClassName("avatarRotateCW");this._imgRotateCW.Hide();this._imgRotateCCW=new $$IMG("imgRotateCW",{source:cm.hosts.common+"/system/ui/common/images/blue_rotate_ccw.png"});this._divPhoto.AddChild(this._imgRotateCCW);this._imgRotateCCW.AddClassName("avatarRotateCCW");this._imgRotateCCW.Hide()}this._cmDivModals=$$P.div("divModals");this.AddChild(this._cmDivModals);this._avatarModal=new cm.ui.dialog.ModalDialog("AvatarModal",{width:390,height:580,dialogClass:"avatarModal"});this._cmDivModals.AddChild(this._avatarModal);this._avatarModalControl=new cm.ui.common.AvatarModalControl("modalAddAvatar",{controller:this._co.controller,panelContainer:this,title:"modalAddAvatar",width:this._co.width,isProfilePhoto:this._co.isProfilePhoto,isPersonFrame:this._co.isPersonFrame,isAuthorizedAdult:this._co.isAuthorizedAdult,isUserUpgrade:this._co.isUserUpgrade,isSelf:this._co.isSelf,verifyUserOnServerCall:this._co.verifyUserOnServerCall});this._avatarModal.AddChild(this._avatarModalControl)},createEvents:function($super){$super();this.SubmitEvent=new cm.event();this.ClearEvent=new cm.event();this.InitializedEvent=new cm.event();this.VerifyUser=new cm.event();this.ImageChangedEvent=new cm.event()},wireEvents:function($super){$super();this._divEdit.AddClickListener();this._divEdit.ClickEvent.subscribe(this.onCMBtnAvatarClick,this);this._avatarModalControl.CloseEvent.subscribe(this.onCloseAvatarModal,this);this._avatarModalControl.ClearEvent.subscribe(this.onClearAvatarModal,this);this._avatarModalControl.SubmitEvent.subscribe(this.onSubmitAvatarModal,this);this._avatarModalControl.ShowModalEvent.subscribe(this.onShowAvatarModal,this);this._avatarModalControl.VerifyUser.subscribe(this.onVerifyUser,this);this._securityDAO.PersonAvatarFileNameReceived.subscribe(this.onPersonAvatarFileNameReceived,this);if(this._co.isProfilePhoto&&this._isUnifiedPersonRecord&&this._co.isUPRProfile){this._imgRotateCW.AddClickListener();this._imgRotateCW.ClickEvent.subscribe(this.onRotateCWClick,this);this._imgRotateCCW.AddClickListener();this._imgRotateCCW.ClickEvent.subscribe(this.onRotateCCWClick,this)}},Destroy:function(){this._avatarModal.DestroyChildControl(this._avatarModalControl)},onVerifyUser:function(b,a){this.VerifyUser.fire(this,a)},onRotateCWClick:function(b,a){DAO.Person.RotateAvatar({PersonID:$$AR.PersonID,ClockWise:true},{scope:this,onSuccess:function(c){this.SubmitEvent.fire()}})},onRotateCCWClick:function(b,a){DAO.Person.RotateAvatar({PersonID:$$AR.PersonID,ClockWise:false},{scope:this,onSuccess:function(c){this.SubmitEvent.fire()}})},onCMBtnAvatarClick:function(b,a){this._avatarModalControl.Bind(this._currentUser)},onShowAvatarModal:function(b,a){this._avatarModal.Show()},onCloseAvatarModal:function(b,a){this._avatarModal.Hide()},onClearAvatarModal:function(b,a){this._currentUser=this._avatarModalControl.GetData();this.ClearEvent.fire(b,this._currentUser);this.renderData()},onSubmitAvatarModal:function(b,a){this._currentUser=this._avatarModalControl.GetData();this.SubmitEvent.fire(b,this._currentUser);this.renderData()},onDataUpdated:function(){var d=this.GetBoundData();var h=0;var c=0;var f=2;var a="";var i="";var b="";var e="";if(!$$CM.isNull(d)){if($$CM.isNumber(d.PersonID)){h=d.PersonID}if($$CM.isNumber(d.ClientID)){c=d.ClientID}if($$CM.isNumber(d.Gender)){f=d.Gender}if(!$$CM.isEmpty(d.AvatarFileName)){a=d.AvatarFileName}if(!$$CM.isEmpty(d.ProfilePhotoURL)){i=d.ProfilePhotoURL}if(!$$CM.isEmpty(d.AvatarURL)){b=d.AvatarURL}if(!$$CM.isEmpty(d.FirstName)){e=d.FirstName}}if(h==0||($$CM.IsUPR()&&!$$CM.isNull(d))){if(h>0&&!$$CM.isNull(d.PersonInfo)){this._currentUser=d.PersonInfo}else{this._currentUser={};this._currentUser.PersonID=h;this._currentUser.ClientID=c;this._currentUser.Gender=f;this._currentUser.GenderID=f;this._currentUser.AvatarFileName=a;this._currentUser.ProfilePhotoURL=i;this._currentUser.AvatarURL=b;this._currentUser.FirstName=e}this.renderData()}else{if(this.GetConfigOptions().verifyUserOnServerCall==true){var g={};g.fn=this.onVerifyUserPersonAvatarFileNameGet;g.arg=[c,h];g.scope=this;this.VerifyUser.fire(this,g)}else{this._securityDAO.PersonAvatarFileNameGet(c,h)}}},onVerifyUserPersonAvatarFileNameGet:function(d,a){var b=a[0];var c=a[1];this._securityDAO.PersonAvatarFileNameGet(b,c)},GetData:function(){return this._currentUser},GetAvatarFileName:function(){var a="";if(!$$CM.isNull(this._currentUser)){a=this._currentUser.AvatarFileName}return a},onPersonAvatarFileNameReceived:function(b,a){this._currentUser=a.data;this.renderData()},renderData:function(){var g=$$CM.newGuid();var a="";var b="";if(this._co.isSelf){a="yourself";b="your"}else{var e="person";if(!$$CM.isEmpty(this._co.personLabel)){e=this._co.personLabel}var f="person";if(!$$CM.isEmpty(this._co.personLabelPossessive)){f=this._co.personLabelPossessive}a="the "+e;b="the "+f;if(!$$CM.isEmpty(this._currentUser.FirstName)){a=this._currentUser.FirstName;b=a;if(a.charAt(a.length-1)=="s"){b=a+"'"}else{b=a+"'s"}}}this._currentUser.firstNameLabel;this._currentUser.firstNamePossessiveLabel=b;var c="";var d="";if(!$$CM.isEmpty(this.GetConfigOptions().forcePath)){d=this.GetConfigOptions().forcePath}else{if(!$$CM.isEmpty(cm.hosts.common)){d=cm.hosts.common}}if(this._co.isProfilePhoto){if(!$$CM.isEmpty(this._currentUser.ProfilePhotoURL)){if(this._currentUser.ProfilePhotoURL.indexOf("defaultAvatars")>=0){if(this._co.isProfilePhoto&&this._isUnifiedPersonRecord&&this._co.isUPRProfile){this._imgRotateCW.Hide();this._imgRotateCCW.Hide()}this._pInstructions.UpdateInnerHtml("Please upload a current photo of "+a+" by clicking on the image to the right.<br />&nbsp;<br />"+this._co.instructionConclusion);this._divEdit.UpdateInnerHtml("Click Here to Upload")}else{if(this._co.isProfilePhoto&&this._isUnifiedPersonRecord&&this._co.isUPRProfile){this._imgRotateCW.Show();this._imgRotateCCW.Show()}this._pInstructions.UpdateInnerHtml("If you would like to update "+b+" photo, please click on the image to the right.<br />&nbsp;<br />"+this._co.instructionConclusion);this._divEdit.UpdateInnerHtml("Click Here to Replace")}c=this._currentUser.ProfilePhotoURL+"?v="+g}else{this._pInstructions.UpdateInnerHtml("Please upload a current photo of "+a+" by clicking on the image to the right.<br />&nbsp;<br />"+this._co.instructionConclusion);this._divEdit.UpdateInnerHtml("Click Here to Upload");if($$CM.IsUPR()&&$$CM.isNumber(this._currentUser.PersonID)&&Number(this._currentUser.PersonID)>0){c=$$CM.getPersonAvatar(this._currentUser,"Medium")}else{if(this._currentUser.Gender==0){c=d+"/common/lib/core/ui/common/images/missDefault_175.png"}else{c=d+"/common/lib/core/ui/common/images/mrDefault_175.png"}}}if(this._co.enableInstructions==true){this._divInstructions.Show()}}else{if(!$$CM.isEmpty(this._currentUser.ProfilePhotoURL)){this._divEdit.UpdateInnerHtml("Replace");c=this._currentUser.ProfilePhotoURL+"?v="+g}else{this._divEdit.UpdateInnerHtml("Upload");if($$CM.IsUPR()&&$$CM.isNumber(this._currentUser.PersonID)&&Number(this._currentUser.PersonID)>0){c=$$CM.getPersonAvatar(this._currentUser,"Small")}else{if(this._currentUser.Gender==0){c=d+"/common/lib/core/ui/common/images/missDefault.png"}else{c=d+"/common/lib/core/ui/common/images/mrDefault.png"}}}}c=$$CM.getPersonAvatar(this._currentUser,"Medium",!this._co.isUPRProfile);this._divPhoto.AssignStyle("background-image","url('"+c+"')");this._divPhoto.AddClassName("uprAvatarBackground");this.ImageChangedEvent.fire(this,c);this._divPhoto.Show();this.InitializedEvent.fire(this,{})}});"cm.ui.common".namespace();cm.ui.common.AvatarModalControl=Class.create(cm.ui.ComplexControl,{_imageID:"crop_img",_avatarURL:"",_imageURL:"",_avatarAdded:false,_activePanel:1,_binding:false,_isProfilePhoto:false,_avatarFileName:"",CROP_CONSTRAINT_WIDTH:250,CROP_CONSTRAINT_HEIGHT:250,CROP_CONSTRAINT_MIN_WIDTH:50,CROP_CONSTRAINT_MIN_HEIGHT:50,_loadingImage:false,_currentUser:null,initializeDAOs:function($super){$super();this._mediaDAO=new cm.dao.Media.DAO();this._securityDAO=new cm.dao.Security.DAO()},initializeUIElements:function(){this._title="modalAddAvatar";this._width=390;this._isProfilePhoto=false;this._isPersonFrame=false;this._isPerson=true;this._isUserUpgrade=false;this._isSelf=false;this._cfo=this.GetConfigOptions();if(!$$CM.isNull(this._cfo.title)){this._title=this._cfo.title}if(!$$CM.isNull(this._cfo.width)){this._width=this._cfo.width}if(!$$CM.isNull(this._cfo.isProfilePhoto)){this._isProfilePhoto=this._cfo.isProfilePhoto}if(!$$CM.isNull(this._cfo.isSelf)){this._isSelf=this._cfo.isSelf}if(!$$CM.isNull(this._cfo.isPersonFrame)){this._isPersonFrame=this._cfo.isPersonFrame}if(!$$CM.isNull(this._cfo.isPerson)){this._isPerson=this._cfo.isPerson}if(!$$CM.isNull(this._cfo.isUserUpgrade)){this._isUserUpgrade=this._cfo.isUserUpgrade}this._modalHeader=$$P.div("modalAddAvatarHeader");this.AddChild(this._modalHeader);this._modalHeader.AddClassName("hd");this._modalHeader.AssignStyle("cursor","move");this._modalBody=$$P.div("modalAddAvatarBody");this.AddChild(this._modalBody);this._modalBody.AddClassName("bd");this._modalBody.AssignStyle("height","auto");this._container=$$P.div("modalAddAvatarContent");this._modalBody.AddChild(this._container);this._modalBody.AddClassName("modalAddAvatarContent");this._divToStepOne=$$P.div("divToStepOne");this._modalHeader.AddChild(this._divToStepOne);this._divToStepOne.AddClassName("toStepOne");this._divToStepTwo=$$P.div("divToStepTwo");this._modalHeader.AddChild(this._divToStepTwo);this._divToStepTwo.AddClassName("toStepTwo");this._divToStepThree=$$P.div("divToStepThree");this._modalHeader.AddChild(this._divToStepThree);this._divToStepThree.AddClassName("toStepThree");this._divLoadingWrapper=$$P.div("loading");this._container.AddChild(this._divLoadingWrapper);this._divLoadingWrapper.Hide();var b=$$P.div("loadingGraphic");this._divLoadingWrapper.AddChild(b);this._spanLoading=$$P.div("loadingText");this._divLoadingWrapper.AddChild(this._spanLoading);this._divSliderContainer=$$P.div("slider");this._container.AddChild(this._divSliderContainer);this._divSliderContainer.AddClassName("sliderContainer");this._divSliderContainer.SetHeight(474);this._divSlider=$$P.div("slider");this._divSliderContainer.AddChild(this._divSlider);this._divSlider.AddClassName("slider");this._divOrSkip=$$P.div("bottomNavigationWrapper");this._container.AddChild(this._divOrSkip);this._divOrSkip.AddClassName("bottomNavigationWrapper");this._bottomNavigationInnerWrapper=$$P.div("bottomNavigationInnerWrapper");this._divOrSkip.AddChild(this._bottomNavigationInnerWrapper);this._bottomNavigationInnerWrapper.AddClassName("bottomNavigationInnerWrapper");this._divCancel=$$P.div();this._bottomNavigationInnerWrapper.AddChild(this._divCancel);this._divCancel.AddClassName("cancel");this._divCancelPanel1=$$P.div();this._divCancel.AddChild(this._divCancelPanel1);this._divCancelPanel1.Hide();if(this._isUserUpgrade){this._aSkip1=new $$A("aSkip1",{text:"Skip this step"})}else{this._aSkip1=new $$A("aSkip1",{text:"Cancel"})}this._divCancelPanel1.AddChild(this._aSkip1);this._aSkip1.AddClassName("bottomNavigation");this._divCancelPanel2=$$P.div();this._divCancel.AddChild(this._divCancelPanel2);this._divCancelPanel2.Hide();var d=$$P.span();this._divCancelPanel2.AddChild(d);d.UpdateInnerHtml("Don't like it?&nbsp;");d.AddClassName("bottomNavigation");this._aToStepOne2=new $$A("aToStepOne",{text:"Start over"});this._divCancelPanel2.AddChild(this._aToStepOne2);this._aToStepOne2.AddClassName("bottomNavigation");var e=$$P.span();this._divCancelPanel2.AddChild(e);e.UpdateInnerHtml("&nbsp;or&nbsp;");e.AddClassName("bottomNavigation");this._aSkip2=new $$A("aSkip2",{text:"cancel"});this._divCancelPanel2.AddChild(this._aSkip2);this._aSkip2.AddClassName("bottomNavigation");var f=$$P.span();this._divCancelPanel2.AddChild(f);f.UpdateInnerHtml(".");f.AddClassName("bottomNavigation");this._divCancelPanel3=$$P.div();this._divCancel.AddChild(this._divCancelPanel3);this._divCancelPanel3.Hide();var d=$$P.span();this._divCancelPanel3.AddChild(d);d.UpdateInnerHtml("Don't like it?&nbsp;");d.AddClassName("bottomNavigation");this._aToStepOne3=new $$A("aToStepOne",{text:"Start over"});this._divCancelPanel3.AddChild(this._aToStepOne3);this._aToStepOne3.AddClassName("bottomNavigation");var e=$$P.span();this._divCancelPanel3.AddChild(e);e.UpdateInnerHtml(",&nbsp;");e.AddClassName("bottomNavigation");this._aToStepTwo3=new $$A("aSkip3",{text:"re-crop"});this._divCancelPanel3.AddChild(this._aToStepTwo3);this._aToStepTwo3.AddClassName("bottomNavigation");var f=$$P.span();this._divCancelPanel3.AddChild(f);f.UpdateInnerHtml("&nbsp;or&nbsp;");f.AddClassName("bottomNavigation");this._aSkip3=new $$A("aSkip3",{text:"cancel"});this._divCancelPanel3.AddChild(this._aSkip3);this._aSkip3.AddClassName("bottomNavigation");var g=$$P.span();this._divCancelPanel3.AddChild(g);g.UpdateInnerHtml(".");g.AddClassName("bottomNavigation");this._divUploadPanel=$$P.div("uploadPanel");this._divSlider.AddChild(this._divUploadPanel);this._divUploadPanel.AddClassName("panel uploadPanel");this._divUploadPanel.Hide();var c=$$P.h2();this._divUploadPanel.AddChild(c);if(this._isProfilePhoto){c.AddClassName("uni createProfilePhoto");c.UpdateInnerHtml("Upload your profile photo")}else{c.AddClassName("uni createAnAvatar");c.UpdateInnerHtml("Upload your avatar")}this._pPanel1Text=$$P.p();this._divUploadPanel.AddChild(this._pPanel1Text);this._pPanel1Text.SetWidth(338);if(this._isProfilePhoto){this._pPanel1Text.AddClassName("modalAddProfileP")}else{this._pPanel1Text.AddClassName("modalAddAvatarP")}var a=$$P.div();this._divUploadPanel.AddChild(a);a.AddClassName("clearLeft");var c=$$P.h2();this._divUploadPanel.AddChild(c);c.AddClassName("uni upload");if(this._isProfilePhoto){c.UpdateInnerHtml("Upload Your Profile Photo")}else{c.UpdateInnerHtml("Upload Your Avatar")}var h=$$CM.uniqueNumber();this._fileUploadWrapperControl=new cm.ui.common.FileUploadWrapperControl("profilePhotoUploaderWrapper_"+h);this._divUploadPanel.AddChild(this._fileUploadWrapperControl);this._divImageCropPanel=$$P.div("imageCropPanel");this._divSlider.AddChild(this._divImageCropPanel);this._divImageCropPanel.AddClassName("panel imageCropPanel");this._divImageCropPanel.Hide();var c=$$P.h2();this._divImageCropPanel.AddChild(c);c.AddClassName("uni crop");c.UpdateInnerHtml("Crop");this._divImageToBeCropped=$$P.div();this._divImageCropPanel.AddChild(this._divImageToBeCropped);this._divBtnWrapper=$$P.div();this._divImageCropPanel.AddChild(this._divBtnWrapper);this._divBtnWrapper.AddClassName("buttonWrapper");this._btnCropPhoto=new $$BTN("btnCropPhoto",{text:"Continue"});this._divBtnWrapper.AddChild(this._btnCropPhoto);this._btnCropPhoto.AddClassName("cropPhoto modalAddAvatarButton");this._divConfirmAndSavePanel=$$P.div("confirmAndSavePanel");this._divSlider.AddChild(this._divConfirmAndSavePanel);this._divConfirmAndSavePanel.AddClassName("panel confirmAndSavePanel");this._divConfirmAndSavePanel.Hide();var c=$$P.h2();this._divConfirmAndSavePanel.AddChild(c);if(this._isProfilePhoto){c.AddClassName("uni uniFinal yourProfilePhoto w195px");c.UpdateInnerHtml("Your Profile Photo")}else{c.AddClassName("uni uniFinal yourNewAvatar w125px");c.UpdateInnerHtml("Your Avatar")}this._divFinalImage=$$P.div();this._divConfirmAndSavePanel.AddChild(this._divFinalImage);this._divFinalImage.AddClassName("imgFinal");this._imgAvatar=new $$IMG("imgAvatar");this._divFinalImage.AddChild(this._imgAvatar);this._imgAvatar.SetAttribute("alt","Person");this._divBtnWrapperSave=$$P.div();this._divConfirmAndSavePanel.AddChild(this._divBtnWrapperSave);this._divBtnWrapperSave.AddClassName("buttonWrapper");this._btnSaveAndSubmit=new $$BTN("btnSaveAndSubmit",{text:"Save and Submit"});this._divBtnWrapperSave.AddChild(this._btnSaveAndSubmit);this._btnSaveAndSubmit.AddClassName("saveAndSubmit modalAddAvatarButton");var a=$$P.div();a.AddClassName("clear");this._container.AddChild(a)},createEvents:function(){this.CloseEvent=new cm.event();this.ClearEvent=new cm.event();this.SubmitEvent=new cm.event();this.ShowModalEvent=new cm.event();this.VerifyUser=new cm.event()},wireEvents:function($super){$super();var a=this;this._aSkip1.ClickEvent.subscribe(this.aSkip_click,this);this._aSkip2.ClickEvent.subscribe(this.aSkip_click,this);this._aSkip3.ClickEvent.subscribe(this.aSkip_click,this);this._btnCropPhoto.ClickEvent.subscribe(this.btnCropPhoto_click,this);this._aToStepOne2.ClickEvent.subscribe(this.aBackToUpload_click,this);this._btnSaveAndSubmit.ClickEvent.subscribe(this.btnSaveAndSubmit_click,this);this._aToStepOne3.ClickEvent.subscribe(this.aToStepOne_click,this);this._aToStepTwo3.ClickEvent.subscribe(this.aToStepTwo_click,this);this._divToStepOne.AddClickListener();this._divToStepOne.ClickEvent.subscribe(this.divToStepOne_click,this);this._divToStepTwo.AddClickListener();this._divToStepTwo.ClickEvent.subscribe(this.divToStepTwo_click,this);this._divToStepThree.AddClickListener();this._divToStepThree.ClickEvent.subscribe(this.divToStepThree_click,this);$$E(this._imgAvatar).onload=function(){a.onFinalImageLoad.call(a)};this._mediaDAO.AvatarFileUploaded.subscribe(this.onAvatarFileUploaded,this);this._mediaDAO.AvatarPhotoToPhotoContainerSaved.subscribe(this.onAvatarPhotoToPhotoContainerSaved,this);this._mediaDAO.AvatarPhotoDeleted.subscribe(this.onAvatarPhotoDeleted,this);this._mediaDAO.PhotoCropAndAdded.subscribe(this.onPhotoCropAndAdded,this);this._fileUploadWrapperControl.FileUploadCompleteEvent.subscribe(this.onFileUploadCompleteEvent,this);this._fileUploadWrapperControl.FileUploadErrorEvent.subscribe(this.onFileUploadErrorEvent,this)},bindFileUpload:function(){var b="";if(this._isProfilePhoto){b="Upload Photo"}else{b="Upload Avatar"}var a={};a.uploadButtonName=b;a.uploadMessage="Uploading Image. Please wait.";this._fileUploadWrapperControl.Bind(a)},onDataUpdated:function(){this._currentUser=this.GetBoundData();this.renderPanel1Text();this.clearData();this.clearImageCropper();if(!$$CM.isNull(this._currentUser.AvatarURL)&&this._currentUser.AvatarURL!=""){this._profilePhotoURL=this._currentUser.ProfilePhotoURL;this._avatarURL=this._currentUser.AvatarURL;this._avatarFileName=this._currentUser.AvatarFileName;if(this._isProfilePhoto){if(this._isPersonFrame){var a={title:"Clear Profile Photo?",header:"",message:"This will clear the photo.<br />&nbsp;<br />Images on the lower tab will not be affected.<br />&nbsp;<br />Are you sure you want to continue?",handlerOk:this.clear_confirm,handlerCancel:this.avatarClose,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(a)}else{var a={title:"Clear Photo?",header:"",message:"This will clear the photo.<br />&nbsp;<br />Are you sure you want to continue?",handlerOk:this.clear_confirm,handlerCancel:this.avatarClose,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(a)}}else{var a={title:"Clear Avatar Photo?",header:"",message:"This will clear the photo.<br />&nbsp;<br />Are you sure you want to continue?",handlerOk:this.clear_confirm,handlerCancel:this.avatarClose,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(a)}}else{this.show()}},GetData:function(){return this._currentUser},renderPanel1Text:function(){if(this._isProfilePhoto){this._pPanel1Text.UpdateInnerHtml("<img src='/CMinder/PersonUser/testAvatar1.jpgx' alt='Person' class='exampleAvatar' /> Please click the button below to upload a photo.<br />&nbsp;<br />Once the photo has been uploaded, please use the cropping tool to size and center the box around "+this._currentUser.firstNamePossessiveLabel+" face.<br />&nbsp;<br /><strong>Please Note:</strong> To ensure photos are high enough quality for printing, images must be at least <font color='#D11F1F'><strong>250 x 250 pixels</strong></font>.  Any photo taken with a digital camera should meet this specification.  Photos downloaded from sites like Facebook may not be large enough.")}else{this._pPanel1Text.UpdateInnerHtml("<img src='/CMinder/PersonUser/testAvatar1.jpgx' alt='Person' class='exampleAvatar' /> An Avatar is an image that represents you, just like on Facebook. Use a photo of yourself, your logo, or anything else you want. Choose your image below to get started.")}},clear_confirm:function(b,a){this._currentUser.AvatarFileName="";this._currentUser.AvatarURL="";this._currentUser.ProfilePhotoURL="";this.ClearEvent.fire(this,{});this.show()},show:function(){var a=this;this.ShowModalEvent.fire(this,{});this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();if(a._avatarURL!=""){a.deleteThumbnailPhoto(1)}else{a.slideIn_uploadAvatar()}})},btnSaveAndSubmit_click:function(d,a){if(this._isPersonFrame){var c=$$SETTINGSDU.GetEntityLabelSettings().EntityLabel;if($$CM.isUndefinedOrNull(c)){c=" "}else{c=" "+c+" "}var b={title:"Copy Profile Photo",header:"",message:"Would you like to save a copy of this</br>Profile Photo to the"+c+"photo tab?",handlerOk:this.addToPhotoContainer,handlerCancel:this.prepareAvatarClose,scope:this,cssClass:"cmGoDialog"};$$CMD.Confirm(b)}else{this.prepareAvatarClose()}},prepareAvatarClose:function(c,a){var b=this;this._currentUser.AvatarFileName=this._avatarFileName;this._currentUser.AvatarURL=this._avatarURL;this._currentUser.ProfilePhotoURL=this._profilePhotoURL;this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){b.SubmitEvent.fire(b,b._currentUser);jQuery(".slider .panel").hide();b.avatarClose()})},avatarClose:function(f,a){var e=this._currentUser.PersonID;var d=this._isPerson;var b=this._avatarFileName;if(!$$CM.isEmpty(b)){if(this.GetConfigOptions().verifyUserOnServerCall==true){var c={};c.fn=this.onVerifyUserAvatarMasterPhotoDelete;c.arg=[e,d,b];c.scope=this;this.VerifyUser.fire(this,c)}else{this._mediaDAO.AvatarMasterPhotoDelete(e,d,b)}}this.CloseEvent.fire(this,{})},addToPhotoContainer:function(d,a){var c=this._currentUser.PersonID;var b=this._avatarFileName;this._mediaDAO.AvatarPhotoToPhotoContainerSave(c,b)},onAvatarPhotoToPhotoContainerSaved:function(b,a){this.prepareAvatarClose()},onVerifyUserAvatarMasterPhotoDelete:function(f,a){var d=this;var e=a[0];var c=a[1];var b=a[2];this._mediaDAO.AvatarMasterPhotoDelete(e,c,b)},aSkip_click:function(c,a){var b=this;if(!this._isUserUpgrade){this._currentUser.AvatarFileName="";this._currentUser.AvatarURL="";this._currentUser.ProfilePhotoURL="";this.ClearEvent.fire(this,{});this.deleteThumbnailPhoto(0)}else{this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();b.onClose()})}},divToStepOne_click:function(d,a){var c=this;if(this._activePanel!=1){if(this._isProfilePhoto){if(this._isPersonFrame){var b={title:"Clear Profile Photo?",header:"",message:"This will clear the photo.<br />&nbsp;<br />Images on the lower tab will not be affected.<br />&nbsp;<br />Are you sure you want to continue?",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}else{var b={title:"Clear Photo?",header:"",message:"This will clear the photo.<br />&nbsp;<br />Are you sure you want to continue?",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}}else{var b={title:"Clear Avatar Photo?",header:"",message:"This will clear the photo.<br />&nbsp;<br />Are you sure you want to continue?",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}}},divToStepTwo_click:function(d,a){var c=this;var b=this._fileUploadPhoto;if(this._activePanel==3){this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();c.slideIn_cropPanel()})}if(this._activePanel==1&&b.value!=""){this.btnAvatarLoad_click()}},divToStepThree_click:function(c,a){var b=this._fileUploadPhoto;if(this._activePanel==2){this.btnCropPhoto_click()}},aToStepOne_click:function(c,a){if(this._isProfilePhoto){var b={title:"Remove Profile Photo?",header:"",message:"<p>This will permanently remove your Profile photo.<br />&nbsp;<br />Are you sure you want to continue?</p>",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}else{var b={title:"Remove Avatar Photo?",header:"",message:"<p>This will permanently remove your Avatar photo.<br />&nbsp;<br />Are you sure you want to continue?</p>",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}},aToStepTwo_click:function(c,a){var b=this;this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();b.slideIn_cropPanel()})},aBackToUpload_click:function(c,a){if(this._isProfilePhoto){var b={title:"Remove Profile Photo?",header:"",message:"<p>Going back will remove your Profile photo and any cropped image you have created from it?<br />&nbsp;<br />Are you sure you want to remove this photo?  This action cannot be undone.</p>",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}else{var b={title:"Remove Avatar Photo?",header:"",message:"<p>Going back will remove your Avatar photo and any Avatar you have created from it?<br />&nbsp;<br />Are you sure you want to remove this photo?  This action cannot be undone.</p>",handlerOk:this.aToStepOne_confirm,handlerCancel:null,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)}},aToStepOne_confirm:function(){var a=this;a.hideHeadNav();a._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();a.deleteThumbnailPhoto(1)})},deleteThumbnailPhoto:function(a){var e=this;if(this._avatarURL!=""){var f=this._currentUser.PersonID;var d=this._isPerson;var b=this._avatarFileName;var g=1;if(this.GetConfigOptions().verifyUserOnServerCall==true){var c={};c.fn=this.onVerifyUserAvatarPhotoDelete;c.arg=[f,d,b,g,a];c.scope=this;this.VerifyUser.fire(this,c)}else{this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();e._spanLoading.UpdateInnerHtml("Clearing Photo, please wait...");e.showLoader();e._mediaDAO.AvatarPhotoDelete(f,d,b,g,a)})}}else{this.deleteThumbnailPhoto_callback(this,{data:{},destination:a})}},onVerifyUserAvatarPhotoDelete:function(h,a){var e=this;var f=a[0];var d=a[1];var c=a[2];var g=a[3];var b=a[4];this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();e._spanLoading.UpdateInnerHtml("Clearing Photo, please wait...");e.showLoader();e._mediaDAO.AvatarPhotoDelete(f,d,c,g,b)})},onAvatarPhotoDeleted:function(c,a){var b=a.profilePhotoType;if(b==1){this.deleteThumbnailPhoto_callback(c,a)}else{this.deleteZoomInPhoto_callback(c,a)}},deleteThumbnailPhoto_callback:function(c,a){var b=a.data;this._avatarURL="";this._imgAvatar.SetAttribute("src","");switch(a.destination){case 0:this.avatarClose();break;case 1:this.deleteZoomInPhoto(a.destination);break;case 2:this.slideIn_cropPanel();break;case 3:this.slideIn_confirmAndSavePanel();break;case 4:this.deleteZoomInPhoto(a.destination);break}return},deleteZoomInPhoto:function(a){var e=this;var f=this._currentUser.PersonID;var d=this._isPerson;var b=this._avatarFileName;var g=2;if(this.GetConfigOptions().verifyUserOnServerCall==true){var c={};c.fn=this.onVerifyUserAvatarPhotoDelete;c.arg=[f,d,b,g,a];c.scope=this;this.VerifyUser.fire(this,c)}else{this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();e._spanLoading.UpdateInnerHtml("Clearing Photo, please wait...");e.showLoader();e._mediaDAO.AvatarPhotoDelete(f,d,b,g,a)})}},deleteZoomInPhoto_callback:function(c,a){var b=a.data;switch(a.destination){case 0:this.avatarClose();break;case 1:this.slideIn_uploadAvatar();break;case 2:this.slideIn_cropPanel();break;case 3:this.slideIn_confirmAndSavePanel();break;case 4:this.showWithPhoto_callback();break}return},onFileUploadCompleteEvent:function(g,a){var e=this;var f=this._currentUser.PersonID;var d=this._isPerson;var b=a.fileName;if(this.GetConfigOptions().verifyUserOnServerCall==true){var c={};c.fn=this.onVerifyUserAvatarFileUpload;c.arg=[f,d,b];c.scope=this;this.VerifyUser.fire(this,c)}else{this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();e._spanLoading.UpdateInnerHtml("Uploading Photo, please wait...");e.showLoader();e._mediaDAO.AvatarFileUpload(f,d,b)})}},onVerifyUserAvatarFileUpload:function(f,a){var d=this;var e=a[0];var c=a[1];var b=a[2];this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();d._spanLoading.UpdateInnerHtml("Uploading Photo, please wait...");d.showLoader();d._mediaDAO.AvatarFileUpload(e,c,b)})},onFileUploadErrorEvent:function(c,a){var b=this;b.hideHeadNav();b._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();b.slideIn_uploadAvatar()})},onAvatarFileUploaded:function(i,a){var g=this;if(a.success==true){var h=$$CM.newGuid();var d=a.data;if(!$$CM.isNull(d)){if(!$$CM.isEmpty(d.Error)){var e={title:"Upload Error",header:"",message:d.Error,width:300};$$CMD.Alert(e)}else{if(!$$CM.isNull(d.Url)){if(window.location.protocol=="https:"){d.Url=d.Url.replace("http:","https:")}this.clearImageCropper();this._imageURL=d.Url;this._avatarFileName=d.FileName;this._resizeRatio=d.ResizeRatio;this._zoomImageWidth=d.ImageWidth;this._zoomImageHeight=d.ImageHeight;var c=this.CROP_CONSTRAINT_WIDTH/this._resizeRatio;var b=this.CROP_CONSTRAINT_HEIGHT/this._resizeRatio;c=Math.ceil(Math.min(c,this._zoomImageWidth));b=Math.ceil(Math.min(b,this._zoomImageHeight));c=Math.ceil(Math.max(c,this.CROP_CONSTRAINT_MIN_WIDTH));b=Math.ceil(Math.max(b,this.CROP_CONSTRAINT_MIN_HEIGHT));if(!$$CM.isNull(this._imgPhoto)){this._divImageToBeCropped.DestroyChildControl(this._imgPhoto)}this._divImageToBeCropped.SetWidth(d.ImageWidth);this._divImageToBeCropped.SetHeight(d.ImageHeight);this._divImageToBeCropped.AssignStyle("width",""+d.ImageWidth+"px");this._divImageToBeCropped.AssignStyle("height",""+d.ImageHeight+"px");this._imgPhoto=new cm.ui.utilityControls.ImageCropper(this._imageID,{width:d.ImageWidth,height:d.ImageHeight});this._divImageToBeCropped.AddChild(this._imgPhoto);this._imgPhoto.onImageLoadedEvent.subscribe(this.image_load,this);this._loadingImage=true;var f={src:d.Url+"?v="+h,resizeRatio:d.ResizeRatio,imageWidth:d.ImageWidth,imageHeight:d.ImageHeight,constraintW:c,constraintH:b};this._imgPhoto.Bind(f);setTimeout(function(){if(g._loadingImage==true){g._loadingImage=false;g.hideHeadNav();g._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();g.slideIn_uploadAvatar()});var j={title:"File Not Found",header:"",message:"There was an error finding the photo: "+g._imageURL,width:700};$$CMD.Alert(j)}},5000,g);return}}}}g.hideHeadNav();g._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();g.slideIn_uploadAvatar()})},image_load:function(b,a){this._loadingImage=false;if(this._binding==false){this.slideIn_cropPanel()}else{this._binding=false}},btnCropPhoto_click:function(j,a){var h=this;var b=this._imgPhoto.GetData();if($$CM.isNull(b)){var c={title:"Cropping Error",header:"",message:"A crop area was not selected. Please click and drag the mouse to select a crop area."};$$CMD.Alert(c)}else{var i=this._currentUser.PersonID;var d=this._avatarFileName;var f=this._isPerson;var g=this._isProfilePhoto;if(this.GetConfigOptions().verifyUserOnServerCall==true){var e={};e.fn=this.onVerifyUserPhotoCropAndAdd;e.arg=[i,f,d,g,b];e.scope=this;this.VerifyUser.fire(this,e)}else{this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();h._spanLoading.UpdateInnerHtml("Resizing Photo, please wait...");h.showLoader();h._mediaDAO.PhotoCropAndAdd(i,f,d,g,b)})}}},onVerifyUserPhotoCropAndAdd:function(h,a){var f=this;var g=a[0];var d=a[1];var c=a[2];var e=a[3];var b=a[4];this.hideHeadNav();this._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();f._spanLoading.UpdateInnerHtml("Resizing Photo, please wait...");f.showLoader();f._mediaDAO.PhotoCropAndAdd(g,d,c,e,b)})},onPhotoCropAndAdded:function(e,a){var c=this;var d=$$CM.newGuid();var b=a.data;if(!$$CM.isNull(b)){if(!$$CM.isNull(b.NewFileName)!=null&&!$$CM.isNull(b.Url)){if(window.location.protocol=="https:"){b.Url=b.Url.replace("http:","https:");b.UrlProfile=b.UrlProfile.replace("http:","https:")}this._avatarURL=b.Url;this._profilePhotoURL=b.UrlProfile;this._avatarAdded=true;this._loadingImage=true;if(!$$CM.isNull(this._isProfilePhoto)&&this._isProfilePhoto==true){this._imgAvatar.SetAttribute("src",this._profilePhotoURL+"?v="+d)}else{this._imgAvatar.SetAttribute("src",this._avatarURL+"?v="+d)}setTimeout(function(){if(c._loadingImage==true){c._loadingImage=false;c.hideHeadNav();c._divCancel.Hide();jQuery(".slider").animate({left:"-480px"},"slow",function(){jQuery(".slider .panel").hide();c.slideIn_cropPanel()});var f={title:"File Not Found",header:"",message:"There was an error finding the photo: "+c._avatarURL,width:700};$$CMD.Alert(f)}},5000,c);return}}this.slideIn_cropPanel()},onFinalImageLoad:function(){this._loadingImage=false;this.slideIn_confirmAndSavePanel()},clearImageCropper:function(){if(this._imgCrop!=null){this._imgCrop.Destroy()}this._imgCrop=null;this._avatarFileName="";this._avatarURL="";this._imageURL="";this._avatarAdded=false;this._imgAvatar.SetAttribute("src","")},clearData:function(){this._avatarAdded=false;this._avatarFileName="";this._avatarURL="";this._imageURL=""},slideIn_uploadAvatar:function(){var a=this;jQuery(".slider .uploadPanel").show();a.hideLoader();this.bindFileUpload();jQuery(".slider").animate({left:"0"},"slow",function(){jQuery("#modalAddAvatar .hd").removeClass("stepTwo stepThree");a._activePanel=1;a._divCancelPanel1.Show();a._divCancelPanel2.Hide();a._divCancelPanel3.Hide();a._divCancel.Show();a.showHeadNav()})},slideIn_cropPanel:function(){var a=this;jQuery(".slider .imageCropPanel").show();a.hideLoader();jQuery(".slider").animate({left:"0"},"slow",function(){jQuery("#modalAddAvatar .hd").removeClass("stepThree").addClass("stepTwo");a._activePanel=2;a._divCancelPanel1.Hide();a._divCancelPanel2.Show();a._divCancelPanel3.Hide();a._divCancel.Show();a.showHeadNav()})},slideIn_confirmAndSavePanel:function(){var a=this;jQuery(".slider .confirmAndSavePanel").show();a.hideLoader();jQuery(".slider").animate({left:"0"},"slow",function(){jQuery("#modalAddAvatar .hd").removeClass("stepTwo").addClass("stepThree");a._activePanel=3;a._divCancelPanel1.Hide();a._divCancelPanel2.Hide();a._divCancelPanel3.Show();a._divCancel.Show();a.showHeadNav()})},showLoader:function(){jQuery("#modalAddAvatar .bd #loading").animate({opacity:"show"})},hideLoader:function(){jQuery("#modalAddAvatar .bd #loading").animate({opacity:"hide"})},hideHeadNav:function(){},showHeadNav:function(){}});"cm.ui.common".namespace();cm.ui.common.AvatarWidgetConfigOptions=Class.create(cm.ConfigOptions,{width:390,isProfilePhoto:false,isPersonFrame:false,isPerson:true,isUserUpgrade:false,isSelf:false,verifyUserOnServerCall:false,forcePath:"",isUPRProfile:false,enableInstructions:true,instructionConclusion:"After updating the photo, press 'Submit Form' to submit this form.",instructionsCss:"mtb10px",instructionsInline:true,imageCss:"w175px w175px",editCss:"w175px",horizontalPosition:"right",wrapperCss:"",});cm.ui.common.AvatarWidget=Class.create(cm.ui.ComplexControl,{_currentUser:{},_isAvatarChanged:false,configureDefaultOptions:function(){return new cm.ui.common.AvatarWidgetConfigOptions()},initializeData:function($super){$super();this.Initialized=false;this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}var a=$$CLIENT.VersionBranch;this._isUPR=(a&1048576)==1048576},initializeDAOs:function($super){$super();this._securityDAO=new cm.dao.Security.DAO()},initializeUIElements:function(){if(!$$CM.isEmpty(this._co.cssClass)){this.AddClassName(this._co.cssClass)}this._divPhotoControlWrapper=$$P.div();this.AddChild(this._divPhotoControlWrapper);if(!$$CM.isEmpty(this._co.wrapperCss)){this._divPhotoControlWrapper.AddClassName(this._co.wrapperCss)}this._divInstructions=$$P.div();this._divPhotoControlWrapper.AddChild(this._divInstructions);if(!$$CM.isEmpty(this._co.instructionsCss)){this._divInstructions.AddClassName(this._co.instructionsCss)}this._divInstructions.Hide();this._divPhoto=$$P.div();this._divPhotoControlWrapper.AddChild(this._divPhoto);if(this._co.horizontalPosition=="left"){if(this._co.instructionsInline==true){this._divInstructions.AddClassName("cmFloatRight w55prct")}this._divPhoto.AddClassName("cmFloatLeft")}else{if(this._co.horizontalPosition=="right"){if(this._co.instructionsInline==true){this._divInstructions.AddClassName("cmFloatLeft w55prct")}this._divPhoto.AddClassName("cmFloatRight")}else{this._divPhoto.AddClassName("cmCenter")}}this._divPhoto.AddClassName(this._co.imageCss);this._divEdit=$$P.div();this._divPhoto.AddChild(this._divEdit);this._divEdit.AddClassName(this._co.editCss);if(this._co.isProfilePhoto){this._divPhoto.AddClassName("profileDiv");this._divEdit.AddClassName("profileEditDiv");this._divEdit.UpdateInnerHtml("Click Here to Upload")}else{this._divPhoto.AddClassName("avatarDiv");this._divEdit.AddClassName("avatarEditDiv");this._divEdit.UpdateInnerHtml("Upload")}if(this._co.isProfilePhoto&&this._isUPR&&this._co.isUPRProfile){this._imgRotateCW=new $$IMG("imgRotateCW",{source:cm.hosts.common+"/system/ui/common/images/blue_rotate_cw.png"});this._divPhoto.AddChild(this._imgRotateCW);this._imgRotateCW.AddClassName("avatarRotateCW");this._imgRotateCW.Hide();this._imgRotateCCW=new $$IMG("imgRotateCW",{source:cm.hosts.common+"/system/ui/common/images/blue_rotate_ccw.png"});this._divPhoto.AddChild(this._imgRotateCCW);this._imgRotateCCW.AddClassName("avatarRotateCCW");this._imgRotateCCW.Hide()}this._divModals=$$P.div("divModals");this.AddChild(this._divModals)},createEvents:function($super){$super();this.SubmitEvent=new cm.event();this.ClearEvent=new cm.event();this.InitializedEvent=new cm.event();this.VerifyUser=new cm.event();this.ImageChangedEvent=new cm.event()},wireEvents:function($super){$super();this._divEdit.AddClickListener();this._divEdit.ClickEvent.subscribe(this.onAvatarClick,this);this._securityDAO.PersonAvatarFileNameReceived.subscribe(this.onPersonAvatarFileNameReceived,this);if(this._co.isProfilePhoto&&this._isUPR&&this._co.isUPRProfile){this._imgRotateCW.AddClickListener();this._imgRotateCW.ClickEvent.subscribe(this.onRotateCWClick,this);this._imgRotateCCW.AddClickListener();this._imgRotateCCW.ClickEvent.subscribe(this.onRotateCCWClick,this)}},destroyAvatarModal:function(){this._divModals.DestroyChildControls(true);this._divModals.UpdateInnerHtml("");this._avatarModal=null;this._avatarModalControl=null},createAvatarModal:function(){this.destroyAvatarModal();this._avatarModal=new cm.ui.dialog.ModalDialog("AvatarModal",{width:390,height:580,dialogClass:"avatarModal"});this._divModals.AddChild(this._avatarModal);this._avatarModalControl=new cm.ui.common.AvatarModalControl("modalAddAvatar",{controller:this._co.controller,panelContainer:this,title:"modalAddAvatar",width:this._co.width,isProfilePhoto:this._co.isProfilePhoto,isPersonFrame:this._co.isPersonFrame,isAuthorizedAdult:this._co.isAuthorizedAdult,isUserUpgrade:this._co.isUserUpgrade,isSelf:this._co.isSelf,verifyUserOnServerCall:this._co.verifyUserOnServerCall});this._avatarModal.AddChild(this._avatarModalControl);this._avatarModalControl.CloseEvent.subscribe(this.onCloseAvatarModal,this);this._avatarModalControl.ClearEvent.subscribe(this.onClearAvatarModal,this);this._avatarModalControl.SubmitEvent.subscribe(this.onSubmitAvatarModal,this);this._avatarModalControl.ShowModalEvent.subscribe(this.onShowAvatarModal,this);this._avatarModalControl.VerifyUser.subscribe(this.onVerifyUser,this)},onAvatarClick:function(b,a){this.createAvatarModal();this._avatarModalControl.Bind(this._currentUser)},onRotateCWClick:function(b,a){DAO.Person.RotateAvatar({PersonID:$$AR.PersonID,ClockWise:true},{scope:this,onSuccess:function(c){this.SubmitEvent.fire()}})},onRotateCCWClick:function(b,a){DAO.Person.RotateAvatar({PersonID:$$AR.PersonID,ClockWise:false},{scope:this,onSuccess:function(c){this.SubmitEvent.fire()}})},onVerifyUser:function(b,a){this.VerifyUser.fire(this,a)},onShowAvatarModal:function(b,a){this._avatarModal.Show()},onCloseAvatarModal:function(b,a){this._avatarModal.Hide();this.destroyAvatarModal()},onClearAvatarModal:function(b,a){this._currentUser=this._avatarModalControl.GetData();this.ClearEvent.fire(b,this._currentUser);this.renderData()},onSubmitAvatarModal:function(b,a){this._currentUser=this._avatarModalControl.GetData();this.SubmitEvent.fire(b,this._currentUser);this.renderData()},onPersonAvatarFileNameReceived:function(b,a){this._currentUser=a.data;this.renderData()},onVerifyUserPersonAvatarFileNameGet:function(d,a){var b=a[0];var c=a[1];this._securityDAO.PersonAvatarFileNameGet(b,c)},renderData:function(){var h=$$CM.newGuid();var a="";var b="";if(this._co.isSelf){a="yourself";b="your"}else{var f="person";if(!$$CM.isEmpty(this._co.personLabel)){f=this._co.personLabel}var g="person";if(!$$CM.isEmpty(this._co.personLabelPossessive)){g=this._co.personLabelPossessive}a="the "+f;b="the "+g;if(!$$CM.isEmpty(this._currentUser.FirstName)){a=this._currentUser.FirstName;b=a;if(a.charAt(a.length-1)=="s"){b=a+"'"}else{b=a+"'s"}}}this._currentUser.firstNameLabel;this._currentUser.firstNamePossessiveLabel=b;var c="";var e="";if(!$$CM.isEmpty(this.GetConfigOptions().forcePath)){e=this.GetConfigOptions().forcePath}else{if(!$$CM.isEmpty(cm.hosts.common)){e=cm.hosts.common}}if(this._co.isProfilePhoto){var d="";if(!$$CM.isEmpty(this._currentUser.ProfilePhotoURL)){if(this._currentUser.ProfilePhotoURL.indexOf("defaultAvatars")>=0){if(this._co.isProfilePhoto&&this._isUPR&&this._co.isUPRProfile){this._imgRotateCW.Hide();this._imgRotateCCW.Hide()}d+="Please upload a current photo of "+a+" by clicking on the image."}else{if(this._co.isProfilePhoto&&this._isUPR&&this._co.isUPRProfile){this._imgRotateCW.Show();this._imgRotateCCW.Show()}d+="If you would like to update "+b+" photo, please click on the image."}c=this._currentUser.ProfilePhotoURL+"?v="+h}else{d+="Please upload a current photo of "+a+" by clicking on the image.";if($$CM.IsUPR()&&$$CM.isNumber(this._currentUser.PersonID)&&Number(this._currentUser.PersonID)>0){c=$$CM.getPersonAvatar(this._currentUser,"Medium")}else{if(this._currentUser.Gender==0){c=e+"/common/lib/core/ui/common/images/missDefault_175.png"}else{c=e+"/common/lib/core/ui/common/images/mrDefault_175.png"}}}if(!$$CM.isEmpty(this._co.instructionConclusion)){d+="<br />&nbsp;<br />"+this._co.instructionConclusion}this._divInstructions.UpdateInnerHtml(d);this._divEdit.UpdateInnerHtml("Click Here to Upload");if(this._co.enableInstructions==true){this._divInstructions.Show()}}else{if(!$$CM.isEmpty(this._currentUser.ProfilePhotoURL)){this._divEdit.UpdateInnerHtml("Replace");c=this._currentUser.ProfilePhotoURL+"?v="+h}else{this._divEdit.UpdateInnerHtml("Upload");if($$CM.IsUPR()&&$$CM.isNumber(this._currentUser.PersonID)&&Number(this._currentUser.PersonID)>0){c=$$CM.getPersonAvatar(this._currentUser,"Small")}else{if(this._currentUser.Gender==0){c=e+"/common/lib/core/ui/common/images/missDefault.png"}else{c=e+"/common/lib/core/ui/common/images/mrDefault.png"}}}}c=$$CM.getPersonAvatar(this._currentUser);this._divPhoto.AssignStyle("background-image","url('"+c+"')");this._divPhoto.AddClassName("uprAvatarBackground");this.ImageChangedEvent.fire(this,c);this._divPhoto.Show();this.InitializedEvent.fire(this,{})},onDataUpdated:function(){var d=this.GetBoundData();var h=0;var c=0;var f=2;var a="";var i="";var b="";var e="";if(!$$CM.isNull(d)){if($$CM.isNumber(d.PersonID)){h=d.PersonID}if($$CM.isNumber(d.ClientID)){c=d.ClientID}if($$CM.isNumber(d.Gender)){f=d.Gender}if(!$$CM.isEmpty(d.AvatarFileName)){a=d.AvatarFileName}if(!$$CM.isEmpty(d.ProfilePhotoURL)){i=d.ProfilePhotoURL}if(!$$CM.isEmpty(d.AvatarURL)){b=d.AvatarURL}if(!$$CM.isEmpty(d.FirstName)){e=d.FirstName}}if(h>0){this._currentUser={};this._currentUser.PersonID=h;this._currentUser.ClientID=c;this._currentUser.Gender=f;this._currentUser.AvatarFileName=a;this._currentUser.ProfilePhotoURL=i;this._currentUser.AvatarURL=b;this._currentUser.FirstName=e;this.renderData()}else{if(!$$CM.isNull(d.PersonInfo)){this._currentUser=d.PersonInfo;this.renderData()}else{if(this.GetConfigOptions().verifyUserOnServerCall==true){var g={};g.fn=this.onVerifyUserPersonAvatarFileNameGet;g.arg=[c,h];g.scope=this;this.VerifyUser.fire(this,g)}else{this._securityDAO.PersonAvatarFileNameGet(c,h)}}}},GetData:function(){return this._currentUser},GetAvatarFileName:function(){var a="";if(!$$CM.isNull(this._currentUser)){a=this._currentUser.AvatarFileName}return a}});"cm.ui.common".namespace();cm.ui.common.BubbleNoteConfigOptions=Class.create(cm.ConfigOptions,{text:"",anchor:null,width:150,maxWidth:null,top:0,left:0});cm.ui.common.BubbleNote=Class.create(cm.ui.Control,{_visible:false,initializeUIElements:function(){this.AddClassName("cmBubbleNote");this._divPointer=$$P.div(this.ID()+"_pointer","",{classNames:"pointer"});this.AddChild(this._divPointer);this._divBubble=$$P.div(this.ID()+"_bubble","",{classNames:"bubble"});if($$CM.isNull(this.GetConfigOptions().maxWidth)){this._divBubble.AssignStyle("width",this.GetConfigOptions().width+"px")}else{this._divBubble.AssignStyle("max-width",this.GetConfigOptions().maxWidth+"px")}this.AddChild(this._divBubble)},createEvents:function(){this.AddClickListener();this.AddClickAwayListener()},wireEvents:function(){var a=this;window.onscroll=function(){a.onWindowScroll.call(a)};this.ClickEvent.subscribe(this.onClick,this,true);this.ClickAwayEvent.subscribe(this.onClickAway,this)},postInitialize:function(){this.Bind(this.GetConfigOptions().text);this.relocate()},Bind:function(a){this._divBubble.UpdateInnerHtml(a)},AddBubbleChild:function(a){this._divBubble.AddChild(a)},ClearBubble:function(a){this._divBubble.DestroyChildControls()},GetData:function(){return $$E(this._divBubble).innerHTML},IsVisible:function(){return this._visible},Toggle:function(){this._visible=!this._visible;this.relocate();$$JQ(this).toggle({duration:150})},Show:function(){this._visible=true;$$JQ(this).show("fade",{duration:150})},Hide:function(){this._visible=false;$$JQ(this).hide("fade",{duration:150})},configureDefaultOptions:function(){return new cm.ui.common.BubbleNoteConfigOptions()},relocate:function(){var a=this.GetConfigOptions().anchor;var f=this.GetConfigOptions().top;var c=this.GetConfigOptions().left;if(!$$CM.isNull(a)){var e=$$JQ(a).offset().top;var b=$$JQ(a).offset().left;var d=jQuery(document).scrollTop();$$JQ(this._divPointer).css({top:(f+e-d)+"px",left:(c+b)+"px"});$$JQ(this._divBubble).css({top:(f+e-d)+"px",left:(c+b)+"px"})}},onWindowScroll:function(){this.relocate()},onClickAway:function(b,a){this.Hide()},onClick:function(b,a){}});"cm.ui.common".namespace();cm.ui.common.CheckBoxColumnControlConfigOptions=Class.create(cm.ConfigOptions,{controlWidth:980,labelWidth:100,label:"Select",includeLabel:true,labelClassNames:"",columnNumbers:3,columnClassNames:"",orderUpDown:true,includeAllNone:true,allNoneWidth:80});cm.ui.common.CheckBoxColumnControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.CheckBoxColumnControlConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._checkBoxControls=$A()},initializeUIElements:function(){var a=this.ID();this.SetWidth(this._cfo.controlWidth);this._divLabel=$$P.div("divLabel_"+a);this.AddChild(this._divLabel);this._divLabel.AddClassName("cmFloatLeft");this._divLabel.SetWidth(this._cfo.labelWidth);this._divLabel.Hide();if(this._cfo.includeLabel){this._divLabel.Show();if(!$$CM.isEmpty(this._cfo.label)){this._divLabel.UpdateInnerHtml(this._cfo.label)}if(!$$CM.isEmpty(this._cfo.labelClassNames)){this._divLabel.AddClassName(this._cfo.labelClassNames)}}var b=this._cfo.controlWidth-this._cfo.labelWidth;if(this._cfo.includeAllNone){b-=this._cfo.allNoneWidth}this._divCheckBoxColumnWrapper=$$P.div("divCheckBoxColumnWrapper_"+a);this.AddChild(this._divCheckBoxColumnWrapper);this._divCheckBoxColumnWrapper.AddClassName("cmFloatLeft");this._divCheckBoxColumnWrapper.SetWidth(b);this._divAllNoneWrapper=$$P.div("divAllNoneWrapper_"+a);this.AddChild(this._divAllNoneWrapper);this._divAllNoneWrapper.AddClassName("cmFloatRight");this._divCheckBoxColumnWrapper.SetWidth(this._cfo.allNoneWidt);this._divAllNoneWrapper.Hide();this._aNone=new $$A("aNone_"+a,{text:"None"});this._divAllNoneWrapper.AddChild(this._aNone);this._aNone.AddClassName("cmFloatRight");this._aAll=new $$A("aAll_"+a,{text:"All"});this._divAllNoneWrapper.AddChild(this._aAll);this._aAll.AddClassName("cmFloatRight mr20px");this._;if(this._cfo.includeAllNone){this._divAllNoneWrapper.Show()}},createEvents:function(){this.DataChangedEvent=new cm.event()},wireEvents:function(){this._aNone.ClickEvent.subscribe(this.aNoneClicked,this);this._aAll.ClickEvent.subscribe(this.aAllClicked,this)},aNoneClicked:function(b,a){this.SelectAllControls(false)},aAllClicked:function(b,a){this.SelectAllControls(true)},onDataChanged:function(b,a){this.DataChangedEvent.fire(b)},SelectAllControls:function(a){this._checkBoxControls.each(function(b){b.Bind(a)},this);this.DataChangedEvent.fire(this)},Render:function(f){this._divCheckBoxColumnWrapper.ClearChildControls();this._checkBoxControls=$A();var j=this.ID();var c=this._cfo.columnNumbers;var g=0;var b=$A();if($$CM.isArray(f)&&f.length>0&&c>0){var l=this._cfo.controlWidth-this._cfo.labelWidth;if(this._cfo.includeAllNone){l-=this._cfo.allNoneWidth}var d=Math.floor(l/c);g=Math.floor(f.length/c);if(f.length%c>0){g++}for(var h=0;h<c;h++){var a=$$P.div("divCheckBoxColumn_"+h+"_"+j);a.SetWidth(d);if(!$$CM.isEmpty(this._cfo.columnClassNames)){a.AddClassName(this._cfo.columnClassNames)}this._divCheckBoxColumnWrapper.AddChild(a);b.push(a)}var k=this._cfo.orderUpDown;var e=0;f.each(function(p){var m=$$P.div();m.SetWidth(d);m.AssignStyle("display","inline-block");var i=new $$FCB("cb_"+p.ID,{label:p.Name});m.AddChild(i);i.AddClassName("cmFloatLeft");var n=0;if(k){n=Math.floor(e/g)}else{n=e%c}var o=b[n];if(!$$CM.isNull(o)){o.AddChild(m)}this._checkBoxControls.push(i);i.DataObject=p;i.ClickEvent.subscribe(this.onDataChanged,this);e++},this)}},Bind:function(a){},GetData:function(){var a=$A();this._checkBoxControls.each(function(b){var c=b.DataObject;a.push({Data:c,State:b.GetData()})},this);return a}});"cm.ui.common".namespace();cm.ui.common.CodeMirrorConfigOptions=Class.create(cm.ConfigOptions,{value:"",mode:"javascript",theme:"cmCodeMirror",indentUnit:4,smartIndent:true,tabSize:4,indentWithTabs:true,electricChars:true,autoClearEmptyLines:false,keyMap:"default",extraKeys:null,lineWrapping:false,lineNumbers:false,firstLineNumber:1,autoFocus:true,undoDepth:40,width:600,height:300});$$CODEMIRROR=cm.ui.common.CodeMirror=Class.create(cm.ui.Control,{initializeUIElements:function(){var b=$$P.txa(null,null,{classNames:"cmCodeMirror"});this.AddChild(b);var a=this.GetConfigOptions();this._codeMirror=CodeMirror.fromTextArea($$E(b),this.GetConfigOptions());this._codeMirror.setSize(a.width,a.height)},configureDefaultOptions:function(){return new cm.ui.common.CodeMirrorConfigOptions()},postInitialize:function(){var a=this._codeMirror;setTimeout(function(){a.refresh();a.focus()},200)},Bind:function(a){this._codeMirror.setValue(a.trim())},GetData:function(){return this._codeMirror.getValue()},Refresh:function(){this._codeMirror.refresh()},Focus:function(){this._codeMirror.focus()}});"cm.ui.common".namespace();cm.ui.common.TemplateConfigOptions=Class.create(cm.ConfigOptions,{});$$DOW=cm.ui.common.Template=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.TemplateConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if($$CM.isNull(this._co)){this._co=new Object()}this._uniqueID=$$CM.uniqueID()},initializeUIElements:function(){this.AddClassName(this._co.cssClass)},createEvents:function($super){$super()},wireEvents:function($super){$super()},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear()},onDataUpdated:function(){var a=this.GetBoundData();if($$CM.isNull(a)){}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}return a}});"cm.ui.common".namespace();cm.ui.common.CurrencyControlConfigOptions=Class.create(cm.ConfigOptions,{required:false,groupFieldName:"",titleCssClass:"",dividerCssClass:"",digitInputCssClass:"",decimalInputCssClass:"w20px",digitFieldName:"Dollars",decimalFieldName:"Cents",dividerLabel:".",currencyLabel:"$",includeCurrencyLabel:true,minValue:0,maxValue:999999999.99});cm.ui.common.CurrencyControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.CurrencyControlConfigOptions()},render:function(){var a=$$P.span(this._id+"Controls");return $$E(a)},initializeData:function($super){$super();this._co=this.GetConfigOptions();if($$CM.isNull(this._co)){this._co=new Object()}},initializeUIElements:function(){var b=$$CM.uniqueID();var a=Math.floor(this._co.maxValue).toFixed(0).length;if(this.Version()==2){this.AddClassName("cmCurrencyControl");this._currencyLabel=new $$FLBL2(null,{value:this._co.currencyLabel,classNames:"cmCurrencyControlSubControl cmCurrencyControlSubControlLabel mr1px"});this.AddChild(this._currencyLabel);if(!this._co.includeCurrencyLabel){this._currencyLabel.Hide()}this._ftxtDigit=new $$FTXT2(null,{maxLength:a,classNames:"cmCurrencyControlSubControl cmCurrencyControlSubControlDigit"});this.AddChild(this._ftxtDigit);this._ftxtDigit.GetInputControl().SetWidth(a*10);this.AddChild(new $$FLBL2(null,{value:".",classNames:"cmCurrencyControlSubControl cmCurrencyControlSubControlDivider"}));this._ftxtDecimal=new $$FTXT2(null,{maxLength:2,classNames:"cmCurrencyControlSubControl cmCurrencyControlSubControlDecimal"});this.AddChild(this._ftxtDecimal)}else{this._currencyLabel=$$P.strong("",this._co.currencyLabel,{});this.AddChild(this._currencyLabel);this._currencyLabel.AddClassName("mr1px");if(!this._co.includeCurrencyLabel){this._currencyLabel.Hide()}this._ftxtDigit=new $$FTXT("ftxtDigit_"+b,{maxLength:a,inputWidth:(a*7)});this.AddChild(this._ftxtDigit);if(this._co.clearStyles==true){this._ftxtDigit.GetTitleControl().RemoveClassName("cmTitleBase");this._ftxtDigit.GetTitleControl().RemoveClassName("cmTitleWidth");this._ftxtDigit.GetTitleControl().RemoveClassName("cmTextTitleBase");if($$CM.isEmpty(this._ftxtDigit.GetConfigOptions().label)){this._ftxtDigit.RemoveChildControl(this._ftxtDigit.GetTitleControl())}this._ftxtDigit.GetInputControl().RemoveClassName("cmInputWidth")}if(!$$CM.isEmpty(this._co.digitInputCssClass)){this._ftxtDigit.GetInputControl().AddClassName(this._co.digitInputCssClass)}this._strongDivider=$$P.strong("",".",{});this.AddChild(this._strongDivider);this._strongDivider.AddClassName("ml1px mr1px");if(!$$CM.isEmpty(this._co.dividerCssClass)){this._strongDivider.AddClassName(this._co.dividerCssClass)}this._ftxtDecimal=new $$FTXT("ftxtDecimal_"+b,{maxLength:2});this.AddChild(this._ftxtDecimal);if(this._co.clearStyles==true){this._ftxtDecimal.GetTitleControl().RemoveClassName("cmTitleBase");this._ftxtDecimal.GetTitleControl().RemoveClassName("cmTitleWidth");this._ftxtDecimal.GetTitleControl().RemoveClassName("cmTextTitleBase");if($$CM.isEmpty(this._ftxtDecimal.GetConfigOptions().label)){this._ftxtDecimal.RemoveChildControl(this._ftxtDecimal.GetTitleControl())}this._ftxtDecimal.GetInputControl().RemoveClassName("cmInputWidth")}if(!$$CM.isEmpty(this._co.decimalInputCssClass)){this._ftxtDecimal.GetInputControl().AddClassName(this._co.decimalInputCssClass)}}this.SetValidation()},Bind:function(a){if(!$$CM.isEmpty(a)){var b=a.toFixed(2).toString().split(".");if($$CM.isArray(b)&&b.length==2){this._ftxtDigit.Bind(b[0]);this._ftxtDecimal.Bind(b[1])}}},GetData:function(){var c=this._ftxtDigit.GetData();var b=this._ftxtDecimal.GetData();var a=c+"."+b;return Number(a)},Reset:function(){this.Validator.Clear();this._ftxtDigit.Bind("");this._ftxtDecimal.Bind("")},SetInvalid:function(){this._ftxtDigit.AddClassName("cmValidationError");this._ftxtDecimal.AddClassName("cmValidationError")},SetValidation:function(){var a="";if(!$$CM.isEmpty(this.GetConfigOptions().groupFieldName)){a=this.GetConfigOptions().groupFieldName+" - "}var b=(this._co.required==true)?true:false;var f=this._co.minValue;var d=this._co.maxValue;var e=f.toFixed(2).toString().split(".");var c=d.toFixed(2).toString().split(".");this._ftxtDigit.Validator.addEvaluator($$EVAL.NUMBER({FieldName:a+this._co.digitFieldName,IsRequired:b,MinValue:Number(e[0]),MaxValue:Number(c[0])}));this._ftxtDecimal.Validator.addEvaluator($$EVAL.NUMBER({FieldName:a+this._co.decimalFieldName,IsRequired:b,MinValue:Number(e[1]),MaxValue:Number(c[1])}))},ToggleValidation:function(a){if(a==true){this._ftxtDigit.Validator.Enable();this._ftxtDecimal.Validator.Enable()}else{this._ftxtDigit.Validator.Disable();this._ftxtDecimal.Validator.Disable()}}});"cm.ui.common".namespace();cm.ui.common.DataTableConfigOptions=Class.create(cm.ConfigOptions,{cols:$A(),headers:true,hasBodyScroll:false,hidePageOptions:false,bodyScrollHeight:100,bodyCssClass:"",hasSelectAll:false,pageSize:0,pageOptions:[{Name:"20",Value:20},{Name:"50",Value:50},{Name:"All",Value:Infinity},],filterFunction:null,defaultFilterColumn:null,paginationControlContainer:null,SelectionChangedEvent:null,selectOrShowing:"Showing"});cm.ui.common.DataTable=$$DTBL=Class.create(cm.ui.Control,{COL_CHECK:{Key:"Select",Name:"",ClassNames:""},_rows:null,_headerColumns:null,PaginateEvent:null,configureDefaultOptions:function(){return new cm.ui.common.DataTableConfigOptions()},render:function(){var a=$$P.tbl(this._id,this.GetConfigOptions());return $$E(a)},initializeData:function(){this._co=this.GetConfigOptions();this._rows=new cm.ui.Hashtable();this._currentPage=1;this._totalPages=1;this._isShowAll=true;this._filterEnabled=false;this._filterColumn=this._co.defaultFilterColumn;this._filterValue=this._co.defaultFilterValue;this._filteredRows=[]},initializeUIElements:function(){this.AddClassName("cmDataTable");this._header=$$P.div();var b=this._co.pageSize;if(b>0){this._divPageSelector=$$P.div();this._ddlPageSelector=new $$FDDL(null,{label:"Show: ",inputWidth:50,spanWidth:40});this._ddlPageSelector.bindList(this._co.pageOptions);this._divPageSelector.AddChild(this._ddlPageSelector);this._divPageSelector.AddClassName("cmFloatRight");this._header.AddChild(this._divPageSelector);var a=this._co.pageOptions.indexOf(this._co.pageOptions.find(function(c){return c.Value==b}));this._ddlPageSelector.setSelectedIndex(a);if(this._co.hidePageOptions){this._ddlPageSelector.Hide()}}this._divPageCount=$$P.div("divWarning",null,{classNames:"cmFloatLeft cmBold"});this._header.AddChild(this._divPageCount);if(this._co.paginationControlContainer){this._co.paginationControlContainer.AddChild(this._header);this._divPageCount.Hide()}this._headerColumns={};if(this._co.headers==true){this._tHead=$$P.thead();this._thr=$$P.tr();if(this._co.hasBodyScroll){this._tHead.AddChild(this._thr)}if(this._co.hasSelectAll){this._co.cols.unshift(this.COL_CHECK)}this._co.cols.each(function(c){var e=($$CM.isObject(c))?c.Name:c;var g=$$P.th();var d=null;if(c==this.COL_CHECK){var f=new $$FCB(null,{classNames:"p0px"});f.ClickEvent.subscribe(this.onSelectAll,this);d=f}else{if(c&&c.Object){d=c.Object}}if($$CM.isObject(d)&&!$$CM.isNull(d)){g.AddChild(d)}else{g.UpdateInnerHtml(e)}if(!$$CM.isNull(c.ClassNames)){g.AddClassName(c.ClassNames)}if(this._co.hasBodyScroll){this._thr.AddChild(g)}else{this._tHead.AddChild(g)}this._headerColumns[e]=g},this);this.AddChild(this._tHead)}this._body=$$P.tbody();this.AddChild(this._body);if(this._co.hasBodyScroll){this.AddClassName("hasBodyScroll");this._body.AssignStyle("overflow-y","scroll");this._body.AssignStyle("overflow-x","hidden");this._thr.AssignStyle("display","block");this._body.AssignStyle("display","block");this._body.SetHeight(this._co.bodyScrollHeight)}if(!$$CM.isEmpty(this._co.bodyCssClass)){this._body.AddClassName(this._co.bodyCssClass)}this._divWarning=$$P.div("divWarning",null,{classNames:"cmRed cmTACenter cmBold m10px"});this.AddChild(this._divWarning);this._divWarning.Hide()},createEvents:function($super){$super();this.PaginateEvent=new cm.event();this.SelectionChangedEvent=new cm.event()},wireEvents:function($super){$super();if(this._co.pageSize>0){this._ddlPageSelector.ChangeEvent.subscribe(this.onPageSizeSelected,this)}},GetBody:function(){return this._body},SetBodyHeight:function(a){this._co.bodyScrollHeight=a;this._body.SetHeight(this._co.bodyScrollHeight)},GetRowCount:function(){return this._rows.keys.length},SetColumnLabel:function(a,b){var c=this._headerColumns[a];if(!$$CM.isNull(c)){c.UpdateInnerHtml(b)}},Clear:function(){var c=this._filterEnabled;this._filterEnabled=false;while(this._rows.keys.length>0){this.RemoveRow(this._rows.keys[0])}this._filterEnabled=c;if(this._co.pageSize>0){this._currentPage=1}if(this._co.hasSelectAll){var b=this._headerColumns[this.COL_CHECK.Name];if(b&&b._childControls.length>0){var a=b._childControls[0];a.SetChecked(false)}}},onSelectRow:function(d,a){if(!d.IsChecked()){var c=this._headerColumns[this.COL_CHECK.Name];if(c&&c._childControls.length>0){var b=c._childControls[0];b.SetChecked(d.IsChecked())}}this.updateSelectShowCount();this.SelectionChangedEvent.fire()},onSelectAll:function(d,c){if(this._co.hasSelectAll){var b=this._headerColumns[this.COL_CHECK.Name];if(b&&b._childControls.length>0){var a=b._childControls[0];c=a.IsChecked()}this.SelectAll(c)}this.updateSelectShowCount();this.SelectionChangedEvent.fire()},SelectAll:function(b){var c=this;if(!$$CM.isNull(b)){var d=this._headerColumns[this.COL_CHECK.Name];if(d&&d._childControls.length>0){var a=d._childControls[0];a.SetChecked(b)}this._rows.keys.each(function(f){var g=c.GetRow(f);var h=g.Data.get(c.COL_CHECK.Key);var e=h._childControls.length>0?h._childControls[0]:null;if(e){e.SetChecked(b)}})}},GetSelectedRows:function(){if(this._rows.keys.length>0){var a=this;var b=[];if(this._co.hasSelectAll){this._rows.keys.each(function(d){var e=a.GetRow(d);if(e.PageNumber!==-1){var f=e.Data.get(a.COL_CHECK.Key);var c=f._childControls.length>0?f._childControls[0]:null;if(c&&c.IsChecked()){b.push(d)}}})}return b}else{return[]}},RowIDs:function(){var a=$A();this._rows.keys.each(function(b){a.push(b)},this);return a},AddSingleColumnRow:function(f,a){var h=$$P.tr();this._body.AddChild(h);var c=new cm.ui.Hashtable();var b=this._co.cols[0];var d=($$CM.isObject(b))?b.Key:b;var g=$$P.td();h.AddChild(g);g.SetAttribute("colspan",this._co.cols.length);if(!$$CM.isNull(b.ClassNames)){g.AddClassName(b.ClassNames)}c.put(d,g);var e={Row:h,Data:c};this._rows.put(f,e);if(!$$CM.isEmpty(a)){h.AddClassName(a)}return e},AddRow:function(f,b){var g=$$P.tr();this._body.AddChild(g);var c=new cm.ui.Hashtable();this._co.cols.each(function(h){var i=($$CM.isObject(h))?h.Key:h;var j=$$P.td();g.AddChild(j);if(!$$CM.isNull(h.ClassNames)){j.AddClassName(h.ClassNames)}c.put(i,j)},this);var d={Row:g,Data:c};if(this._co.pageSize>0){this._totalPages=Math.floor((this._rows.keys.length+1)/this._co.pageSize)+1;var e=this.determineRowPage(this._rows.keys.length,0);d.PageNumber=e;d.IsValid=true;this.determineRowVisibility(d)}this._rows.put(f,d);if(!$$CM.isEmpty(b)){g.AddClassName(b)}if(this._co.hasSelectAll){var a=new $$FCB(null,{value:f,classNames:"p0px"});a.ClickEvent.subscribe(this.onSelectRow,this);this.SetCell(f,this.COL_CHECK.Key,a)}return d},GetRow:function(a){return this._rows.get(a)},RemoveRowAndPaginate:function(a){this.RemoveRow(a);if(this._co.pageSize>0){this.determineRowPagination();this.paginateRows()}},RemoveRow:function(b){var a=this._rows.get(b);if(!$$CM.isNull(a)){this._body.DestroyChildControl(a.Row);this._rows.remove(b)}},setErrorMessage:function(a){this._body.Hide();this._tHead.Hide();if(this._co.pageSize>0){this._header.Hide()}this._divWarning.UpdateInnerHtml(a);this._divWarning.Show()},clearErrorMessage:function(){this._body.Show();this._tHead.Show();if(this._co.pageSize>0){this._header.Show()}this._divWarning.Hide()},onPageSizeSelected:function(c,a){var b=this._ddlPageSelector.GetData();this._co.pageSize=this._co.pageOptions.find(function(d){if(d.Name===b){return d}}).Value;this.determineRowPagination();this.paginateRows()},incrementPage:function(){if(this._currentPage<this._totalPages){this._currentPage++;this.paginateRows()}},decrementPage:function(){if(this._currentPage>1){this._currentPage--;this.paginateRows()}},determineRowVisibility:function(a){if(a.PageNumber<=this._currentPage&&a.PageNumber>-1&&a.IsValid){a.Row.Show();return true}else{a.Row.Hide();return false}},determineRowPagination:function(){var b=this;var a=0;var c=0;this._rows.keys.each(function(d){var f=b._rows.get(d);if(!f.IsValid){c++}var e=b.determineRowPage(a,c);if(f.IsValid){f.PageNumber=e}else{f.PageNumber=-1}a++})},determineRowPage:function(c,b){if(this._co.pageSize>0){var a=Math.ceil((c+1-b)/this._co.pageSize);return a}},paginateRows:function(){var b=this;var a=0;this._rows.keys.each(function(c){var d=b._rows.get(c);b.determineRowVisibility(d)});this.updateSelectShowCount()},updateSelectShowCount:function(){var a=this;var d=0;var b=0;var c=0;this._rows.keys.each(function(g){var h=a._rows.get(g);if(h.PageNumber!==-1){var f=a.determineRowVisibility(h);var e=a.determineRowIsChecked(h.Row);if(f){d=d+1}else{if(h.IsValid){b=b+1}}if(e){c=c+1}}});if(d>0){if(this.selectOrShowing=="Showing"){this._divPageCount.UpdateInnerHtml("Showing "+d+" out of "+(d+b))}else{this._divPageCount.UpdateInnerHtml("Selected "+c+" out of "+(d+b))}this._divPageCount.Show()}else{this._divPageCount.Hide()}},determineRowIsChecked:function(b){if(this._co.hasSelectAll){if(b._childControls.length>0){var a=b._childControls[0]._childControls[0];state=a.IsChecked()}return state}return false},FilterRows:function(a){if(a!=undefined){this._filterEnabled=a}var b=this;this._filteredRows=[];if(this._filterEnabled){if(this._co.filterFunction){this._rows.keys.each(function(d){var e=b._rows.get(d);var c=b._co.filterFunction(e.Data,b._filterColumn,b._filterValue);e.IsValid=c;if(c){b._filteredRows.push(e)}},this)}}else{this._rows.keys.each(function(c){var d=b._rows.get(c);d.IsValid=true})}if(this._co.pageSize>0){this.determineRowPagination();this.paginateRows()}},GetFilteredRows:function(){return this._filteredRows},GetFilteredRowCount:function(){return this._filteredRows.length},SetFilterColumn:function(a){this._filterColumn=a},SetFilterValue:function(a){this._filteredRows=0;this._filterValue=a;this.FilterRows(this._filterEnabled=true)},GetCell:function(c,b){var d=this._rows.get(c);if($$CM.isNull(d)){return null}var a=d.Data.get(b);if($$CM.isNull(a)){throw"No such column ID '"+b+"'"}if(a.ChildControls().length>0){return a.ChildControls()[0]}else{var e=$$E(a).innerHTML;if($$CM.isEmpty(e)){return null}else{return $$E(a).innerHTML}}},SetCell:function(d,c,f,a){var e=this._rows.get(d);if($$CM.isNull(e)){e=this.AddRow(d)}var b=e.Data.get(c);if($$CM.isNull(b)){throw"No such column ID '"+c+"'"}if(!$$CM.isEmpty(f)&&$$CM.isObject(f)){b.DestroyChildControls();b.AddChild(f)}else{b.UpdateInnerHtml(f)}if(!$$CM.isEmpty(a)){b.AddClassName(a)}},HideRow:function(a){var b=this._rows.get(a);if(b){b.Row.Hide();b.IsValid=false}if(this._co.pageSize>0){this.determineRowPagination();this.paginateRows()}},ShowRow:function(a){var b=this._rows.get(a);if(b){b.Row.Show();b.IsValid=true}if(this._co.pageSize>0){this.determineRowPagination();this.paginateRows()}},MoveRow:function(c,e){var b=this._rows.get(c).Row;var d=this._rows.keys.indexOf(c);var g=d+e;if(g<0||(g>this._rows.keys.length-1)){return}this._body.RemoveChildControl(b);var a=(e>0)?g+1:g;if(a<=this._rows.keys.length-1){var f=this._rows.get(this._rows.keys[a]).Row;this._body.AddChild(b,$$E(f))}else{this._body.AddChild(b)}var h=this._rows.keys[d];this._rows.keys[d]=this._rows.keys[g];this._rows.keys[g]=h;if(this._co.pageSize>0){this.determineRowPagination();this.paginateRows()}}});"cm.ui.common".namespace();cm.ui.common.DateTimeControlConfigOptions=Class.create(cm.ConfigOptions,{includeMonth:true,includeDay:true,includeYear:true,includeHour:true,includeMinute:true,requireDate:false,requireTime:false,fieldNamePrefix:"",label:"",htmlCssVersion:1});cm.ui.common.DateTimeControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.DateTimeControlConfigOptions()},initializeUIElements:function(){if(this.GetConfigOptions().includeMonth){if(this.GetConfigOptions().htmlCssVersion==1){this._ddlMonth=new $$FDDL("ddlMonth",{label:this.GetConfigOptions().label,inputWidth:90,spanWidth:this.GetConfigOptions().label?null:0})}else{this._ddlMonth=new $$FDDL2(null,{label:this.GetConfigOptions().label,classNames:"dtcDDLMonth"})}this._ddlMonth.AddClassName("wAuto");this.AddChild(this._ddlMonth);var d=$$DATE.getMonthArray(false);this._ddlMonth.bindList(d,"","Month");this._ddlMonth.Validator.addEvaluator($$EVAL.SELECT({FieldName:this.GetConfigOptions().fieldNamePrefix+"Month",IsRequired:this.GetConfigOptions().requireDate}))}if(this.GetConfigOptions().includeDay){if(this.GetConfigOptions().htmlCssVersion==1){this._ddlDay=new $$FDDL("ddlDay",{inputWidth:50,spanWidth:0})}else{this._ddlDay=new $$FDDL2(null,{classNames:"dtcDDLDay"})}this._ddlDay.AddClassName("wAuto");this.AddChild(this._ddlDay);var a=$$DATE.getDayArray();this._ddlDay.bindList(a,"","Day");this._ddlDay.Validator.addEvaluator($$EVAL.SELECT({FieldName:this.GetConfigOptions().fieldNamePrefix+"Day",IsRequired:this.GetConfigOptions().requireDate}))}if(this.GetConfigOptions().includeYear){if(this.GetConfigOptions().htmlCssVersion==1){this._ddlYear=new $$FDDL("ddlYear",{inputWidth:60,spanWidth:0})}else{this._ddlYear=new $$FDDL2(null,{classNames:"dtcDDLYear"})}this._ddlYear.AddClassName("wAuto");this.AddChild(this._ddlYear);this._ddlYear.Validator.addEvaluator($$EVAL.SELECT({FieldName:this.GetConfigOptions().fieldNamePrefix+"Year",IsRequired:this.GetConfigOptions().requireDate}))}if(this.GetConfigOptions().includeHour){if(this.GetConfigOptions().htmlCssVersion==1){this._ddlHour=new $$FDDL("ddlHour",{inputWidth:65,spanWidth:0})}else{this._ddlHour=new $$FDDL(null,{classNames:"dtcDDLHour"})}this._ddlHour.AddClassName("wAuto");this.AddChild(this._ddlHour);var b=$$DATE.getHourArray();this._ddlHour.bindList(b,"","Hour");this._ddlHour.Validator.addEvaluator($$EVAL.SELECT({FieldName:this.GetConfigOptions().fieldNamePrefix+"Hour",IsRequired:this.GetConfigOptions().requireTime}))}if(this.GetConfigOptions().includeMinute){if(this.GetConfigOptions().htmlCssVersion==1){this._ddlMinute=new $$FDDL("ddlMinute",{inputWidth:50,spanWidth:0})}else{this._ddlMinute=new $$FDDL(null,{classNames:"dtcDDLMinute"})}this._ddlMinute.AddClassName("wAuto");this.AddChild(this._ddlMinute);var c=$$DATE.getMinuteArray(true);this._ddlMinute.bindList(c,"","Min");this._ddlMinute.Validator.addEvaluator($$EVAL.SELECT({FieldName:this.GetConfigOptions().fieldNamePrefix+"Minute",IsRequired:this.GetConfigOptions().requireTime}))}},wireEvents:function($super){$super();if(this.GetConfigOptions().includeDay&&this.GetConfigOptions().includeMonth&&this.GetConfigOptions().includeYear){this._ddlMonth.ChangeEvent.subscribe(this.onMonthChanged,this);this._ddlYear.ChangeEvent.subscribe(this.onYearChanged,this)}},onMonthChanged:function(f,a){var b=this._ddlDay.GetData();var e=Number(this._ddlMonth.GetData());var g=Number(this._ddlYear.GetData());var d=g%4==0;var c=$$DATE.getDayArray();if(e==4||e==6||e==9||e==11){c=$$DATE.getDayArray(30)}else{if(e==2){if(d){c=$$DATE.getDayArray(29)}else{c=$$DATE.getDayArray(28)}}}this._ddlDay.bindList(c,"","Day");this._ddlDay.Bind(b)},onYearChanged:function(b,a){this.onMonthChanged()},Bind:function(b,e,j){this.Validator.Clear();var d=new Date().getFullYear();var h=d+1;if(!$$CM.isNull(e)){d=e}if(!$$CM.isNull(j)){h=j}var n=$A();for(var g=d;g<=h;g++){n.push({ID:g,Name:g})}this._ddlYear.bindList(n,"","Year");if($$CM.isNull(b)){if(this.GetConfigOptions().includeMonth){this._ddlMonth.setSelectedIndex(0)}if(this.GetConfigOptions().includeDay){this._ddlDay.setSelectedIndex(0)}if(this.GetConfigOptions().includeYear){this._ddlYear.setSelectedIndex(0)}if(this.GetConfigOptions().includeHour){this._ddlHour.setSelectedIndex(0)}if(this.GetConfigOptions().includeMinute){this._ddlMinute.setSelectedIndex(0)}}else{var a=new $$CMDATE(b).getUTCData();var l=Number(a.MM);var c=Number(a.DD);var m=Number(a.YYYY);var f=Number(a.hh);var k=Number(a.mm);if(this.GetConfigOptions().includeMonth){this._ddlMonth.setSelectedValue(l)}if(this.GetConfigOptions().includeDay){this._ddlDay.setSelectedValue(c)}if(this.GetConfigOptions().includeYear){this._ddlYear.setSelectedValue(m)}if(this.GetConfigOptions().includeHour){this._ddlHour.setSelectedValue(f)}if(this.GetConfigOptions().includeMinute){this._ddlMinute.setSelectedValue(k)}}if(this.GetConfigOptions().includeDay&&this.GetConfigOptions().includeMonth&&this.GetConfigOptions().includeYear){this.onMonthChanged()}},GetData:function(){var a=new $$CMDATE();var k=new Date();var h=1;var e=1;var l=k.getFullYear();var f=0;var g=0;if(this.GetConfigOptions().includeMonth&&this._ddlMonth.getSelectedValue()!=""){h=parseInt(this._ddlMonth.getSelectedValue(),10)}if(this.GetConfigOptions().includeDay&&this._ddlDay.getSelectedValue()!=""){e=parseInt(this._ddlDay.getSelectedValue(),10)}if(this.GetConfigOptions().includeYear&&this._ddlYear.getSelectedValue()!=""){l=parseInt(this._ddlYear.getSelectedValue(),10)}var d=l+"-"+$$CM.padZero(h)+"-"+$$CM.padZero(e)+"T00:00:00";var b=new $$CMDATE(d);if(this.GetConfigOptions().includeHour&&this._ddlHour.getSelectedValue()!=""){f=parseInt(this._ddlHour.getSelectedValue(),10)}if(this.GetConfigOptions().includeMinute&&this._ddlMinute.getSelectedValue()!=""){g=parseInt(this._ddlMinute.getSelectedValue(),10)}var c=l+"-"+$$CM.padZero(h)+"-"+$$CM.padZero(e)+"T"+$$CM.padZero(f)+":"+$$CM.padZero(g)+":00";var j=(b.getDateObject().getTimezoneOffset()/60);if(j==0){c+="Z"}else{var i=Math.abs(j);if(i<10){i="0"+i}if(j>0){c+="-"+i+":00"}else{if(j<0){c+="+"+i+":00"}}}var a=new $$CMDATE(c);return a.getData()},SetTabIndex:function(b){var a=$$CM.isNull(b)?1:b;if(this.GetConfigOptions().includeMonth){this._ddlMonth.SetTabIndex(a++)}if(this.GetConfigOptions().includeDay){this._ddlDay.SetTabIndex(a++)}if(this.GetConfigOptions().includeYear){this._ddlYear.SetTabIndex(a++)}if(this.GetConfigOptions().includeHour){this._ddlHour.SetTabIndex(a++)}if(this.GetConfigOptions().includeMinute){this._ddlMinute.SetTabIndex(a++)}return a}});cm.ui.common.DateTimeControl2ConfigOptions=Class.create(cm.ui.common.DateTimeControlConfigOptions,{htmlCssVersion:2});cm.ui.common.DateTimeControl2=Class.create(cm.ui.common.DateTimeControl,{configureDefaultOptions:function(){return new cm.ui.common.DateTimeControl2ConfigOptions()}});"cm.ui.common".namespace();cm.ui.common.DaysOfWeekConfigOptions=Class.create(cm.ConfigOptions,{cssWrapper:"",cssLabel:"",cssCheckBoxList:"",cssCheckBox:"",settings:new Object()});$$DOW=cm.ui.common.DaysOfWeek=Class.create(cm.ui.ComplexControl,{SelectionChangedEvent:null,configureDefaultOptions:function(){return new cm.ui.common.DaysOfWeekConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if($$CM.isNull(this._co)){this._co=new Object()}this._uniqueID=$$CM.uniqueID();this._settings=new Object();if(!$$CM.isNull(this._co.settings)){this._settings=this._co.settings}this.SUNDAY_DOWL="Sun";this.SUNDAY_DOWF=1;this.MONDAY_DOWL="Mon";this.MONDAY_DOWF=2;this.TUESDAY_DOWL="Tue";this.TUESDAY_DOWF=4;this.WEDNESDAY_DOWL="Wed";this.WEDNESDAY_DOWF=8;this.THURSDAY_DOWL="Thu";this.THURSDAY_DOWF=16;this.FRIDAY_DOWL="Fri";this.FRIDAY_DOWF=32;this.SATURDAY_DOWL="Sat";this.SATURDAY_DOWF=64;this._daysOption=0;this._daysEnabled={}},initializeUIElements:function(){this.AddClassName("cmDaysOfWeekWrapper");if(!$$CM.isEmpty(this._co.cssWrapper)){this.AddClassName(this._co.cssWrapper)}this._divLabel=$$P.div("divLabel_"+this._uniqueID);this.AddChild(this._divLabel);this._divLabel.AddClassName("cmDaysOfWeekLabel");if(!$$CM.isEmpty(this._co.cssLabel)){this._divLabel.AddClassName(this._co.cssLabel)}this._divCheckBoxes=$$P.div("divCheckBoxes_"+this._uniqueID);this.AddChild(this._divCheckBoxes);this._divCheckBoxes.AddClassName("cmDaysOfWeekCheckBoxes");if(!$$CM.isEmpty(this._co.cssCheckBoxList)){this._divCheckBoxes.AddClassName(this._co.cssCheckBoxList)}this._cbSun=new $$FCB("cbSun_"+this._uniqueID,{label:this.SUNDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.SUNDAY_DOWF});this._divCheckBoxes.AddChild(this._cbSun);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbSun.AddClassName(this._co.cssCheckBox)}this._divSun=$$P.div("divSun_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divSun);this._divSun.AddClassName("cmFloatLeft");this._cbMon=new $$FCB("cbMon_"+this._uniqueID,{label:this.MONDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.MONDAY_DOWF});this._divCheckBoxes.AddChild(this._cbMon);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbMon.AddClassName(this._co.cssCheckBox)}this._divMon=$$P.div("divMon_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divMon);this._divMon.AddClassName("cmFloatLeft");this._cbTue=new $$FCB("cbTue_"+this._uniqueID,{label:this.TUESDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.TUESDAY_DOWF});this._divCheckBoxes.AddChild(this._cbTue);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbTue.AddClassName(this._co.cssCheckBox)}this._divTue=$$P.div("divTue_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divTue);this._divTue.AddClassName("cmFloatLeft");this._cbWed=new $$FCB("cbWed_"+this._uniqueID,{label:this.WEDNESDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.WEDNESDAY_DOWF});this._divCheckBoxes.AddChild(this._cbWed);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbWed.AddClassName(this._co.cssCheckBox)}this._divWed=$$P.div("divWed_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divWed);this._divWed.AddClassName("cmFloatLeft");this._cbThu=new $$FCB("cbThu_"+this._uniqueID,{label:this.THURSDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.THURSDAY_DOWF});this._divCheckBoxes.AddChild(this._cbThu);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbThu.AddClassName(this._co.cssCheckBox)}this._divThu=$$P.div("divThu_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divThu);this._divThu.AddClassName("cmFloatLeft");this._cbFri=new $$FCB("cbFri_"+this._uniqueID,{label:this.FRIDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.FRIDAY_DOWF});this._divCheckBoxes.AddChild(this._cbFri);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbFri.AddClassName(this._co.cssCheckBox)}this._divFri=$$P.div("divFri_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divFri);this._divFri.AddClassName("cmFloatLeft");this._cbSat=new $$FCB("cbSat_"+this._uniqueID,{label:this.SATURDAY_DOWL,labelClass:"cmDaysOfWeekDay cmFloatLeft",dowf:this.SATURDAY_DOWF});this._divCheckBoxes.AddChild(this._cbSat);if(!$$CM.isEmpty(this._co.cssCheckBox)){this._cbSat.AddClassName(this._co.cssCheckBox)}this._divSat=$$P.div("divSat_"+this._uniqueID);this._divCheckBoxes.AddChild(this._divSat);this._divSat.AddClassName("cmFloatLeft")},createEvents:function($super){$super();this.SelectionChangedEvent=new cm.event()},wireEvents:function($super){$super();this._cbSun.ChangeEvent.subscribe(this.onSelectionChanged,this);this._cbMon.ChangeEvent.subscribe(this.onSelectionChanged,this);this._cbTue.ChangeEvent.subscribe(this.onSelectionChanged,this);this._cbWed.ChangeEvent.subscribe(this.onSelectionChanged,this);this._cbThu.ChangeEvent.subscribe(this.onSelectionChanged,this);this._cbFri.ChangeEvent.subscribe(this.onSelectionChanged,this);this._cbSat.ChangeEvent.subscribe(this.onSelectionChanged,this)},onSelectionChanged:function(f,a){this.Validator.Clear();this._divCheckBoxes.RemoveClassName("cmCustomValidationError");var d="";var c=false;if($$CM.isInteger(this._dayOfWeekFlagIDInDB)&&!$$CM.isNull(f)){d=f.GetConfigOptions().label;var b=Number(f.GetConfigOptions().dowf);if(b>0){c=((this._dayOfWeekFlagIDInDB&b)==b)}}if(c==true){f.Bind(c);var e="This camper has already applied for this day.";if(!$$CM.isNull(this._settings)&&!$$CM.isNull(this._settings)){e=$$SETTINGSDU.GetFormattedCallUsMessage(e+"  If you would like to make changes",this._settings.GeneralSettings)}e=$$CM.convertToEntityLabelString(e,$$SETTINGSDU.GetEntityLabelSettings());$$CMD.AlertCancel({title:"Error",header:"",message:e})}this.SelectionChangedEvent.fire(this,{cb:f,data:this.GetData()})},BindSettings:function(a){this.resetDays();if(!$$CM.isNull(a)){this._fieldName=a.fieldName;this._daysOption=a.daysOption;this._daysCount=a.daysCount;this._showDaysFlag=a.showDaysFlag;this._enabledDaysFlag=a.enabledDaysFlag;this._fullSessionOptionFlag=a.fullSessionOptionFlag;this._atOrOverCapacityDaysFlag=a.atOrOverCapacityDaysFlag;this._atOrOverCapacityDaysHideOnAppEnabled=a.atOrOverCapacityDaysHideOnAppEnabled;if($$CM.isInteger(this._fullSessionOptionFlag)&&this._fullSessionOptionFlag>0){if(this._fullSessionOptionFlag==1){this._enabledDaysFlag=this._enabledDaysFlag-this._atOrOverCapacityDaysFlag;if(this._atOrOverCapacityDaysHideOnAppEnabled==true){this._showDaysFlag=this._showDaysFlag-this._atOrOverCapacityDaysFlag}}}this.ToggleSettings(true)}},ToggleEnabledState:function(a){if(!a){this._cbSun.SetEnabled(a);this._cbMon.SetEnabled(a);this._cbTue.SetEnabled(a);this._cbWed.SetEnabled(a);this._cbThu.SetEnabled(a);this._cbFri.SetEnabled(a);this._cbSat.SetEnabled(a)}else{if(!$$CM.isNull(this._daysEnabled)){this._cbSun.SetEnabled(!$$CM.isNull(this._daysEnabled[1])?this._daysEnabled[1]:false);this._cbMon.SetEnabled(!$$CM.isNull(this._daysEnabled[2])?this._daysEnabled[2]:false);this._cbTue.SetEnabled(!$$CM.isNull(this._daysEnabled[4])?this._daysEnabled[4]:false);this._cbWed.SetEnabled(!$$CM.isNull(this._daysEnabled[8])?this._daysEnabled[8]:false);this._cbThu.SetEnabled(!$$CM.isNull(this._daysEnabled[16])?this._daysEnabled[16]:false);this._cbFri.SetEnabled(!$$CM.isNull(this._daysEnabled[32])?this._daysEnabled[32]:false);this._cbSat.SetEnabled(!$$CM.isNull(this._daysEnabled[64])?this._daysEnabled[64]:false)}}},ToggleSettings:function(b){var d="";var e=(this._daysCount==1)?"":"s";this._isAllDays=false;if(this._daysOption==1){d="Select any "+this._daysCount+" day"+e}else{if(this._daysOption==2){d="Select min "+this._daysCount+" day"+e}else{this._isAllDays=true}}this._daysEnabled={};this._daysEnabled[1]=false;this._daysEnabled[2]=false;this._daysEnabled[4]=false;this._daysEnabled[8]=false;this._daysEnabled[16]=false;this._daysEnabled[32]=false;this._daysEnabled[64]=false;if(this._isAllDays!=true){this._divLabel.UpdateInnerHtml(d);if(((this._showDaysFlag&1)==1)){this._cbSun.Show();var c=((this._enabledDaysFlag&1)==1)&&this._daysOption>0;this._daysEnabled[1]=c;this._cbSun.SetEnabled(c)}if(((this._showDaysFlag&2)==2)){this._cbMon.Show();var c=((this._enabledDaysFlag&2)==2)&&this._daysOption>0;this._daysEnabled[2]=c;this._cbMon.SetEnabled(c)}if(((this._showDaysFlag&4)==4)){this._cbTue.Show();var c=((this._enabledDaysFlag&4)==4)&&this._daysOption>0;this._daysEnabled[4]=c;this._cbTue.SetEnabled(c)}if(((this._showDaysFlag&8)==8)){this._cbWed.Show();var c=((this._enabledDaysFlag&8)==8)&&this._daysOption>0;this._daysEnabled[8]=c;this._cbWed.SetEnabled(c)}if(((this._showDaysFlag&16)==16)){this._cbThu.Show();var c=((this._enabledDaysFlag&16)==16)&&this._daysOption>0;this._daysEnabled[16]=c;this._cbThu.SetEnabled(c)}if(((this._showDaysFlag&32)==32)){this._cbFri.Show();var c=((this._enabledDaysFlag&32)==32)&&this._daysOption>0;this._daysEnabled[32]=c;this._cbFri.SetEnabled(c)}if(((this._showDaysFlag&64)==64)){this._cbSat.Show();var c=((this._enabledDaysFlag&64)==64)&&this._daysOption>0;this._daysEnabled[64]=c;this._cbSat.SetEnabled(c)}}else{if(((this._showDaysFlag&1)==1)){this._cbSun.Show()}if(((this._showDaysFlag&2)==2)){this._cbMon.Show()}if(((this._showDaysFlag&4)==4)){this._cbTue.Show()}if(((this._showDaysFlag&8)==8)){this._cbWed.Show()}if(((this._showDaysFlag&16)==16)){this._cbThu.Show()}if(((this._showDaysFlag&32)==32)){this._cbFri.Show()}if(((this._showDaysFlag&64)==64)){this._cbSat.Show()}this.Bind()}if($$CM.isInteger(this._atOrOverCapacityDaysFlag)&&this._atOrOverCapacityDaysFlag>0){var a="cmAtOrOverCapacitySM";this.SetAtOrOverCapacityClass(this._atOrOverCapacityDaysFlag,a)}if(b!=true){this.SetEnabled(true);this._daysEnabled[1]=true;this._daysEnabled[2]=true;this._daysEnabled[4]=true;this._daysEnabled[8]=true;this._daysEnabled[16]=true;this._daysEnabled[32]=true;this._daysEnabled[64]=true}},resetDays:function(){this._divLabel.UpdateInnerHtml("");this._cbSun.Hide();this._cbMon.Hide();this._cbTue.Hide();this._cbWed.Hide();this._cbThu.Hide();this._cbFri.Hide();this._cbSat.Hide();this._cbSun.Bind(false);this._cbMon.Bind(false);this._cbTue.Bind(false);this._cbWed.Bind(false);this._cbThu.Bind(false);this._cbFri.Bind(false);this._cbSat.Bind(false);this._cbSun.SetEnabled(false);this._cbMon.SetEnabled(false);this._cbTue.SetEnabled(false);this._cbWed.SetEnabled(false);this._cbThu.SetEnabled(false);this._cbFri.SetEnabled(false);this._cbSat.SetEnabled(false);this.ClearPostLabels()},Validate:function(e){var f=new cm.validation.ValidationResult(this._fieldName,null);if($$CM.isNumber(this._daysOption)&&$$CM.isNumber(this._enabledDaysFlag)){var a=this.GetData();var c=this.GetNumberOfDays(a);var d=(this._daysCount==1)?"":"s";switch(this._daysOption){case 1:if(c!=this._daysCount){var b="You must select any "+this._daysCount+" day"+d;f.AddError(b);this._divCheckBoxes.AddClassName("cmCustomValidationError")}break;case 2:if(c<this._daysCount){var b="You must select minimum "+this._daysCount+" day"+d;f.AddError(b);this._divCheckBoxes.AddClassName("cmCustomValidationError")}break}}if(e==true){this.Validator.ShowErrors(f)}return f},AddErrorClass:function(){this._divCheckBoxes.AddClassName("cmCustomValidationError")},RemoveErrorClass:function(){this._divCheckBoxes.RemoveClassName("cmCustomValidationError")},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},SetAtOrOverCapacityClass:function(b,a){if($$CM.isNumber(b)&&Number(b)>0&&!$$CM.isEmpty(a)){if(((b&1)==1)){this._cbSun.GetTitleInnerControl().RemoveClassName(a);this._cbSun.GetTitleInnerControl().AddClassName(a)}if(((b&2)==2)){this._cbMon.GetTitleInnerControl().RemoveClassName(a);this._cbMon.GetTitleInnerControl().AddClassName(a)}if(((b&4)==4)){this._cbTue.GetTitleInnerControl().RemoveClassName(a);this._cbTue.GetTitleInnerControl().AddClassName(a)}if(((b&8)==8)){this._cbWed.GetTitleInnerControl().RemoveClassName(a);this._cbWed.GetTitleInnerControl().AddClassName(a)}if(((b&16)==16)){this._cbThu.GetTitleInnerControl().RemoveClassName(a);this._cbThu.GetTitleInnerControl().AddClassName(a)}if(((b&32)==32)){this._cbFri.GetTitleInnerControl().RemoveClassName(a);this._cbFri.GetTitleInnerControl().AddClassName(a)}if(((b&64)==64)){this._cbSat.GetTitleInnerControl().RemoveClassName(a);this._cbSat.GetTitleInnerControl().AddClassName(a)}}},SetDayOfWeekFlagIDInDB:function(a){this._dayOfWeekFlagIDInDB=a},SetPostLabel:function(b,c,a){if($$CM.isNumber(b)&&Number(b)>0){if(((b&1)==1)){this._divSun.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divSun.AddClassName(a)}this._divSun.UpdateInnerHtml(c)}if(((b&2)==2)){this._divMon.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divMon.AddClassName(a)}this._divMon.UpdateInnerHtml(c)}if(((b&4)==4)){this._divTue.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divTue.AddClassName(a)}this._divTue.UpdateInnerHtml(c)}if(((b&8)==8)){this._divWed.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divWed.AddClassName(a)}this._divWed.UpdateInnerHtml(c)}if(((b&16)==16)){this._divThu.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divThu.AddClassName(a)}this._divThu.UpdateInnerHtml(c)}if(((b&32)==32)){this._divFri.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divFri.AddClassName(a)}this._divFri.UpdateInnerHtml(c)}if(((b&64)==64)){this._divSat.RemoveClassNames();if(!$$CM.isEmpty(a)){this._divSat.AddClassName(a)}this._divSat.UpdateInnerHtml(c)}}},ClearPostLabels:function(){this._divSun.UpdateInnerHtml("");this._divMon.UpdateInnerHtml("");this._divTue.UpdateInnerHtml("");this._divWed.UpdateInnerHtml("");this._divThu.UpdateInnerHtml("");this._divFri.UpdateInnerHtml("");this._divSat.UpdateInnerHtml("")},ClearFields:function(){this.Validator.Clear();this._divCheckBoxes.RemoveClassName("cmCustomValidationError");this._cbSun.Bind(false);this._cbMon.Bind(false);this._cbTue.Bind(false);this._cbWed.Bind(false);this._cbThu.Bind(false);this._cbFri.Bind(false);this._cbSat.Bind(false)},onDataUpdated:function(){this.ClearFields();var b=0;if(this._isAllDays==true){b=Number(this._enabledDaysFlag)}else{var a=this.GetBoundData();if(!$$CM.isNull(a)){if($$CM.isNumber(a)){b=Number(a)}}}if(b>0){if(((b&1)==1)&&((this._enabledDaysFlag&1)==1)){this._cbSun.Bind(true)}if(((b&2)==2)&&((this._enabledDaysFlag&2)==2)){this._cbMon.Bind(true)}if(((b&4)==4)&&((this._enabledDaysFlag&4)==4)){this._cbTue.Bind(true)}if(((b&8)==8)&&((this._enabledDaysFlag&8)==8)){this._cbWed.Bind(true)}if(((b&16)==16)&&((this._enabledDaysFlag&16)==16)){this._cbThu.Bind(true)}if(((b&32)==32)&&((this._enabledDaysFlag&32)==32)){this._cbFri.Bind(true)}if(((b&64)==64)&&((this._enabledDaysFlag&64)==64)){this._cbSat.Bind(true)}}},GetDaysOption:function(){return this._daysOption},GetNumberOfDays:function(a){var b=0;if($$CM.isNumber(a)){if(((a&1)==1)){b++}if(((a&2)==2)){b++}if(((a&4)==4)){b++}if(((a&8)==8)){b++}if(((a&16)==16)){b++}if(((a&32)==32)){b++}if(((a&64)==64)){b++}}return b},GetData:function(){var a=0;if(this._cbSun.GetData()){a+=1}if(this._cbMon.GetData()){a+=2}if(this._cbTue.GetData()){a+=4}if(this._cbWed.GetData()){a+=8}if(this._cbThu.GetData()){a+=16}if(this._cbFri.GetData()){a+=32}if(this._cbSat.GetData()){a+=64}return a}});"cm.ui.common".namespace();cm.ui.common.DefinitionModalControlConfigOptions=Class.create(cm.ConfigOptions,{async:true,hideCloseButton:false});cm.ui.common.DefinitionModalControl=Class.create(cm.ui.Control,{async:true,_oddClass:"cmOdd",_evenClass:"cmEven",_saveAdd:false,_worker:null,_modelQueue:null,_loadTotal:null,_progress:0,_widthRightButtonColumn:125,configureDefaultOptions:function(){return new cm.ui.common.DefinitionModalControlConfigOptions()},initializeUIElements:function(){this._divEditDefinitions=$$P.div("divEditDefinitions");this.AddChild(this._divEditDefinitions);this._divEditDefinitions.SetAttribute("style","overflow: visible;");this._modalDivBody=$$P.div("modalDefinitionBd");this._divEditDefinitions.AddChild(this._modalDivBody);this._modalDivBody.AddClassName("bd");this._divHeaderMessage=$$P.div("divHeaderMessage");this._modalDivBody.AddChild(this._divHeaderMessage);var a=$$P.div();this._modalDivBody.AddChild(a);a.AddClassName("cmClear");this._divLabelHeader=$$P.div("divLabelHeader");this._modalDivBody.AddChild(this._divLabelHeader);this._divLabelHeader.AddClassName("divLabelHeader");this._divLabelHeader.SetHeight(34);this._divLabelHeader.Hide();this._txtLabel=new $$FTXT("txtLabel");this._divLabelHeader.AddChild(this._txtLabel);this._btnLabelModify=new $$BTN("btnLabelModify",{text:"Save Label"});this._divLabelHeader.AddChild(this._btnLabelModify);this._btnLabelModify.AddClassName("cmFloatLeft cmGoButton sm");this._btnLabelModify.AssignStyle("margin-top","4px");this._btnLabelModify.AssignStyle("margin-left","8px");this._divFilterHeaderOuterWrapper=$$P.div("divFilterHeaderOuterWrapper");this._modalDivBody.AddChild(this._divFilterHeaderOuterWrapper);this._divFilterHeaderOuterWrapper.SetHeight(34);this._divFilterHeaderOuterWrapper.Hide();this._divFilterHeaderInnerWrapper=$$P.div("divFilterHeaderInnerWrapper");this._divFilterHeaderOuterWrapper.AddChild(this._divFilterHeaderInnerWrapper);this._divFilterHeaderInnerWrapper.SetHeight(34);this._divFilterHeaderInnerWrapper.Hide();this._divFilterHeader=$$P.div("divFilterHeader");this._divFilterHeaderInnerWrapper.AddChild(this._divFilterHeader);this._divFilterHeader.AddClassName("divFilterHeader");this._divFilterHeader.SetHeight(34);this._divFilterHeader.Hide();this._ddlFilter=new $$FDDL("ddlFilter",{label:"Select by",spanWidth:68});this._divFilterHeader.AddChild(this._ddlFilter);this._btnEditByFilter=new $$BTN("btnEditByFilter");this._divFilterHeader.AddChild(this._btnEditByFilter);this._btnEditByFilter.AddClassName("cmFloatRight");this._divFilterSpacer=$$P.div();this._modalDivBody.AddChild(this._divFilterSpacer);this._divFilterSpacer.AddClassName("divFilterSpacer");this._divFilterSpacer.Hide();this._divArrangeHeaderOuterWrapper=$$P.div("divArrangeHeaderOuterWrapper");this._modalDivBody.AddChild(this._divArrangeHeaderOuterWrapper);this._divArrangeHeaderOuterWrapper.SetHeight(34);this._divArrangeHeaderOuterWrapper.Hide();this._divArrangeHeaderInnerWrapper=$$P.div("divArrangeHeaderInnerWrapper");this._divArrangeHeaderOuterWrapper.AddChild(this._divArrangeHeaderInnerWrapper);this._divArrangeHeaderInnerWrapper.SetHeight(34);this._divArrangeHeaderInnerWrapper.Hide();this._divArrangeHeader=$$P.div("divArrangeHeader");this._divArrangeHeaderInnerWrapper.AddChild(this._divArrangeHeader);this._divArrangeHeader.AddClassName("divArrangeHeader");this._divArrangeHeader.SetHeight(34);this._divArrangeHeader.Hide();this._spanArrangeLabel=$$P.div("spanArrangeLabel","Drag and Drop to Rearrange");this._divArrangeHeader.AddChild(this._spanArrangeLabel);this._spanArrangeLabel.AddClassName("fieldTip");this._spanArrangeLabel.Hide();this._btnArrangeShow=new $$BTN("btnArrangeShow",{text:"Arrange"});this._divArrangeHeader.AddChild(this._btnArrangeShow);this._btnArrangeShow.AddClassName("cmFloatRight");var a=$$P.div();this._modalDivBody.AddChild(a);a.AddClassName("cmClear");this._divScroll=$$P.div();this._modalDivBody.AddChild(this._divScroll);this._divScroll.AddClassName("table scrollable");this._divScrollHd=$$P.div();this._divScroll.AddChild(this._divScrollHd);this._divScrollHd.AddClassName("divDefinitionHeader");this._divScrollBd=$$P.div("divScrollBd");this._divScroll.AddChild(this._divScrollBd);this._divScrollBd.AddClassName("cmScrollY h300px cmClear");this._divScrollBd.Hide();this._divWait=$$P.div();this._divScroll.AddChild(this._divWait);this._divWait.AddClassName("divWait cmFloatLeft progressBar");this._pWait=$$P.p();this._divWait.AddChild(this._pWait);this._cmLogoDiv=new $$IMG("cmWaitingLogo");this._pWait.AddChild(this._cmLogoDiv);this._messageSpan=$$P.div("messageSpan","Loading results...");this._pWait.AddChild(this._messageSpan);this._messageSpan.AddClassName("ml5px mb5px");this._progressBar=new cm.ui.utilityControls.ProgressBar();this._pWait.AddChild(this._progressBar);this._divWait.AddClassName("progressBarWidthActivation");this._progressBar.Hide();this._modalDivFooter=$$P.div("modalDefinitionFt");this._divEditDefinitions.AddChild(this._modalDivFooter);this._modalDivFooter.AddClassName("ft");this._divNotesWrapper=$$P.div("modelDefinitionFtNotesWrapper");this._modalDivFooter.AddChild(this._divNotesWrapper);this._divNotesWrapper.AddClassName("pb10px");this._divNotesWrapper.AssignStyle("font-weight","bold");this._divNote=$$P.div("modelDefinitionFtNote");this._divNotesWrapper.AddChild(this._divNote);var a=$$P.div();this._divNotesWrapper.AddChild(a);a.AddClassName("cmClear");this._footerStandard=$$P.div("footerStandard");this._modalDivFooter.AddChild(this._footerStandard);this._btnClose=new $$BTN("btnClose",{text:"Close"});this._footerStandard.AddChild(this._btnClose);this._btnClose.AddClassName("cmCancelDeleteButton");if(this.GetConfigOptions().hideCloseButton==true){this._btnClose.Hide()}this._rightBtnPanel=$$P.div("divRightButtonPanel");this._footerStandard.AddChild(this._rightBtnPanel);this._rightBtnPanel.AddClassName("cmFloatRight");this._btnDefine=new $$BTN("btnDefine",{text:"Define New"});this._rightBtnPanel.AddChild(this._btnDefine);this._btnDefine.AddClassName("cmGoButton cmFloatRight");this._btnHideInactive=new $$BTN("btnHideInactive",{text:"Hide Inactive"});this._rightBtnPanel.AddChild(this._btnHideInactive);this._btnHideInactive.AddClassName("cmFloatRight");this._footerArrange=$$P.div("footerArrange");this._modalDivFooter.AddChild(this._footerArrange);this._footerArrange.Hide();this._btnSortCancel=new $$BTN("btnSortCancel",{text:"Cancel Changes"});this._footerArrange.AddChild(this._btnSortCancel);this._btnSortCancel.AddClassName("cmCancelDeleteButton");this._btnSortSave=new $$BTN("btnSortSave",{text:"Save Changes"});this._footerArrange.AddChild(this._btnSortSave);this._btnSortSave.AddClassName("cmGoButton cmFloatRight");this._footerFilter=$$P.div("footerFilter");this._modalDivFooter.AddChild(this._footerFilter);this._footerFilter.Hide();this._btnFilterCancel=new $$BTN("btnFilterCancel",{text:"Cancel Changes"});this._footerFilter.AddChild(this._btnFilterCancel);this._btnFilterCancel.AddClassName("cmCancelDeleteButton");this._btnFilterSave=new $$BTN("btnFilterSave",{text:"Save Changes"});this._footerFilter.AddChild(this._btnFilterSave);this._btnFilterSave.AddClassName("cmGoButton cmFloatRight")},createEvents:function($super){$super();this.DefinitionClosedEvent=new cm.event()},wireEvents:function($super){$super();this._btnClose.ClickEvent.subscribe(this.btnModalClose_click,this);this._btnHideInactive.ClickEvent.subscribe(this.btnHideInactive_click,this);this._btnDefine.ClickEvent.subscribe(this.btnDefine_click,this);this._btnArrangeShow.ClickEvent.subscribe(this.btnArrangeDefinitions_click,this);this._ddlFilter.ChangeEvent.subscribe(this.ddlFilter_change,this);this._btnEditByFilter.ClickEvent.subscribe(this.btnEditByFilter_click,this);this._btnSortCancel.ClickEvent.subscribe(this.btnCancelSortDefinitions_click,this);this._btnSortSave.ClickEvent.subscribe(this.btnSaveSortDefinitions_click,this);this._btnFilterCancel.ClickEvent.subscribe(this.btnCancelFilterEdit_click,this);this._btnFilterSave.ClickEvent.subscribe(this.btnSaveFilterEdit_click,this);this._btnLabelModify.ClickEvent.subscribe(this.btnLabelModify_click,this)},postInitialize:function(){var a=this.GetConfigOptions();this._panelParent=a.panelParent;this._definitionModal=a.definitionModal;var b="";var c="";if(!$$CM.isEmpty(cm.hosts.common)){c=cm.hosts.common}b=c+"/common/lib/images/leafSpinning.gif";this._cmLogoDiv.SetAttribute("src",b)},Bind:function(c){this._panelObject=c;if($$CM.isNull(this._panelObject)){throw"panelObject is required"}if(!$$CM.isNull(this._panelObject.DefinitionEntityID)){this._definitionEntityID=this._panelObject.DefinitionEntityID}else{this._definitionEntityID=0}if($$CM.isFunction(this._panelObject.DataSource)){this._dataSource=this._panelObject.DataSource()}else{if(!$$CM.isNull(this._panelObject.DataSource)){this._dataSource=this._panelObject.DataSource}else{throw"dataSource is required"}}if(!$$CM.isNull(this._panelObject.PanelColumns)){this._columnArray=$A(this._panelObject.PanelColumns)}else{throw"columnArray is required"}if(!$$CM.isNull(this._panelObject.Title)){this._title=this._panelObject.Title}else{this._title="Definition"}if(!$$CM.isNull(this._panelObject.EntityName)){this._entityName=this._panelObject.EntityName}else{this._entityName=this._title}if(!$$CM.isNull(this._panelObject.AllowDelete)){this._allowDelete=this._panelObject.AllowDelete}else{this._allowDelete=true}if(!$$CM.isNull(this._panelObject.AllowArchive)){this._allowArchive=this._panelObject.AllowArchive}else{this._allowArchive=false}if(!$$CM.isNull(this._panelObject.AllowModify)){this._allowModify=this._panelObject.AllowModify}else{this._allowModify=true}if(!$$CM.isNull(this._panelObject.AllowNew)){this._allowNew=this._panelObject.AllowNew}else{this._allowNew=true}if(!$$CM.isNull(this._panelObject.AllowArrange)){this._allowArrange=this._panelObject.AllowArrange}else{this._allowArrange=true}if(!$$CM.isNull(this._panelObject.ModifyFunctionCallback)){this._modifyFunctionCallback=this._panelObject.ModifyFunctionCallback}else{this._modifyFunctionCallback=null}if(!$$CM.isNull(this._panelObject.DeleteFunctionCallback)){this._deleteFunctionCallback=this._panelObject.DeleteFunctionCallback}else{this._deleteFunctionCallback=null}if(!$$CM.isNull(this._panelObject.ArchiveFunctionCallback)){this._archiveFunctionCallback=this._panelObject.ArchiveFunctionCallback}else{this._archiveFunctionCallback=null}if(!$$CM.isNull(this._panelObject.InUseFunctionCallback)){this._inUseFunctionCallback=this._panelObject.InUseFunctionCallback}else{this._inUseFunctionCallback=null}if(!$$CM.isNull(this._panelObject.ValidateModifyFunctionCallback)){this._validateModifyFunctionCallback=this._panelObject.ValidateModifyFunctionCallback}else{this._validateModifyFunctionCallback=null}if(!$$CM.isNull(this._panelObject.ValidateArchiveFunctionCallback)){this._validateArchiveFunctionCallback=this._panelObject.ValidateArchiveFunctionCallback}else{this._validateArchiveFunctionCallback=null}if(!$$CM.isNull(this._panelObject.ValidateDeleteFunctionCallback)){this._validateDeleteFunctionCallback=this._panelObject.ValidateDeleteFunctionCallback}else{this._validateDeleteFunctionCallback=null}if(!$$CM.isNull(this._panelObject.SortFunctionCallback)){this._sortFunctionCallback=this._panelObject.SortFunctionCallback}else{this._sortFunctionCallback=null}if(!$$CM.isNull(this._panelObject.InUseAllowModify)){this._inUseAllowModify=this._panelObject.InUseAllowModify}else{this._inUseAllowModify=false}if(!$$CM.isNull(this._panelObject.InUseAllowDelete)){this._inUseAllowDelete=this._panelObject.InUseAllowDelete}else{this._inUseAllowDelete=false}if(!$$CM.isNull(this._panelObject.InUseAllowArchive)){this._inUseAllowArchive=this._panelObject.InUseAllowArchive}else{this._inUseAllowArchive=false}if(!$$CM.isNull(this._panelObject.HasLabelEdit)){this._hasLabelEdit=this._panelObject.HasLabelEdit}else{this._hasLabelEdit=false}if(!$$CM.isNull(this._panelObject.MinAddRowHeight)){this._minAddRowHeight=this._panelObject.MinAddRowHeight}else{this._minAddRowHeight=40}if(!$$CM.isEmpty(this._panelObject.HeaderMessage)){this._headerMessage=this._panelObject.HeaderMessage}else{this._headerMessage=""}if(!$$CM.isEmpty(this._panelObject.HeaderMessageCssClass)){this._headerMessageCssClass=this._panelObject.HeaderMessageCssClass}else{this._headerMessageCssClass="cmInfo"}this._divHeaderMessage.AddClassName(this._headerMessageCssClass);if(!$$CM.isEmpty(this._headerMessage)){this._divHeaderMessage.UpdateInnerHtml(this._headerMessage);this._divHeaderMessage.Show()}else{this._divHeaderMessage.UpdateInnerHtml("");this._divHeaderMessage.Hide()}if(!$$CM.isNull(this._panelObject.Note)){this._note=this._panelObject.Note}else{this._note=""}if(!$$CM.isEmpty(this._note)){this._divNotesWrapper.Show()}else{this._divNotesWrapper.Hide()}this._divNote.UpdateInnerHtml(this._note);this._enableFilterColumnExists=false;if(!$$CM.isNull(this._panelObject.EnableFilter)&&!$$CM.isNull(this._panelObject.FilterPropertyName)&&!$$CM.isNull(this._panelObject.FilterSource)){this._enableFilter=this._panelObject.EnableFilter;this._filterPropertyName=this._panelObject.FilterPropertyName;this._filterPropertyBy=this._panelObject.FilterPropertyBy;this._filterPropertyMappingProperty=this._panelObject.FilterPropertyMappingProperty;this._filterSource=this._panelObject.FilterSource;this._columnArray.each(function(f){if(!$$CM.isNull(f.PropertyArray)){f.PropertyArray.each(function(g){var h=this.isValidVersionBranch(g);if(h){if(g.PropertyName==this._filterPropertyName){this._enableFilterColumnExists=true}}},this)}},this);this._editByFilter=false;if(!$$CM.isNull(this._panelObject.EditByFilter)&&this._panelObject.EditByFilter==true&&this._enableFilterColumnExists){this._editByFilter=true;this._editByFilterLabel="Edit by Filter";if(!$$CM.isNull(this._panelObject.EditByFilterLabel)){this._editByFilterLabel=this._panelObject.EditByFilterLabel}}}else{this._enableFilter=false;this._filterPropertyName="";this._filterSource=null;this._editByFilter=false}if(!$$CM.isNull(this._panelObject)&&!$$CM.isNull(this._panelObject.SortByProperty)){this._sortByProperty=this._panelObject.SortByProperty}else{this._sortByProperty=null}var a=false;this._columnArray.each(function(f){if(!$$CM.isNull(f.PropertyArray)){f.PropertyArray.each(function(g){var h=this.isValidVersionBranch(g);if(h){if(g.PropertyName=="Active"||g.PropertyName=="IsActive"){a=true}}},this)}},this);if(!$$CM.isNull(this._entityName)){this.setDefinitionNames()}this._hideInactiveFeature=a;this._hideInactiveDefinitions=false;this._editingByFilter=false;this._divScrollHd.DestroyChildControls();this._divScrollBd.DestroyChildControls();if(this._allowNew){this._btnDefine.Show()}else{this._btnDefine.Hide()}this._spanArrangeLabel.Hide();if(this._hasLabelEdit==true){if(!$$CM.isNull(this._panelObject.LabelModifyCallback)){this._labelModifyCallback=this._panelObject.LabelModifyCallback;var b=this._entityNameSingular+" Label";if(!$$CM.isNull(this._panelObject.LabelText)){b=this._panelObject.LabelText}this._txtLabel.SetLabel(b);if($$CM.isArray(this._panelObject.LabelValue)&&this._panelObject.LabelValue.length>0){this._txtLabel.Bind(this._panelObject.LabelValue[0])}if(!$$CM.isNull(this._panelObject.LabelClass)){this._txtLabel.AddClassName(this._panelObject.LabelClass)}this._divLabelHeader.Show()}}else{this._divLabelHeader.Hide()}if(this._enableFilter==true){if(this._enableFilterColumnExists){this._columnArray.each(function(f){if(!$$CM.isNull(f.PropertyArray)){f.PropertyArray.each(function(g){var h=this.isValidVersionBranch(g);if(h){if(g.PropertyName==this._filterByProperty){this._filterSource=this.sortDataSource(this._filterSource,g.DataSourceOrderProperty)}}},this)}},this);this._ddlFilter.bindList(this._filterSource,"",{ID:0,Name:"All"},false)}else{this._ddlFilter.bindList(this._filterSource,"",null,false)}}var d=this._widthRightButtonColumn+17+20;this._columnArray.each(function(f){d+=f.ColumnWidth});this._panelWidth=d;var e="Definition";if(!$$CM.isNull(this._panelObject.Title)){e=this._panelObject.Title}this._divScroll.SetWidth(this._panelWidth);this._divScrollHd.SetWidth(this._panelWidth-20);if(!$$CM.isNull(this._definitionModal)){this._definitionModal.SetTitle(e);this._definitionModal.SetWidth(this._panelWidth+20)}this.setHeaderRow();this.bindContent()},getFilteredSource:function(b){var a=$A();this._dataSource.each(function(e){var c=true;var d=Number(this._ddlFilter.GetData());if(!$$CM.isNull(b)){d=Number(b)}if(this._enableFilter==true&&this._editingByFilter==false&&d!=0){if(d!=Number(e[this._filterPropertyName])){c=false}}if(c){a.push(e)}},this);return a},sortDataSource:function(a,b){if($$CM.isEmpty(b)){b=this._sortByProperty}if(!$$CM.isNull(b)&&b!=""){a.sort(function(c,d){if(!($$CM.isNull(c[b])||$$CM.isNull(d[b]))){var e="";var g="";if($$CM.isNumber(c[b])&&$$CM.isNumber(d[b])){e=parseInt(c[b],10);g=parseInt(d[b],10)}else{e=c[b].toLowerCase();g=d[b].toLowerCase()}if(e<g){return -1}else{if(e>g){return 1}else{var f="";var h="";if(!$$CM.isEmpty(e.Name)){f=e.Name}if(!$$CM.isEmpty(g.Name)){h=g.Name}if(f<h){return -1*direction}else{if(f>h){return 1*direction}else{return 0}}}}}return 0},this)}return a},sortDataSourceFilter:function(a){var b=this._sortByProperty;var c=this._filterPropertyName;var d=this._filterPropertyBy;var f=this._filterPropertyMappingProperty;var e=this._filterSource;if(!$$CM.isNull(b)&&b!=""){a.sort(function(g,h){if(!($$CM.isNull(g[b])||$$CM.isNull(h[b])||$$CM.isNull(g[c])||$$CM.isNull(h[c]))){var i=e.find(function(m){return m[f]==g[c]},this);var j=e.find(function(m){return m[f]==h[c]},this);i=i[d];j=j[d];var k="";var l="";if($$CM.isNumber(i)&&$$CM.isNumber(j)){k=parseInt(i,10);l=parseInt(j,10)}else{k=i.toLowerCase();l=j.toLowerCase()}if(k<l){return -1}else{if(k>l){return 1}}var k="";var l="";if($$CM.isNumber(g[b])&&$$CM.isNumber(h[b])){k=parseInt(g[b],10);l=parseInt(h[b],10)}else{k=g[b].toLowerCase();l=h[b].toLowerCase()}return((k<l)?-1:((k>l)?1:0))}return 0},this)}return a},bindContent:function(){if(this._enableFilter==true){this._divFilterHeader.Show();this._divFilterHeaderInnerWrapper.Show();this._divFilterHeaderOuterWrapper.Show();this._divFilterSpacer.Show();this._divScroll.Show();if(this._filterSource.length==0){this._divScroll.Hide();this._divArrangeHeader.Hide();this._divArrangeHeaderInnerWrapper.Hide();this._divArrangeHeaderOuterWrapper.Hide();this._btnDefine.Hide();this._btnEditByFilter.Hide()}else{this._divScroll.Show();if(this._allowNew){this._btnDefine.Show()}this._ddlFilter.Show();if(this._editByFilter){if(this._editingByFilter){this._btnEditByFilter.Hide();this._ddlFilter.Hide()}else{this._btnEditByFilter.Show();this._btnEditByFilter.UpdateInnerHtml(this._editByFilterLabel)}}else{this._btnEditByFilter.Hide()}if(this._allowArrange==true){this._divArrangeHeader.Show();this._divArrangeHeaderInnerWrapper.Show();this._divArrangeHeaderOuterWrapper.Show();var b=this._ddlFilter.GetData();if($$CM.isNumber(b)){if(Number(b)==0){this._btnArrangeShow.Hide()}else{this._btnArrangeShow.Show()}}else{this._btnArrangeShow.Show()}}else{this._divArrangeHeader.Hide();this._divArrangeHeaderInnerWrapper.Hide();this._divArrangeHeaderOuterWrapper.Hide()}}}else{this._divFilterHeader.Hide();this._divFilterHeaderInnerWrapper.Hide();this._divFilterHeaderOuterWrapper.Hide();this._divFilterSpacer.Hide();this._divScroll.Show();if(this._allowNew){this._btnDefine.Show()}this._btnEditByFilter.Hide();if(this._allowArrange==true){this._divArrangeHeader.Show();this._divArrangeHeaderInnerWrapper.Show();this._divArrangeHeaderOuterWrapper.Show();this._btnArrangeShow.Show()}else{this._divArrangeHeader.Hide();this._divArrangeHeaderInnerWrapper.Hide();this._divArrangeHeaderOuterWrapper.Hide()}}if(this._hideInactiveFeature==true){this._btnHideInactive.Show();this._btnHideInactive.UpdateInnerHtml("Hide Inactive");this._hideInactiveDefinitions=false}if(this._hideInactiveFeature==false||this._dataSource.length<1){this._btnHideInactive.Hide()}else{this._btnHideInactive.Show();this._hideInactiveDefinitions=false}this._footerStandard.Show();this._footerArrange.Hide();this._footerFilter.Hide();var a=this.getFilteredSource();if(this._editingByFilter==false){a=this.sortDataSource(a)}else{a=this.sortDataSourceFilter(a)}var b=this._ddlFilter.GetData();if($$CM.isNumber(b)){if(Number(b)==0){a=this.sortDataSourceFilter(a)}}if($$CM.isArray(a)&&a.length==0){this._btnArrangeShow.Hide();this._btnEditByFilter.Hide()}this._divScrollBd.DestroyChildControls();if(!$$CM.isNull(this._ulBodyContent)&&!$$CM.isNull(this._ulBodyContent.Destroy)){this._ulBodyContent.Destroy(false)}this._ulBodyContent=new cm.ui.utilityControls.Sortable("ulBodyContent",{oddClass:this._oddClass,evenClass:this._evenClass});this._ulBodyContent.AddClassName("cmFloatLeft mtb0px");this._divScrollBd.AddChild(this._ulBodyContent);this._divAddNew=new cm.ui.common.DefinitionModalRowControl("divContainer_"+0,{parentControl:this,contentID:0,columnArray:this._columnArray,isNewRow:true,allowDelete:this._allowDelete,allowArchive:this._allowArchive,allowModify:this._allowModify,definitionEntityID:this._definitionEntityID,widthRightButtonColumn:this._widthRightButtonColumn});this._ulBodyContent.AddChild(this._divAddNew);this._divAddNew.EditClicked.subscribe(this.btnEdit_click,this);this._divAddNew.DeleteClicked.subscribe(this.btnDelete_click,this);this._divAddNew.ArchiveClicked.subscribe(this.btnArchive_click,this);this._divAddNew.SaveClicked.subscribe(this.btnSave_click,this);this._divAddNew.SaveAddClicked.subscribe(this.btnSaveAdd_click,this);this._divAddNew.CancelClicked.subscribe(this.btnCancel_click,this);this._divAddNew.AddClassName(this._oddClass);this._divAddNew.AddClassName("divDefinitionUserRow");this._divAddNew.Bind(null);this._divAddNew.Hide();this._divAddNew.AssignStyle("min-height",this._minAddRowHeight+"px");this._rowControlArray=$A();this.setLoadingFields("Rendering results...",false);this._progressBar.Show();this._rowsToRender=a;this.createRows()},renderRowsComplete:function(){this._divWait.Hide();this._divFilterHeaderInnerWrapper.Show();this._divArrangeHeaderInnerWrapper.Show();this._rightBtnPanel.Show();this._divScrollBd.Show();this.showActiveRows();if(this._saveAdd==true){this._saveAdd=false;this.btnDefine_click()}if(this._editingByFilter){this._btnArrangeShow.Hide();this._footerStandard.Hide();this._footerArrange.Hide();this._footerFilter.Show();this._ulBodyContent.ChildControls().each(function(a){a.ShowEditMode(true,true)},this)}},createRow:function(b){var a=new cm.ui.common.DefinitionModalRowControl("divContainer_"+b.ID,{parentControl:this,contentID:b.ID,columnArray:this._columnArray,isNewRow:false,allowDelete:this._allowDelete,allowArchive:this._allowArchive,allowModify:this._allowModify,definitionEntityID:this._definitionEntityID,widthRightButtonColumn:this._widthRightButtonColumn});this._ulBodyContent.AddChild(a);a.EditClicked.subscribe(this.btnEdit_click,this);a.DeleteClicked.subscribe(this.btnDelete_click,this);a.ArchiveClicked.subscribe(this.btnArchive_click,this);a.SaveClicked.subscribe(this.btnSave_click,this);a.SaveAddClicked.subscribe(this.btnSaveAdd_click,this);a.CancelClicked.subscribe(this.btnCancel_click,this);a.Bind(b);a.AddClassName("divDefinitionUserRow cmFloatLeft");return a},createRows:function(){if(this.GetConfigOptions().async==true){this._modelQueue=this._rowsToRender;this._loadTotal=this._modelQueue.length;this._worker.Start(this.createAsync)}else{this._rowsToRender.each(function(a){var b=this.createRow(a);this._rowControlArray.push(b)},this);this.renderRowsComplete()}},createAsync:function(){this._worker.SetProgress(Math.ceil((this._rowControlArray.length/this._loadTotal)*100));if(this._modelQueue.length>0){var a=this._modelQueue[0];var b=this.createRow(a);this._rowControlArray.push(b);this._modelQueue.remove(a)}else{this._worker.Stop()}},setLoadingFields:function(b,a){this._worker=this.initializeWorker();this._divFilterHeaderInnerWrapper.Hide();this._divArrangeHeaderInnerWrapper.Hide();this._rightBtnPanel.Hide();this._divScrollBd.Hide();this._progressBar.Hide();if(!$$CM.isNull(a)&&a==false){this._cmLogoDiv.Hide()}else{this._cmLogoDiv.Show()}this._progress=0;this._progressBar.Bind(0);this._messageSpan.UpdateInnerHtml(b);this._divWait.Show()},initializeWorker:function(){var a=$$CM.uniqueNumber();var b=new cm.Thread(a+"_loader",this,1);b.ProgressUpdated.subscribe(this.onProgressUpdated,this);b.ThreadStarted.subscribe(this.onThreadStart,this);b.ThreadFinished.subscribe(this.onThreadFinish,this);return b},onProgressUpdated:function(c,a){var b=a;this._progress=Math.max(this._progress,b);this._progressBar.Bind(this._progress)},onThreadStart:function(b,a){},onThreadFinish:function(b,a){this.renderRowsComplete()},setRowClass:function(){var a=false;this._ulBodyContent.ChildControls().each(function(b){var c=b.GetBoundData();if($$CM.isNull(c)||((this._hideInactiveDefinitions&&c.Active)||!this._hideInactiveDefinitions)){b.RemoveClassName(this._oddClass);b.RemoveClassName(this._evenClass);if(a){b.AddClassName(this._oddClass)}else{b.AddClassName(this._evenClass)}a=!a}},this)},setHeaderRow:function(){this._divScrollHd.DestroyChildControls();var a=$$P.div();this._divScrollHd.AddChild(a);this._columnArray.each(function(e){var g=$$P.span();a.AddChild(g);g.SetWidth(e.ColumnWidth);g.AddClassName("cmFloatLeft");var f=e.ColumnName;var h=$$CLIENT.VersionBranch;if($$CM.isNumber(e.ColumnNameVersionBranchAnd)){if((h&e.ColumnNameVersionBranchAnd)==e.ColumnNameVersionBranchAnd){if(!$$CM.isEmpty(e.ColumnNameVersionBranchAndLabel)){f=e.ColumnNameVersionBranchAndLabel}}}else{if($$CM.isNumber(e.ColumnNameVersionBranchOr)){if((h&e.ColumnNameVersionBranchOr)>0){if(!$$CM.isEmpty(e.ColumnNameVersionBranchOrLabel)){f=e.ColumnNameVersionBranchOrLabel}}}}g.UpdateInnerHtml(f)},this);var d=this._widthRightButtonColumn;var b=$$P.span();a.AddChild(b);b.SetWidth(d);b.AddClassName("cmFloatLeft");b.UpdateInnerHtml("&nbsp;");var c=$$P.span();a.AddChild(c);c.UpdateInnerHtml("&nbsp;")},btnModalClose_click:function(){this.hide()},hide:function(){if(!$$CM.isNull(this._definitionModal)){this._definitionModal.Hide()}else{this.Hide()}this.hideNewDefinitionArea();this.DefinitionClosedEvent.fire(this)},setDefinitionNames:function(){this._entityNameSingular=this._entityName;if(this._entityName.substr(this._entityName.length,1)=="s"){this._entityNamePlural=this._entityName+"es"}else{this._entityNamePlural=this._entityName+"s"}},ddlFilter_change:function(){this.bindContent()},btnLabelModify_click:function(d,a){if($$CM.isNull(this._labelModifyCallback)){var b={title:"Alert",header:"Error: 'label modify' Function Callback not defined"};$$CMD.Alert(b)}else{var c=this._txtLabel.GetData();this._labelModifyCallback.call(this.GetConfigOptions().panelContainer,c,this,this.labelModifyCallback_callback)}},labelModifyCallback_callback:function(d,b){var c=d;if($$CM.isNull(b)){var a={title:"Alert",header:"Error: Label Modify Failed"};$$CMD.Alert(a)}else{c._txtLabel.Bind(b);cm.ui.utilityControls.growlBanner.ShowBanner("Label Saved",1000)}},resetSortOrders:function(){var b={};var a=$A();$A($$E(this._ulBodyContent).children).each(function(g){if(g.uniqueID>0){var f=this._ulBodyContent.ChildControls().find(function(h){return Number(h.GetData().ID)==Number(g.uniqueID)},this);a.push(f.GetData())}},this);if(this._allowArrange==true){if(this._enableFilter==false){b["1"]=a}else{a.each(function(h){var g=h[this._filterPropertyName];var f=$A();if(!$$CM.isNull(b[g])){f=b[g]}f.push(h);b[g]=f},this)}for(var c in b){if(b.hasOwnProperty(c)){var d=b[c];var e=0;d.each(function(f){f[this._sortByProperty]=e;e++},this)}}}return a},btnSaveFilterEdit_click:function(j,a){var h=$A();var i=$A();var e=true;var d=false;if($$CM.isNull(this._modifyFunctionCallback)){var c={title:"Alert",header:"Error: 'modify' Function Callback not defined"};$$CMD.Alert(c)}else{var g=this.resetSortOrders();g.each(function(l){var o=this._ulBodyContent.ChildControls().find(function(p){return Number(p.GetData().ID)==Number(l.ID)},this);if(!$$CM.isNull(o)&&!o.GetConfigOptions().isNewRow){if(o.Validator.validate(true).IsValid()){if(e&&this.validateUniqueness(l)){var n=o.GetBoundData();var m=false;if(!$$CM.isNull(n)){m=this.dataChangedCheck(n,l)}if(m){i.push(l)}h.push(l)}else{e=false}}}},this);if(e){if(i.length>0&&!$$CM.isNull(this._inUseFunctionCallback)){var f=false;var k=$A();g.each(function(l){var m=this.getUniqueChanges(l);if(m.length>0){m.each(function(n){var o=k.find(function(p){return p==n},this);if($$CM.isNull(o)){k.push(n)}},this);f=true}},this);if(!f){this.inUse(i,h,this.onModify)}else{var a={};a.itemListChanged=i;a.itemList=h;var b="The following unique field(s) has been changed:<br />";k.each(function(l){b+=(" - "+l+"<br />")},this);b+="<br />Changing a unique value will affect all previous usage of that value throughout the entire system and will affect all previous seasons and future reports.<br /><br />Do you still wish to continue?";var c={title:"Confirm",header:"Changing Unique Values",message:b,width:400,handlerOk:this.btnSave_click_uniqueCheckContinue,handlerCancel:null,scope:this,args:a,cssClass:"cmAlertDialog"};$$CMD.Confirm(c)}}else{this.onModify(this,h,false,$A())}}}},btnSaveSortDefinitions_click:function(d,a){var c=this.resetSortOrders();if($$CM.isNull(this._sortFunctionCallback)){var b={title:"Alert",header:"Error: 'sort' Function Callback not defined"};$$CMD.Alert(b)}else{this._sortFunctionCallback.call(this.GetConfigOptions().panelContainer,c,this,this.setDefinitionSortOrder_callback,true)}},setDefinitionSortOrder_callback:function(d,b){var c=d;if($$CM.isNull(b)){var a={title:"Alert",header:"Error: Sort Failed"};$$CMD.Alert(a)}else{if($$CM.isArray(b)){c._dataSource=b}c._btnHideInactive.UpdateInnerHtml("Hide Inactive");c.showDragHandles(false)}},inUse:function(e,d,f,c,b){if($$CM.isNull(c)){c=false}if($$CM.isNull(b)){b=false}if($$CM.isNull(this._inUseFunctionCallback)){var a={title:"Alert",header:"Error: 'inUse' Function Callback not defined"};$$CMD.Alert(a)}else{this._inUseFunctionCallback.call(this.GetConfigOptions().panelContainer,e,d,this,this.inUse_callback,f,c,b)}},inUse_callback:function(e,b,a,f,c){var d=e;f(d,b,a,c)},btnArchive_click:function(d,a){if(!$$CM.isNull(this._validateArchiveFunctionCallback)){var c=a;var b=c.GetData();this._validateArchiveFunctionCallback.call(this.GetConfigOptions().panelContainer,b,this,this.postValidateArchive,c)}else{this.postValidateArchive(d,a)}},postValidateArchive:function(f,a){var e=a;var c=e.GetBoundData();if($$CM.isNull(this._archiveFunctionCallback)){var b={title:"Alert",header:"Error: 'archive' Function Callback not defined"};$$CMD.Alert(b)}else{var d=$A();d.push(c);if(!$$CM.isNull(this._inUseFunctionCallback)){this.inUse(d,d,this.onArchive,true)}else{this.onArchive(this,d,false,$A())}}},onArchive:function(j,g,f,h){if(!$$CM.isNull(f)){var d=j._entityNameSingular.toLowerCase();var k="";for(var e=0;e<h.length;e++){item=h[e];if(h.length>1&&e!=(h.length-1)){if(e<(h.length-2)){k+=(item.Name+", ")}else{k+=(item.Name+" and ")}}else{k+=item.Name}}if($$CM.isEmpty(k)){k=j._entityNameSingular}var n="is";var m="this <b>"+d+"</b>";var l="";if(h.length>1){n="are";m="them";l="At least one of the following: "}if(f){if(j._inUseAllowArchive){var b=l+"<b>"+k+"</b> "+n+" in use with associations made to "+m+".  By archiving "+m+" you may be severing all associations tied to "+m+".  This cannot be undone.<p>Are you sure you want to continue?</p>";var c={title:"Confirm",header:"Archive "+j._entityNameSingular,message:b,width:400,handlerOk:j.onArchive_confirm,handlerCancel:j.onArchive_cancel,scope:j,args:g,cssClass:"cmAlertDialog"};$$CMD.Confirm(c)}else{var a=l+"<b>"+k+"</b> "+n+" in use with associations made to "+m+".  Archives to "+m+" are not allowed.";var c={title:"Alert",header:"Archive "+j._entityNameSingular,message:a,width:400};$$CMD.Alert(c)}}else{var b="Are you sure you wish to archive "+d+": <b>"+k+"</b>?";var c={title:"Confirm",header:"Archive "+j._entityNameSingular,message:b,width:400,handlerOk:j.onArchive_confirm,handlerCancel:j.onArchive_cancel,scope:j,args:g,cssClass:"cmAlertDialog"};$$CMD.Confirm(c)}}},onArchive_cancel:function(b,a){},onArchive_confirm:function(b,a){b._archiveFunctionCallback.call(b.GetConfigOptions().panelContainer,a,b,b.onArchive_callback)},onArchive_callback:function(g,e){var f=g;if($$CM.isNull(e)){}else{if($$CM.isArray(e)){f._dataSource=e}var a=f.getFilteredSource();if(f._allowArrange==true&&$$CM.isArray(a)&&a.length>0){a=f.sortDataSource(a);for(var c=0;c<a.length;c++){var d=a[c];d[f._sortByProperty]=c}if($$CM.isNull(f._sortFunctionCallback)){var b={title:"Alert",header:"Error: 'sort' Function Callback not defined"};$$CMD.Alert(b)}else{f._sortFunctionCallback.call(f.GetConfigOptions().panelContainer,a,f,f.onArchiveSetOrder_callback,true)}}else{f.bindContent()}}},onArchiveSetOrder_callback:function(d,b){var c=d;if($$CM.isNull(b)){var a={title:"Alert",header:"Error: Sort Failed"};$$CMD.Alert(a)}else{if($$CM.isArray(b)){c._dataSource=b}c.bindContent()}},btnDelete_click:function(f,a){var e=a;var c=e.GetBoundData();if($$CM.isNull(this._deleteFunctionCallback)){var b={title:"Alert",header:"Error: 'delete' Function Callback not defined"};$$CMD.Alert(b)}else{var d=$A();d.push(c);if(!$$CM.isNull(this._inUseFunctionCallback)){this.inUse(d,d,this.onDelete,true)}else{this.onDelete(this,d,false,$A())}}},onDelete:function(j,g,f,h){if(!$$CM.isNull(f)){var d=j._entityNameSingular.toLowerCase();var k="";for(var e=0;e<h.length;e++){item=h[e];if(h.length>1&&e!=(h.length-1)){if(e<(h.length-2)){k+=(item.Name+", ")}else{k+=(item.Name+" and ")}}else{k+=item.Name}}if($$CM.isEmpty(k)){k=j._entityNameSingular}var n="is";var m="this <b>"+d+"</b>";var l="";if(h.length>1){n="are";m="them";l="At least one of the following: "}if(f){if(j._inUseAllowDelete){var b=l+"<b>"+k+"</b> "+n+" in use with associations made to "+m+".  By deleting "+m+" you may be severing all associations tied to "+m+".  This cannot be undone.<p>Are you sure you want to continue?</p>";var c={title:"Confirm",header:"Delete "+j._entityNameSingular,message:b,width:400,handlerOk:j.onDelete_confirm,handlerCancel:j.onDelete_cancel,scope:j,args:g,cssClass:"cmAlertDialog"};$$CMD.Confirm(c)}else{var a=l+"<b>"+k+"</b> "+n+" in use with associations made to "+m+".  Deletes to "+m+" are not allowed.";var c={title:"Alert",header:"Delete "+j._entityNameSingular,message:a,width:400};$$CMD.Alert(c)}}else{var b="Are you sure you wish to delete "+d+": <b>"+k+"</b>?";var c={title:"Confirm",header:"Delete "+j._entityNameSingular,message:b,width:400,handlerOk:j.onDelete_confirm,handlerCancel:j.onDelete_cancel,scope:j,args:g,cssClass:"cmAlertDialog"};$$CMD.Confirm(c)}}},onDelete_cancel:function(b,a){},onDelete_confirm:function(b,a){b._deleteFunctionCallback.call(b.GetConfigOptions().panelContainer,a,b,b.onDelete_callback)},onDelete_callback:function(g,e){var f=g;if($$CM.isNull(e)){}else{if($$CM.isArray(e)){f._dataSource=e}var a=f.getFilteredSource();if(f._allowArrange==true&&$$CM.isArray(a)&&a.length>0){a=f.sortDataSource(a);for(var c=0;c<a.length;c++){var d=a[c];d[f._sortByProperty]=c}if($$CM.isNull(f._sortFunctionCallback)){var b={title:"Alert",header:"Error: 'sort' Function Callback not defined"};$$CMD.Alert(b)}else{f._sortFunctionCallback.call(f.GetConfigOptions().panelContainer,a,f,f.onDeleteSetOrder_callback,true)}}else{f.bindContent()}}},onDeleteSetOrder_callback:function(d,b){var c=d;if($$CM.isNull(b)){var a={title:"Alert",header:"Error: Sort Failed"};$$CMD.Alert(a)}else{if($$CM.isArray(b)){c._dataSource=b}c.bindContent()}},btnSaveAdd_click:function(b,a){this._saveAdd=true;this.btnSave_click(b,a)},btnSave_click:function(d,a){if(!$$CM.isNull(this._validateModifyFunctionCallback)){var c=a;var b=c.GetData();this._validateModifyFunctionCallback.call(this.GetConfigOptions().panelContainer,b,this,this.postValidateSave,c)}else{this.postValidateSave(d,a)}},postValidateSave:function(m,b){var l=b;if($$CM.isNull(this._modifyFunctionCallback)){var i={title:"Alert",header:"Error: 'modify' Function Callback not defined"};$$CMD.Alert(i)}else{if(l.Validator.validate(true).IsValid()){var f=l.GetData();if(this.validateUniqueness(f)){if(this._enableFilter==true&&!this._enableFilterColumnExists){f[this._filterPropertyName]=this._ddlFilter.GetData()}if(this._allowArrange==true){if(f.ID==0){var c=this.getFilteredSource(f[this._filterPropertyName]);f[this._sortByProperty]=c.length}}var j=l.GetBoundData();var g=false;if(!$$CM.isNull(j)){g=this.dataChangedCheck(j,f)}var k=$A();k.push(f);var a={};a.itemListChanged=k;a.itemList=k;var d="";var e="";if(g){var h=this.getDefaultChanges(f);var n=this.getUniqueChanges(f);if(h.length==0&&n.length==0){this.inUse(k,k,this.onModify);return}else{var d="";var e="";if(h.length>0){d="Changing Default Values";if(h.length==1){e+="The following default field has been changed:<br />"}else{e+="The following default field(s) have been changed:<br />"}h.each(function(o){e+=(" - "+o+"<br />")},this);e+="<br />Changing a default value will affect all previous usage of that value throughout the system. It  will also affect all previous seasons and future reports."}if(n.length>0){if(!$$CM.isEmpty(d)){d=""}else{d="Changing Unique Values"}if(!$$CM.isEmpty(e)){e+="<br /><br />"}if(h.length==1){e+="The following unique field has been changed:<br />"}else{e+="The following unique field(s) has been changed:<br />"}n.each(function(o){e+=(" - "+o+"<br />")},this);e+="<br />Changing a unique value will affect all previous usage of that value throughout the entire system and will affect all previous seasons and future reports."}}}else{if(f.ID==0){a.isNew=true;var h=this.getDefaultChanges(f,true);if(h.length>0){d="Setting Default Values";if(h.length==1){e+="The following field has been set to default:<br />"}else{e+="The following fields have been set to default:<br />"}h.each(function(o){e+=(" - "+o+"<br />")},this);e+="<br />Setting a default value will affect all previous usage of that value throughout the system. It  will also affect all previous seasons and future reports."}}}if(!$$CM.isNull(this._inUseFunctionCallback)&&!$$CM.isEmpty(e)){e+="<br /><br />Do you still wish to continue?";var i={title:"Confirm",header:d,message:e,width:400,handlerOk:this.btnSave_click_uniqueCheckContinue,handlerCancel:null,scope:this,args:a,cssClass:"cmAlertDialog"};$$CMD.Confirm(i)}else{this.onModify(this,k,false,$A())}}}}},btnSave_click_uniqueCheckContinue:function(d,a){var c=a.itemListChanged;var b=a.itemList;if(a.isNew==true){this.onModify(this,b,false,$A())}else{this.inUse(c,b,this.onModify)}},getDefaultChanges:function(a,c){var b=$A();var d=this._ulBodyContent.ChildControls();d.each(function(e){var f=e.GetBoundData();if(!$$CM.isNull(f)&&Number(a.ID)==Number(f.ID)){this._columnArray.each(function(g){if(!$$CM.isNull(g.PropertyArray)){g.PropertyArray.each(function(k){var l=this.isValidVersionBranch(k);if(l){if(!$$CM.isNull(k.Default)&&k.Default==true){var i=a[k.PropertyName];var j=f[k.PropertyName];if(i!=j){var h=k.PropertyName;if(!$$CM.isEmpty(k.Label)){h=k.Label.replace(":","")}b.push(h)}}}},this)}},this)}else{if($$CM.isNull(f)&&c==true){this._columnArray.each(function(g){if(!$$CM.isNull(g.PropertyArray)){g.PropertyArray.each(function(j){var k=this.isValidVersionBranch(j);if(k){if(!$$CM.isNull(j.Default)&&j.Default==true){var i=a[j.PropertyName];if(i==true){var h=j.PropertyName;if(!$$CM.isEmpty(j.Label)){h=j.Label.replace(":","")}b.push(h)}}}},this)}},this)}}},this);return b},getUniqueChanges:function(a){var b=$A();var c=this._ulBodyContent.ChildControls();c.each(function(d){var e=d.GetBoundData();if(!$$CM.isNull(e)&&Number(a.ID)==Number(e.ID)){this._columnArray.each(function(f){if(!$$CM.isNull(f.PropertyArray)){f.PropertyArray.each(function(i){var j=this.isValidVersionBranch(i);if(j){if(!$$CM.isNull(i.Unique)&&i.Unique==true){var g=a[i.PropertyName];if($$CM.isEmpty(g)){g=""}var h=e[i.PropertyName];if($$CM.isEmpty(h)){h=""}if(g!=h){b.push(i.PropertyName)}}}},this)}},this)}},this);return b},validateUniqueness:function(b){var c=true;var d=this._ulBodyContent.ChildControls();var a="The";if(this._editingByFilter){a="A"}d.each(function(f){var g=f.GetData();var e=true;if(this._enableFilter){if(b[this._filterPropertyName]!=g[this._filterPropertyName]||$$CM.isEmpty(b[this._filterPropertyName])){e=false}}if(!$$CM.isNull(g)&&Number(b.ID)!=Number(g.ID)&&e){this._columnArray.each(function(h){if(!$$CM.isNull(h.PropertyArray)){h.PropertyArray.each(function(l){var n=this.isValidVersionBranch(l);if(n){if(!$$CM.isNull(l.Unique)&&l.Unique==true){var i=b[l.PropertyName];var m=g[l.PropertyName];if($$CM.isArray(i)){var k=[];i.each(function(o){if($$CM.isNull(k)||k.length==0){k=m.findAll(function(p){return p.toLowerCase()==o.toLowerCase()&&c&&o!=""})}});if(!$$CM.isNull(k)&&k.length>0){var j={title:"Alert",header:"Duplication Conflict",message:a+" value for "+l.UniqueFieldName+" is already used. Please enter a unique value."};$$CMD.Alert(j);c=false}}else{if(i.toLowerCase()==m.toLowerCase()&&c&&i!=""){var j={title:"Alert",header:"Duplication Conflict",message:a+" value for "+l.UniqueFieldName+" is already used. Please enter a unique value."};$$CMD.Alert(j);c=false}}}}},this)}},this)}},this);return c},onModify:function(j,g,f,h){if(!$$CM.isNull(f)){var d=j._entityNameSingular.toLowerCase();var k="";for(var e=0;e<h.length;e++){item=h[e];if(h.length>1&&e!=(h.length-1)){if(e<(h.length-2)){k+=(item.Name+", ")}else{k+=(item.Name+" and ")}}else{k+=item.Name}}if($$CM.isEmpty(k)){k=j._entityNameSingular}var n="is";var m="this <b>"+d+"</b>";var l="";if(h.length>1){n="are";m="them";l="At least one of the following: "}if(f){if(j._inUseAllowModify){var b=l+"<b>"+k+"</b> "+n+" in use with assignments made to "+m+".  By updating "+m+" you are affecting all assignments tied to "+m+".  This cannot be undone.<p>Are you sure you want to continue?</p>";var c={title:"Confirm",header:"Update "+j._entityNameSingular,message:b,width:400,handlerOk:j.onModify_confirm,handlerCancel:j.onModify_cancel,scope:j,args:g,cssClass:"cmAlertDialog"};$$CMD.Confirm(c)}else{var a=l+"<b>"+k+"</b> "+n+" in use with assignments made to "+m+".  Updates to the specific properties changed for "+m+" are not allowed.";var c={title:"Alert",header:"Update "+j._entityNameSingular,message:a,width:400};$$CMD.Alert(c)}}else{j.onModify_confirm(j,g)}}},onModify_cancel:function(a){},onModify_confirm:function(b,a){b._modifyFunctionCallback.call(this.GetConfigOptions().panelContainer,a,b,b.onModify_callback)},onModify_callback:function(c,a){var b=c;if($$CM.isNull(a)){}else{if($$CM.isArray(a)){b._dataSource=a}b._editingByFilter=false;b.bindContent();if(b._hasLabelEdit==true){if($$CM.isArray(b._panelObject.LabelValue)&&b._panelObject.LabelValue.length>0){b._txtLabel.Bind(b._panelObject.LabelValue[0])}}}},showNewDefinitionArea:function(a){this._divAddNew.Reset();if(a){this._divAddNew.Show(true,700)}else{this._divAddNew.Show()}},hideNewDefinitionArea:function(a){if(a){this._divAddNew.Hide(true,700)}else{this._divAddNew.Hide()}},btnArrangeDefinitions_click:function(b,a){this._hideInactiveDefinitions=false;this._btnHideInactive.UpdateInnerHtml("Hide Inactive");this._ddlFilter.SetEnabled(false);if(this._editByFilter){this._btnEditByFilter.Hide()}this.showActiveRows();this.showDragHandles(true)},btnCancelSortDefinitions_click:function(b,a){this._ddlFilter.SetEnabled(true);if(this._editByFilter){this._btnEditByFilter.Show()}this.showActiveRows();this.showDragHandles(false)},showDragHandles:function(d){var c=this;this._ulBodyContent.ChildControls().each(function(e){var f=e.GetConfigOptions();if(!f.isNewRow){e.ShowDragHandle(d);e.ShowEditButtons(!d)}},this);if(d){this._btnArrangeShow.Hide();this._spanArrangeLabel.Show();this._footerStandard.Hide();this._footerFilter.Hide();this._footerArrange.Show();this.setSortableList()}else{if(this._allowArrange==true){var b=this._ddlFilter.GetData();if($$CM.isNumber(b)){if(Number(b)==0){this._btnArrangeShow.Hide()}else{this._btnArrangeShow.Show()}}else{this._btnArrangeShow.Show()}}else{this._btnArrangeShow.Hide()}var a=this.getFilteredSource();if($$CM.isArray(a)&&a.length==0){this._btnArrangeShow.Hide();this._btnEditByFilter.Hide()}this._spanArrangeLabel.Hide();this._footerStandard.Show();this._footerFilter.Hide();this._footerArrange.Hide();this.cancelSortableList()}},setSortableList:function(){this._ulBodyContent.Activate()},cancelSortableList:function(){this._ddlFilter.Show();this._ddlFilter.SetEnabled(true);if(this._editByFilter){this._btnEditByFilter.Show()}if(this._allowNew){this._btnDefine.Show()}this._editingByFilter=false;this._ulBodyContent.Destroy();this.bindContent()},onSortableListItem_changed:function(){var b=0;var a=false;$A($$E(this._ulBodyContent).children).each(function(c){c.removeClassName(this._oddClass);c.removeClassName(this._evenClass);if(a){c.addClassName(this._oddClass)}else{c.addClassName(this._evenClass)}a=!a},this)},btnEditByFilter_click:function(b,a){this._editingByFilter=true;this._hideInactiveDefinitions=false;this._btnHideInactive.UpdateInnerHtml("Hide Inactive");this._ddlFilter.Hide();this._btnEditByFilter.Hide();this._btnDefine.Hide();this.bindContent()},btnCancelFilterEdit_click:function(b,a){this._editingByFilter=false;this._ddlFilter.Show();if(this._editByFilter){this._btnEditByFilter.Show()}this.bindContent()},btnDefine_click:function(){this._btnDefine.Hide();if(this._hideInactiveFeature==true){this._btnHideInactive.Hide()}this.showEditButtons(false);this.showNewDefinitionArea(true);jQuery("#divContainer_0").find("input[type=text],textarea,select").filter(":first").focus();this._ulBodyContent.ChildControls().each(function(a){if(a.GetConfigOptions().isNewRow){a.BindEditValue(this._filterPropertyName,this._ddlFilter.GetData())}},this)},btnEdit_click:function(d,a){var c=a;var b=a.GetData();c.ShowEditMode(true);this._btnDefine.Hide();if(this._hideInactiveFeature==true){this._btnHideInactive.Hide()}this.showEditButtons(false)},btnCancel_click:function(d,a){var c=a;var b=c.GetConfigOptions();if(b.isNewRow){this.hideNewDefinitionArea(true)}else{c.ShowEditMode(false);c.Bind(c.GetBoundData())}if(this._allowNew){this._btnDefine.Show()}if(this._hideInactiveFeature==true){this._btnHideInactive.Show()}this.showEditButtons(true)},showEditButtons:function(c){this._ulBodyContent.ChildControls().each(function(d){d.ShowEditButtons(c)},this);if(c){if(this._allowArrange==true){var b=this._ddlFilter.GetData();if($$CM.isNumber(b)){if(Number(b)==0){this._btnArrangeShow.Hide()}else{this._btnArrangeShow.Show()}}else{this._btnArrangeShow.Show()}}else{this._btnArrangeShow.Hide()}var a=this.getFilteredSource();if($$CM.isArray(a)&&a.length==0){this._btnArrangeShow.Hide();this._btnEditByFilter.Hide()}}else{this._btnArrangeShow.Hide()}},btnHideInactive_click:function(){if(this._hideInactiveDefinitions){this._hideInactiveDefinitions=false;this._btnHideInactive.UpdateInnerHtml("Hide Inactive")}else{this._hideInactiveDefinitions=true;this._btnHideInactive.UpdateInnerHtml("Show Inactive")}this.showActiveRows()},showActiveRows:function(){this._ulBodyContent.ChildControls().each(function(a){a.ShowActive(!this._hideInactiveDefinitions)},this);this.setRowClass()},isValidVersionBranch:function(a){var b=true;var c=$$CLIENT.VersionBranch;if($$CM.isNumber(a.VersionBranchAnd)){if((c&a.VersionBranchAnd)!=a.VersionBranchAnd){b=false}}else{if($$CM.isNumber(a.VersionBranchOr)){if((c&a.VersionBranchOr)==0){b=false}}else{if($$CM.isNumber(a.VersionBranchNegate)){if((c&a.VersionBranchNegate)==a.VersionBranchNegate){b=false}}}}return b},dataChangedCheck:function(c,b){var a=false;if(!$$CM.isNull(c)&&!$$CM.isNull(b)&&b.ID>0){if(c.ID!=b.ID){a=true}this._columnArray.each(function(d){if(!$$CM.isNull(d.PropertyArray)){d.PropertyArray.each(function(l){var m=this.isValidVersionBranch(l);if(m){if(!(this._enableFilter&&this._filterPropertyName==l.PropertyName)){var e=l.DataType.toLowerCase();switch(e){case"address":if(!$$CM.addressesMatch(c[l.PropertyName],c[l.PropertyName])){a=true}break;case"updated":case"timestamp":case"lbl":break;default:var j=c[l.PropertyName];var g=b[l.PropertyName];if($$CM.isArray(j)&&$$CM.isArray(g)){j=j.sort();g=g.sort();if(j.length!=g.length){a=true}else{for(var f=0;f<j.length;f++){var k=j[f];var h=g[f];if($$CM.isNumber(k)){k=Number(k);h=Number(h)}else{if(!$$CM.isBoolean(k)&&!$$CM.isBoolean(h)){k=!$$CM.isNull(k)?k.toLowerCase():k;h=!$$CM.isNull(h)?h.toLowerCase():h}}if(k!=h){a=true}}}}else{if(!$$CM.isArray(j)&&$$CM.isArray(g)&&g.length>0){a=true}else{if(!$$CM.isArray(j)&&!$$CM.isArray(g)){if($$CM.isNumber(j)){j=Number(j);g=Number(g)}else{if(!$$CM.isBoolean(j)&&!$$CM.isBoolean(g)){j=!$$CM.isNull(j)?j.toLowerCase():j;g=!$$CM.isNull(g)?g.toLowerCase():g}}if(j!=g){a=true}}else{a=true}}}break}}}},this)}},this)}return a}});"cm.ui.common".namespace();cm.ui.common.DefinitionModalFileUploadWrapperControlConfigOptions=Class.create(cm.ConfigOptions,{width:300,height:80,imageWidth:150,imageHeight:150,includeLabel:true,labelWidth:100,label:"Image:",includeRemoveButton:true,includeCrop:false,cropMinWidth:175,cropMinHeight:175,cropWidth:400,cropHeight:400});cm.ui.common.DefinitionModalFileUploadWrapperControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.DefinitionModalFileUploadWrapperControlConfigOptions()},initializeDAOs:function($super){$super();this._mediaDAO=new cm.dao.Media.DAO()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._fileName="";this._fileUrl=""},initializeUIElements:function(){var b=this.GetConfigOptions();var h=b.width;var g=this._cfo.imageHeight;g+=5;if(this._cfo.includeRemoveButton){g+=20}g=Math.max(this._cfo.height,g);this.SetWidth(h);this.SetHeight(g);this.AddClassName("mt10px");this._fileUploadWrapperControl=new cm.ui.common.FileUploadWrapperControl(this.ID()+"_Wrapper",{width:h});this.AddChild(this._fileUploadWrapperControl);this._fileUploadWrapperControl.Hide();this._imageWrapperControl=$$P.div();this.AddChild(this._imageWrapperControl);this._imageWrapperControl.AddClassName("cmFloatLeft");this._imageWrapperControl.SetWidth(h);this._imageWrapperControl.Hide();this._lblImage=$$P.div();this._imageWrapperControl.AddChild(this._lblImage);this._lblImage.AddClassName("cmFloatLeft cmBold");var c=$$P.div();this._imageWrapperControl.AddChild(c);c.AddClassName("cmFloatRight");this._img=new $$IMG();c.AddChild(this._img);this._img.AddClassName("cmFloatRight");var e=this._cfo.imageWidth;var d=this._cfo.imageHeight;this._img.SetWidth(e);this._img.SetHeight(d);var a=$$P.br();c.AddChild(a);this._btnRemove=new $$BTN(this.ID()+"_btnRemove",{text:"Remove"});c.AddChild(this._btnRemove);this._btnRemove.AddClassName("cmFloatRight sm cmCancelDeleteButton mt5px");this._btnRemove.AssignStyle("margin-right","0px !important");if(!this._cfo.includeRemoveButton){this._btnRemove.Hide()}if(this._cfo.includeLabel==true){this._lblImage.Show();if(this._cfo.labelWidth>0){this._lblImage.SetWidth(this._cfo.labelWidth)}var f="";if(!$$CM.isEmpty(this._cfo.label)){f=this._cfo.label}this._lblImage.UpdateInnerHtml(f)}else{this._lblImage.Hide()}this._cmDivModals=$$P.div();this.AddChild(this._cmDivModals);var b={};b.width=440;b.parent=this;b.cropMinWidth=this._cfo.cropMinWidth;b.cropMinHeight=this._cfo.cropMinHeight;b.cropWidth=this._cfo.cropWidth;b.cropHeight=this._cfo.cropHeight;this._definitionModalFileUploadWrapperCroppingDialog=new cm.ui.common.DefinitionModalFileUploadWrapperCroppingDialog("cropDialog_"+this.ID(),b);this._cmDivModals.AddChild(this._definitionModalFileUploadWrapperCroppingDialog)},createEvents:function($super){$super();this.FileUploadCompleteEvent=new cm.event();this.FileUploadErrorEvent=new cm.event()},wireEvents:function($super){$super();this._fileUploadWrapperControl.FileUploadCompleteEvent.subscribe(this.onFileUploadComplete,this);this._fileUploadWrapperControl.FileUploadErrorEvent.subscribe(this.onFileUploadError,this);this._btnRemove.ClickEvent.subscribe(this.onRemoveClicked,this);this._definitionModalFileUploadWrapperCroppingDialog.CropSelectedEvent.subscribe(this.onCropSelected,this);this._definitionModalFileUploadWrapperCroppingDialog.CropCanceledEvent.subscribe(this.onCropCanceled,this);this._mediaDAO.TempImageDeleted.subscribe(this.onTempImageDeleted,this);this._mediaDAO.TempImageCropped.subscribe(this.onTempImageCropped,this)},onFileUploadComplete:function(b,a){this._fileName="";this._fileUrl="";if(this._cfo.includeCrop){this.Reset();this._definitionModalFileUploadWrapperCroppingDialog.Bind(a);this._definitionModalFileUploadWrapperCroppingDialog.Show()}else{this.BindImage(a)}},onCropSelected:function(d,b){var a=this._definitionModalFileUploadWrapperCroppingDialog.GetData();if($$CM.isNull(a.cropRectangle)){var c={title:"Cropping Error",header:"",message:"A crop area was not selected. Please click and drag the mouse to select a crop area."};$$CMD.Alert(c)}else{$$CMD.ShowWaitDialog({showProgress:false,message:"Please wait..."});this._mediaDAO.TempImageCrop(a)}},onCropCanceled:function(){this._definitionModalFileUploadWrapperCroppingDialog.Hide();this.Reset()},onTempImageCropped:function(b,a){$$CMD.HideWaitDialog();this._definitionModalFileUploadWrapperCroppingDialog.Hide();this.BindImage(a)},onFileUploadError:function(b,a){$$CMD.Alert({title:"File Upload Error",message:error})},onRemoveClicked:function(d,a){var c="";if(!$$CM.isEmpty(this._cfo.label)){c=this._cfo.label}var b={title:"Confirm",header:"Delete "+c,message:"Are you sure you wish to remove this "+c.toLowerCase(),width:400,handlerOk:this.onDelete_confirm,scope:this,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)},onDelete_confirm:function(b,a){this._mediaDAO.TempImageDelete(this._fileName)},onTempImageDeleted:function(b,a){this.Reset()},BindImage:function(a){this._fileName="";this._fileUrl="";if(!$$CM.isNull(a)){this._fileName=a.fileName;this._fileUrl=a.fileUrl;if(!$$CM.isEmpty(this._fileUrl)&&window.location.protocol=="https:"){this._fileUrl=this._fileUrl.replace("http:","https:")}}if($$CM.isEmpty(this._fileUrl)){this._imageWrapperControl.Hide();this._fileUploadWrapperControl.Show()}else{this._img.SetAttribute("src",this._fileUrl);this._fileUploadWrapperControl.Hide();this._imageWrapperControl.Show()}},Reset:function(){this._fileUploadWrapperControl.Reset();this.BindImage()},GetData:function(){return this._fileName}});cm.ui.common.DefinitionModalFileUploadWrapperCroppingDialogConfigOptions=Class.create(cm.ui.dialog.ModalDialogConfigOptions,{dialogClass:"cmEditDialog",title:"Crop Image",cropMinWidth:175,cropMinHeight:175,cropWidth:400,cropHeight:400});cm.ui.common.DefinitionModalFileUploadWrapperCroppingDialog=Class.create(cm.ui.dialog.ModalDialog,{CropSelectedEvent:null,CropCanceledEvent:null,CROP_CONSTRAINT_MIN_WIDTH:50,CROP_CONSTRAINT_MIN_HEIGHT:50,configureDefaultOptions:function(){return new cm.ui.common.DefinitionModalFileUploadWrapperCroppingDialogConfigOptions()},initializeDAOs:function($super){$super()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this.AddClassName("definitionModalFileUploadWrapperCroppingDialog");var c=$$P.div();this.AddChild(c);c.AddClassName("definitionModalFileUploadWrapperCroppingWrapper bd");var b=$$P.div();c.AddChild(b);this._divImageToBeCropped=$$P.div();b.AddChild(this._divImageToBeCropped);this._divImageToBeCropped.AddClassName("cmFloatLeft");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFloatLeft mt10px");a.SetWidth(420);this._btnSave=new $$BTN("btnCrop_"+this.ID(),{text:"Crop"});a.AddChild(this._btnSave);this._btnSave.AddClassName("cmFloatRight cmGoButton");this._btnCancel=new $$BTN("btnCancel_"+this.ID(),{text:"Cancel"});a.AddChild(this._btnCancel);this._btnCancel.AddClassName("cmCancelDeleteButton mr5px")},createEvents:function($super){$super();this.CropSelectedEvent=new cm.event();this.CropCanceledEvent=new cm.event()},wireEvents:function($super){$super();this._btnSave.ClickEvent.subscribe(this.onSaveClicked,this);this._btnCancel.ClickEvent.subscribe(this.onCancelClicked,this)},postInitialize:function($super){$super()},onSaveClicked:function(b,a){this.CropSelectedEvent.fire(this)},onCancelClicked:function(b,a){this.CropCanceledEvent.fire(this)},clearImageCropper:function(){if(this._imgCrop!=null){this._imgCrop.Destroy()}this._imgCrop=null},Reset:function(){},Bind:function(g){this._fileName=g.fileName;this._fileUrl=g.fileUrl;var m=g.imageWidth;var k=g.imageHeight;var n=g.imageWidth;var l=g.imageHeight;var f=this._cfo.cropWidth;var c=this._cfo.cropHeight;var e=this._cfo.cropMinWidth;var d=this._cfo.cropMinHeight;if(m<e||k<d){var h={title:"Cropping Error",header:"",message:"The image is too small. It must be a minimum of "+e+"px wide by "+d+"px high."};$$CMD.Alert(h);this.CropCanceledEvent.fire(this);return}var p=f/m;var i=c/k;this._sizeMultiplier=p;if(i<p){this._sizeMultiplier=i}var n=Math.floor(m*this._sizeMultiplier);var l=Math.floor(k*this._sizeMultiplier);n=Math.min(f,n);l=Math.min(c,l);this.clearImageCropper();var e=this._cfo.cropMinWidth;var d=this._cfo.cropMinHeight;var o=1;if($$CM.isNumber(e)&&Number(e)>0&&$$CM.isNumber(d)&&Number(d)){o=Number(e)/Number(d)}var b=Math.floor(e*this._sizeMultiplier);var a=Math.floor(d*this._sizeMultiplier);b=Math.ceil(Math.min(b,f));a=Math.ceil(Math.min(a,c));b=Math.ceil(Math.max(b,this.CROP_CONSTRAINT_MIN_WIDTH));a=Math.ceil(Math.max(a,this.CROP_CONSTRAINT_MIN_HEIGHT));if(!$$CM.isNull(this._imgPhoto)){this._divImageToBeCropped.DestroyChildControl(this._imgPhoto)}this._divImageToBeCropped.SetWidth(n);this._divImageToBeCropped.SetHeight(l);this._divImageToBeCropped.AssignStyle("width",""+n+"px");this._divImageToBeCropped.AssignStyle("height",""+l+"px");this._imgPhoto=new cm.ui.utilityControls.ImageCropper(this.ID()+"_ImageCropper",{width:n,height:l});this._divImageToBeCropped.AddChild(this._imgPhoto);this._loadingImage=true;var j={src:this._fileUrl,resizeRatio:o,imageWidth:n,imageHeight:l,constraintW:b,constraintH:a};this._imgPhoto.Bind(j)},GetData:function(){var a={};a.fileName=this._fileName;a.cropRectangle=this._imgPhoto.GetData();if(!$$CM.isNull(a.cropRectangle)){a.cropRectangle.width=Math.ceil(a.cropRectangle.width/this._sizeMultiplier);a.cropRectangle.height=Math.ceil(a.cropRectangle.height/this._sizeMultiplier);a.cropRectangle.x=Math.ceil(a.cropRectangle.x/this._sizeMultiplier);a.cropRectangle.y=Math.ceil(a.cropRectangle.y/this._sizeMultiplier)}a.fileName=this._fileName;a.fileUrl=this._fileUrl;return a}});"cm.ui.common".namespace();cm.ui.common.DefinitionModalRowControl=Class.create(cm.ui.ComplexControl,{render:function(){var a=$$P.li(this._id);return $$E(a)},initializeUIElements:function(){var b=this.GetConfigOptions();var c=0;var e=0;if(!b.isNewRow){if($$CM.isNumber(b.contentID)){c=b.contentID}}this._parentControl=b.parentControl;this._divLabel=$$P.div("lblDiv_"+c);this._divLabel.AddClassName("cmFloatLeft handle");this.AddChild(this._divLabel);this._divEdit=$$P.div("editDiv_"+c);this._divEdit.AddClassName("cmFloatLeft");this.AddChild(this._divEdit);this._labelControls=$A();b.columnArray.each(function(f){var i=$$P.span();this._divLabel.AddChild(i);i.SetWidth(f.ColumnWidth);i.AddClassName("cmFloatLeft handle");if(!$$CM.isNull(f.PropertyArray)){var g=1;f.PropertyArray.each(function(l){var m=this.isValidVersionBranch(l);if(m){if(g>1){var k=$$P.div();i.AddChild(k);k.AddClassName("cmClear")}var j=this.getLabelControl(l,c,f.ColumnWidth);i.AddChild(j);this._labelControls.push(j);g++}},this);var h=$$P.div();i.AddChild(h);h.AddClassName("cmClear");h.UpdateInnerHtml("&nbsp;");h.SetWidth(f.ColumnWidth);h.AssignStyle("line-height","1px")}e+=f.ColumnWidth},this);var d=$$P.span("spanButtons_"+c);this._divLabel.AddChild(d);d.SetWidth(b.widthRightButtonColumn);d.AddClassName("top cmFloatLeft mt5px");this._btnDelete=new $$BTN("btnDelete_"+c,{text:"Delete"});d.AddChild(this._btnDelete);this._btnDelete.AddClassName("sm cmCancelDeleteButton cmFloatRight ml5px mr0px");this._btnDelete.Hide();if(b.allowDelete){this._btnDelete.Show()}this._btnArchive=new $$BTN("btnArchive_"+c,{text:"Archive"});d.AddChild(this._btnArchive);this._btnArchive.AddClassName("sm cmCancelDeleteButton cmFloatRight ml5px mr0px");this._btnArchive.Hide();if(b.allowArchive){this._btnArchive.Show()}this._btnEdit=new $$BTN("btnEdit_"+c,{text:"Edit"});d.AddChild(this._btnEdit);this._btnEdit.AddClassName("sm cmEditButton cmFloatRight mr0px");this._btnEdit.Hide();if(b.allowModify){this._btnEdit.Show()}e+=b.widthRightButtonColumn;this._divLabel.SetWidth(e);this._editControls=$A();b.columnArray.each(function(f){var i=$$P.span();this._divEdit.AddChild(i);i.SetWidth(f.ColumnWidth);i.AddClassName("cmFloatLeft");if(!$$CM.isNull(f.PropertyArray)){var g=1;f.PropertyArray.each(function(p){var q=this.isValidVersionBranch(p);if(q){var k=p.DataType.toLowerCase();if(k=="number"){var o=0;var n=0;if($$CM.isNumber(p.MinValue)){o=Number(p.MinValue)}if($$CM.isNumber(p.MaxValue)){n=Number(p.MaxValue)}p.DataSource=[];for(var m=o;m<=n;m++){p.DataSource.push({ID:m,Name:m})}}if(g>1){var l=$$P.div();i.AddChild(l);l.AddClassName("cmClear")}var j=this.getEditControl(p,c,f.ColumnWidth);i.AddChild(j);this._editControls.push(j);g++}},this);var h=$$P.div();i.AddChild(h);h.AddClassName("cmClear");h.UpdateInnerHtml("&nbsp;");h.SetWidth(f.ColumnWidth);h.AssignStyle("line-height","1px")}},this);var d=$$P.span("spanButtons_"+c);this._divEdit.AddChild(d);d.SetWidth(b.widthRightButtonColumn);d.AddClassName("top cmFloatLeft mt5px");this._btnSave=new $$BTN("btnSave_"+c,{text:"Save"});d.AddChild(this._btnSave);this._btnSave.AddClassName("sm cmGoButton cmFloatRight ml5px mr0px");this._btnSaveAdd=new $$BTN("btnSaveAdd_"+c,{text:"Save + Add"});d.AddChild(this._btnSaveAdd);this._btnSaveAdd.AddClassName("sm cmGoButton cmFloatRight ml5px mr0px");var a=$$P.br();d.AddChild(a);this._btnCancel=new $$BTN("btnCancel_"+c,{text:"Cancel"});d.AddChild(this._btnCancel);this._btnCancel.AddClassName("sm cmCancelDeleteButton cmFloatRight w50px mr0px");this._divEdit.SetWidth(e);if(b.isNewRow){this._divLabel.Hide()}else{this._divEdit.Hide()}this.SetWidth(e)},createEvents:function($super){$super();this.EditClicked=new cm.event();this.DeleteClicked=new cm.event();this.ArchiveClicked=new cm.event();this.SaveClicked=new cm.event();this.SaveAddClicked=new cm.event();this.CancelClicked=new cm.event()},wireEvents:function($super){$super();this._btnEdit.ClickEvent.subscribe(this.btnEdit_click,this);this._btnDelete.ClickEvent.subscribe(this.btnDelete_click,this);this._btnArchive.ClickEvent.subscribe(this.btnArchive_click,this);this._btnSave.ClickEvent.subscribe(this.btnSave_click,this);this._btnSaveAdd.ClickEvent.subscribe(this.btnSaveAdd_click,this);this._btnCancel.ClickEvent.subscribe(this.btnNewCancel_click,this)},btnEdit_click:function(b,a){this.EditClicked.fire(b,this)},btnDelete_click:function(b,a){this.DeleteClicked.fire(b,this)},btnArchive_click:function(b,a){this.ArchiveClicked.fire(b,this)},btnSave_click:function(b,a){this.SaveClicked.fire(b,this)},btnSaveAdd_click:function(b,a){this.SaveAddClicked.fire(b,this)},btnNewCancel_click:function(b,a){this.CancelClicked.fire(b,this)},onDataUpdated:function(){var d=this.GetBoundData();if(!$$CM.isNull(d)){var a=this.GetConfigOptions();$$E(this).uniqueID=d.ID;var b={};a.columnArray.each(function(e){if(!$$CM.isNull(e.PropertyArray)){e.PropertyArray.each(function(h){var i=this.isValidVersionBranch(h);if(i){this.bindLabelControl(h,d);this.bindEditControl(h,d);var g=h.PropertyName;if(!$$CM.isNull(h.EnableDependency)){var f=this._editControls.find(function(j){return j.propertyName==h.EnableDependency},this);b[h.EnableDependency]={control:f,item:d}}}},this)}},this);for(var c in b){if(b.hasOwnProperty(c)){this.enableDependencyControlUpdateControls(b[c].control,b[c].item)}}}else{$$E(this).uniqueID=0}},Reset:function(){var a=this.GetConfigOptions();this.Validator.Clear();a.columnArray.each(function(b){if(!$$CM.isNull(b.PropertyArray)){b.PropertyArray.each(function(n){var p=this.isValidVersionBranch(n);if(p){var f=n.DataType.toLowerCase();var m=n.PropertyName;var e=this._editControls.find(function(i){return i.propertyName==m},this);var o=$A();if($$CM.isFunction(n.DataSource)){o=n.DataSource()}else{o=n.DataSource}switch(f){case"txt":case"txa":e.Bind("");break;case"date":var d=new $$CMDATE();d.bindFromDate(new Date());e.Bind(this.getDateString(d.getFormattedLocalDate(true,true,true,false,true)));break;case"yesno":case"radiolist":case"checkboxlist":var c=1;buttonControls=e.ChildControls();o.each(function(u){var t=false;if(!$$CM.isNull(u.IsDefault)){t=(u.IsDefault==true)}if((f=="yesno"||f=="radiolist")&&c==1&&($$CM.isNull(u.IsDefault)||(!$$CM.isNull(u.IsDefault)&&u.IsDefault))){t=true}var i=buttonControls.find(function(r){return r.buttonListCounter==c},this);i.Bind(t);c++},this);break;case"number":case"ddl":if(!$$CM.isNull(n.Dependency)){e.clearOptionList()}else{var l=e.GetOptionList();if(l.length>0){for(var g=0;g<l.length;g++){l[g].selected=false}if(!$$CM.isNull(n.IsMultiple)&&n.IsMultiple==true){}else{if(l.length==2){e.setSelectedIndex(1)}else{e.setSelectedIndex(0)}}}}break;case"lbl":var h="";if(!$$CM.isEmpty(n.Label)){var q="";if($$CM.isNumber(n.LabelWidth)){q=" style='width:"+n.LabelWidth+"px;'"}h="<span class='cmEditDialogEntryLabel'"+q+">"+n.Label+"</span>&nbsp;"}var j=h;var k="";if(!$$CM.isEmpty(n.DefaultValue)){k=n.DefaultValue}if(!$$CM.isNull(n.ItalicizeData)&&n.ItalicizeData==true){j=h+"<i>"+k+"</i>"}else{j=h+k}if($$CM.isEmpty(j)){j="&nbsp;"}e.UpdateInnerHtml(j);break;case"address":e.Reset();break;case"time":e.Reset();break;case"file":e.Reset();break;default:e.UpdateInnerHtml("&nbsp;");break}}},this)}},this)},getEditControl:function(A,o,d){var g=A.DataType.toLowerCase();var z=A.PropertyName;var f=null;var r=true;if(!$$CM.isNull(A.IsEditable)&&A.IsEditable==false&&parseInt(o)!=0){r=false}var t=false;if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidation.dataType)&&r){if(!$$CM.isNull(A.DataValidation.IsRequired)&&A.DataValidation.IsRequired==true){t=true}}var G=d-20;if(!$$CM.isNull(A.Width)){G=A.Width}var k="";if(!$$CM.isNull(A.DataValidation)){if(!$$CM.isNull(A.DataValidation.Legend)){k=A.DataValidation.Legend}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidation.MaxLength)){k=A.DataValidation.MaxLength+" char max"}if(A.DataType=="ddl"&&!$$CM.isNull(A.IsMultiple)&&A.IsMultiple==true){var y="";if(!$$CM.isEmpty(cm.hosts.common)){y=cm.hosts.common}var D=y+"/common/lib/core/ui/common/images/ctrlclick.png";var p="<img src='"+D+"' alt='Multiple selections allowed' title='Multiple selections allowed'>";k=p}}var B=$A();if($$CM.isFunction(A.DataSource)){B=A.DataSource()}else{B=A.DataSource}switch(g){case"txt":f=$$P.div(z+"_0_"+o);f.SetAttribute("groupName",A.PropertyName);f.AddClassName("smallerGreyLabel");var u="";if(!$$CM.isEmpty(A.Label)){u=A.Label;var v=$$P.div("",u);f.AddChild(v);v.AddClassName("cmFloatLeft cmEditDialogEntryEdit");if($$CM.isNumber(A.LabelWidth)){v.SetWidth(A.LabelWidth);v.SetHeight(24)}}var q=G;if(!$$CM.isEmpty(A.Label)&&$$CM.isNumber(A.LabelWidth)){q=G-Number(A.LabelWidth)}var F=new $$FTXT(z+"_"+o,{width:q,inputWidth:q,fieldTip:k});f.AddChild(F);F.AddClassName("cmFloatLeft");if(!$$CM.isEmpty(A.Label)&&$$CM.isNumber(A.LabelWidth)){F.GetTitleControl().SetWidth(A.LabelWidth);F.GetTitleControl().AddClassName("cmEditDialogEntryEdit")}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r){F.Validator.addEvaluator($$EVAL.GetEvaluator(A.DataValidationType,A.DataValidation))}if(F!=null){if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidation.MaxLength)){F.GetInputControl().SetAttribute("maxLength",A.DataValidation.MaxLength)}}f.GetData=function(){return F.GetData()};f.Bind=function(J){return F.Bind(J)};break;case"txa":f=$$P.div(z+"_0_"+o);f.SetAttribute("groupName",A.PropertyName);f.AddClassName("smallerGreyLabel");var u="";if(!$$CM.isEmpty(A.Label)){u=A.Label;var v=$$P.div("",u);f.AddChild(v);v.AddClassName("cmFloatLeft cmEditDialogEntryEdit");if($$CM.isNumber(A.LabelWidth)){v.SetWidth(A.LabelWidth);v.SetHeight(24)}}var q=G;if(!$$CM.isEmpty(A.Label)&&$$CM.isNumber(A.LabelWidth)){q=G-Number(A.LabelWidth)}var n=60;if(!$$CM.isNull(A.Height)){n=A.Height}var E=new $$FTXA(z+"_"+o,{width:A.Width,inputWidth:Math.abs(G-6),inputHeight:n,fieldTip:k});f.AddChild(E);E.AddClassName("cmFloatLeft");if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r){E.Validator.addEvaluator($$EVAL.GetEvaluator(A.DataValidationType,A.DataValidation))}if(E!=null){if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidation.MaxLength)){E.GetInputControl().SetAttribute("maxLength",A.DataValidation.MaxLength)}}f.GetData=function(){return E.GetData()};f.Bind=function(J){return E.Bind(J)};break;case"date":f=new $$FDATE(z+"_"+o,{width:A.Width,inputWidth:G,fieldTip:k});if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r){f.Validator.addEvaluator($$EVAL.GetEvaluator(A.DataValidationType,A.DataValidation))}break;case"number":var u="";if(!$$CM.isEmpty(A.Label)){u=A.Label}f=new $$FDDL(z+"_"+o,{inputWidth:G,fieldTip:k,label:u});if(!$$CM.isEmpty(A.Label)&&$$CM.isNumber(A.LabelWidth)){f.GetTitleControl().SetWidth(A.LabelWidth);f.GetTitleControl().AddClassName("cmEditDialogEntryEdit")}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r&&!$$CM.isNull(A.DataValidation.IsRequired)&&A.DataValidation.IsRequired==true&&($$CM.isNull(A.NoSelect)||A.NoSelect==false)){f.bindList(B,"","Select")}else{f.bindList(B,"",null)}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r){f.Validator.addEvaluator($$EVAL.GetEvaluator(A.DataValidationType,A.DataValidation))}break;case"ddl":var u="";if(!$$CM.isEmpty(A.Label)){u=A.Label}if(!$$CM.isNull(A.IsMultiple)&&A.IsMultiple==true){f=new $$FLB(z+"_"+o,{inputWidth:G,fieldTip:k,label:u})}else{f=new $$FDDL(z+"_"+o,{inputWidth:G,fieldTip:k,label:u})}if(!$$CM.isEmpty(A.Label)&&$$CM.isNumber(A.LabelWidth)){f.GetTitleControl().SetWidth(A.LabelWidth);f.GetTitleControl().AddClassName("cmEditDialogEntryEdit")}if(!$$CM.isNull(A.Dependency)){var h=this._editControls.find(function(J){return J.propertyName==A.Dependency},this);if($$CM.isNull(h.dependencyControlArray)){h.dependencyControlArray=$A()}h.dependencyControlArray.push(f);h.ChangeEvent.subscribe(this.dependencyControl_changed,this)}var j=false;if(!$$CM.isNull(A.ExpandCamelCase)&&A.ExpandCamelCase==true){j=true}if(!$$CM.isNull(A.IsMultiple)&&A.IsMultiple==true){if(!$$CM.isNull(A.Size)){f.SetAttribute("size",A.Size)}if($$CM.isNull(A.Dependency)){if(!$$CM.isNull(A.DataSourceOrderProperty)){B=this._parentControl.sortDataSource(B,A.DataSourceOrderProperty)}f.bindList(B,"",null,j)}}else{if($$CM.isNull(A.Dependency)){if(!$$CM.isNull(A.DataSourceOrderProperty)){B=this._parentControl.sortDataSource(B,A.DataSourceOrderProperty)}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r&&!$$CM.isNull(A.DataValidation.IsRequired)&&A.DataValidation.IsRequired==true&&($$CM.isNull(A.NoSelect)||A.NoSelect==false)){f.bindList(B,"","Select",j)}else{f.bindList(B,"",null,j)}}}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r){f.Validator.addEvaluator($$EVAL.GetEvaluator(A.DataValidationType,A.DataValidation))}break;case"yesno":case"radiolist":case"checkboxlist":var I=false;if(!$$CM.isNull(A.WrapInputUnderLabel)&&A.WrapInputUnderLabel==true&&$$CM.isNumber(A.LabelWidth)){I=true}f=$$P.div(z+"_0_"+o);f.SetAttribute("groupName",A.PropertyName);f.AddClassName("smallerGreyLabel");var u="";if(!$$CM.isEmpty(A.Label)){u=A.Label;var v=$$P.div("",u);f.AddChild(v);v.AddClassName("cmFloatLeft cmEditDialogEntryEdit");if($$CM.isNumber(A.LabelWidth)){v.SetWidth(A.LabelWidth);v.SetHeight(24)}}var c=1;var b=$A();B.each(function(N){var M=false;if(!$$CM.isNull(A.IsVertical)&&A.IsVertical==true){M=true}var L=false;if(!$$CM.isNull(A.ExpandCamelCase)&&A.ExpandCamelCase==true){L=true}var J=null;if(g=="yesno"||g=="radiolist"){if(L==true){J=new $$FRB(z+"_"+c+"_"+o,{name:A.PropertyName+"_"+o,label:$$CM.separateCamelCaseString(N.Name),value:N.ID})}else{J=new $$FRB(z+"_"+c+"_"+o,{name:A.PropertyName+"_"+o,label:N.Name,value:N.ID})}}else{if(L==true){J=new $$FCB(z+"_"+c+"_"+o,{name:A.PropertyName+"_"+o,label:$$CM.separateCamelCaseString(N.Name),value:N.ID})}else{J=new $$FCB(z+"_"+c+"_"+o,{name:A.PropertyName+"_"+o,label:N.Name,value:N.ID})}if($$CM.isNumber(A.LabelWidth)){J.GetTitleControl().SetWidth(A.LabelWidth)}}if(r==false){J.SetEnabled(false)}J.buttonListCounter=c;if(!$$CM.isNull(A.EnableDependency)&&!$$CM.isNull(A.EnableDependencyValue)){var K=this._editControls.find(function(O){return O.propertyName==A.EnableDependency},this);if($$CM.isNull(K.enableDependencyControlArray)){K.enableDependencyControlArray=$A()}K.enableDependencyControlArray.push({Value:A.EnableDependencyValue,Control:J});K.ChangeEvent.subscribe(this.enableDependencyControl_changed,this)}if(M&&($$CM.isNumber(A.LabelWidth)||$$CM.isNumber(A.Width))){if($$CM.isNumber(A.LabelWidth)){J.AssignStyle("width",A.LabelWidth+"px !important")}if($$CM.isNumber(A.Width)){J.AssignStyle("width",A.Width+"px !important")}}if(!$$CM.isEmpty(A.Label)&&((I&&!M)||(M&&c==1))){J.AddClassName("wrapInputUnderLabel")}if(!M&&c<B.length){J.AddClassName("pr10px")}J.dataType=g;J.propertyName=z;J.propertyObj=A;f.AddChild(J);c++;b.push(J)},this);if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidationType)&&r){f.Validator.addEvaluator($$EVAL.GetEvaluator(A.DataValidationType,A.DataValidation))}f.GetData=function(){var J=$A();b.each(function(K){J.push(K.GetData())},this);return J};if(I){f.SetWidth(A.LabelWidth)}f.AddChangeListener();break;case"lbl":f=$$P.lbl(z+"_"+o);var u="";if(!$$CM.isEmpty(A.Label)){var H="";if($$CM.isNumber(A.LabelWidth)){H=" style='width:"+A.LabelWidth+"px;'"}u="<span class='cmEditDialogEntryLabel'"+H+">"+A.Label+"</span>&nbsp;"}var w=u;var x="";if(!$$CM.isEmpty(A.DefaultValue)){x=A.DefaultValue}if(!$$CM.isNull(A.ItalicizeData)&&A.ItalicizeData==true){w=u+"<i>"+x+"</i>"}else{w=u+x}if($$CM.isEmpty(w)){w="&nbsp;"}f.UpdateInnerHtml(w);f.AddClassName("cmEditDialogLabelControlDisplay");break;case"lbldate":f=$$P.lbl(z+"_"+o);f.UpdateInnerHtml("&nbsp;");f.AddClassName("cmEditDialogLabelControlDisplay");break;case"updated":f=$$P.span(z+"_"+o);f.UpdateInnerHtml("&nbsp;");f.AddClassName("cmEditDialogLabelControlDisplay");break;case"timestamp":f=$$P.span(z+"_"+o);f.AssignStyle("padding-top","7px !important");f.UpdateInnerHtml("&nbsp;");f.AddClassName("cmEditDialogLabelControlDisplay");break;case"address":var m="";var C=false;if(!$$CM.isNull(A.DataValidation)&&r){m=A.DataValidation.FieldName;C=true}var a=$$CM.uniqueID();f=new $$FADDRESS(z+"_"+o+"_"+a,{uniqueID:a,width:A.Width,required:C,groupFieldName:m});break;case"time":var m="";var C=false;if(!$$CM.isNull(A.DataValidation)&&r){m=A.DataValidation.FieldName;C=true}f=new $$FTIME(z+"_"+o,{width:A.Width,inputWidth:G,required:C,groupFieldName:m});break;case"file":var e={};if($$CM.isNumber(A.Width)){e.width=A.Width}if($$CM.isNumber(A.Height)){e.height=A.Height}if($$CM.isNumber(A.ImageWidth)){e.imageWidth=A.ImageWidth}if($$CM.isNumber(A.ImageHeight)){e.imageHeight=A.ImageHeight}if(!$$CM.isNull(A.IncludeLabel)){e.includeLabel=A.IncludeLabel}if($$CM.isNumber(A.LabelWidth)){e.labelWidth=A.LabelWidth}if(!$$CM.isEmpty(A.Label)){e.label=A.Label}if(!$$CM.isNull(A.IncludeCrop)){e.includeCrop=A.IncludeCrop}if($$CM.isNumber(A.CropMinWidth)){e.cropMinWidth=A.CropMinWidth}if($$CM.isNumber(A.CropMinHeight)){e.cropMinHeight=A.CropMinHeight}var l=new cm.ui.common.DefinitionModalFileUploadWrapperControl(z+"_"+o+"_"+$$CM.uniqueNumber(),e);f=l;break}if(f!=null){if(r==false){f.SetEnabled(false)}if(!$$CM.isNull(A.DataValidation)&&!$$CM.isNull(A.DataValidation.MaxLength)){f.SetAttribute("maxLength",A.DataValidation.MaxLength)}f.AddClassName("cmFloatLeft");f.dataType=g;f.propertyName=z;f.propertyObj=A;if(g!="yesno"&&g!="radiolist"&&g!="checkboxlist"){if(!$$CM.isNull(A.EnableDependency)&&!$$CM.isNull(A.EnableDependencyValue)){var i=this._editControls.find(function(J){return J.propertyName==A.EnableDependency},this);if($$CM.isNull(i.enableDependencyControlArray)){i.enableDependencyControlArray=$A()}i.enableDependencyControlArray.push({Value:A.EnableDependencyValue,Control:f});i.ChangeEvent.subscribe(this.enableDependencyControl_changed,this)}}}return f},getLabelControl:function(f,d,a){var h=false;if(!$$CM.isNull(f.WrapInputUnderLabel)&&f.WrapInputUnderLabel==true&&$$CM.isNumber(f.LabelWidth)){h=true}var c=f.DataType.toLowerCase();var e=f.PropertyName;var g=f.Width;if(!$$CM.isEmpty(f.LabelWidth)){g=a}if(h){g=f.LabelWidth}var b=$$P.div("divLabel"+e+"_"+d);b.SetWidth(g);b.dataType=c;b.propertyName=e;return b},bindEditControl:function(u,m){this.Validator.Clear();var j=u.DataType.toLowerCase();var t=u.PropertyName;var f=this._editControls.find(function(i){return i.propertyName==t},this);var v=$A();if($$CM.isFunction(u.DataSource)){v=u.DataSource()}else{v=u.DataSource}switch(j){case"txt":case"txa":f.Bind(m[t]);break;case"date":f.Bind(this.getDateString(m[t]));break;case"number":case"ddl":if(!$$CM.isNull(u.Dependency)){var k=this._editControls.find(function(i){return i.propertyName==u.Dependency},this);this.dependencyControl_changed(k,null)}var r=f.GetOptionList();if(r.length>0){for(var l=0;l<r.length;l++){r[l].selected=false}var h=$A(v);if($$CM.isArray(m[t])){m[t].each(function(B){var z=h.find(function(i){return i.ID==B},this);if(!$$CM.isNull(z)){for(var A=0;A<r.length;A++){if(Number(r[A].value)==Number(z.ID)){r[A].selected=true}}}},this)}else{var g=h.find(function(i){return i.ID==m[t]},this);if(!$$CM.isNull(g)){for(var l=0;l<r.length;l++){if(Number(r[l].value)==Number(g.ID)){r[l].selected=true}}}}}break;case"yesno":case"radiolist":var h=$A(v);var g=h.find(function(i){return i.ID==m[t]});if(!$$CM.isNull(g)){if(!$$CM.isNull(g)){var b=1;buttonControls=f.ChildControls();h.each(function(z){var i=buttonControls.find(function(A){return A.buttonListCounter==b},this);if(Number(i.GetValue())==Number(g.ID)){i.Bind(true)}b++},this)}}break;case"checkboxlist":var h=$A(v);var b=1;buttonControls=f.ChildControls();h.each(function(z){var i=buttonControls.find(function(A){return A.buttonListCounter==b},this);i.Bind(false)},this);if($$CM.isArray(m[t])){m[t].each(function(A){var z=h.find(function(B){return B.ID==A});if(!$$CM.isNull(z)){var i=1;h.each(function(C){var B=buttonControls.find(function(D){return D.buttonListCounter==i},this);if(Number(B.GetValue())==Number(z.ID)){B.Bind(true)}i++},this)}},this)}else{var g=h.find(function(i){return i.ID==m[t]});if(!$$CM.isNull(g)){if(!$$CM.isNull(g)){var b=1;h.each(function(z){var i=buttonControls.find(function(A){return A.buttonListCounter==b},this);if(Number(i.GetValue())==Number(g.ID)){i.Bind(true)}else{if(j=="checkboxlist"){i.Bind(false)}}b++},this)}}}break;case"lbl":var n="";if(!$$CM.isEmpty(u.Label)){var y="";if($$CM.isNumber(u.LabelWidth)){y=" style='width:"+u.LabelWidth+"px;'"}n="<span class='cmEditDialogEntryLabel'"+y+">"+u.Label+"</span>&nbsp;"}var o=n;var p="";if(!$$CM.isEmpty(u.DefaultValue)){p=u.DefaultValue}if(!$$CM.isEmpty(m[t])){p=m[t]}if(!$$CM.isNull(u.ItalicizeData)&&u.ItalicizeData==true){o=n+"<i>"+p+"</i>"}else{o=n+p}if($$CM.isEmpty(o)){o="&nbsp;"}f.UpdateInnerHtml(o);break;case"lbldate":var n="";if(!$$CM.isEmpty(u.Label)){var y="";if($$CM.isNumber(u.LabelWidth)){y=" style='width:"+u.LabelWidth+"px;'"}n="<span class='cmEditDialogEntryLabel'"+y+">"+u.Label+"</span>&nbsp;"}if(!$$CM.isEmpty(m[t])&&m[t]!="0001-01-01T00:00:00"&&m[t]!="0001-01-01T00:00:00.0000000"){var e=new $$CMDATE(m[t]);n+=e.getFormattedLocalDate(true,true,true,false,true)}f.UpdateInnerHtml(n);break;case"updated":var n="&nbsp;";if(!$$CM.isEmpty(m.UpdatedDateAsString)&&m.UpdatedDateAsString!="0001-01-01T00:00:00"&&m.UpdatedDateAsString!="0001-01-01T00:00:00.0000000"){var e=new $$CMDATE(m.UpdatedDateAsString);n=e.getFormattedLocalDate(true,true,true,false,true)}if(!$$CM.isEmpty(n)){n+="<br />"}if(!$$CM.isEmpty(m.UpdatedBy)&&m.UpdatedBy!="null"){n+="<span class='cmSubtle'>by "+m.UpdatedBy+"</span>"}f.UpdateInnerHtml(n);break;case"timestamp":var n="&nbsp;";var w=m.TimeStamp;if(!$$CM.isNull(w)){var q=w.Modified;if(!$$CM.isNull(q)){if(!$$CM.isEmpty(q.Time)&&q.Time!="0001-01-01T00:00:00"&&q.Time!="0001-01-01T00:00:00.0000000"){var d=new $$CMDATE(q.Time);n=d.getFormattedLocalDate(true,true,true,false,true)}if(!$$CM.isEmpty(n)){n+="<br />"}if(!$$CM.isEmpty(q.Name)&&q.Name!="null"){n+="<span class='cmSubtle'>by "+q.Name+"</span>"}}}f.UpdateInnerHtml(n);break;case"address":f.Bind(m[t]);break;case"time":var c=new $$CMDATE(m[t]);f.Bind(c.getData());break;case"file":var a={};var x=u.UrlPropertyName;a.fileName=m[t];a.fileUrl=m[x];f.BindImage(a);break}},bindLabelControl:function(y,p){var j=y.DataType.toLowerCase();var x=y.PropertyName;var f=this._labelControls.find(function(H){return H.propertyName==x},this);var k=true;var G=false;if(!$$CM.isNull(y.WrapInputUnderLabel)&&y.WrapInputUnderLabel==true&&$$CM.isNumber(y.LabelWidth)){G=true}if(!$$CM.isNull(y.EnableDependency)&&!$$CM.isNull(y.EnableDependencyValue)){var l=this._editControls.find(function(H){return H.propertyName==y.EnableDependency},this);var E=y.EnableDependencyValue;var D=this.getDataItem(l.propertyObj);var k=true;if($$CM.isArray(D)){var v=D.find(function(H){if($$CM.isInteger(H)&&$$CM.isInteger(E)){return((Number(H)&Number(E))==Number(H))}else{return H==E}},this);if($$CM.isNull(v)){k=false}}else{if($$CM.isInteger(D)&&$$CM.isInteger(E)){if((Number(D)&Number(E))!=Number(D)){k=false}}else{if(D!=E){k=false}}}}var z=$A();if($$CM.isFunction(y.DataSource)){z=y.DataSource()}else{z=y.DataSource}if(k){switch(j){case"txt":case"txa":var q="";if(!$$CM.isEmpty(y.Label)){var F="";if($$CM.isNumber(y.LabelWidth)){F=" style='width:"+y.LabelWidth+"px;'"}q="<span class='cmEditDialogEntryLabel'"+F+">"+y.Label+"</span>&nbsp;"}f.UpdateInnerHtml(q+!$$CM.isNull(p[x])?$$CM.escapeHTML(p[x]):"");break;case"date":f.UpdateInnerHtml(this.getDateString(!$$CM.isNull(p[x])?p[x]:""));case"number":case"ddl":case"yesno":case"radiolist":case"checkboxlist":var i=$A(z);var m=false;if(!$$CM.isNull(y.ExpandCamelCase)&&y.ExpandCamelCase==true){m=true}var q="";if(!$$CM.isEmpty(y.Label)){var F="";if($$CM.isNumber(y.LabelWidth)){F=" style='width:"+y.LabelWidth+"px;'"}q="<span class='cmEditDialogEntryLabel'"+F+">"+y.Label+"</span>";if(!G){q=q+"&nbsp;"}}if($$CM.isArray(p[x])){var t="";var h=$A();p[x].each(function(K){var H=i.find(function(N){return N.ID==K});if(!$$CM.isNull(H)){var I=$$CM.deepClone(H);var L="";var J=H.OrderIndex;if(J>=0){if(!$$CM.isEmpty(L)){L+="_"}L+=$$CM.getFormattedOrderIndex(J,10)}var M=H.SortOrder;if(M>=0){if(!$$CM.isEmpty(L)){L+="_"}L+=$$CM.getFormattedOrderIndex(M,10)}if(!$$CM.isEmpty(H.Name)){if(!$$CM.isEmpty(L)){L+="_"}L+=H.Name}I.SortKey=L;h.push(I)}},this);h=h.sort($$CM.sortBySortKey);h.each(function(H){if(m==true){t=t+$$CM.separateCamelCaseString(H.Name)+",<br />"}else{t=t+H.Name+",<br />"}},this);t=t.substring(0,t.length-7);f.UpdateInnerHtml(q+t)}else{var g=i.find(function(H){return H.ID==p[x]});if(!$$CM.isNull(g)){if(m==true){f.UpdateInnerHtml(q+$$CM.separateCamelCaseString(g.Name))}else{f.UpdateInnerHtml(q+g.Name)}}}break;case"lbl":var q="";if(!$$CM.isEmpty(y.Label)){var F="";if($$CM.isNumber(y.LabelWidth)){F=" style='width:"+y.LabelWidth+"px;'"}q="<span class='cmEditDialogEntryLabel'"+F+">"+y.Label+"</span>&nbsp;"}var r=q;var u="";if(!$$CM.isEmpty(y.DefaultValue)){u=y.DefaultValue}if(!$$CM.isEmpty(p[x])){u=p[x]}if(!$$CM.isNull(y.ItalicizeData)&&y.ItalicizeData==true){r=q+"<i>"+u+"</i>"}else{r=q+u}f.UpdateInnerHtml(r);break;case"lbldate":var q="";if(!$$CM.isEmpty(y.Label)){var F="";if($$CM.isNumber(y.LabelWidth)){F=" style='width:"+y.LabelWidth+"px;'"}q="<span class='cmEditDialogEntryLabel'"+F+">"+y.Label+"</span>&nbsp;"}if(!$$CM.isEmpty(p[x])&&p[x]!="0001-01-01T00:00:00"&&p[x]!="0001-01-01T00:00:00.0000000"){var d=new $$CMDATE(p[x]);q+=d.getFormattedLocalDate(true,true,true,false,true)}f.UpdateInnerHtml(q);break;case"updated":var q="&nbsp;";if(!$$CM.isEmpty(p.UpdatedDateAsString)&&p.UpdatedDateAsString!="0001-01-01T00:00:00"&&p.UpdatedDateAsString!="0001-01-01T00:00:00.0000000"){var d=new $$CMDATE(p.UpdatedDateAsString);q=d.getFormattedLocalDate(true,true,true,false,true)}if(!$$CM.isEmpty(q)){q+="<br />"}if(!$$CM.isEmpty(p.UpdatedBy)&&p.UpdatedBy!="null"){q+="<span class='cmSubtle'>by "+p.UpdatedBy+"</span>"}f.UpdateInnerHtml(q);break;case"timestamp":var q="&nbsp;";var B=p.TimeStamp;if(!$$CM.isNull(B)){var w=B.Modified;if(!$$CM.isNull(w)){if(!$$CM.isEmpty(w.Time)&&w.Time!="0001-01-01T00:00:00"&&w.Time!="0001-01-01T00:00:00.0000000"){var c=new $$CMDATE(w.Time);q=c.getFormattedLocalDate(true,true,true,false,true)}if(!$$CM.isEmpty(q)){q+="<br />"}if(!$$CM.isEmpty(w.Name)&&w.Name!="null"){q+="<span class='cmSubtle'>by "+w.Name+"</span>"}}}f.UpdateInnerHtml(q);break;case"address":var a="";if(!$$CM.isEmpty(p[x].AddressLine1)){a+=" "+p[x].AddressLine1}if(!$$CM.isEmpty(p[x].AddressLine2)){a+=" "+p[x].AddressLine2}if(!$$CM.isEmpty(a)){a+="<br />"}if(!$$CM.isEmpty(p[x].City)){a+=p[x].City}if(!$$CM.isEmpty(p[x].State)){a+=", "+p[x].State}if(!$$CM.isEmpty(p[x].Zip)){a+=" "+p[x].Zip}if(!$$CM.isEmpty(p[x].Country)){a+="<br />"+p[x].Country}f.UpdateInnerHtml(a);break;case"time":var A=this.getTimeString(!$$CM.isNull(p[x])?p[x]:"");f.UpdateInnerHtml(A);break;case"file":f.ClearChildControls();var C=y.UrlPropertyName;var o=p[C];if(!$$CM.isEmpty(o)){var e={};if($$CM.isNumber(y.Width)){e.width=y.Width}if($$CM.isNumber(y.Height)){e.height=y.Height}if($$CM.isNumber(y.ImageWidth)){e.imageWidth=y.ImageWidth}if($$CM.isNumber(y.ImageHeight)){e.imageHeight=y.ImageHeight}if(!$$CM.isNull(y.IncludeLabel)){e.includeLabel=y.IncludeLabel}if($$CM.isNumber(y.LabelWidth)){e.labelWidth=y.LabelWidth}if(!$$CM.isEmpty(y.Label)){e.label=y.Label}e.includeRemoveButton=false;var n=new cm.ui.common.DefinitionModalFileUploadWrapperControl(x+"_Label_"+f.ID()+"_"+$$CM.uniqueNumber(),e);f.AddChild(n);var b={};b.fileName=p[x];b.fileUrl=p[C];n.BindImage(b)}break}}if($$CM.isEmpty(f.GetInnerHtml())){f.AssignStyle("height","1px")}else{f.AssignStyle("height","auto")}},enableDependencyControl_changed:function(b,a){this.enableDependencyControlUpdateControls(b,null)},enableDependencyControlUpdateControls:function(c,b){var a=c;if($$CM.isArray(a.enableDependencyControlArray)){a.enableDependencyControlArray.each(function(f){var g=f.Control;var p=f.Value;var o=this.getDataItem(a.propertyObj);var j=true;if($$CM.isArray(o)){var n=o.find(function(q){if($$CM.isInteger(q)&&$$CM.isInteger(p)){return((Number(q)&Number(p))==Number(q))}else{return q==p}},this);if($$CM.isNull(n)){j=false}}else{if($$CM.isInteger(o)&&$$CM.isInteger(p)){if((Number(o)&Number(p))!=Number(o)){j=false}}else{if(o!=p){j=false}}}if(j){var l=g.propertyObj.EnableDependencyEnabledDefaultID;if(!$$CM.isNull(l)&&!$$CM.isNull(g.propertyObj.DataSource)&&$$CM.isNull(b)){var d=g.buttonListCounter-1;var m=g.propertyObj.DataSource[d].ID;if(l==m){g.Bind(true);var i=this._editControls.find(function(q){return q.propertyName==g.propertyName},this);if(!$$CM.isNull(i)){this.enableDependencyControlUpdateControls(i)}}}g.Show();var h=$$E(g);var e=$$E(g.Parent);if(!$$CM.isEmpty(e.id)){jQuery("#"+e.id+" .cmEditDialogEntryEdit").show()}g.Validator.Enable();if(!$$CM.isNull(e.previousSibling)&&e.previousSibling.className=="cmClear"){e.previousSibling.show()}}else{var k=g.propertyObj.EnableDependencyDisabledDefaultID;if(!$$CM.isNull(k)&&!$$CM.isNull(g.propertyObj.DataSource)){var d=g.buttonListCounter-1;var m=g.propertyObj.DataSource[d].ID;if(k==m){g.Bind(true);var i=this._editControls.find(function(q){return q.propertyName==g.propertyName},this);if(!$$CM.isNull(i)){this.enableDependencyControlUpdateControls(i)}}}g.Hide();var h=$$E(g);var e=$$E(g.Parent);if(!$$CM.isEmpty(e.id)){jQuery("#"+e.id+" .cmEditDialogEntryEdit").hide()}g.Validator.Disable();if(!$$CM.isNull(e.previousSibling)&&e.previousSibling.className=="cmClear"){e.previousSibling.hide()}}},this)}},dependencyControl_changed:function(d,a){var c=d;var b=this.GetConfigOptions();if($$CM.isArray(c.dependencyControlArray)){c.dependencyControlArray.each(function(f){var k=f.propertyObj;var h=0;if(!b.isNewRow&&!$$CM.isNull(k.LockSelectedValues)&&k.LockSelectedValues==true){var i=this.GetBoundData();var j=i[k.PropertyName];if(($$CM.isArray(j)&&j.length>0)||(!$$CM.isArray(j)&&!$$CM.isEmpty(j))){}}var e=$A();var l=c.GetData();var m=f.GetData();propertyObjDataSource.each(function(n){var o=false;n.DependencyArray.each(function(p){var q=l.find(function(r){return parseInt(p)==parseInt(r)});if(!$$CM.isNull(q)){o=true}});if(o==true){e.push(n)}});var g=false;if(!$$CM.isNull(k.ExpandCamelCase)&&k.ExpandCamelCase==true){g=true}e=this._parentControl.sortDataSource(e,k.DataSourceOrderProperty);f.bindList(e,"",null,g);if(!b.isNewRow){var i=this.GetBoundData();var j=i[k.PropertyName];f.setSelectedValues(j);if(!$$CM.isNull(k.LockSelectedValues)&&k.LockSelectedValues==true){}}if(!$$CM.isNull(m)){f.setSelectedValues(m)}},this)}},getTimeString:function(b){var a=new $$CMDATE(b);return a.getFormattedLocalTime(true,true,false)},getDateString:function(a){var c="";if(!$$CM.isNull(a)&&!$$CM.isEmpty(a)){var f=a.indexOf("T");if(f>=0){var b=$$CM.toActualDate(a);var g=b.getMonth()+1;var h=$$CM.padZero(g).toString();var d=b.getDate();var e=$$CM.padZero(d).toString();var i=b.getFullYear();var j=i.toString();c=h+"/"+e+"/"+j}else{c=a}}return c},ShowEditButtons:function(b){var a=this.GetConfigOptions();if(b){if(a.allowDelete){this._btnDelete.Show()}if(a.allowArchive){this._btnArchive.Show()}if(a.allowModify){this._btnEdit.Show()}}else{this._btnEdit.Hide();this._btnDelete.Hide();this._btnArchive.Hide()}},ShowEditMode:function(d,b){var c=this;var a=this.GetConfigOptions();if(!a.isNewRow){if(d){this._divLabel.Hide(false);if(a.allowModify){this._divEdit.Show(true,400,null,null,function(){jQuery($$E(c._btnSave)).focus()},c)}}else{this._divEdit.Hide(true,400,null,null,function(){c._divLabel.Show()},c)}}if(!$$CM.isNull(b)){this._btnSave.Hide();this._btnSaveAdd.Hide();this._btnCancel.Hide()}else{this._btnSave.Show();if(!a.isNewRow){this._btnSaveAdd.Hide()}this._btnCancel.Show()}},ShowDragHandle:function(a){if(a){this._divLabel.ChildControls().each(function(b){b.RemoveClassName("cmDragHandleOff");b.AddClassName("cmDragHandleOn")},this);this._divLabel.RemoveClassName("cmDragHandleOff");this._divLabel.AddClassName("cmDragHandleOn")}else{this._divLabel.ChildControls().each(function(b){b.RemoveClassName("cmDragHandleOn");b.AddClassName("cmDragHandleOff")},this);this._divLabel.RemoveClassName("cmDragHandleOn");this._divLabel.AddClassName("cmDragHandleOff")}},ShowActive:function(c){var a=this.GetConfigOptions();if(!a.isNewRow){var b=this.GetBoundData();if((!$$CM.isNull(b.Active)&&b.Active==false)||(!$$CM.isNull(b.IsActive)&&b.IsActive==false)){if(c){this.Show()}else{this.Hide()}}}},BindEditValue:function(e,f){var b=this._editControls.find(function(g){return g.propertyName==e},this);if(!$$CM.isNull(b)){b.Bind(f)}var a=this.GetConfigOptions();var c={};a.columnArray.each(function(g){if(!$$CM.isNull(g.PropertyArray)){g.PropertyArray.each(function(i){var j=this.isValidVersionBranch(i);if(j){if(!$$CM.isNull(i.EnableDependency)){var h=this._editControls.find(function(k){return k.propertyName==i.EnableDependency},this);c[i.EnableDependency]=h}}},this)}},this);for(var d in c){if(c.hasOwnProperty(d)){this.enableDependencyControlUpdateControls(c[d],null)}}},isValidVersionBranch:function(a){return this._parentControl.isValidVersionBranch(a)},getDataItem:function(m){var e=m.DataType.toLowerCase();var l=m.PropertyName;var d=this._editControls.find(function(i){return i.propertyName==l},this);var n=$A();if($$CM.isFunction(m.DataSource)){n=m.DataSource()}else{n=m.DataSource}switch(e){case"txt":case"txa":return d.GetData();break;case"date":return d.GetData();break;case"number":case"ddl":var j=[];var k=d.GetOptionList();if(k.length>0){for(var h=0;h<k.length;h++){if(k[h].selected==true){j.push(k[h].value)}}if(!$$CM.isNull(m.IsMultiple)&&m.IsMultiple==true){return j}else{return j[0]}}else{if(!$$CM.isNull(m.IsMultiple)&&m.IsMultiple==true){return[]}else{return""}}break;case"yesno":var a=1;buttonControls=d.ChildControls();var r=false;n.each(function(t){var i=buttonControls.find(function(u){return u.buttonListCounter==a},this);if(i.GetData()){if(i.GetValue()=="true"||i.GetValue()=="1"){r=true}}a++},this);return r;break;case"radiolist":var a=1;buttonControls=d.ChildControls();var o=0;n.each(function(t){var i=buttonControls.find(function(u){return u.buttonListCounter==a},this);if(i.GetData()){o=i.GetValue()}a++},this);return o;break;case"checkboxlist":var j=[];var a=1;buttonControls=d.ChildControls();n.each(function(t){var i=buttonControls.find(function(u){return u.buttonListCounter==a},this);if(i.GetData()){j.push(i.GetValue())}a++},this);if(!$$CM.isNull(m.BooleanValue)&&m.BooleanValue==true){if(j.length>0){return Boolean(Number(j[0]))}else{return false}}else{return j}break;case"lbl":return 0;break;case"lblDate":var c=new $$CMDATE();c.bindFromDate(new Date());return c.getDate();break;case"address":return d.GetData();break;case"time":var q=new $$CMDATE();q.bindFromDate(new Date());var f=q._utcData.YYYY+"-"+q._utcData.MM+"-"+q._utcData.DD+"T"+d.GetData();var g=new Date(f);var b=new $$CMDATE();b.bindFromDate(g);var p=b.getData();return p;break;case"file":return d.GetData();break}},GetData:function(){var c=this.GetBoundData();var a=this.GetConfigOptions();var b=new Object();if(!$$CM.isNull(c)&&c.ID>0){b=$$CM.deepClone(c)}else{b.ID=0;b.DefinitionEntityID=parseInt(a.definitionEntityID)}b.DefinitionID=parseInt(b.ID);a.columnArray.each(function(d){if(!$$CM.isNull(d.PropertyArray)){d.PropertyArray.each(function(h){var i=this.isValidVersionBranch(h);if(i){var g=h.PropertyName;var f=h.DataType.toLowerCase();if(f=="timestamp"){}else{if(f=="updated"){var e=new $$CMDATE();e.bindFromDate(new Date());b.UpdatedDateAsString=e.getDate();b.UpdatedBy=cm.User.FullName}else{b[g]=this.getDataItem(h)}}}},this)}},this);return b}});"cm.ui.common".namespace();cm.ui.common.DefinitionPanel=Class.create(cm.ui.ComplexControl,{_dataSourceList:null,initializeUIElements:function(){var b=$$P.p();this.AddChild(b);b.AddClassName("cmHeaderSmall p0px m0px cmLightGray");b.UpdateInnerHtml("Definitions");var a=$$P.div();a.AddClassName("cmSideNav w150px cmFloatLeft mt0px");this.AddChild(a);var c=this.GetConfigOptions().panelObjectList;c.each(function(f){var e=$$P.div();e.AddClassName("");a.AddChild(e);var d=new $$BTN("btn"+f.PropertyName,{text:f.ButtonName});d.panelObject=f;e.AddChild(d);d.AddClassName("cmDefinitionButton mb5px");d.ClickEvent.subscribe(this.onPanelButtonClick,this)},this);this._cmDivModals=$$P.div("divModals");this.AddChild(this._cmDivModals);this._definitionModal=new cm.ui.dialog.ModalDialog("DefinitionModal",{dialogClass:"cmEditDialog",showCloseButton:false});this._cmDivModals.AddChild(this._definitionModal);this._definitionModalControl=new cm.ui.common.DefinitionModalControl("DefinitionModalControl",{controller:this.GetConfigOptions().controller,panelContainer:this.GetConfigOptions().panelContainer,definitionModal:this._definitionModal});this._definitionModal.AddChild(this._definitionModalControl)},onPanelButtonClick:function(e,a){var d=e.panelObject;var b=d.LaunchConfirmMethod;var c=d.LaunchConfirmMethodScope;if(!$$CM.isNull(b)&&!$$CM.isNull(c)){var a={};a.PanelObject=d;a.CallbackFuntion=this.onPanelLaunch;a.CallbackScope=this;b.call(c,a)}else{this.onPanelLaunch(d)}},onPanelLaunch:function(a){if(a.DefinitionType==1){this._definitionModalControl.Bind(a);this._definitionModal.Show()}}});"cm.ui.common".namespace();cm.ui.common.DialogControl=Class.create(cm.ui.ComplexControl,{SaveEvent:null,CancelEvent:null,initializeUIElements:function($super){$super();this._cmDivControlFooter=$$P.div("ft");this.AddChild(this._cmDivControlFooter);this._cmDivControlFooter.AddClassName("ft");this._btnSave=new $$BTN(null,{text:"Save"});this._cmDivControlFooter.AddChild(this._btnSave);this._btnSave.AddClassName("cmFloatRight cmGoButton");this._btnCancel=new $$BTN(null,{text:"Cancel"});this._cmDivControlFooter.AddChild(this._btnCancel);this._btnCancel.AddClassName("cmCancelDeleteButton")},createEvents:function(){this.SaveEvent=new cm.event();this.CancelEvent=new cm.event()},wireEvents:function($super){$super();this._btnSave.ClickEvent.subscribe(this.onBtnSaveClick,this);this._btnCancel.ClickEvent.subscribe(this.onBtnCancel,this)},onBtnSaveClick:function(){this.SaveEvent.fire(this,null)},onBtnCancel:function(){this.CancelEvent.fire(this,null)}});"cm.ui.common".namespace();cm.ui.common.DropDownMenu=Class.create(cm.ui.Control,{_dataSourceList:null,_menuStates:{},_divDropDownMenuArray:{},_selected:false,_tabStyle:false,_menuObjectID:null,MenuItemClicked:null,createEvents:function($super){$super();this.MenuItemClicked=new cm.event()},wireEvents:function($super){$super()},getMenuCount:function(){var a=0;for(var b in this._divDropDownMenuArray){a++}return a},BindMenu:function(g){this._menuObjectID=g.ID;var f="";var e=false;if(!$$CM.isNull(g.LeftPlacement)&&g.LeftPlacement==true){e=true;f="Left"}this._tabStyle=false;if(!$$CM.isNull(g.TabStyle)&&g.TabStyle==true){this._tabStyle=true}var a=$$P.div("divMenu_"+g.ID);this.AddChild(a);a.AddClassName("cmDropDownMenuControl"+f);if(!e){a.AssignStyle("right",g.Right+"px")}var c=$$P.div("divMenuHeader_"+g.ID);a.AddChild(c);c.AddClassName("divMenuHeader");c.UpdateInnerHtml(g.Name);if(Number(g.WidthHeader)>0){c.SetWidth(g.WidthHeader)}var b=$$P.div("divMenuBody_"+g.ID);this.AddChild(b);b.AddClassName("cmDropDownMenuControlBody");b.SetWidth(200);if(!e){if(g.Allignment=="left"){b.AssignStyle("right",(g.Right-(200-g.WidthHeader)+4)+"px")}else{b.AssignStyle("right",(g.Right+3)+"px")}}divDropDownMenu=$$P.div("divDropDownMenu_"+g.ID);b.AddChild(divDropDownMenu);divDropDownMenu.AddClassName("divDropDownMenu");divDropDownMenu.SetWidth(200);divDropDownMenu.Hide();var d=1;g.MenuArray.each(function(h){var i=new cm.ui.common.DropDownMenuItem("menuItem_"+h.ID);i.BindMenuItem(g,h);i.SetWidth(180);i.MenuItemClicked.subscribe(this.onMenuItemClick,this);if(h.IncludeMenuDivider==true){d+=1}d+=24},this);this._menuStates[g.ID]={isOpen:false,isOver:false,isHeaderOver:false,height:d};this._divDropDownMenuArray[g.ID]=divDropDownMenu;c.AddMouseOverListener({id:g.ID});c.MouseOverEvent.subscribe(this.onMenuHeaderMouseOverEvent,this);c.AddMouseOutListener({id:g.ID});c.MouseOutEvent.subscribe(this.onMenuHeaderMouseOutEvent,this);c.AddClickListener({id:g.ID});c.ClickEvent.subscribe(this.onMenuHeaderClickEvent,this);divDropDownMenu.AddMouseOverListener({id:g.ID});divDropDownMenu.MouseOverEvent.subscribe(this.onMenuMouseOverEvent,this);divDropDownMenu.AddMouseOutListener({id:g.ID});divDropDownMenu.MouseOutEvent.subscribe(this.onMenuMouseOutEvent,this)},SelectMenu:function(b,a){this._selected=b;if(a){this.showMenu(this._menuObjectID)}},onMenuItemClick:function(e,a){var d=this;var c=a.menuID;this._menuStates[c].isOver=false;this._divDropDownMenuArray[c].Hide();var b=jQuery($$E(this._divDropDownMenuArray[c]));b.height(0);setTimeout(function(){d.MenuItemClicked.fire(d,a)},10)},onMenuHeaderMouseOverEvent:function(c,a){var b=a.id;this._menuStates[b].isHeaderOver=true;this.showMenu(b)},onMenuHeaderMouseOutEvent:function(c,a){var b=a.id;this._menuStates[b].isHeaderOver=false;this.hideMenu(b)},onMenuHeaderClickEvent:function(c,a){var b=a.id;this._selected=true;this.showMenu(b)},onMenuMouseOverEvent:function(c,a){var b=a.id;this._menuStates[b].isOver=true},onMenuMouseOutEvent:function(c,a){var b=a.id;this._menuStates[b].isOver=false;this.hideMenu(b)},showMenu:function(a){var b=this;if(!this._tabStyle||(this._tabStyle&&this._selected)){setTimeout(function(){var c=jQuery($$E(b._divDropDownMenuArray[a]));if(b._menuStates[a].isOpen==false){for(var e in b._menuStates){if(b._menuStates[e].hasOwnProperty()==true){if(b._menuStates[e].isOpen==true){toggleMenu(e)}}}b._menuStates[a].isOpen=true;var d=jQuery("#divMenuHeader_"+a);if(!b._tabStyle){d.addClass("selected")}b._divDropDownMenuArray[a].Show();c.animate({height:b._menuStates[a].height},200,function(){})}},205)}},hideMenu:function(a){var b=this;setTimeout(function(){if(b._menuStates[a].isOpen==true&&b._menuStates[a].isOver==false){var c=jQuery($$E(b._divDropDownMenuArray[a]));if(b._menuStates[a].isHeaderOver==false){c.animate({height:0},200,function(){b._divDropDownMenuArray[a].Hide();b._menuStates[a].isOpen=false;var d=jQuery("#divMenuHeader_"+a);if(!b._tabStyle){d.removeClass("selected")}})}}},205)},toggleMenu:function(d){var e=this;if(this._menuStates[d].isOpen==true){var a=jQuery($$E(this._divDropDownMenuArray[d]));this._divDropDownMenuArray[d].Hide();this._menuStates[d].isOpen=false;var b=jQuery("#divMenuHeader_"+d);if(!this._tabStyle){b.removeClass("selected")}}else{for(var c in this._menuStates){if(this._menuStates[c].hasOwnProperty()==true){if(this._menuStates[c].isOpen==true){toggleMenu(c)}}}var a=jQuery($$E(this._divDropDownMenuArray[d]));var b=jQuery("#divMenuHeader_"+d);if(!this._tabStyle){b.addClass("selected")}this._divDropDownMenuArray[d].Show();a.height(this._menuStates[d].height);this._menuStates[d].isOpen=true}}});"cm.ui.common".namespace();cm.ui.common.DropDownMenuItem=Class.create(cm.ui.Control,{MenuItemClicked:null,createEvents:function($super){$super();this.MenuItemClicked=new cm.event()},wireEvents:function($super){$super()},BindMenuItem:function(c,b){var a=$$P.div("divMenuItem_"+b.ID);divDropDownMenu.AddChild(a);a.AddClassName("divMenuItem cmClear");a.SetWidth(200);a.UpdateInnerHtml(b.Name);a.AddClickListener({menuID:c.ID,menuItemID:b.ID});a.ClickEvent.subscribe(this.onMenuItemClick,this);if(b.IncludeMenuDivider==true){a.AddClassName("divMenuItemDivider")}},onMenuItemClick:function(b,a){this.MenuItemClicked.fire(this,a)}});"cm.ui.common".namespace();cm.ui.common.DroppableConfigOptions=Class.create(cm.ConfigOptions,{active:true,hoverClass:""});cm.ui.common.Droppable=Class.create(cm.ui.UILibraryControl,{DropEvent:null,createEvents:function(){this.DropEvent=new cm.event()},postAppendTo:function(){this.SetActive(this.GetConfigOptions().active)},configureDefaultOptions:function(){return new cm.ui.common.DroppableConfigOptions()},SetActive:function(c){var b=this;var a=this.GetConfigOptions();this.getLibraryElement().unbind("drop");if(c==true){this.getLibraryElement().droppable(a);this.getLibraryElement().bind("drop",function(d,f){if(d.target==b.GetHtmlElement()){var e=f.draggable[0].dragItem;b.DropEvent.fire(b,e)}})}}});"cm.ui.common".namespace();cm.ui.common.EntityAddressConfigOptions=Class.create(cm.ConfigOptions,{disableAddressEntity:false,disableAddressType:false});cm.ui.common.EntityAddress=Class.create(cm.ui.ComplexControl,{CancelEvent:null,SaveEvent:null,configureDefaultOptions:function(){return new cm.ui.common.EntityAddressConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._addressEntityArray=$A();if($$CM.isArray(this._co.addressEntityArray)){this._addressEntityArray=this._co.addressEntityArray}this._enumAddressType=cm.dao.Lists.Enums.AddressType.asEnum();this._enumAddressEntityType=cm.dao.Lists.Enums.AddressEntityType.asEnum();this._enumEntityTypeFlag=cm.dao.Lists.Enums.EntityTypeFlag.asEnum();this._addressTypeArray=$A();if($$CM.isArray(this._co.addressTypeArray)){this._addressTypeArray=this._co.addressTypeArray}else{if(!$$CM.isNull(cm.dao.Lists.Enums.AddressType)){cm.dao.Lists.Enums.AddressType.toArray().each(function(a){if(a.ID>0){this._addressTypeArray.push(a)}},this)}}},initializeUIElements:function(){this._divBody=$$P.div("divBody_"+this._uniqueID);this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._divHeader=$$P.div("divHeader_"+this._uniqueID);this._divBody.AddChild(this._divHeader);this._divHeader.AddClassName("mtb10px");this._divHeader.Hide();this._divAddressEntity=$$P.div("divAddressEntity_"+this._uniqueID);this._divBody.AddChild(this._divAddressEntity);this._divAddressEntity.AddClassName("ldp mb5px");if(this._co.disableAddressEntity==true){this._divAddressEntity.Hide()}this._fddlAddressEntity=new $$FDDL("fddlAddressEntity_"+this._uniqueID,{label:"Address For:",isRequired:true});this._divAddressEntity.AddChild(this._fddlAddressEntity);this._fddlAddressEntity.AddClassName("cmFloatLeft w100prct");this._fddlAddressEntity.GetTitleControl().AddClassName("w105px");this._fddlAddressEntity.GetInputControl().AddClassName("w390px");this._fddlAddressEntity.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Address For",IsRequired:true}));this._fddlAddressEntity.SetTabIndex(1021);this._divAddressType=$$P.div("divAddressType_"+this._uniqueID);this._divBody.AddChild(this._divAddressType);this._divAddressType.AddClassName("ldp mb5px");if(this._co.disableAddressType==true){this._divAddressType.Hide()}this._fddlAddressType=new $$FDDL("fddlAddressType_"+this._uniqueID,{label:"Address Type:",isRequired:true});this._divAddressType.AddChild(this._fddlAddressType);this._fddlAddressType.AddClassName("cmFloatLeft w100prct");this._fddlAddressType.GetTitleControl().AddClassName("w105px");this._fddlAddressType.GetInputControl().AddClassName("w390px");this._fddlAddressType.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Address Type:",IsRequired:true}));this._fddlAddressType.bindList(this._addressTypeArray);this._fddlAddressType.SetTabIndex(1022);this._divAddressLabel=$$P.div("divAddressLabel_"+this._uniqueID);this._divBody.AddChild(this._divAddressLabel);this._divAddressLabel.AddClassName("ldp mb5px");this._divAddressLabel.Hide();this._ftxtAddressLabel=new $$FTXT("ftxtAddressLabel_"+this._uniqueID,{label:"Address Label:",isRequired:true,maxLength:30});this._divAddressLabel.AddChild(this._ftxtAddressLabel);this._ftxtAddressLabel.AddClassName("cmFloatLeft w100prct");this._ftxtAddressLabel.GetTitleControl().AddClassName("w105px");this._ftxtAddressLabel.GetInputControl().AddClassName("w385px");this._ftxtAddressLabel.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Address Label",IsRequired:true}));this._ftxtAddressLabel.SetTabIndex(1023);var a={enabled:true,legendLabel:"",legendCssClass:"",groupFieldName:"",required:true,defaultCountry:$$CLIENT.Country,initialTabIndex:1024};this._ctrAddress=new $$FADDRESS("ctrAddress_"+this._uniqueID,a);this._divBody.AddChild(this._ctrAddress);this._ctrAddress.AddClassName("mtb10px");this._divFooter=$$P.div("divFooter_"+this._uniqueID);this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnSave=new $$BTN("btnSave_"+this._uniqueID,{text:"Save"});this._divFooter.AddChild(this._btnSave);this._btnSave.AddClassName("cmGoButton cmFloatRight mr0px");this._btnSave.SetTabIndex(1051);this._btnDelete=new $$BTN("btnDelete_"+this._uniqueID,{text:"Delete"});this._divFooter.AddChild(this._btnDelete);this._btnDelete.AddClassName("cmCancelDeleteButton cmFloatRight mr0px");this._btnDelete.Hide();this._btnDelete.SetTabIndex(1052);this._btnCancel=new $$BTN("btnCancel_"+this._uniqueID,{text:"Cancel"});this._divFooter.AddChild(this._btnCancel);this._btnCancel.AddClassName("cmCancelDeleteButton ml0px");this._btnCancel.SetTabIndex(1053)},postInitialize:function($super){$super();this.BindStaticLists()},createEvents:function($super){$super();this.CancelEvent=new cm.event();this.SaveEvent=new cm.event()},wireEvents:function($super){$super();this._fddlAddressEntity.ChangeEvent.subscribe(this.onAddressEntityChange,this);this._fddlAddressType.ChangeEvent.subscribe(this.onAddressTypeChange,this);this._btnCancel.ClickEvent.subscribe(this.onCancel,this);this._btnSave.ClickEvent.subscribe(this.onSave,this)},onCancel:function(b,a){this.CancelEvent.fire(this,{})},onSave:function(c,a){if(this.IsValid(false)){var b=this.GetData();this.SaveEvent.fire(this,{data:b})}},BindStaticLists:function(a){if(!$$CM.isNull(a)){if($$CM.isArray(a.addressEntityArray)){this._addressEntityArray=a.addressEntityArray}if($$CM.isArray(a.addressTypeArray)){this._addressTypeArray=a.addressTypeArray}}this._fddlAddressEntity.bindList(this._addressEntityArray)},onAddressEntityChange:function(b,a){this.toggleAddressType()},onAddressTypeChange:function(b,a){this.toggleAddressLabel()},toggleAddressType:function(){var d=this.GetBoundData();var g=this._masterEntityAddressList;var c=false;var h=false;if($$CM.isArray(g)){var e=g.find(function(i){return i.TypeID==this._enumEntityTypeFlag.GetId("Person")&&i.AddressTypeID==this._enumAddressType.GetId("Business")},this);if(!$$CM.isNull(e)){c=true}var e=g.find(function(i){return i.TypeID==this._enumEntityTypeFlag.GetId("Person")&&i.AddressTypeID==this._enumAddressType.GetId("School")},this);if(!$$CM.isNull(e)){h=true}}var b=$A();if(this._co.disableAddressEntity!=true){var f=this._fddlAddressEntity.GetData();var a=0;if($$CM.isInteger(f)){a=Number(f)}switch(a){case this._enumAddressEntityType.GetId("family"):case this._enumAddressEntityType.GetId("family1"):case this._enumAddressEntityType.GetId("family2"):b.push({ID:this._enumAddressType.GetId("Other"),Name:"Other"});break;case this._enumAddressEntityType.GetId("person"):case this._enumAddressEntityType.GetId("parent"):case this._enumAddressEntityType.GetId("camper"):case this._enumAddressEntityType.GetId("parent1"):case this._enumAddressEntityType.GetId("parent2"):if(!c||(!$$CM.isNull(d)&&d.AddressTypeID==this._enumAddressType.GetId("Business"))){b.push({ID:this._enumAddressType.GetId("Business"),Name:"Business"})}if(!h||(!$$CM.isNull(d)&&d.AddressTypeID==this._enumAddressType.GetId("School"))){b.push({ID:this._enumAddressType.GetId("School"),Name:"School"})}b.push({ID:this._enumAddressType.GetId("Other"),Name:"Other"});break;default:b.push({ID:this._enumAddressType.GetId("Other"),Name:"Other"});break}}else{if(!c||(!$$CM.isNull(d)&&d.AddressTypeID==this._enumAddressType.GetId("Business"))){b.push({ID:this._enumAddressType.GetId("Business"),Name:"Business"})}if(!h||(!$$CM.isNull(d)&&d.AddressTypeID==this._enumAddressType.GetId("School"))){b.push({ID:this._enumAddressType.GetId("School"),Name:"School"})}b.push({ID:this._enumAddressType.GetId("Other"),Name:"Other"})}this._fddlAddressType.bindList(b);if(!$$CM.isNull(d)&&d.AddressTypeID>0){if(d.AddressTypeID>0){this._fddlAddressType.Bind(d.AddressTypeID)}}this.toggleAddressLabel()},toggleAddressLabel:function(){var b=this._fddlAddressType.GetData();var a=0;if($$CM.isInteger(b)){a=Number(b)}switch(a){case this._enumAddressType.GetId("Other"):this._divAddressLabel.Show();break;default:this._divAddressLabel.Hide();break}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fddlAddressEntity.Bind();this._fddlAddressType.Bind();this._ftxtAddressLabel.Bind();this._ctrAddress.Bind()},SetMasterEntityAddressList:function(a){this._masterEntityAddressList=a},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();this._originalData=$$CM.deepClone(b);if(!$$CM.isNull(b)){if($$CM.isInteger(b.AddressEntityTypeID)){this._fddlAddressEntity.Bind(b.AddressEntityTypeID)}else{var a=this._addressEntityArray.find(function(c){return c.EntityID==b.EntityID},this);if(!$$CM.isNull(a)){if(a.EntityTypeID==1){b.AddressEntityTypeID=this._enumAddressEntityType.GetId("parent1")}if(a.EntityTypeID==2){b.AddressEntityTypeID=this._enumAddressEntityType.GetId("family1")}this._fddlAddressEntity.Bind(b.AddressEntityTypeID)}}if($$CM.isInteger(b.AddressTypeID)){this._fddlAddressType.Bind(b.AddressTypeID)}if(!$$CM.isNull(b.Address)){this._ctrAddress.Bind(b.Address)}if(!$$CM.isNull(b.Label)){this._ftxtAddressLabel.Bind(b.Label)}if(b.TypeID==this._enumEntityTypeFlag.GetId("family")){this._fddlAddressType.Hide()}else{this._fddlAddressType.Show()}}this.toggleAddressType()},GetData:function(){var d=this.GetBoundData();if($$CM.isNull(d)){d=new Object()}if($$E(this._divAddressEntity).visible()&&this._co.disableAddressEntity!=true){var b=Number(this._fddlAddressEntity.GetData());if(!$$CM.isInteger(b)&&b>=0){b=0}var e=0;var f=0;var a=this._addressEntityArray.find(function(g){return g.ID==b},this);if(!$$CM.isNull(a)){e=a.EntityID;f=a.EntityTypeID}d.AddressEntityTypeID=Number(b);d.EntityID=Number(e);d.TypeID=Number(f)}if($$E(this._divAddressType).visible()&&$$E(this._fddlAddressType).visible()&&this._co.disableAddressType!=true){var c=Number(this._fddlAddressType.GetData());if(!$$CM.isInteger(c)&&c>=0){c=0}d.AddressTypeID=Number(c)}if($$E(this._divAddressLabel).visible()){d.Label=this._ftxtAddressLabel.GetData()}else{}d.Address=this._ctrAddress.GetData();d.HasChanges=true;return d}});"cm.ui.common".namespace();$$EFS=cm.ui.common.ExpandableFieldset=Class.create(cm.ui.ComplexControl,{initializeData:function($super){$super();this._co=this.GetConfigOptions();this._cssClass="cmGroupBorder w900px mt10px";if(!$$CM.isEmpty(this._co.cssClass)){this._cssClass=this._co.cssClass}this._legendLabel="";if(!$$CM.isEmpty(this._co.legendLabel)){this._legendLabel=this._co.legendLabel}this._legendCssClass="";if(!$$CM.isEmpty(this._co.legendCssClass)){this._legendCssClass=this._co.legendCssClass}this._collapsable=this._co.collapsable;this._collapsed=this._co.collapsed},render:function($super){$super();this._fsWrapper=new $$FS2(this._id,{cssClass:this._cssClass,legendLabel:this._legendLabel,legendCssClass:this._legendCssClass,collapsable:this._collapsable,collapsed:this._collapsed});if(this._collapsable){this._fsWrapper.AddClassName("collapsable");this._ctrIcon=$$P.div(this._id+"_Icon");this._fsWrapper.GetLegendControl().AddChild(this._ctrIcon);this._ctrIcon.AddClassName("icon")}return $$E(this._fsWrapper)},initializeUIElements:function($super){$super();this._divWrapper=$$P.div(this._id+"_Wrapper");this.AddChild(this._divWrapper)},postInitialize:function($super){$super();if(this._collapsable){this.collapseContent()}},createEvents:function($super){$super();if(this._collapsable){this._fsWrapper.GetLegendControl().AddClickListener()}},wireEvents:function($super){$super();if(this._collapsable){this._fsWrapper.GetLegendControl().ClickEvent.subscribe(this.onCollapse,this)}},onCollapse:function(b,a){this._collapsed=!this._collapsed;this.collapseContent()},collapseContent:function(){this._fsWrapper.RemoveClassName("expanded");if(this._collapsed==true){this._divWrapper.Hide()}else{this._fsWrapper.AddClassName("expanded");this._divWrapper.Show()}},GetWrapper:function(){return this._divWrapper}});"cm.ui.common".namespace();cm.ui.common.ExpandableInfoLeafConfigOptions=Class.create(cm.ConfigOptions,{location:"right",anchor:null,width:190,maxWidth:null,text:"",top:0,left:0,clickAwayClose:true});cm.ui.common.ExpandableInfoLeaf=Class.create(cm.ui.Control,{initializeData:function($super){$super();this._showStatus=1;this._sizeStatus=1;this._helpVideoShowState=1;this._videoURL=""},initializeDAOs:function($super){$super()},initializeUIElements:function(){this._sControl=$$P.span(null,null,{classNames:"helpLeafIconI"});this.AddChild(this._sControl);this._divBubble=$$P.div(this._UID+"_bubble","",{classNames:"infoFeature"});this._infoHeader=$$P.div(this.ID()+"_bubbleHeader","",{classNames:"infoFeatureHeader"});this._divBubble.AddChild(this._infoHeader);this._infoHeaderText=$$P.span(this.ID()+"_bubbleHeaderText","");this._infoHeaderText.UpdateInnerHtml("info ");this._infoHeader.AddChild(this._infoHeaderText);this._infoHeaderPLus=$$P.span(this.ID()+"_plus","");this._infoHeaderPLus.AddClassName("infoPLus");this._infoHeaderPLus.UpdateInnerHtml(" + ");this._infoHeader.AddChild(this._infoHeaderPLus);this._infoHeaderMinus=$$P.span(this.ID()+"_minus","");this._infoHeaderMinus.AddClassName("infoPLus");this._infoHeaderMinus.UpdateInnerHtml(" - ");this._infoHeader.AddChild(this._infoHeaderMinus);this._infoHeaderMinus.Hide();this._infoTextBox=$$P.div(this.ID()+"_bubbleTextBox","",{classNames:"infoFeatureText"});this._divBubble.AddChild(this._infoTextBox);this._infoVideoBox=$$P.div(this.ID()+"_bubbleVideoBox","",{classNames:"infoFeatureVideoBox"});this._infoTextBox.AddChild(this._infoVideoBox);this._infoVideoBox.Hide();this._infoVideo=$$P.div(this.ID()+"_bubbleVideo","",{classNames:"infoFeatureVideoPlayer"});this._infoVideoBox.AddChild(this._infoVideo);this._infoVideo.UpdateInnerHtml('<center><video width="95%" height="auto" controls><source src="" type="video/mp4"></video></center>');this._infoText=$$P.span(this.ID()+"_bubbleText","");this._infoTextBox.AddChild(this._infoText);this._infoLine=$$P.hr(this.ID()+"_bubbleline","");this._infoLine.AddClassName("infoLine");this._infoTextBox.AddChild(this._infoLine);this._helpVideo=$$P.div(this.ID()+"_helpVideo");this._helpVideo.AddClassName("infoFeatureVideo");this._infoTextBox.AddChild(this._helpVideo);this._helpVideo.Hide();this.AssignStyle("display","inline");this.AddChild(this._divBubble);if($$CM.isNull(this.GetConfigOptions().maxWidth)){this._divBubble.AssignStyle("width",this.GetConfigOptions().width+"px")}else{this._divBubble.AssignStyle("max-width",this.GetConfigOptions().maxWidth+"px")}if(this.GetConfigOptions().location=="left"){var a="-"+(30+this.GetConfigOptions().width)+"px";this._divBubble.AssignStyle("margin-left",a)}if(this.GetConfigOptions().location=="top"){var b="-"+$$JQ(this._divBubble).height()+"px";this._divBubble.AssignStyle("margin-top",b)}},createEvents:function(){this._sControl.AddClickListener();this._infoHeaderPLus.AddClickListener();this._infoHeaderMinus.AddClickListener();this._helpVideo.AddClickListener();this.AddClickAwayListener();this.stayOpenEvent=new cm.event()},wireEvents:function(){var a=this;this._sControl.ClickEvent.subscribe(this.onClick,this,true);this._infoHeaderPLus.ClickEvent.subscribe(this.onPlusClick,this,true);this._infoHeaderMinus.ClickEvent.subscribe(this.onMinusClick,this,true);if(this.GetConfigOptions().clickAwayClose){this.ClickAwayEvent.subscribe(this.onClickAway,this)}this._helpVideo.ClickEvent.subscribe(this.onHelpVideo,this)},postInitialize:function(){},configureDefaultOptions:function(){return new cm.ui.common.InfoFeatureConfigOptions()},onHelpVideo:function(){if(this._helpVideoShowState==1){this._infoVideo.UpdateInnerHtml('<center><video width="95%" height="auto" controls><source src='+this._videoURL+' type="video/mp4"></video></center>');this._infoVideoBox.Show();this._infoText.Hide();this._helpVideo.UpdateInnerHtml("X");this._helpVideoShowState=2;this._helpVideoClicked=2}else{var a=this._infoVideo.GetData();this._infoVideo.UpdateInnerHtml(a);this._infoVideoBox.Hide();this._infoText.Show();this._helpVideo.UpdateInnerHtml("");this._helpVideoShowState=1}},onClickAway:function(c,a){var b=this;if(this._showStatus==2){if(this._sizeStatus==1){this._divBubble.Hide();this._infoHeaderMinus.Hide();b._helpVideoShowState=2;b.onHelpVideo()}else{this._divBubble.AssignStyle("width",this.GetConfigOptions().width+"px");this._infoHeader.AssignStyle("font-size","15px");this._infoTextBox.AssignStyle("padding","10px");this._infoText.AssignStyle("font-size","11px");this._infoText.AssignStyle("font-weight","600");this._infoText.AssignStyle("line-height","15px");this._infoLine.AssignStyle("margin","5px 0 5px 0");this._infoHeaderMinus.Hide();setTimeout(function(){b._divBubble.Hide();b._helpVideoShowState=2;b.onHelpVideo()},500)}this._showStatus=1;this._sizeStatus=1;this.stayOpenEvent.fire(this,false)}},onClick:function(b,a){if(this._showStatus==1){this._divBubble.AssignStyle("display","inline");this._showStatus=2;this.stayOpenEvent.fire(this,true);return}else{this.onClickAway();this.stayOpenEvent.fire(this,false)}},onPlusClick:function(b,a){if(this._sizeStatus==1){this._divBubble.AssignStyle("width",this.GetConfigOptions().width+120+"px");this._infoHeader.AssignStyle("font-size","24px");this._infoTextBox.AssignStyle("padding","18px");this._infoText.AssignStyle("font-size","20px");this._infoText.AssignStyle("font-weight","500");this._infoText.AssignStyle("line-height","24px");this._infoLine.AssignStyle("margin","15px 0 15px 0");this._infoHeaderMinus.Show();this._infoHeaderPLus.Show();this._sizeStatus=2}else{this._divBubble.AssignStyle("width",this.GetConfigOptions().width+350+"px");this._infoHeader.AssignStyle("font-size","32px");this._infoTextBox.AssignStyle("padding","25px");this._infoText.AssignStyle("font-size","26px");this._infoText.AssignStyle("font-weight","500");this._infoText.AssignStyle("line-height","28px");this._infoLine.AssignStyle("margin","15px 0 15px 0");this._infoHeaderMinus.Show();this._infoHeaderPLus.Show();this._sizeStatus=3}},onMinusClick:function(b,a){if(this._sizeStatus==4){this._divBubble.AssignStyle("width",this.GetConfigOptions().width+350+"px");this._infoHeader.AssignStyle("font-size","32px");this._infoTextBox.AssignStyle("padding","25px");this._infoText.AssignStyle("font-size","20px");this._infoText.AssignStyle("font-weight","500");this._infoText.AssignStyle("line-height","28px");this._infoLine.AssignStyle("margin","15px 0 15px 0");this._infoHeaderMinus.Show();this._infoHeaderPLus.Show();this._sizeStatus=3}else{if(this._sizeStatus==3){this._divBubble.AssignStyle("width",this.GetConfigOptions().width+120+"px");this._infoHeader.AssignStyle("font-size","24px");this._infoTextBox.AssignStyle("padding","18px");this._infoText.AssignStyle("font-size","20px");this._infoText.AssignStyle("font-weight","500");this._infoText.AssignStyle("line-height","24px");this._infoLine.AssignStyle("margin","15px 0 15px 0");this._infoHeaderMinus.Show();this._infoHeaderPLus.Show();this._sizeStatus=2}else{this._divBubble.AssignStyle("width",this.GetConfigOptions().width+"px");this._infoHeader.AssignStyle("font-size","15px");this._infoTextBox.AssignStyle("padding","10px");this._infoText.AssignStyle("font-size","11px");this._infoText.AssignStyle("font-weight","600");this._infoText.AssignStyle("line-height","15px");this._infoLine.AssignStyle("margin","5px 0 5px 0");this._infoHeaderPLus.Show();this._infoHeaderMinus.Hide();this._sizeStatus=1}}},clear:function(){this.onClickAway();this._infoText.UpdateInnerHtml("");this._helpVideo.Hide();this._infoVideo.UpdateInnerHtml('<iframe class="infoFeatureIframeVideo" src="" allowfullscreen></iframe>');this._infoVideoBox.Hide();this._helpVideo.UpdateInnerHtml("");this._helpVideoShowState=1},Bind:function(a){if($$CM.isNull(a)){return}if(!$$CM.isNull(a.HelpText)){this._infoText.UpdateInnerHtml(a.HelpText);this._infoText.Show()}if(!$$CM.isNull(a.VideoURL)){this._videoURL=a.VideoURL;this._helpVideo.Show()}}});"cm.ui.common".namespace();cm.ui.common.FileUploadControl2ConfigOptions=Class.create(cm.ConfigOptions,{urlSubmit:"/ui/media/AlternateImageUpload",height:80,width:300,fileTypes:["jpg","jpeg","png","gif","bmp"],autoUpload:false});cm.ui.common.FileUploadControl2=Class.create(cm.ui.ComplexControl,{_formSubmitted:false,configureDefaultOptions:function(){return new cm.ui.common.FileUploadControl2ConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._inline=false;if(!$$CM.isEmpty(this._co.inline)){this._inline=this._co.inline}this._fileInputCssClass="mr5px";if(!$$CM.isEmpty(this._co.fileInputCssClass)){this._fileInputCssClass=this._co.fileInputCssClass}this._uploadButtonLabel="Upload";if(!$$CM.isEmpty(this._co.uploadButtonLabel)){this._uploadButtonLabel=this._co.uploadButtonLabel}this._uploadButtonCssClass="";if(!$$CM.isEmpty(this._co.uploadButtonCssClass)){this._uploadButtonCssClass=this._co.uploadButtonCssClass}},initializeUIElements:function(){var a=this.GetConfigOptions();this._iFrameName=this.ID()+"_iframe";this._iFrame=$$P.iframe(this._iFrameName);this._iFrame.SetAttribute("name",this._iFrameName);this._iFrame.Hide();jQuery("body")[0].appendChild(this._iFrame.GetHtmlElement());this._form=$$P.frm(this.ID()+"_form");this.AddChild(this._form);this._form.SetAttribute("action",a.urlSubmit);this._form.SetAttribute("method","post");this._form.SetAttribute("enctype","multipart/form-data");this._form.SetAttribute("target",this._iFrameName);this.addFormElements();this._loadingMessage=$$P.p(this.ID()+"_loadMsg","Uploading. Please wait.");this.AddChild(this._loadingMessage);this._loadingMessage.Hide()},addFormElements:function(){var a=this.GetConfigOptions();this._fileInput=$$P.fl(this.ID()+"_fileInput");this._form.AddChild(this._fileInput);this._fileInput.SetAttribute("name","fileUpload");if(this._co.autoUpload){this._fileInput.SetAttribute("onChange","this.form.submit()")}this._fileInput.SetWidth(a.width);if(!$$CM.isEmpty(this._fileInputCssClass)){this._fileInput.AddClassName(this._fileInputCssClass)}if(this._inline!=true){this._form.AddChild($$P.br())}this._submitBtn=new $$BTN("submitBtn",{text:this._uploadButtonLabel});this._form.AddChild(this._submitBtn);if(!$$CM.isEmpty(this._uploadButtonCssClass)){this._submitBtn.AddClassName(this._uploadButtonCssClass)}this._submitBtn.Hide();this.createFormEvents();this.wireFormEvents()},postInitialize:function(){},createEvents:function($super){$super();this.FileUploadCompleteEvent=new cm.event();this.FileUploadErrorEvent=new cm.event();this.SubmitEvent=new cm.event();this._iFrame.AddLoadListener()},createFormEvents:function(){this._fileInput.AddChangeListener()},wireEvents:function($super){$super();this._iFrame.OnLoadEvent.subscribe(this.onIFrameLoaded,this)},wireFormEvents:function(){this._fileInput.ChangeEvent.subscribe(this.fileInput_change,this);this._submitBtn.ClickEvent.subscribe(this.submitBtn_click,this)},fileInput_change:function(){var a=$$E(this._fileInput).value;if($$CM.isEmpty(a)){this._submitBtn.Hide()}else{if(this._co.autoUpload){this.submitBtn_click()}else{if(this.fileTypeAccepted(a)==true){this._submitBtn.Show()}}}},fileTypeAccepted:function(e){var b=this.GetConfigOptions();var f=b.fileTypes;if($$CM.isArray(f)){var g=e.lastIndexOf(".");var d=e.substring(g+1,e.length).toLowerCase();var h=$A(f).find(function(i){return d==i.toLowerCase()},this);if($$CM.isNull(h)){var a=f.join(", ");var c={title:"File Type Error",header:"File Type Not Accepted",message:"Accepted files types include: "+a,width:350};$$CMD.Alert(c);this._submitBtn.Hide();return false}}return true},submitBtn_click:function(){this._formSubmitted=true;this._form.Hide();this._loadingMessage.Show();this.SubmitEvent.fire()},onIFrameLoaded:function(){if(this._formSubmitted!=true){return}var l=null;try{var i=jQuery($$E(this._iFrame)).contents();var h=i.find("body")[0];var c=h;do{c=c.children[0]}while(c.childElementCount>0);var m=c.innerHTML;l=JSON.parse(m)}catch(b){}if(typeof(l)=="object"&&!$$CM.isNull(l)){l.data=JSON.parse(l.data);var f=l.data.fileName;var g=l.data.fileUrl;var k=l.data.imageWidth;var j=l.data.imageHeight;var d=l.error||l.data.error;if(!$$CM.isEmpty(d)){d=d.urlDecode();var a={title:"Error",header:"Error Uploading File",message:d,scope:this,handlerOk:this.fileUploadError};$$CMD.Alert(a)}else{if($$CM.isEmpty(f)){var a={title:"Error",header:"File Could Not Be Uploaded",scope:this,handlerOk:this.fileUploadError};$$CMD.Alert(a)}else{this.FileUploadCompleteEvent.fire(this,{fileName:f,fileUrl:g,imageWidth:k,imageHeight:j,data:l.data})}}}else{var a={title:"Error",header:"Error Uploading File",message:d,scope:this,handlerOk:this.fileUploadError};$$CMD.Alert(a)}this.Reset()},fileUploadError:function(){this.FileUploadErrorEvent.fire(this,{});this.Reset()},onDataUpdated:function(){var a=this.GetBoundData();var b="Upload";if(!$$CM.isEmpty(a.uploadButtonName)){b=a.uploadButtonName}this._submitBtn.Bind(b);var c="Uploading. Please wait.";if(!$$CM.isEmpty(a.uploadMessage)){c=a.uploadMessage}this._loadingMessage.Bind(c)},Reset:function(){this._form.DestroyChildControls();this.addFormElements();this._formSubmitted=false;this._form.Show();this._loadingMessage.Hide()}});"cm.ui.common".namespace();cm.ui.common.FileUploadControlHTML5ConfigOptions=Class.create(cm.ConfigOptions,{fileTypes:["jpg","jpeg","png","gif","bmp"]});cm.ui.common.FileUploadControlHTML5=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.FileUploadControlHTML5ConfigOptions()},initializeDAOs:function(){this._mediaDAO=new cm.dao.Media.DAO()},initializeUIElements:function(){this._fileInput=$$P.fl(this.ID()+"_fileInput");this.AddChild(this._fileInput);this.createFormEvents();this.wireFormEvents()},createEvents:function($super){$super();this.FileUploadCompleteEvent=new cm.event();this.FileUploadErrorEvent=new cm.event()},createFormEvents:function($super){this._fileInput.AddChangeListener()},wireEvents:function(){this._mediaDAO.TempFileUploaded.subscribe(this.onFileUploaded,this)},wireFormEvents:function(){this._fileInput.ChangeEvent.subscribe(this.onFileSelected,this)},getFileSelected:function(){var a=jQuery("#"+this._fileInput.ID()).get(0).files[0];return a},onFileSelected:function(){var a=this.getFileSelected();if(this.fileTypeAccepted(a.name)){this.FileUpload(a)}},fileTypeAccepted:function(e){var b=this.GetConfigOptions();var f=b.fileTypes;if($$CM.isArray(f)){var g=e.lastIndexOf(".");var d=e.substring(g+1,e.length).toLowerCase();var h=$A(f).find(function(i){return d==i.toLowerCase()},this);if($$CM.isNull(h)){var a=f.join(", ");var c={title:"File Type Error",header:"File Type Not Accepted",message:"Accepted files types include: "+a,width:350};$$CMD.Alert(c);this._submitBtn.Hide();return false}}return true},Reset:function(){this.DestroyChildControls();this.initializeUIElements()},FileUpload:function(a){var b=this;var c=new FileReader();c.onload=function(d){var e=$A(new Uint8Array(d.target.result));b._mediaDAO.TempFileUpload(e);b.Reset()};c.readAsArrayBuffer(a)},onFileUploaded:function(c,a){var b={error:a.data.error,fileName:a.data.fileName};if(b.error){this.onFileUploadError(c,b)}else{this.onFileUploadComplete(c,b)}},onFileUploadComplete:function(b,a){this.FileUploadCompleteEvent.fire(this,a)},onFileUploadError:function(){this.FileUploadErrorEvent.fire(this,{})},BrowserIsFeatureCompatible:function(){try{var b=new FileReader();if(!b.readAsArrayBuffer){return false}if(!Uint8Array){return false}try{if(!"files" in DataTransfer.prototype){return false}}catch(a){}}catch(a){return false}return true}});"cm.ui.common".namespace();cm.ui.common.FileUploadWrapperControlConfigOptions=Class.create(cm.ConfigOptions,{urlSubmit:"/ui/media/AlternateImageUpload",height:80,width:300,fileTypes:["jpg","jpeg","png","gif","bmp"]});cm.ui.common.FileUploadWrapperControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.FileUploadWrapperControlConfigOptions()},createEvents:function($super){$super();this.FileUploadCompleteEvent=new cm.event();this.FileUploadErrorEvent=new cm.event()},initializeUIElements:function(){var a=this.GetConfigOptions();var e=a.urlSubmit;var c=a.height;var f=a.width;var b=a.fileTypes;var d=this.ID();this._fileUploadControl=new cm.ui.common.FileUploadControl2(d+"_FileUploadControl",{urlSubmit:e,height:c,width:f,fileTypes:b});this.AddChild(this._fileUploadControl)},wireEvents:function($super){$super();this._fileUploadControl.FileUploadCompleteEvent.subscribe(this.onFileUploadCompleteEvent,this);this._fileUploadControl.FileUploadErrorEvent.subscribe(this.onFileUploadErrorEvent,this)},onFileUploadCompleteEvent:function(b,a){this.FileUploadCompleteEvent.fire(b,a)},onFileUploadErrorEvent:function(b,a){this.FileUploadErrorEvent.fire(b,a)},Reset:function(){this._fileUploadControl.Reset()},Bind:function(a){this._fileUploadControl.Bind(a)}});"cm.ui.common".namespace();cm.ui.common.ImageViewerConfigOptions=Class.create(cm.ConfigOptions,{height:500,width:530,navHeight:70,classNames:""});cm.ui.common.ImageViewer=Class.create(cm.ui.ComplexControl,{_currentPhotoIndex:0,configureDefaultOptions:function(){return new cm.ui.common.ImageViewerConfigOptions()},initializeData:function(){this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this.SetWidth(this._cfo.width);this._divPhotoFrame=$$P.div("divImageFrame","",{classNames:"cmImageFrame"});this._divPhotoFrame.SetHeight(this._cfo.height-this._cfo.navHeight);this.AddChild(this._divPhotoFrame);this._pPhotoCount=$$P.span("pImageCount","",{classNames:"cmImageCount"});this._divPhotoFrame.AddChild(this._pPhotoCount);this._imgImg=new $$IMG();this._imgImg.AssignStyle("max-width",this._cfo.width+"px");this._imgImg.AssignStyle("max-height",(this._cfo.height-this._cfo.navHeight-30)+"px");this._divPhotoFrame.AddChild(this._imgImg);this._divNavigation=$$P.div("divNavigation",null,{classNames:"cmClearfix"});this.AddChild(this._divNavigation);this._divLeftArrow=$$P.div("divLeftArrow",null,{classNames:"cmNavigationControl cmNavigateLeft cmFloatLeft"});this._divNavigation.AddChild(this._divLeftArrow);this._divLeftArrow.SetHeight(this._cfo.navHeight);this._divLeftArrow.SetWidth(this._cfo.navHeight);this._divLeftArrow.Hide();this._divNavigation.AddChild($$P.span(null,"Press the '-' key for the previous photo or the '=' key for the next photo",{classNames:"cmInlineBlock mt20px"}));this._divRightArrow=$$P.div("divRightArrow",null,{classNames:"cmNavigationControl  cmNavigateRight cmFloatRight"});this._divNavigation.AddChild(this._divRightArrow);this._divRightArrow.SetHeight(this._cfo.navHeight);this._divRightArrow.SetWidth(this._cfo.navHeight);this._divRightArrow.Hide()},postInitialize:function($super){$super()},createEvents:function($super){$super();this.ImageChangedEvent=new cm.event();this.NavigateLeftEvent=new cm.event();this.NavigateRightEvent=new cm.event();this._divLeftArrow.AddClickListener();this._divRightArrow.AddClickListener()},wireEvents:function($super){$super();this._divLeftArrow.ClickEvent.subscribe(this.onNavigateLeftClicked,this);this._divRightArrow.ClickEvent.subscribe(this.onNavigateRightClicked,this);var a=this;jQuery("html").keydown(function(c){var d=c.charCode||c.keyCode;if(d==189||d==173){var b=new Object();b.event=c;a.onLeftPressed();return false}if(d==187||d==61){var b=new Object();b.event=c;a.onRightPressed();return false}})},GetCurrentPhoto:function($super){return this._photoArray[this._currentPhotoIndex]},SetSource:function(a){this._imgImg.SetSource(a)},SetPhotoCount:function(){var a="";if($$CM.isArray(this._photoArray)&&this._photoArray.length>0){a=(this._currentPhotoIndex+1)+"/"+(this._photoArray.length)}this._pPhotoCount.UpdateInnerHtml(a)},onLeftPressed:function(b,a){this.Previous()},onRightPressed:function(b,a){this.Next()},Next:function(){if(this._currentPhotoIndex==this._photoArray.length-1){}else{this.NavigateRightEvent.fire();this._currentPhotoIndex++;this.RenderPhoto()}},Previous:function(){if(this._currentPhotoIndex==0){}else{this.NavigateLeftEvent.fire();this._currentPhotoIndex--;this.RenderPhoto()}},RenderPhoto:function(){if($$CM.isArray(this._photoArray)&&this._photoArray.length>0&&this._photoArray[0].ZoominUrl){this.SetSource(this._photoArray[this._currentPhotoIndex].ZoominUrl);this._imgImg.Show()}else{this._imgImg.Hide()}this.SetPhotoCount();this.ImageChangedEvent.fire(this,this.GetCurrentPhoto());if(this._currentPhotoIndex==0){this._divLeftArrow.Hide()}else{this._divLeftArrow.Show()}if(this._currentPhotoIndex==this._photoArray.length-1||this._photoArray.length==0){this._divRightArrow.Hide()}else{this._divRightArrow.Show()}},onNavigateLeftClicked:function(){this.Previous()},onNavigateRightClicked:function(){this.Next()},onDataUpdated:function(){var a=this.GetBoundData();this._photoArray=a;this._currentPhotoIndex=0;this.RenderPhoto()}});"cm.ui.common".namespace();cm.ui.common.InfoFeatureConfigOptions=Class.create(cm.ConfigOptions,{id:null,location:"right",anchor:null,width:190,maxWidth:null,text:"",top:0,left:0,clickAwayClose:true,saveAnalytics:true,getInfo:true,admin:false});cm.ui.common.InfoFeature=Class.create(cm.ui.Control,{initializeData:function($super){$super();this._showStatus=1;this._sizeStatus=1;this._helpVideoShowState=1;this._infoReceived=1;this._helpArticleClicked=1;this._helpVideoClicked=1;this._contextualHelpInfo={};this._contextualHelpArticle;this._UID=this.GetConfigOptions().id;this._helpArticleShowStatus=1;this.images=[];this._helpArticleReceived=1;this.left=0;this.top=0;this.height=0;this.width=190},initializeDAOs:function($super){$super();this._infoFeatureDAO=new cm.dao.InfoFeature.DAO()},initializeUIElements:function(){var a=this;this._sControl=$$P.span(this._UID+"_helpLeaf",null,{classNames:"helpLeafIconI"});this.AddChild(this._sControl);this._divFeature=$$P.div(this._UID+"_bubble","",{classNames:"infoFeature"});this._infoHeader=$$P.div(this._UID+"_bubbleHeader","",{classNames:"infoFeatureHeader"});this._divFeature.AddChild(this._infoHeader);this._infoHeaderText=$$P.span(this._UID+"_bubbleHeaderText","");this._infoHeaderText.UpdateInnerHtml("info ");this._infoHeader.AddChild(this._infoHeaderText);this._infoFeatureExit=$$P.span(this._UID+"_plus","");this._infoFeatureExit.AddClassName("infoPLus");this._infoFeatureExit.UpdateInnerHtml("&#10006;");this._infoHeader.AddChild(this._infoFeatureExit);this._infoTextBox=$$P.div(this._UID+"_bubbleTextBox","",{classNames:"infoFeatureText"});this._divFeature.AddChild(this._infoTextBox);this._infoVideoBox=$$P.div(this._UID+"_bubbleVideoBox","",{classNames:"infoFeatureVideoBox"});this._infoTextBox.AddChild(this._infoVideoBox);this._infoVideoBox.Hide();this._infoVideo=$$P.div(this._UID+"_bubbleVideo","",{classNames:"infoFeatureVideoPlayer"});this._infoVideoBox.AddChild(this._infoVideo);this._infoVideo.UpdateInnerHtml('<center><video width="95%" height="auto" controls><source src="" type="video/mp4"></video></center>');this._infoText=$$P.span(this._UID+"_bubbleText","");this._infoTextBox.AddChild(this._infoText);this._infoText.AssignStyle("white-space","pre-line");this._helpArticleText=$$P.div(this._UID+"_Text","");this._infoTextBox.AddChild(this._helpArticleText);this._helpArticleText.SetAttribute("style","overflow-y: scroll;");this._infoLine=$$P.hr(this._UID+"_bubbleline","");this._infoLine.AddClassName("infoLine");this._infoTextBox.AddChild(this._infoLine);this._helpLink=new $$A("id",{text:"Help Article"});this._helpLink.AddClassName("infoHelpArticle");this._infoTextBox.AddChild(this._helpLink);this._helpLink.Hide();this._helpVideo=$$P.div(this._UID+"_helpVideo");this._helpVideo.AddClassName("infoFeatureVideo");this._infoTextBox.AddChild(this._helpVideo);this._helpVideo.Hide();this.AssignStyle("display","inline");if($$CM.isNull(this.GetConfigOptions().maxWidth)){this._divFeature.AssignStyle("width",this.GetConfigOptions().width+"px")}else{this._divFeature.AssignStyle("max-width",this.GetConfigOptions().maxWidth+"px")}if(this.GetConfigOptions().location=="left"){var b="-"+(30+this.GetConfigOptions().width)+"px";this._divFeature.AssignStyle("margin-left",b)}if(this.GetConfigOptions().location=="top"){var c="-"+$$JQ(this._divFeature).height()+"px";this._divFeature.AssignStyle("margin-top",c)}jQuery(window).resize(function(){a._helpArticleShowStatus==1&&a._helpVideoShowState==1?a.onPlaceFeature(true):false;a._helpArticleShowStatus==2?a.onExpand(true,true):false;a._helpVideoShowState==2?a.onExpand(false,true):false})},createEvents:function(){this._sControl.AddClickListener();this._infoFeatureExit.AddClickListener();this._helpLink.AddMouseEnterListener();this._helpLink.AddMouseLeaveListener();this._helpVideo.AddClickListener();this._helpLink.AddClickListener();this._divFeature.AddClickAwayListener();this.stayOpenEvent=new cm.event()},wireEvents:function(){var a=this;this._sControl.ClickEvent.subscribe(this.onClick,this,true);this._infoFeatureExit.ClickEvent.subscribe(this.onClickAway,this,true);this._helpLink.MouseEnterEvent.subscribe(this.onHelpLinkHover,this);this._helpLink.MouseLeaveEvent.subscribe(this.onHelpLinkUnHover,this);this._helpVideo.ClickEvent.subscribe(this.onHelpVideo,this);this._helpLink.ClickEvent.subscribe(this.onHelpArticle,this);this._infoFeatureDAO.ContextualHelpFetchedEvent.subscribe(this.onContextualHelpFetched,this);this._infoFeatureDAO.ContextualHelpArticleFetchedEvent.subscribe(this.onContextualHelpArticleFetched,this);this._infoFeatureDAO.ContextualHelpMetricModifiedEvent.subscribe(this.onContextualHelpMetricModified,this)},configureDefaultOptions:function(){return new cm.ui.common.InfoFeatureConfigOptions()},onHelpVideo:function(){if(this._helpVideoShowState==1){this._infoVideo.UpdateInnerHtml('<center><video width="95%" height="auto" controls autoplay><source src='+this._contextualHelpInfo.VideoURL+' type="video/mp4"></video></center>');this.onExpand(false);this._helpVideoShowState=2;this._helpVideoClicked=2}else{this.onShowBasicFeature()}},onShowBasicFeature:function(){this._divFeature.AssignStyle("transition-duration",".4s");this.onPlaceFeature();var a=this._infoVideo.GetData();this._infoVideo.UpdateInnerHtml('<center><video width="95%" height="auto" controls><source src='+this._contextualHelpInfo.VideoURL+' type="video/mp4"></video></center>');this._helpArticleText.Hide();this._helpVideo.Show();this._helpArticleShowStatus=1;this.assignFeatureClass(1,0);this._helpLink.UpdateInnerHtml("Help Article");this._helpLink.RemoveClassName("infoFeatureVideoRemove");this._divFeature.AssignStyle("height","auto");this._helpVideo.RemoveClassName("infoFeatureVideoRemove");this._helpVideo.UpdateInnerHtml("");this._infoVideoBox.Hide();this._helpVideoShowState=1;this._helpLink.Show();this._infoText.Show()},initializeBubble:function(){if(!$$CM.isNull(this._contextualHelpInfo.HelpText)){this._infoText.UpdateInnerHtml(this._contextualHelpInfo.HelpText);this._infoText.Show()}if(!$$CM.isNull(this._contextualHelpInfo.HelpContentID)||!$$CM.isNull(this._contextualHelpInfo.ArticleURL)){this._helpLink.Show()}else{this._helpLink.AddClassName("linkNone")}if(!$$CM.isNull(this._contextualHelpInfo.VideoURL)){this._helpVideo.Show()}else{this._helpVideo.AddClassName("linkNone")}if(this._contextualHelpInfo.HelpText.length>300){this._divFeature.AssignStyle("width",270+"px");this.width=270}},onClickAway:function(c,a){var b=this;if(this._showStatus==2){this._helpArticleShowStatus==1&&this._helpVideoShowState==1?this._divFeature.Hide():setTimeout(function(){b._divFeature.Hide()},500);this.onShowBasicFeature();this.GetConfigOptions().saveAnalytics?this.onSaveAnalytics():false;this._helpArticleClicked=1;this._helpVideoClicked=1;this._showStatus=1;this.stayOpenEvent.fire(this,false)}},onClick:function(c,a){if(this._showStatus==1){var b=this.GetConfigOptions().id;if(!$$CM.isNull(b)){this._infoReceived==1&&this.GetConfigOptions().getInfo&&this.GetConfigOptions().admin?this.getInfoBubbleData(b):false;this.onPlaceFeature();this._divFeature.AssignStyle("display","inline");this._showStatus=2;this.stayOpenEvent.fire(this,true);return}}else{this.onClickAway();this.stayOpenEvent.fire(this,false)}},onSaveAnalytics:function(){var a={ContextualHelpID:this.GetConfigOptions().id,ContextualHelpMetricID:0,ArticleID:null,VideoID:null,TimeStamp:{Created:{Time:new Date().toString()}}};this._helpArticleClicked==2?a.ArticleID=this._contextualHelpInfo.ArticleID:false;this._helpVideoClicked==2?a.VideoID=this._contextualHelpInfo.VideoID:false;this.saveAnalytics(a)},onHelpArticle:function(){if(this._helpArticleShowStatus==1&&this._helpArticleReceived==2){this.onOpenArticle()}else{if(this._helpArticleShowStatus==2){this.onHelpArticleExit()}}if(this._helpArticleShowStatus==1&&this._helpArticleReceived==1){if(!$$CM.isNull(this._contextualHelpInfo.ArticleURL)&&$$CM.isNull(this._contextualHelpInfo.HelpContentID)){var a="/ui/security/ForceCommunityAuthenticateRequest?ArticleUrl="+this._contextualHelpInfo.ArticleURL;this._helpLink.SetLinkUrl(a);this._helpLink.SetAttribute("target","_blank")}else{this.getInfoArticleData(this._contextualHelpInfo.HelpContentID);this._helpArticleClicked=2}}},onHelpLinkHover:function(){this._infoLine.AssignStyle("width","50%")},onHelpLinkUnHover:function(){this._infoLine.AssignStyle("width","25%")},clear:function(){this.onClickAway();this._infoText.UpdateInnerHtml("");this._helpLink.Hide();this._helpVideo.Hide();this._infoVideo.UpdateInnerHtml('<iframe class="infoFeatureIframeVideo" src="" allowfullscreen></iframe>');this._infoVideoBox.Hide();this._helpVideo.UpdateInnerHtml("");this._helpVideoShowState=1},GetData:function(){var b=this;var a=this.GetConfigOptions().id;this._infoReceived==1?(this.getInfoBubbleData(a),setTimeout(function(){var c=1},500)):false;return this._contextualHelpInfo},onContextualHelpFetched:function(a){this._contextualHelpInfo=a._data.undefined[0];this._infoReceived=2;this.initializeBubble()},contextualHelpBind:function(a){this._contextualHelpInfo=a;this._infoReceived=2;this.initializeBubble()},onContextualHelpArticleFetched:function(a){var e=this;var g=a._data.undefined[0].m_Item2;var c=a._data.undefined[0].m_Item3;var f="";var d=this._UID+"img";var b=1;g.each(function(i){f+="<div class='helpArticleTextarea'>"+i.Text+"</div>";if(i.Image>0){var h=c.find(function(k){return i.Image==k.ImageID});var j=d+b;f+="<img class='articleImg' id='"+d+b+"'style='width:45%; transition-duration: .4s;' src ='"+h.Filename+"'>";e.images.push({image:j,state:1});b++}});this._helpArticleText.UpdateInnerHtml("<div id='textTest' style='padding:0px 5px 0px 30px;'>"+f+"</div>");this._helpArticleText.Hide();e.images.each(function(h){jQuery("#"+h.image).click(function(){console.log("hi");var i=e.images.find(function(j){if(j.image==h.image){return j}});i.state==1?(jQuery("#"+h.image).width("90%"),i.state=2):(jQuery("#"+h.image).width("45%"),i.state=1)})});this._helpArticleReceived=2;this.onOpenArticle()},onOpenArticle:function(){var c=this;this.height=this._divFeature._htmlElement.clientHeight;this.onExpand(true);var a="#"+this._UID+"_bubble";var b="#"+this._UID+"_Text";jQuery(a).draggable();this._helpArticleShowStatus=2;setTimeout(function(){c._divFeature.AssignStyle("transition-duration","0s")},250)},onHelpArticleExit:function(){var a="#"+this._UID+"_bubble",b="#"+this._UID+"_Text";jQuery(a).draggable("destroy");this.onShowBasicFeature()},onExpand:function(a,c){var c=c||false;this._infoText.Hide();this._infoVideoBox.Hide();this._helpArticleText.Hide();this._helpVideo.Hide();this._helpLink.Hide();this.assignFeatureClass(4,false);a?(this._helpLink.Show(),this._helpArticleText.Show(),this._helpLink.UpdateInnerHtml("Go Back &#8634;"),this._helpLink.AddClassName("infoFeatureVideoRemove")):(this._infoVideoBox.Show(),this._helpVideo.Show(),this._helpVideo.UpdateInnerHtml("Go Back &#8634;"),this._helpVideo.AddClassName("infoFeatureVideoRemove"));var d=a?(window.innerWidth*0.5):(window.innerWidth*0.6);var b=a?(window.innerHeight*0.45):(d*0.6800000000000001);this._divFeature.AssignStyle("width",d+"px");this._divFeature.AssignStyle("height","auto");this._helpArticleText.AssignStyle("max-height",b+"px");a?this.onCenter(this._divFeature,d,null,c):this.onCenter(this._divFeature,d,b,c)},assignFeatureClass:function(b,a){a!==false?this._divFeature.AssignStyle("width",this.width+a+"px"):false;this._divFeature.RemoveClassName("infoFeature4");this._divFeature.RemoveClassName("infoFeature3");this._divFeature.RemoveClassName("infoFeature2");this._divFeature.RemoveClassName("infoFeature1");b?this._divFeature.AddClassName("infoFeature"+b):false},onCenter:function(g,f,a,c){var d=jQuery(document).scrollTop();var b=(window.innerWidth/2)-(f?f/2:g._htmlElement.clientWidth/2);var e=(window.innerHeight/2)-(a?a/2:g._htmlElement.clientHeight/2);c?g.AssignStyle("transition-duration","0s"):false;setTimeout(function(){g.AssignStyle("transition-duration",".4s"),500});g.AssignStyle("left",b+"px");g.AssignStyle("top",e+"px")},onPlaceFeature:function(c){var a=this;var b="#"+this._UID+"_helpLeaf";leafTop=jQuery(b).offset().top;left=jQuery(b).offset().left+25;((+left+this.width)>(window.innerWidth-15))?(left-=(this.width),leafTop+=25):false;c?(a._divFeature.AssignStyle("transition-duration","0s"),setTimeout(function(){a._divFeature.AssignStyle("transition-duration",".4s")},100)):false;this._divFeature.AssignStyle("top",leafTop+"px ");this._divFeature.AssignStyle("left",left+"px")},onContextualHelpMetricModified:function(a){},getInfoBubbleData:function(a){this._infoFeatureDAO.ContextualHelpFetch({ID:a})},getInfoArticleData:function(a){this._infoFeatureDAO.ContextualHelpArticleFetch({ID:a})},saveAnalytics:function(a){this._infoFeatureDAO.ContextualHelpMetricModify({ContextualHelpMetric:a})}});"cm.ui.common".namespace();cm.ui.common.InfoFeatureInitConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.common.InfoFeatureInit=Class.create(cm.ui.Control,{initializeDAOs:function($super){$super();this._infoFeatureDAO=new cm.dao.InfoFeature.DAO()},initializeData:function($super){$super()},postInitialize:function(){var a={};a.URL=this.getURL();a.URL?this._infoFeatureDAO.ContextualHelpInitFetch(a):false},wireEvents:function(){this._infoFeatureDAO.ContextualHelpInitFetchedEvent.subscribe(this.initInfo,this)},getURL:function(){var a=window.location.pathname;return a.toLowerCase().indexOf("login")>=0?a.toLowerCase().indexOf("loginchangesettings")>=0?a:false:a},initInfo:function(a){var c=this;if(a._data.undefined&&a._data.undefined.length>0){var b=a._data.undefined;setTimeout(function(){c.initInfoFeatures(b)},1000)}},initInfoFeatures:function(b){var c=this,a=0;b.each(function(f){var d=f.ContextualHelpID==109?false:true;var e=new cm.ui.common.InfoFeature(null,{location:"right",id:f.ContextualHelpID,saveAnalytics:d});f.DomStyle?e._htmlElement.setAttribute("style",f.DomStyle):false;e.contextualHelpBind(f);if(f.DomElement){jQuery(f.DomElement).length>0?(jQuery(f.DomElement).append(e._htmlElement),jQuery("body").append(e._divFeature._htmlElement)):setTimeout(function(){c.appendFeature(f.DomElement,e,a)},500)}})},appendFeature:function(b,c,a){var d=this;if(a<=15){jQuery(b).length>0?(jQuery(b).append(c._htmlElement),jQuery("body").append(c._divFeature._htmlElement)):(a++,setTimeout(function(){d.appendFeature(b,c,a)},500))}}});"cm.ui.common".namespace();cm.ui.common.LastUpdatedControl=Class.create(cm.ui.ComplexControl,{render:function(){var a=$$P.span(this._id);return $$E(a)},initializeUIElements:function(){this.Add},onDataUpdated:function(){var a=this.GetBoundData();if(!$$CM.isEmpty(a.UpdatedBy)||!$$CM.isEmpty(a.UpdatedAsString)){var d="Last updated";if(!$$CM.isEmpty(a.UpdatedBy)){d+=" by "+a.UpdatedBy}if(!$$CM.isEmpty(a.UpdatedAsString)){var b=new $$CMDATE(a.UpdatedAsString);var c=b.getFormattedDate(false,true);var e=b.getFormattedTime(true,true,true);d+=" on "+c+" at "+e}this.UpdateInnerHtml(d+".")}}});"cm.ui.common".namespace();cm.ui.common.LeftStep=Class.create(cm.ConfigOptions,{});$$LFTSTP=cm.ui.common.LeftStep=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.AdditionalCommentsConfigOptions()},initializeData:function($super){this._co=this.c;stepNumber=1},initializeUIElements:function(){this.AddClassName("cmFormRow cmAddComments");this._addAdditionalComments=$$P.p("addAdditionalComments_"+this._uniqueID);this.AddChild(this._addAdditionalComments);this._aAddAdditionalComments=$$P.a("aAddAdditionalComments_"+this._uniqueID,"Additional comments");this._addAdditionalComments.AddChild(this._aAddAdditionalComments);this._spanAddAdditionalComments=$$P.span("spanAddAdditionalComments_"+this._uniqueID,"Additional comments");this._addAdditionalComments.AddChild(this._spanAddAdditionalComments);this._spanAddAdditionalComments.Hide();this._txaAdditionalComments=$$P.txa("ftxaAdditionalComments_"+this._uniqueID);this.AddChild(this._txaAdditionalComments);this._txaAdditionalComments.AddClassName("cmFixBoxSize");this._txaAdditionalComments.AssignStyle("width","100%");this._txaAdditionalComments.AssignStyle("margin-top","5px");this._txaAdditionalComments.AssignStyle("margin-bottom","5px");this._txaAdditionalComments.Hide();this._aHideAdditionalComments=$$P.a("aHideAdditionalComments_"+this._uniqueID,"Hide additional comments");this.AddChild(this._aHideAdditionalComments);this._aHideAdditionalComments.AddClassName("cmFormRow");this._aHideAdditionalComments.Hide()},createEvents:function(){this._aAddAdditionalComments.AddClickListener();this._aHideAdditionalComments.AddClickListener()},wireEvents:function($super){$super();this._aAddAdditionalComments.ClickEvent.subscribe(this.onAddAdditionalComments_click,this);this._aHideAdditionalComments.ClickEvent.subscribe(this.onHideAdditionalComments_click,this)},SetTabIndex:function(a){this._txaAdditionalComments.SetTabIndex(a++)},GetData:function(){if(this._txaAdditionalComments.IsVisible()){return $$E(this._txaAdditionalComments).value}return null},onAddAdditionalComments_click:function(){this._aAddAdditionalComments.Hide();this._spanAddAdditionalComments.Show();this._txaAdditionalComments.Show();this._aHideAdditionalComments.Show()},onHideAdditionalComments_click:function(){this._spanAddAdditionalComments.Hide();this._aAddAdditionalComments.Show();this._txaAdditionalComments.Hide();this._aHideAdditionalComments.Hide()}});"cm.ui.common".namespace();cm.ui.common.ListEditorControlConfigOptions=Class.create(cm.ConfigOptions,{width:320,height:100,includeCategory:false,modalWidth:350,title:"",details:""});cm.ui.common.ListEditorControl=Class.create(cm.ui.ComplexControl,{AddEvent:null,listEntryDialogControl:null,configureDefaultOptions:function(){return new cm.ui.common.ListEditorControlConfigOptions()},initialize:function($super,c,b,a){if(!$$CM.isNull(c)){this._listEntryDialogControl=c}else{throw"Input List Entry Dialog Control required"}$super(b,a)},initializeUIElements:function($super){$super();this._cmDivModals=$$P.div("divModals");this.AddChild(this._cmDivModals);this._divTitle=$$P.div("divTitle");this.AddChild(this._divTitle);if(!$$CM.isEmpty(this.GetConfigOptions().title)){this._divTitle.UpdateInnerHtml("<b>"+this.GetConfigOptions().title+"</b>")}this._divDetails=$$P.div("divDetails");this.AddChild(this._divDetails);if(!$$CM.isEmpty(this.GetConfigOptions().details)){this._divDetails.UpdateInnerHtml(this.GetConfigOptions().details)}this._divScrollWrapper=$$P.div("divScrollWrapper");this.AddChild(this._divScrollWrapper);this._divScrollWrapper.AddClassName("cmScrollY");if(!$$CM.isNull(this.GetConfigOptions().width)){this._divScrollWrapper.SetWidth(this.GetConfigOptions().width)}if(!$$CM.isNull(this.GetConfigOptions().height)){this._divScrollWrapper.SetHeight(this.GetConfigOptions().height)}this._btnAdd=new $$BTN("btnAdd",{text:"Add to List"});this.AddChild(this._btnAdd);this._btnAdd.AddClassName("cmGoButton");if(this.GetConfigOptions().includeCategory==true){this._btnEditCategories=new $$BTN("btnEditCategories",{text:"Edit Categories"});this.AddChild(this._btnEditCategories);this._btnEditCategories.AddClassName("cmGoButton");this._categoryDialog=new cm.ui.dialog.ModalDialog("categoryDialog_"+this.ID(),{title:"Edit Categories",width:300});this._cmDivModals.AddChild(this._categoryDialog);this._categoryDialogControl=new cm.ui.common.ListEditorDialogCategoryControl("categoryDialogControl_"+this.ID());this._categoryDialog.AddChild(this._categoryDialogControl)}var a=this.GetConfigOptions().modalWidth;if(!$$CM.isNull(this._listEntryDialogControl.GetConfigOptions().width)&&this._listEntryDialogControl.GetConfigOptions().width>a){a=this._listEntryDialogControl.GetConfigOptions().width}var b="Add to List";if(!$$CM.isNull(this._listEntryDialogControl.GetConfigOptions().title)){b=this._listEntryDialogControl.GetConfigOptions().title}this._listEntryDialog=new cm.ui.dialog.ModalDialog(this._listEntryDialogControl.ID(),{title:b,width:a});this._cmDivModals.AddChild(this._listEntryDialog);this._listEntryDialog.AddChild(this._listEntryDialogControl)},createEvents:function(){this.AddEvent=new cm.event()},wireEvents:function($super){$super();this._btnAdd.ClickEvent.subscribe(this.onBtnAddClick,this);this._listEntryDialogControl.SaveEvent.subscribe(this.onSave,this);this._listEntryDialogControl.SaveAddEvent.subscribe(this.onSaveAdd,this);this._listEntryDialogControl.CancelEvent.subscribe(this.onCancel,this);if(this.GetConfigOptions().includeCategory==true){this._btnEditCategories.ClickEvent.subscribe(this.onBtnCategoryClick,this);this._categoryDialogControl.SaveEvent.subscribe(this.onCategorySave,this);this._categoryDialogControl.CancelEvent.subscribe(this.onCategoryCancel,this)}},onDataUpdated:function(){var a=this.GetBoundData();this._divScrollWrapper.DestroyChildControls();a=a.sort($$CM.sortByNameProperty);if($$CM.isArray(a)){a.each(function(c){var b=new cm.ui.common.ListEditorRowControl(c.ID);this._divScrollWrapper.AddChild(b);b.Bind(c);b.EditEvent.subscribe(this.onListEditorRowControlEdit,this);b.DeleteEvent.subscribe(this.onListEditorRowControlDelete,this)},this)}},GetData:function(){var a=$A();this._divScrollWrapper.ChildControls().each(function(b){a.push(b.GetData())},this);return a},onBtnAddClick:function(b,a){this._listEntryDialogControl.Reset();this._listEntryDialogControl.Bind({ID:$$CM.newGuid(),IsDeletable:true,IsEditable:true});this._listEntryDialog.Show()},onListEditorRowControlEdit:function(b,a){this._listEntryDialogControl.Bind(b.GetData());this._listEntryDialog.Show()},onListEditorRowControlDelete:function(c,a){var b={title:"Confirm",header:c.GetData().Name,message:"Do you want to delete this?",width:250,handlerOk:this.confirmDelete,handlerCancel:this.cancelDelete,scope:this,args:c};$$CMD.Confirm(b)},confirmDelete:function(c,a){var b=a;this.deleteListData(b.GetData())},cancelDelete:function(b,a){},onSave:function(d,a){var b=this._listEntryDialogControl.GetData();if(!this.updateListData(b)){var c={title:"Alert",header:d.GetData().Name,message:"The item must be unique."};$$CMD.Alert(c)}else{this._listEntryDialog.Hide()}},onSaveAdd:function(d,a){var b=this._listEntryDialogControl.GetData();if(!this.updateListData(b)){var c={title:"Alert",header:d.GetData().Name,message:"The item must be unique."};$$CMD.Alert(c)}else{this._listEntryDialogControl.Reset();this._listEntryDialogControl.Bind({ID:$$CM.newGuid(),IsDeletable:true,IsEditable:true})}},onCancel:function(b,a){this._listEntryDialog.Hide()},deleteListData:function(b){var a=this.GetData();var d=-1;for(var c=0;c<a.length;c++){if(a[c].ID==b.ID){d=c}}if(d>=0){a.splice(d,1)}this.Bind(a)},updateListData:function(b){var a=this.GetData();var f=a;if(this.GetConfigOptions().includeCategory==true){f=a.find(function(g){return b.CategoryName==g.Name;s},this)}var e=f.find(function(g){return b.Name==g.Name},this);if(!$$CM.isNull(e)){return false}var d=true;for(var c=0;c<f.length;c++){if(f[c].ID==b.ID){d=false;f[c]=b}}if(d){f.push(b)}this.Bind(a);return true},onBtnCategoryClick:function(b,a){this._categoryDialog.Show()},onCategorySave:function(c,a){var b=this._categoryDialogControl.GetData();this._categoryDialog.Hide()},onCategoryCancel:function(b,a){this._categoryDialog.Hide()}});cm.ui.common.ListEditorRowControl=Class.create(cm.ui.ComplexControl,{EditEvent:null,DeleteEvent:null,initializeUIElements:function($super){$super();this._lblName=$$P.lbl();this.AddChild(this._lblName);this._aDelete=new $$A("aDelete_"+this.ID(),{text:"Delete"});this.AddChild(this._aDelete);this._aDelete.AddClassName("cmFloatRight");this._aEdit=new $$A("aEdit_"+this.ID(),{text:"Edit"});this.AddChild(this._aEdit);this._aEdit.AddClassName("cmFloatRight")},createEvents:function(){this.EditEvent=new cm.event();this.DeleteEvent=new cm.event()},wireEvents:function($super){$super();this._aDelete.ClickEvent.subscribe(this.onADeleteClick,this);this._aEdit.ClickEvent.subscribe(this.onAEditClick,this)},onDataUpdated:function(){var a=this.GetBoundData();this._lblName.UpdateInnerHtml(a.Name);if(!a.IsEditable){this._aEdit.Hide()}if(!a.IsDeletable){this._aDelete.Hide()}},GetData:function(){var a=this.GetBoundData();return a},onADeleteClick:function(b,a){this.DeleteEvent.fire(this)},onAEditClick:function(b,a){this.EditEvent.fire(this)}});"cm.ui.common".namespace();cm.ui.common.MergeFieldDataConfigOptions=Class.create(cm.ConfigOptions,{forStaffApp:false,forCamperApp:false,forPersonApp:false,forReferenceEmail:false,forDonorEmail:false});cm.ui.common.MergeFieldData=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.MergeFieldDataConfigOptions()},initializeData:function(){this.co=this.GetConfigOptions();this.mfList=this.co.forStaffApp?this.mfStaffList:this.co.forDonorEmail?this.mfDonorList:this.co.forCamperApp?this.mfCamperList:this.mfReferenceList;this.mergeLabel=this.co.forStaffApp?this.mergeLabelStaff:this.co.forDonorEmail?this.mergeLabelDonor:this.co.forCamperApp?this.mergeLabelCamper:this.mergeLabelReference;this.mfData=this.co.forReferenceEmail?this.mergeFieldRefFormData:this.mergeFieldData;if(this.co.forCamperApp==true){this.mergeLabel=this.mergeLabelCamper;this.mfList=this.mfCamperList}else{if(this.co.forStaffApp==true){this.mergeLabel=this.mergeLabelStaff;this.mfList=this.mfStaffList}else{if(this.co.forPersonApp==true){this.mergeLabel=this.mergeLabelPerson;this.mfList=this.mfPersonList}else{if(this.co.forDonorEmail==true){this.mergeLabel=this.mergeLabelDonor;this.mfList=this.mfDonorList}else{if(this.co.forReferenceEmail==true){this.mergeLabel=this.mergeLabelCamper;this.mfList=this.mfCamperList;this.mfData=this.co.mergeFieldRefFormData}else{this.mergeLabel=this.mergeLabelDefault}}}}}},mfStaffList:[{Name:"Select a Merge Field",ID:""},{Name:"Full Name",ID:"{Full Name}"},{Name:"First Name",ID:"{First Name}"},{Name:"Last Name",ID:"{Last Name}"},],mfCamperList:[{Name:"Select a Merge Field",ID:""},{Name:"Camper Full Name",ID:"{CamperFullName}"},{Name:"Camper First Name",ID:"{CamperFirstName}"},{Name:"Camper Last Name",ID:"{CamperLastName}"},{Name:"Camper Nickname",ID:"{CamperNickname}"},],mfPersonList:[{Name:"Select a Merge Field",ID:""},{Name:"Full Name",ID:"{FullName}"},{Name:"First Name",ID:"{FirstName}"},{Name:"Last Name",ID:"{LastName}"},{Name:"Nickname",ID:"{Nickname}"},],mfDonorList:[{Name:"Select a Merge Field",ID:""},{Name:"Donor Full Name",ID:"{DonorFullName}"},{Name:"Donor First Name",ID:"{DonorFirstName}"},{Name:"Donor Last Name",ID:"{DonorLastName}"},{Name:"Donor Nickname",ID:"{DonorNickname}"},],mfReferenceList:[{Name:"Select a Merge Field",ID:""},{Name:"Camper Full Name",ID:"{CamperFullName}"},{Name:"Camper First Name",ID:"{CamperFirstName}"},{Name:"Camper Last Name",ID:"{CamperLastName}"},],mergeLabelStaff:"Subject&nbsp;<span id='subjectClueSpan'>(?)<div id='subjectClue'>Thefollowing merge fields are available for use in the subject line. <br/>{First Name} <br/>{Last Name} <br/>{Full Name}</div></span>",mergeLabelCamper:"Subject&nbsp;<span id='subjectClueSpan'>(?)<div id='subjectClue'>Thefollowing merge fields are available for use in the subject line.<br/>{CamperFullName} <br/>{CamperFirstName} <br/>{CamperLastName} <br/>{CamperNickname} </div></span>",mergeLabelPerson:"Subject&nbsp;<span id='subjectClueSpan'>(?)<div id='subjectClue'>Thefollowing merge fields are available for use in the subject line.<br/>{FullName} <br/>{FirstName} <br/>{LastName} <br/>{Nickname} </div></span>",mergeLabelDonor:"Subject&nbsp;<span id='subjectClueSpan'>(?)<div id='subjectClue'>Thefollowing merge fields are available for use in the subject line.<br/>{DonorFullName} <br/>{DonorFirstName} <br/>{DonorLastName} <br/>{DonorNickname} </div></span>",mergeLabelDefault:"Subject",mergeLabelReference:"Subject&nbsp;<span id='subjectClueSpan'>(?)<div id='subjectClue'>Thefollowing merge fields are available for use in the subject line.<br/>{CamperFullName} <br/>{CamperFirstName} <br/>{CamperLastName} </div></span>",mergeFieldData:{firstName:'<img alt="mergeField: First Name" id="imgEditorMergeField" mergefieldid="firstName" src="/v2/reporting/mergeFieldImage.ashx?field=First Name" />',fullName:'<img alt="mergeField: Full Name" id="imgEditorMergeField" mergefieldid="fullName" src="/v2/reporting/mergeFieldImage.ashx?field=Full Name" />',lastName:'<img alt="mergeField: Last Name" id="imgEditorMergeField" mergefieldid="lastName" src="/v2/reporting/mergeFieldImage.ashx?field=Last Name" />'},mergeFieldRefFormData:{firstName:'<img alt="mergeField: Applicant First Name" id="imgEditorMergeField" mergefieldid="afirstName" src="/v2/reporting/mergeFieldImage.ashx?field=Applicant First Name" />',fullName:'<img alt="mergeField: Applicant Full Name" id="imgEditorMergeField" mergefieldid="afullName" src="/v2/reporting/mergeFieldImage.ashx?field=Applicant Full Name" />',lastName:'<img alt="mergeField: Applicant Last Name" id="imgEditorMergeField" mergefieldid="alastName" src="/v2/reporting/mergeFieldImage.ashx?field=Applicant Last Name" />'},convertSubjectMergeFields:function(b){var a=b.replace(/{First Name}/g,this.mfData.firstName);a=a.replace(/{Full Name}/g,this.mfData.fullName);a=a.replace(/{Last Name}/g,this.mfData.lastName);return a},revertSubjectMergeFieldsOnBind:function(b){var a=b.replace(this.convertToRegex(this.mfData.firstName),"{First Name}");a=a.replace(this.convertToRegex(this.mfData.fullName),"{Full Name}");a=a.replace(this.convertToRegex(this.mfData.lastName),"{Last Name}");return a},convertToRegex:function(a){a=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new RegExp(a,"g")}});"cm.ui.common".namespace();cm.ui.common.MergeFieldInputToolConfigOptions=Class.create(cm.ConfigOptions,{listData:false,inputToAlter:false,containerElement:false});cm.ui.common.MergeFieldInputTool=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.MergeFieldInputToolConfigOptions()},initializeData:function(){this.co=this.GetConfigOptions()},initializeUIElements:function(){this._MergeFieldButton=new $$BTN("MergeFieldButton",{text:""});this._MergeFieldButton.UpdateInnerHtml("<span style='color:black'>{</span>mF<span style='color:black'>}</span>");this._MergeFieldButton.AddClassName("MergeFieldButton");this.co.containerElement?this.co.containerElement.AddChild(this._MergeFieldButton):this.AddChild(this._MergeFieldButton);this._MergeFieldDDL=new $$DDL("MergeFieldDDL",{});this._MergeFieldDDL.AddClassName("MergeFieldDDL");this.co.containerElement?this.co.containerElement.AddChild(this._MergeFieldDDL):this.AddChild(this._MergeFieldDDL);this._MergeFieldDDL.Hide();this._MergeFieldDDL.AssignStyle("width","0px");this._MergeFieldDDL.AssignStyle("transition-duration",".2s");this.co.listData?this._MergeFieldDDL.bindList(this.co.listData):false},createEvents:function($super){$super();this._MergeFieldDDL.AddInputListener()},wireEvents:function($super){$super();this._MergeFieldButton.ClickEvent.subscribe(this.openMergeFieldDDL,this);this._MergeFieldDDL.InputEvent.subscribe(this.onMergeFieldDDLSelect,this)},BindList:function(a){if(a&&a.length>0){this._MergeFieldDDL.bindList(a)}},openMergeFieldDDL:function(){this.DDLTransition(true)},onMergeFieldDDLSelect:function(){var b=this.co.inputToAlter.GetData();var a=this._MergeFieldDDL.GetData();a&&a.length>0?b+=" "+a:false;this.co.inputToAlter.Bind(b);this._MergeFieldDDL.Bind("");this.DDLTransition(false)},DDLTransition:function(d){var b=this,c=this.co.inputToAlter.GetInputControl()._htmlElement.clientWidth,a;if(d){c-=98;a=131;this._MergeFieldDDL.Show();this._MergeFieldButton.Hide()}else{c+=98;a=0;setTimeout(function(){b._MergeFieldDDL.Hide();b._MergeFieldButton.Show()},50)}this.co.inputToAlter.GetInputControl().AssignStyle("width",c+"px");this._MergeFieldDDL.AssignStyle("width",a+"px")}});"cm.ui.common".namespace();cm.ui.common.MessageConfigOptions=Class.create(cm.ConfigOptions,{message:"",cssClass:""});cm.ui.common.Message=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.MessageConfigOptions()},initializeUIElements:function(){var a=this.GetConfigOptions();this.AddClassName(a.cssClass);this.UpdateInnerHtml(a.message)}});"cm.ui.common".namespace();cm.ui.common.NumberDDLControlConfigOptions=Class.create(cm.ConfigOptions,{min:0,max:5,ddlClassNames:"w55px"});cm.ui.common.NumberDDLControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.NumberDDLControlConfigOptions()},initializeUIElements:function(){this._ddlNumber=new $$DDL("ddlNumber_"+this.ID());this.AddChild(this._ddlNumber);this._ddlNumber.AddClassName(this.GetConfigOptions().ddlClassNames);var c=this.GetConfigOptions().min;var b=this.GetConfigOptions().max;var d=$A();for(var a=c;a<=b;a++){d.push({ID:a,Name:a})}this._ddlNumber.bindList(d)},createEvents:function(){this.AddChangeListener()},wireEvents:function(){this._ddlNumber.ChangeEvent.subscribe(this.onChange,this)},Bind:function(a){this._ddlNumber.Bind(a)},GetData:function(){return this._ddlNumber.GetData()},Reset:function(){this._ddlNumber.setSelectedIndex(0)},onChange:function(b,a){this.ChangeEvent.fire(b,a)}});"cm.ui.common".namespace();cm.ui.common.PasswordStrengthCheck=Class.create(cm.ui.ComplexControl,{initializeData:function($super){$super();this._co=this.GetConfigOptions()},initializeUIElements:function(){var a=$$P.div();this.AddChild(a);this.AddClassName("ctrPasswordStrengthCheck");this._spnPasswordStrength=$$P.span("spnPasswordStrength");this._spnPasswordStrength.AddClassName("strength none");a.AddChild(this._spnPasswordStrength);this._aPasswordHelp=new $$ANCHOR("aPasswordHelp",{text:"?"});a.AddChild(this._aPasswordHelp);this._aPasswordHelp.AddClassName("aPasswordHelp");this._passwordStrengthModal=new cm.ui.common.PasswordStrengthModal("passwordStrengthModal",{title:"Password Strength",width:500});this.AddChild(this._passwordStrengthModal)},wireEvents:function($super){$super();this._aPasswordHelp.ClickEvent.subscribe(this.onOpenHelpModel,this);this._passwordStrengthModal.CloseHelpModelEvent.subscribe(this.onCloseHelpModel,this)},postInitialize:function($super){$super();this._ftxtPasswordControl=this._co.ftxtPasswordControl;if($$CM.isNull(this._ftxtPasswordControl)){throw"Password Control Required"}this._ftxtPasswordControl.KeyUpEvent.subscribe(this.checkPassword,this)},onOpenHelpModel:function(b,a){this._passwordStrengthModal.Show()},onCloseHelpModel:function(b,a){this._passwordStrengthModal.Hide()},clear:function(){var a=this._spnPasswordStrength;a.RemoveClassName("weak");a.RemoveClassName("medium");a.RemoveClassName("strong")},checkPassword:function(e,a){this.clear();var d=this._spnPasswordStrength;var f="";var c="none";var b=this._ftxtPasswordControl.GetData();if(b.length>0){if($$CM.containsBadPasswordCharacter(b)){b=$$CM.replaceBadPasswordCharacter(b,true)}this._ftxtPasswordControl.Bind(b);c=this.teststrength(b,f)}d.AddClassName(c);return c},teststrength:function(a,c){var b=0;if(a.length<7){return"weak"}if(a.toLowerCase()==c.toLowerCase()){return"weak"}b+=a.length*4;b+=(this.checkRepetition(1,a).length-a.length)*1;b+=(this.checkRepetition(2,a).length-a.length)*1;b+=(this.checkRepetition(3,a).length-a.length)*1;b+=(this.checkRepetition(4,a).length-a.length)*1;if(a.match(/(.*[0-9].*[0-9].*[0-9])/)){b+=5}if(a.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){b+=5}if(a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){b+=10}if(a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)){b+=15}if(a.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&a.match(/([0-9])/)){b+=15}if(a.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&a.match(/([a-zA-Z])/)){b+=15}if(a.match(/^\w+$/)||a.match(/^\d+$/)){b-=10}if(b<0){b=0}if(b>100){b=100}if(b<34){return"weak"}if(b<68){return"medium"}return"strong"},checkRepetition:function(c,f){var e="";for(var a=0;a<f.length;a++){var d=true;for(var b=0;b<c&&(b+a+c)<f.length;b++){d=d&&(f.charAt(b+a)==f.charAt(b+a+c))}if(b<c){d=false}if(d){a+=c-1;d=false}else{e+=f.charAt(a)}}return e}});cm.ui.common.PasswordStrengthModal=Class.create(cm.ui.dialog.ModalDialog,{CloseHelpModelEvent:null,initializeData:function($super){$super();this._co=this.GetConfigOptions()},initializeUIElements:function(){var b=$$P.div("divPasswordStrengthModal");this.AddChild(b);b.AddClassName("passwordStrengthModal");var d=$$P.p();d.UpdateInnerHtml("A strong password contains a variety of different characters. Here are some good rules of thumb to follow when generating a password.");b.AddChild(d);var e=$$P.ul();e.AddClassName("passwordTips");b.AddChild(e);var c=$$P.li();c.UpdateInnerHtml("<strong>Length:</strong> A password should have a minimum of 6 characters");e.AddChild(c);var c=$$P.li();c.UpdateInnerHtml("<strong>Letters:</strong> A password should have both upper and lower case letters");e.AddChild(c);var c=$$P.li();c.UpdateInnerHtml("<strong>Numbers:</strong> A password should contain at least one number");e.AddChild(c);var c=$$P.li();c.UpdateInnerHtml("<strong>Symbols:</strong> A password should contain at least one symbol (!, @, #, $, ^, *, ?, _, ~)");e.AddChild(c);var c=$$P.li();c.UpdateInnerHtml("<strong>Inelligible Symbols:</strong> You cannot use the following symbols (+, %, &)");e.AddChild(c);var c=$$P.li();c.UpdateInnerHtml("<strong>Username:</strong> A password should be different from your username.");e.AddChild(c);var a=$$P.div();b.AddChild(a);this._btnDismissPasswordHelp=new $$BTN("btnDismissPasswordHelp",{text:"Close"});a.AddChild(this._btnDismissPasswordHelp);this._btnDismissPasswordHelp.AddClassName("cmFloatLeft")},createEvents:function($super){$super();this.CloseHelpModelEvent=new cm.event()},wireEvents:function($super){$super();this._btnDismissPasswordHelp.ClickEvent.subscribe(this.onCloseHelpModel,this)},onCloseHelpModel:function(b,a){this.CloseHelpModelEvent.fire(this)}});"cm.ui.common".namespace();cm.ui.common.PersonRelationshipInfoConfigOptions=Class.create(cm.ConfigOptions,{showHeader:true,width:305,rightMargin:0,strech:false});cm.ui.common.PersonRelationshipWidget=cm.ui.common.PersonRelationshipInfo=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.PersonRelationshipInfoConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._listsRelationshipArray=FW.Data.GetStore("Lists").Get("RelationshipArray");this._appendAgeToName=(this._co.appendAgeToName==true);this._strech=this._co.strech},initializeUIElements:function(){this._h2=$$P.h2(null,"Relationships");this.AddChild(this._h2);if(!this._co.showHeader){this._h2.Hide()}var b=(this._co.rightMargin+"px");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFloatLeft");a.AssignStyle("margin-right",b);if(this._strech){a.AddClassName("w100prct")}else{a.SetWidth(this._co.width)}this._divRelationshipLabel=$$P.div();a.AddChild(this._divRelationshipLabel);this._divRelationshipLabel.UpdateInnerHtml("Relationships To");this._divRelationshipLabel.AddClassName("cmFloatLeft cmBold");if(this._strech){this._divRelationshipLabel.AddClassName("w100prct")}else{this._divRelationshipLabel.SetWidth(this._co.width)}this._divRelationships=$$P.div();a.AddChild(this._divRelationships);this._divRelationships.UpdateInnerHtml("RelationshipControls");this._divRelationships.AddClassName("cmFloatLeft");if(this._strech){this._divRelationships.AddClassName("w100prct")}else{this._divRelationships.SetWidth(this._co.width)}},createEvents:function($super){$super()},wireEvents:function($super){$super()},postInitialize:function($super){$super()},reset:function(){this._divRelationships.ClearChildControls()},Bind:function(d,a,f,g){this.reset();var e=$A();var b=a.find(function(h){return h.Person.PersonID==d.PersonID},this);if(!$$CM.isNull(b)){var e=b.RelationshipArray}if(!$$CM.isNull(d)){if($$CM.isArray(a)){var c=a.findAll(function(h){return h.Person.PersonID!=d.PersonID},this);if(c.length==0){this._divRelationshipLabel.Hide()}else{this._divRelationshipLabel.Show();householdMembersArraySort=$A();c.each(function(h){householdMembersArraySort.push(h.Person)},this);householdMembersArraySort=householdMembersArraySort.sort($$CM.sortByNameFirstLastProperty);householdMembersArraySort.each(function(i){var j=e.find(function(l){return l.RelatedToPersonID==i.PersonID},this);var k=0;if(!$$CM.isNull(j)){k=j.RelationshipID}var h=new cm.ui.common.PersonRelationshipInfoControl("ctrPersonRelationshipInfoControl_"+this._uniqueID+"_"+i.PersonID,{width:this._co.width,appendAgeToName:this._appendAgeToName});this._divRelationships.AddChild(h);h.Bind(i,k,d,f,g)},this)}}}},GetData:function(){var a=$A();this._divRelationships.ChildControls().each(function(b){a.push(b.GetData())},this);return a}});cm.ui.common.PersonRelationshipInfoControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.PersonRelationshipInfoConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._listsRelationshipArray=FW.Data.Lists.RelationshipArray;this._appendAgeToName=(this._co.appendAgeToName==true)},initializeUIElements:function(){var a=this.ID();this._ddlRelationship=new $$FDDL("ddlRelationship_"+a,{spanWidth:this._co.width,inputWidth:200});this.AddChild(this._ddlRelationship);this._ddlRelationship.AddClassName("personRelationshipInfoControl");this._ddlRelationship.SetWidth(this._co.width)},ClearFields:function(){},Bind:function(f,h,e,i,j){this.ClearFields();this._personInfo=f;this._originalPersonInfo=e;this._thirdPartyPerson=i;var d=FW.Enums.Gender.Undefined;if(!$$CM.isNull(f)){d=this._originalPersonInfo.GenderID}if(!$$CM.isNull(i)){d=this._thirdPartyPerson.Gender}var a=$$UPRDU.RelationshipListGet(d);this._ddlRelationship.bindList(a,-1,"Select one...");var c="";if(!$$CM.isNull(f)&&!$$CM.isNull(f.Name)){c=$$CM.getFormattedPersonNameUPR(f.Name,false,true,true,false,true)}if(this._appendAgeToName){if(!$$CM.isNull(f)&&!$$CM.isEmpty(f.Age)&&Number(f.Age)>0){c+=" ("+f.Age+")"}}this._ddlRelationship.SetLabel(c);if($$CM.isNumber(h)&&h>0){var g="";if($$CM.isNumber(j)&&j>0){if(h==108||h==109||h==114||h==119||h==130){if(j==100||j==102||j==104||j==106||j==131){g=j}else{if(j==108||j==109||j==119){g=j}else{if(j==110||j==112||j==114){g=j}}}}if(h==117){if(j==100||j==131){g=128}else{if(j==128){g=100}else{if(j==108||j==109||j==119){g=130}else{if(j==130){g=108}else{if(j==101){g=101}else{if(j==113){g=113}else{if(j==111){g=110}}}}}}}}if(h==101||h==103){if(j==108||j==109||j==119||j==130){g=112}else{if(j==100||j==131){g=110}else{if(j==113){g=114}}}}if(h==100||j==131){if(j==114){g=113}}}else{this._listsRelationshipArray.each(function(k){if(k.ID==h){g=k.InverseID;throw $break}},this)}this._ddlRelationship.Bind(g)}else{if(e.GenderID!=FW.Enums.Gender.Undefined){var b="";if(f.RoleID<3&&e.RoleID<3){if(f.GenderID!=e.GenderID&&f.GenderID!=FW.Enums.Gender.Undefined){b=117}else{b=120}}else{if(f.RoleID>2&&e.RoleID<3){b=100}else{if(f.RoleID<3&&e.RoleID>2){b=101}else{if(f.RoleID>2&&e.RoleID>2){b=108}}}}this._ddlRelationship.Bind(b)}}if(!$$CM.isNumber(j)){this._ddlRelationship.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Relationship to "+c,IsRequired:true}))}},GetData:function(){var d=this._personInfo;var c=this._originalPersonInfo;var g=this._thirdPartyPerson;var f=c;if(!$$CM.isNull(g)){f=g}var e=Number(this._ddlRelationship.GetData());var b=0;this._listsRelationshipArray.each(function(h){if(h.ID==e){b=h.InverseID;throw $break}},this);var a={PersonID:f.PersonID,RelatedToPersonID:d.PersonID,RelationshipID:b};return a}});"cm.ui.common".namespace();cm.ui.common.PersonStatus=Class.create(cm.data.Data,{Child:null,Parent:null,Donor:null,Adult:null,Staff:null,PersonID:null,SeasonID:null,initializeData:function(a){this.enumPartition=cm.dao.Person.Enums.Partition;this.enumPartitionStatus=cm.dao.Person.Enums.PartitionStatus;this.enumPartitionWidgetSize=cm.dao.Person.Enums.PartitionWidgetSize;this.enumPartitionCategory=cm.dao.Person.Enums.PartitionCategory;this.enumPartitionFlag=cm.dao.Person.Enums.PartitionFlag;this.enumCamperStatus=cm.dao.Person.Enums.CamperStatus;this.enumStaffStatus=cm.dao.Person.Enums.StaffStatus;this.enumDonorStatus=cm.dao.Person.Enums.DonorStatus;this.enumContactStatus=cm.dao.Person.Enums.ContactStatus;if(!$$CM.isNull(a)){this.Child=new cm.ui.common.PersonStatusDetails(a.ChildDetails,{partition:this.enumPartition.asEnum().GetId("Child")});this.Parent=new cm.ui.common.PersonStatusDetails(a.ParentDetails,{partition:this.enumPartition.asEnum().GetId("Parent")});this.Donor=new cm.ui.common.PersonStatusDetails(a.DonorDetails,{partition:this.enumPartition.asEnum().GetId("Donor")});this.Adult=new cm.ui.common.PersonStatusDetails(a.AdultDetails,{partition:this.enumPartition.asEnum().GetId("Adult")});this.Staff=new cm.ui.common.PersonStatusDetails(a.StaffDetails,{partition:this.enumPartition.asEnum().GetId("Staff")});this.Contact=new cm.ui.common.PersonStatusDetails(a.ContactDetails,{partition:this.enumPartition.asEnum().GetId("Contact")});this.PersonID=a.PersonID;this.SeasonID=a.SeasonID}else{this.Child=new cm.ui.common.PersonStatusDetails(null,{partition:this.enumPartition.asEnum().GetId("Child")});this.Parent=new cm.ui.common.PersonStatusDetails(null,{partition:this.enumPartition.asEnum().GetId("Parent")});this.Donor=new cm.ui.common.PersonStatusDetails(null,{partition:this.enumPartition.asEnum().GetId("Donor")});this.Adult=new cm.ui.common.PersonStatusDetails(null,{partition:this.enumPartition.asEnum().GetId("Adult")});this.Staff=new cm.ui.common.PersonStatusDetails(null,{partition:this.enumPartition.asEnum().GetId("Staff")});this.Contact=new cm.ui.common.PersonStatusDetails(null,{partition:this.enumPartition.asEnum().GetId("Contact")})}return a},onDataChanged:function(){if(!$$CM.isNull(this.Value)){this.Child.Bind(this.Value.ChildDetails);this.Parent.Bind(this.Value.ParentDetails);this.Donor.Bind(this.Value.DonorDetails);this.Adult.Bind(this.Value.AdultDetails);this.Staff.Bind(this.Value.StaffDetails);this.Contact.Bind(this.Value.ContactDetails)}else{this.Child.Bind(null);this.Parent.Bind(null);this.Donor.Bind(null);this.Adult.Bind(null);this.Staff.Bind(null);this.Contact.Bind(null)}},GetDetails:function(a){switch(a){case this.enumPartition.asEnum().GetId("Child"):return this.Child;case this.enumPartition.asEnum().GetId("Staff"):return this.Staff;case this.enumPartition.asEnum().GetId("Donor"):return this.Donor;case this.enumPartition.asEnum().GetId("Adult"):return this.Adult;case this.enumPartition.asEnum().GetId("Parent"):return this.Parent;case this.enumPartition.asEnum().GetId("Contact"):return this.Contact;default:return null}},GetMainPartition:function(){if(this.Child.IsActiveInPartition()){return this.enumPartition.asEnum().GetId("Child")}else{if(this.Staff.IsActiveInPartition()){return this.enumPartition.asEnum().GetId("Staff")}else{if(this.Parent.IsActiveInPartition()){return this.enumPartition.asEnum().GetId("Parent")}else{if(this.Adult.IsActiveInPartition()){return this.enumPartition.asEnum().GetId("Adult")}else{if(this.Donor.IsActiveInPartition()){return this.enumPartition.asEnum().GetId("Donor")}else{return this.enumPartition.asEnum().GetId("Contact")}}}}}},IsCurrentSeason:function(){var a=$$CLIENT.CurrentSeasonID;return this.SeasonID==a},IsAlumni:function(){return(this.IsAlumniChild()||this.IsAlumniStaff()||this.IsAlumniAdult())==true},IsAlumniChild:function(){return this.IsActiveCamper()!=true&&this.Child.IsFormer()==true&&this.Child.IsNextYear()!=true},IsAlumniStaff:function(){return this.IsActiveStaff()!=true&&this.Staff.IsFormer()==true&&this.Staff.IsNextYear()!=true},IsAlumniAdult:function(){return this.IsActiveAdult()!=true&&this.Adult.IsFormer()==true&&this.Adult.IsNextYear()!=true},IsEnrolledWithdrawnDismissedLeftEarly:function(){return this.IsChild()&&(this.Child.IsEnrolled()||this.Child.IsWithdrawn()||this.Child.IsDismissed()||this.Child.IsLeftEarly())},IsEnrolledCamperTag:function(){return this.IsChild()&&(this.Child.IsEnrolled()||this.Child.IsCancelled()||this.Child.IsWithdrawn()||this.Child.IsDismissed()||this.Child.IsLeftEarly())},IsAppliedCamperTag:function(){return this.IsChild()&&(this.Child.IsApplied()||this.Child.IsWaitList()||this.Child.IsEligible())},IsActiveCamper:function(){return this.IsChild()&&(this.Child.IsEnrolled()||this.Child.IsApplied()||this.Child.IsLead()||this.Child.IsIncomplete()||this.Child.IsCancelled()||this.Child.IsWithdrawn()||this.Child.IsDismissed()||this.Child.IsWaitList()||this.Child.IsLeftEarly()||this.Child.IsEligible())},IsActiveCamperNotLead:function(){return this.IsChild()&&(this.Child.IsEnrolled()||this.Child.IsApplied()||this.Child.IsIncomplete()||this.Child.IsCancelled()||this.Child.IsWithdrawn()||this.Child.IsDismissed()||this.Child.IsWaitList()||this.Child.IsLeftEarly()||this.Child.IsEligible())},IsActiveCamperTag:function(){return this.IsChild()&&(this.Child.IsEnrolled()||this.Child.IsApplied()||this.Child.IsCancelled()||this.Child.IsWithdrawn()||this.Child.IsDismissed()||this.Child.IsWaitList()||this.Child.IsLeftEarly()||this.Child.IsEligible())},IsChild:function(){return this.Child.IsInPartition()==true},IsActiveStaff:function(){return this.IsStaff()&&(this.Staff.IsHired()||this.Staff.IsApplied()||this.Staff.IsLead()||this.Staff.IsIncomplete()||this.Staff.IsCancelled()||this.Staff.IsWithdrawn()||this.Staff.IsDismissed()||this.Staff.IsRejected()||this.Staff.IsResigned()||this.Staff.IsEligible())},IsActiveStaffNotLead:function(){return this.IsStaff()&&(this.Staff.IsHired()||this.Staff.IsApplied()||this.Staff.IsIncomplete()||this.Staff.IsCancelled()||this.Staff.IsWithdrawn()||this.Staff.IsDismissed()||this.Staff.IsRejected()||this.Staff.IsResigned()||this.Staff.IsEligible())},IsStaff:function(){return this.Staff.IsInPartition()==true},IsActiveParentNonLead:function(){return this.IsParent()&&(this.Parent.IsEnrolled()||this.Parent.IsApplied()||this.Parent.IsIncomplete()||this.Parent.IsCancelled()||this.Parent.IsWithdrawn()||this.Parent.IsDismissed()||this.Parent.IsWaitList()||this.Parent.IsLeftEarly()||this.Parent.IsEligible())},IsParent:function(){return this.Parent.IsInPartition()==true},IsActiveAdult:function(){return this.IsAdult()&&(this.Adult.IsEnrolled()||this.Adult.IsApplied()||this.Adult.IsLead()||this.Adult.IsIncomplete()||this.Adult.IsCancelled()||this.Adult.IsWithdrawn()||this.Adult.IsDismissed()||this.Adult.IsWaitList()||this.Adult.IsLeftEarly()||this.Adult.IsEligible())},IsActiveAdultNotLead:function(){return this.IsAdult()&&(this.Adult.IsEnrolled()||this.Adult.IsApplied()||this.Adult.IsIncomplete()||this.Adult.IsCancelled()||this.Adult.IsWithdrawn()||this.Adult.IsDismissed()||this.Adult.IsWaitList()||this.Adult.IsLeftEarly()||this.Adult.IsEligible())},IsActiveAdultTag:function(){return this.IsAdult()&&(this.Adult.IsEnrolled()||this.Adult.IsApplied()||this.Adult.IsCancelled()||this.Adult.IsWithdrawn()||this.Adult.IsDismissed()||this.Adult.IsWaitList()||this.Adult.IsLeftEarly()||this.Adult.IsEligible())},IsAdult:function(){return this.Adult.IsInPartition()==true},IsDonor:function(){return this.Donor.IsInPartition()==true},IsContact:function(){return(this.Contact.IsInPartition()==true||(this.Child.IsInPartition()!=true&&this.Staff.IsInPartition()!=true&&this.Parent.IsInPartition()!=true&&this.Adult.IsInPartition()!=true&&this.Donor.IsInPartition()!=true))},IsGuest:function(){return this.Contact.IsActiveInPartition()==true&&this.Contact.IsGuest()},IsUser:function(){return this.Contact.IsActiveInPartition()==true&&this.Contact.IsUser()},IsMember:function(){return this.Contact.IsActiveInPartition()==true&&this.Contact.IsMember()},GetPrimaryChildStatus:function(){if(!$$CM.isNull(this.Child)){if(this.Child.IsEnrolled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:2}}else{if(this.Child.IsWaitList()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:8}}else{if(this.Child.IsApplied()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:4}}else{if(this.Child.IsIncomplete()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:512}}else{if(this.Child.IsCancelled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:32}}else{if(this.Child.IsLeftEarly()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:16}}else{if(this.Child.IsEligible()){return{Partition:FW.Enums.PartitionFlag.Eligible,Status:1}}else{if(this.Child.IsNextYear()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Future,Status:1}}else{if(this.Child.IsFormer()){return{Partition:FW.Enums.PartitionFlag.Former,Status:1}}else{if(this.Child.IsLead()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Lead,Status:1}}}}}}}}}}}}return{Partition:FW.Enums.PartitionFlag.None,Status:1}},GetPrimaryStaffStatus:function(){if(!$$CM.isNull(this.Staff)){if(this.Staff.IsHired()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:2}}else{if(this.Staff.IsApplied()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:4}}else{if(this.Staff.IsIncomplete()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:128}}else{if(this.Staff.IsResigned()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:16}}else{if(this.Staff.IsDismissed()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:32}}else{if(this.Staff.IsCancelled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:64}}else{if(this.Staff.IsRejected()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:8}}else{if(this.Staff.IsEligible()){return{Partition:FW.Enums.PartitionFlag.Eligible,Status:1}}else{if(this.Staff.IsNextYear()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Future,Status:1}}else{if(this.Staff.IsFormer()){return{Partition:FW.Enums.PartitionFlag.Former,Status:1}}else{if(this.Staff.IsLead()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Lead,Status:1}}}}}}}}}}}}}return{Partition:FW.Enums.PartitionFlag.None,Status:1}},GetPrimaryParentStatus:function(){if(!$$CM.isNull(this.Parent)){if(this.Parent.IsEnrolled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:2}}else{if(this.Parent.IsWaitList()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:8}}else{if(this.Parent.IsApplied()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:4}}else{if(this.Parent.IsIncomplete()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:512}}else{if(this.Parent.IsCancelled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:32}}else{if(this.Parent.IsLeftEarly()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:16}}else{if(this.Parent.IsEligible()){return{Partition:FW.Enums.PartitionFlag.Eligible,Status:1}}else{if(this.Parent.IsNextYear()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Future,Status:1}}else{if(this.Parent.IsFormer()){return{Partition:FW.Enums.PartitionFlag.Former,Status:1}}else{if(this.Parent.IsLead()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Lead,Status:1}}}}}}}}}}}}return{Partition:FW.Enums.PartitionFlag.None,Status:1}},GetPrimaryAdultStatus:function(){if(!$$CM.isNull(this.Adult)){if(this.Adult.IsEnrolled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:2}}else{if(this.Adult.IsWaitList()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:8}}else{if(this.Adult.IsApplied()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:4}}else{if(this.Adult.IsIncomplete()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:512}}else{if(this.Adult.IsCancelled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:32}}else{if(this.Adult.IsLeftEarly()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:16}}else{if(this.Adult.IsEligible()){return{Partition:FW.Enums.PartitionFlag.Eligible,Status:1}}else{if(this.Adult.IsNextYear()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Future,Status:1}}else{if(this.Adult.IsFormer()){return{Partition:FW.Enums.PartitionFlag.Former,Status:1}}else{if(this.Adult.IsLead()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Lead,Status:1}}}}}}}}}}}}return{Partition:FW.Enums.PartitionFlag.None,Status:1}},GetPrimaryDonorStatus:function(){if(!$$CM.isNull(this.Donor)){if(this.Donor.IsEnrolled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:2}}else{if(this.Donor.IsCancelled()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:32}}else{if(this.Donor.IsFormer()){return{Partition:FW.Enums.PartitionFlag.Former,Status:1}}else{if(this.Donor.IsLead()&&this.IsCurrentSeason()){return{Partition:FW.Enums.PartitionFlag.Lead,Status:1}}}}}}return{Partition:FW.Enums.PartitionFlag.None,Status:1}},GetPrimaryContactStatus:function(){if(!$$CM.isNull(this.Contact)){if(this.Contact.IsUser()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:4}}else{if(this.Contact.IsMember()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:8}}else{if(this.Contact.IsGuest()){return{Partition:FW.Enums.PartitionFlag.Exists,Status:2}}}}if(this.GetPrimaryChildStatus().Partition==FW.Enums.PartitionFlag.None&&this.GetPrimaryStaffStatus().Partition==FW.Enums.PartitionFlag.None&&this.GetPrimaryParentStatus().Partition==FW.Enums.PartitionFlag.None&&this.GetPrimaryAdultStatus().Partition==FW.Enums.PartitionFlag.None&&this.GetPrimaryDonorStatus().Partition==FW.Enums.PartitionFlag.None){return{Partition:FW.Enums.PartitionFlag.None,Status:1}}}return{Partition:FW.Enums.PartitionFlag.None,Status:0}},GetPrimaryPartition:function(){var d=this.enumPartitionCategory;var e=this.enumPartitionFlag;var a=this.enumCamperStatus;var f=this.enumStaffStatus;var c=this.enumDonorStatus;var b=this.enumContactStatus;if(!$$CM.isNull(this.Child)&&this.Child.IsEnrolled()){return this.enumPartitionCategory.asEnum().GetId("Child")}else{if(!$$CM.isNull(this.Staff)&&this.Staff.IsHired()){return this.enumPartitionCategory.asEnum().GetId("Staff")}else{if(!$$CM.isNull(this.Child)&&this.Child.IsEligible()){return this.enumPartitionCategory.asEnum().GetId("Child")}else{if(!$$CM.isNull(this.Staff)&&this.Staff.IsEligible()){return this.enumPartitionCategory.asEnum().GetId("Staff")}else{if(!$$CM.isNull(this.Child)&&this.Child.IsLead()){return this.enumPartitionCategory.asEnum().GetId("Child")}else{if(!$$CM.isNull(this.Staff)&&this.Staff.IsLead()){return this.enumPartitionCategory.asEnum().GetId("Staff")}else{if(!$$CM.isNull(this.Parent)&&this.Parent.IsEnrolled()){return this.enumPartitionCategory.asEnum().GetId("Parent")}else{if(!$$CM.isNull(this.Adult)&&this.Adult.IsEnrolled()){return this.enumPartitionCategory.asEnum().GetId("Adult")}else{if(!$$CM.isNull(this.Parent)&&this.Parent.IsActiveInPartition()){return this.enumPartitionCategory.asEnum().GetId("Parent")}else{if(!$$CM.isNull(this.Child)&&this.Child.IsActiveInPartition()){return this.enumPartitionCategory.asEnum().GetId("Child")}else{if(!$$CM.isNull(this.Staff)&&this.Staff.IsActiveInPartition()){return this.enumPartitionCategory.asEnum().GetId("Staff")}else{if(!$$CM.isNull(this.Adult)&&this.Adult.IsActiveInPartition()){return this.enumPartitionCategory.asEnum().GetId("Adult")}else{if(!$$CM.isNull(this.Donor)&&this.Donor.IsActiveInPartition()){return this.enumPartitionCategory.asEnum().GetId("Donor")}}}}}}}}}}}}}return this.enumPartitionCategory.asEnum().GetId("Contact")}});CMEnvironmentLoadEvent.subscribe(function(){if(!(typeof(FW)=="undefined"||$$CM.isNull(FW))){var a=FW.Enums.PartitionFlag;if(!$$CM.isNull(a)){$$PF={};a.GetArray().each(function(b){$$PF[b.Name]=parseInt(b.ID)})}if(!$$CM.isNull(FW.Enums.PartitionStatus)){$$PS={LD:FW.Enums.PartitionStatus.Lead,AP:FW.Enums.PartitionStatus.Applied,EN:FW.Enums.PartitionStatus.Enrolled,RE:FW.Enums.PartitionStatus.Eligible,FO:FW.Enums.PartitionStatus.Former,NY:FW.Enums.PartitionStatus.Future,X:FW.Enums.PartitionStatus.Cancelled,WL:FW.Enums.PartitionStatus.WaitList,ALL:function(){return $A([this.LD,this.AP,this.EN,this.RE,this.FO,this.NY,this.X,this.WL])},ARR:function(){return $A(arguments).collect(function(b){return this[b]},this)},POS_ROW_CONTACT:0,POS_ROW_DONOR:1,POS_ROW_PARENT:2,POS_ROW_CHILD:3,POS_ROW_ADULT:4,POS_ROW_STAFF:5,POS_X_CHILD:0,POS_X_STAFF:27,POS_X_ADULT:57,POS_X_PARENT:57,POS_X_DONOR:88,POS_X_CONTACT:119,PartitionSorted:$A([FW.Enums.Partition.Child,FW.Enums.Partition.Staff,FW.Enums.Partition.Parent,FW.Enums.Partition.Adult,FW.Enums.Partition.Donor,FW.Enums.Partition.Contact])}}}},this);"cm.ui.common".namespace();cm.ui.common.PersonStatusDetailsConfigOptions=Class.create(cm.ConfigOptions,{partition:0});cm.ui.common.PersonStatusDetails=Class.create(cm.data.Data,{Partition:null,StatusFlags:null,PartitionFlags:null,Years:null,initializeData:function(a){this.enumPartition=cm.dao.Person.Enums.Partition;this.enumPartitionStatus=cm.dao.Person.Enums.PartitionStatus;this.enumPartitionWidgetSize=cm.dao.Person.Enums.PartitionWidgetSize;this.enumPartitionFlag=cm.dao.Person.Enums.PartitionFlag;this.enumStaffStatus=cm.dao.Person.Enums.StaffStatus;this.enumCamperStatus=cm.dao.Person.Enums.CamperStatus;this.enumDonorStatus=cm.dao.Person.Enums.DonorStatus;this.enumContactStatus=cm.dao.Person.Enums.ContactStatus;this.SetPartition(this.GetConfigOptions().partition);if(!$$CM.isNull(a)){this.PartitionFlags=a.Partition;this.StatusFlags=a.Status;this.Years=a.Years}else{this.PartitionFlags=1;this.StatusFlags=1;this.Years=0}return a},onDataChanged:function(){if(!$$CM.isNull(this.Value)){this.PartitionFlags=this.Value.Partition;this.StatusFlags=this.Value.Status;this.Years=this.Value.Years}else{this.PartitionFlags=1;this.StatusFlags=1;this.Years=0}},configureDefaultOptions:function(){return new cm.ui.common.PersonStatusDetailsConfigOptions()},IsInPartition:function(){return(this.PartitionFlags!=this.enumPartitionFlag.asEnum().GetId("None"))},IsActiveInPartition:function(){return((this.PartitionFlags&this.enumPartitionFlag.asEnum().GetId("Exists"))==this.enumPartitionFlag.asEnum().GetId("Exists"))},SetPartition:function(b){if($$CM.isNumber(b)){this.Partition=b;try{var c=this.enumPartition.asEnum().GetId(this.Partition)}catch(a){this.Partition=this.enumPartition.asEnum().GetId("Undefined")}}else{if($$CM.isString(b)){try{this.Partition=this.enumPartition.asEnum().GetId(b)}catch(a){this.Partition=this.enumPartition.asEnum().GetId("Undefined")}}}},HasPartitionFlag:function(a){return((this.PartitionFlags&a)==a)},HasStatusFlag:function(a){return((this.StatusFlags&a)==a)},IsCurrentSeason:function(b){var a=$$CLIENT.CurrentSeasonID;return b==a},GetPartitionStatus:function(a){if($$CM.isNull(a)){a=$$CLIENT.CurrentSeasonID}if(this.IsEnrolled()){return this.enumPartitionStatus.asEnum().GetId("Enrolled")}if(this.IsWaitList()){return this.enumPartitionStatus.asEnum().GetId("WaitList")}if(this.IsApplied()){return this.enumPartitionStatus.asEnum().GetId("Applied")}if(this.IsIncomplete()){return this.enumPartitionStatus.asEnum().GetId("Incomplete")}if(this.IsResigned()){return this.enumPartitionStatus.asEnum().GetId("Cancelled")}if(this.IsDismissed()){return this.enumPartitionStatus.asEnum().GetId("Cancelled")}if(this.IsCancelled()){return this.enumPartitionStatus.asEnum().GetId("Cancelled")}if(this.IsRejected()){return this.enumPartitionStatus.asEnum().GetId("Cancelled")}if(this.IsLeftEarly()){return this.enumPartitionStatus.asEnum().GetId("Eligible")}if(this.IsEligible()){return this.enumPartitionStatus.asEnum().GetId("Eligible")}if(this.IsNextYear()&&this.IsCurrentSeason(a)){return this.enumPartitionStatus.asEnum().GetId("NextYear")}if(this.IsFormer()){return this.enumPartitionStatus.asEnum().GetId("Former")}if(this.IsLead()&&(this.enumPartition.asEnum().GetId("Child")!=this.Partition||(this.enumPartition.asEnum().GetId("Child")==this.Partition&&this.IsCurrentSeason(a)))){return this.enumPartitionStatus.asEnum().GetId("Lead")}if(this.IsUser()){return this.enumPartitionStatus.asEnum().GetId("Enrolled")}if(this.IsGuest()){return this.enumPartitionStatus.asEnum().GetId("Applied")}if(this.IsMember()){return this.enumPartitionStatus.asEnum().GetId("Eligible")}if(this.Partition==this.enumPartition.asEnum().GetId("Contact")){return 1}return this.enumPartitionStatus.asEnum().GetId("Undefined")},GetPartitionStatusName:function(a){if($$CM.isNull){a=$$CLIENT.CurrentSeasonID}if(this.IsEnrolled()){if(this.GetConfigOptions().partition==this.enumPartition.asEnum().GetId("Staff")){return"Hired"}else{if(this.GetConfigOptions().partition==this.enumPartition.asEnum().GetId("Donor")){return"Active"}else{return"Enrolled"}}}if(this.IsWaitList()){return"Wait Listed"}if(this.IsApplied()){return"Applied"}if(this.IsIncomplete()){return"Incomplete"}if(this.IsResigned()){return"Resigned"}if(this.IsDismissed()){return"Dismissed"}if(this.IsCancelled()){return"Cancelled"}if(this.IsRejected()){return"Rejected"}if(this.IsLeftEarly()){return"Left Early"}if(this.IsEligible()){if(this.GetConfigOptions().partition==this.enumPartition.asEnum().GetId("Staff")){return"Eligible for Re-hire"}else{return"Eligible for Re-enrollment"}}if(this.IsNextYear()&&this.IsCurrentSeason()){return"Next Year"}if(this.IsFormer()){return"Former"}if(this.IsLead()&&(this.enumPartition.asEnum().GetId("Child")!=this.Partition||(this.enumPartition.asEnum().GetId("Child")==this.Partition&&this.IsCurrentSeason(a)))){return"Lead"}if(this.IsUser()){return"User"}if(this.IsGuest()){return"Guest"}if(this.IsMember()){return"Member"}return""},GetPartitionStatusAbbreviation:function(a){if($$CM.isNull){a=$$CLIENT.CurrentSeasonID}if(this.IsEnrolled()){if(this.GetConfigOptions().partition==this.enumPartition.asEnum().GetId("Staff")){return"HI"}else{if(this.GetConfigOptions().partition==this.enumPartition.asEnum().GetId("Donor")){return"DO"}else{return"EN"}}}if(this.IsWaitList()){return"WL"}if(this.IsApplied()){return"AP"}if(this.IsIncomplete()){return"IN"}if(this.IsResigned()){return"X"}if(this.IsDismissed()){return"X"}if(this.IsCancelled()){return"X"}if(this.IsRejected()){return"X"}if(this.IsLeftEarly()){return"X"}if(this.IsEligible()){if(this.GetConfigOptions().partition==this.enumPartition.asEnum().GetId("Staff")){return"RE"}else{return"RE"}}if(this.IsNextYear()&&this.IsCurrentSeason()){return"NY"}if(this.IsFormer()){return"FO"}if(this.IsLead()&&(this.enumPartition.asEnum().GetId("Child")!=this.Partition||(this.enumPartition.asEnum().GetId("Child")==this.Partition&&this.IsCurrentSeason(a)))){return"LD"}if(this.IsUser()){return"U"}if(this.IsGuest()){return"G"}if(this.IsMember()){return"M"}return""},IsEnrolled:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"));case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Hired"));case this.enumPartition.asEnum().GetId("Parent"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Enrolled"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Enrolled"))}},IsApplied:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Applied"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Applied"))}},IsIncomplete:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Incomplete"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Incomplete"))}},IsWithdrawn:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Withdrawn"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Withdrawn"))}},IsDismissed:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Dismissed"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Dismissed"))}},IsCancelled:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Cancelled"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Cancelled"))}},IsEligible:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Eligible"));case this.enumPartition.asEnum().GetId("Staff"):return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Eligible"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("None"));default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Eligible"))}},IsWaitList:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return false;default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("WaitList"))}},IsLeftEarly:function(){switch(this.Partition){case this.enumPartition.asEnum().GetId("Contact"):return false;case this.enumPartition.asEnum().GetId("Donor"):return false;case this.enumPartition.asEnum().GetId("Staff"):return false;default:return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("LeftEarly"))}},IsInquiry:function(){return this.Partition==this.enumPartition.asEnum().GetId("Child")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumCamperStatus.asEnum().GetId("Inquiry"))},IsHired:function(){return this.Partition==this.enumPartition.asEnum().GetId("Staff")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Hired"))},IsRejected:function(){return this.Partition==this.enumPartition.asEnum().GetId("Staff")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Rejected"))},IsResigned:function(){return this.Partition==this.enumPartition.asEnum().GetId("Staff")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumStaffStatus.asEnum().GetId("Resigned"))},IsGuest:function(){return this.Partition==this.enumPartition.asEnum().GetId("Contact")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumContactStatus.asEnum().GetId("Guest"))},IsUser:function(){return this.Partition==this.enumPartition.asEnum().GetId("Contact")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumContactStatus.asEnum().GetId("User"))},IsMember:function(){return this.Partition==this.enumPartition.asEnum().GetId("Contact")&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasStatusFlag(this.enumContactStatus.asEnum().GetId("Member"))},IsLead:function(){if(this.Partition==this.enumPartition.asEnum().GetId("Contact")){return false}return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Exists"))&&this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Lead"))},IsFormer:function(){if(this.Partition==this.enumPartition.asEnum().GetId("Contact")){return false}return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Former"))},IsNextYear:function(){if(this.Partition==this.enumPartition.asEnum().GetId("Contact")){return false}return this.HasPartitionFlag(this.enumPartitionFlag.asEnum().GetId("Future"))}});"cm.ui.common".namespace();cm.ui.common.PhoneControlConfigOptions=Class.create(cm.ConfigOptions,{isRequired:false,classNames:"cmInputLabel mb5px",titleCssClass:"",ddlCssClass:"m0px",inputCssClass:"cmInputWidth"});$$FPHONE=cm.ui.common.PhoneControl=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.PhoneControlConfigOptions()},render:function(){return $$E($$P.lbl(this._id+"Controls"))},initializeData:function($super){$super();this._co=this.GetConfigOptions();if($$CM.isNull(this._co)){this._co=new Object()}this._uniqueID=$$CM.uniqueID()},initializeUIElements:function(){this.AddClassName(this._co.classNames);var a=$$P.span();this.AddChild(a);a.AddClassName("cmTitleBase cmTitleWidth cmTextTitleBase");this._ddlPhoneType=new $$DDL("ddlPhoneType_"+this._uniqueID);this._ddlPhoneType.bindList($A([{Name:"Home Phone",ID:1},{Name:"Work Phone",ID:2},{Name:"Cell Phone",ID:3},{Name:"Other Phone",ID:0}]),"",null,false);a.AddChild(this._ddlPhoneType);this._ddlPhoneType.AddClassName(this._co.ddlCssClass);this._ddlPhoneType.AssignStyle("height","21px");if(this._co.isRequired==true){this._ddlPhoneType.AssignStyle("border-color","gray");this._ddlPhoneType.AssignStyle("border-bottom-style","dotted");this._ddlPhoneType.AssignStyle("border-bottom-color","red")}this._txtPhone=$$P.txt("txtPhone_"+this._uniqueID);this.AddChild(this._txtPhone);this._txtPhone.AddClassName(this._co.inputCssClass);if(!$$CM.isNull(this._co.fieldTip)){this._fieldTip=$$P.span("fieldTip_"+this._uniqueID,this._co.fieldTip);this.AddChild(this._fieldTip);this._fieldTip.AddClassName("cmFieldTip")}},createEvents:function(){this._txtPhone.AddChangeListener();this._ddlPhoneType.AddChangeListener()},postInitialize:function(){this._txtPhone.GetData=function(){return $$E(this).value}},onDataUpdated:function(){var a=this.GetBoundData();if($$CM.isNull(a)){return}this._ddlPhoneType.Bind(a.PhoneTypeID);this._txtPhone.Bind(a.PhoneNumber)},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.PhoneTypeID=this._ddlPhoneType.GetData();a.PhoneNumber=this._txtPhone.GetData();return a},Reset:function(){this._ddlPhoneType.Bind(1);this._txtPhone.Bind("")},SetValidation:function(a){this._txtPhone.Validator.addEvaluator($$EVAL.STRING({FieldName:a+" Phone",IsRequired:this._co.isRequired}),this._txtPhone.ChangeEvent);this._ddlPhoneType.Validator.addEvaluator($$EVAL.STRING({FieldName:a+" Phone Type",IsRequired:this._co.isRequired}),this._ddlPhoneType.ChangeEvent)},SetTabIndex:function(a){this._ddlPhoneType.SetTabIndex(a++);this._txtPhone.SetTabIndex(a++)},ToggleValidation:function(a){if(a==true){this._txtPhone.Validator.Enable();this._ddlPhoneType.Validator.Enable()}else{this._txtPhone.Validator.Disable();this._ddlPhoneType.Validator.Disable()}}});"cm.ui.common".namespace();cm.ui.common.StepConfigOptions=Class.create(cm.ConfigOptions,{stepNumber:0,neverClickable:false,alwaysClickable:false,location:"left",stepFooter:null});$$STPBTN=cm.ui.common.Step=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.StepConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();this._location=this._co.location;this._neverClickable=this._co.neverClickable;this._alwaysClickable=this._co.alwaysClickable;this._circleText=$$P.p(null,this._co.stepNumber,{classNames:"cmStepCircleText"})},initializeUIElements:function(){this.AddClassName("cmFloatLeft");this._divWrapper=$$P.div();this.AddChild(this._divWrapper);this._divWrapper.SetWidth(150);if(this._location==="left"){this._myCircle=$$P.div("stepCircle_"+this._co.stepNumber,null,{classNames:"cmStepCircle ml55px"});this._myCircle.AddChild(this._circleText);this._divWrapper.AddChild(this._myCircle);this._myLine=$$P.div("stepLine_"+this._co.stepNumber,null,{classNames:"cmStepLine"});this._divWrapper.AddChild(this._myLine);this._myName=$$P.p("myName",this._co.stepName,{});this._myName.AddClassName("fs12px cmCenter cmStepName");this._divWrapper.AddChild(this._myName);this._divWrapper.AddClassName("cmFloatRight")}else{if(this._location==="middle"){this._myLineLeft=$$P.div("stepLeft_"+this._co.stepNumber,null,{classNames:"cmStepLine"});this._divWrapper.AddChild(this._myLineLeft);this._myCircle=$$P.div("stepCircle_"+this._co.stepNumber,null,{classNames:"cmStepCircle"});this._myCircle.AddChild(this._circleText);this._divWrapper.AddChild(this._myCircle);this._myLineRight=$$P.div("stepRight_"+this._co.stepNumber,null,{classNames:"cmStepLine"});this._divWrapper.AddChild(this._myLineRight);this._myName=$$P.p("myName",this._co.stepName,{});this._myName.AddClassName("fs12px cmCenter cmStepName");this._divWrapper.AddChild(this._myName);this._divWrapper.AddClassName("cmFloatLeft")}else{this._myLine=$$P.div("stepLine_"+this._co.stepNumber,null,{classNames:"cmStepLine"});this._divWrapper.AddChild(this._myLine);this._myCircle=$$P.div("stepCircle_"+this._co.stepNumber,null,{classNames:"cmStepCircle"});this._myCircle.AddChild(this._circleText);this._divWrapper.AddChild(this._myCircle);this._myName=$$P.p("myName",this._co.stepName,{});this._myName.AddClassName("fs12px cmCenter cmStepName");this._divWrapper.AddChild(this._myName);this._divWrapper.AddClassName("cmFloatLeft")}}},createEvents:function(){this._myCircle.AddClickListener();this.ButtonsClickedEvent=new cm.event()},wireEvents:function(){this._myCircle.ClickEvent.subscribe(this.onClick,this)},postInitialize:function(){if(this._co._neverClickable){this.EnableClick(false)}},onClick:function(b,a){this.ButtonsClickedEvent.fire(b,this._co.stepNumber)},UpdateStatus:function(a){this._myCircle.RemoveClassName("stepActive");this._myName.RemoveClassName("stepActive");if(this._location==="middle"){this._myLineLeft.RemoveClassName("stepActive");this._myLineRight.RemoveClassName("stepActive")}else{this._myLine.RemoveClassName("stepActive")}if(a){this._myCircle.AddClassName("stepActive");this._myName.AddClassName("stepActive");if(this._location==="middle"){this._myLineLeft.AddClassName("stepActive");this._myLineRight.AddClassName("stepActive")}else{this._myLine.AddClassName("stepActive")}}},EnableClick:function(a){if(this._neverClickable){a=false}this._myCircle.RemoveClassName("stepClickEnabled");if(this._alwaysClickable){this._myCircle.ClickEvent.Enable();if(a){this._myCircle.AddClassName("stepClickEnabled")}return}if(a){this._myCircle.ClickEvent.Enable();this._myCircle.AddClassName("stepClickEnabled")}else{this._myCircle.ClickEvent.Disable()}},GetStepNumber:function(){return this._co.stepNumber}});"cm.ui.common".namespace();cm.ui.common.StepsWidgetConfigOptions=Class.create(cm.ConfigOptions,{initialHeader:0,steps:null});$$STPS=cm.ui.common.StepsWidget=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.StepsWidgetConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();this._steps=this._co.steps;this._stepName="step_";this._stepHeaderToInitialize=this._co.initialHeader;this._activeStep=1},initializeUIElements:function(){this._widgetContainer=$$P.div("stepWidgetContainer",null,{classNames:"stepWidgetContainer p10px"});this.addHeader(this._steps[this._stepHeaderToInitialize].header);this.AddChild(this._widgetContainer);this.addSteps();this.updateSteps()},addHeader:function(a){this._headerDiv=$$P.div();this._stepWidgetHeader=$$P.h3("stepWidgetHeader",a,{classNames:"stepWidgetHeader mb50px ContextualHelpinline"});this._stepWidgetHeader.AssignStyle("font-size","17px");this._headerDiv.AddChild(this._stepWidgetHeader);this._stepWidgetHeaderContextualHelpDiv=$$P.div(a.split(" ").join("")+"ContextualHelp",null,{classNames:"ContextualHelpinline mt17px"});this._headerDiv.AddChild(this._stepWidgetHeaderContextualHelpDiv);this.AddChild(this._headerDiv)},addSteps:function(){this._stepContainer=$$P.div("stepWidget",null,{classNames:"stepWidget p10px"});this._widgetContainer.AddChild(this._stepContainer);this._steps.each(function(b,a){var c=null;if(a==0){var c=this.addStep(b,a,"left")}else{if(a==(this._steps.length-1)){var c=this.addStep(b,a,"right")}else{var c=this.addStep(b,a,"middle")}}c.ButtonsClickedEvent.subscribe(this.stepClicked,this);this._stepContainer.AddChild(c)},this)},addStep:function(c,b,a){var e=c.header;if(!$$CM.isNull(c.footer)){e=c.footer}var d=new $$STPBTN(this._stepName+(b+1),{stepNumber:b+1,location:a,neverClickable:c.neverClickable,alwaysClickable:c.alwaysClickable,stepName:e});return d},Bind:function(a){},postInitialize:function(){},createEvents:function(){this.ButtonsClickedEvent=new cm.event()},wireEvents:function(){},stepClicked:function(c,b){var a=b;this.SetActiveStep(a);this.ButtonsClickedEvent.fire(c,a)},updateSteps:function(){this._stepContainer.ChildControls().each(function(a){var b=a.GetStepNumber();this.UpdateStatus(b,b<=this._activeStep);this.EnableClick(b,b<this._activeStep)},this);this._stepWidgetHeader.UpdateInnerHtml(this._steps[this._activeStep-1].header)},clearDiv:function(){this._widgetContainer.DestroyChildControls(true)},getStepControl:function(b){var a=this._stepContainer.ChildControls().find(function(c){return c.GetStepNumber()==b},this);return a},SetActiveStep:function(a){this._activeStep=a;this.updateSteps()},UpdateStatus:function(c,a){var b=this.getStepControl(c);if(!$$CM.isNull(b)){b.UpdateStatus(a)}},EnableClick:function(c,a){var b=this.getStepControl(c);if(!$$CM.isNull(b)){b.EnableClick(a)}}});"cm.ui.common".namespace();cm.ui.common.TabControlConfigOptions=Class.create(cm.ConfigOptions,{droppableTabs:false,vertical:false,tabCssClass:"",controlCssClass:""});$$TABS=cm.ui.common.TabControl=Class.create(cm.ui.UILibraryControl,{_list:null,_tabs:null,_selectedIndex:0,_hidden:null,TabBeforeSelectEvent:null,TabSelectEvent:null,TabHoverEvent:null,TabEventsRefreshedEvent:null,initializeData:function($super){$super();this._co=this.GetConfigOptions();this._hidden=$A();this._tabs=$A()},AddTab:function(j,c,i,d){var h=this.GetSelectedTab();var f=$$CM.rawGuid();var g=$$P.li();this._list.AddChild(g);if(!$$CM.isEmpty(i)){g.AddClassName(i)}else{if(!$$CM.isEmpty(this._co.tabCssClass)){g.AddClassName(this._co.tabCssClass)}}var b=$$P.a(null,j,"#"+this.ID()+"-"+f);g.AddChild(b);var e=$$P.div(this.ID()+"-"+f);this.AddChild(e);if(!$$CM.isEmpty(d)){e.AddClassName(d)}else{if(!$$CM.isEmpty(this._co.controlCssClass)){e.AddClassName(this._co.controlCssClass)}}if(!$$CM.isNull(c)){e.AddChild(c)}this._tabs.push(e);this.Refresh();this.SetTab(h);return e},AddTabControls:function(a){if(!$$CM.isNull(a)){this._list.AddChild(a)}},RemoveTab:function(a){this.RemoveChildControl(this._tabs[a]);this._list.RemoveChildControl(this._list.ChildControls()[a]);this._tabs=this._tabs.removeAt(a);this.Refresh()},HideTab:function(a){this._list.ChildControls()[a].AssignStyle("display","none");this._tabs[a].AssignStyle("display","none");this._hidden.push(a);if(this.GetSelectedTab()==a){this.SetTab(this.GetFirstVisibleTabIndex())}},ShowTab:function(a){this._list.ChildControls()[a].AssignStyle("display","inline-block");this._hidden.remove(a);if(this.GetSelectedTab()==a){this._tabs[a].AssignStyle("display","inline-block")}},GetFirstVisibleTabIndex:function(){var a=this._tabs.find(function(b){return this._hidden.indexOf(this._tabs.indexOf(b))<0},this);return this._tabs.indexOf(a)},GetTitle:function(a){return $$JQ(this._list.ChildControls()[a]).find("a").html()},SetTitle:function(a,b){$$JQ(this._list.ChildControls()[a]).find("a").html(b)},SetDisabledTabs:function(a){if($$CM.isArray(a)){this.getLibraryElement().tabs("option","disabled",a)}else{if(!$$CM.isNull(a)){this.getLibraryElement().tabs("option","disabled",$A([a]))}else{this.getLibraryElement().tabs("option","disabled",$A())}}},SetEnabled:function(a){this.getLibraryElement().tabs("option","disabled",(a!=true))},SetTab:function(a){this.getLibraryElement().tabs("option","active",a);this._selectedIndex=a},GetLink:function(a){return this._list.ChildControls()[a].ChildControls()[0]},GetTabs:function(){return this._tabs},GetSelectedTab:function(){return this.getLibraryElement().tabs("option","active")},GetTabIndex:function(a){return this._list.ChildControls().indexOf(a)},AddToTabHeaderUI:function(a){var d=$A(this.getLibraryElement().find(".ui-tabs-nav"));var b=$$E(a);var c=d[0];c.appendChild(b)},Refresh:function(){var c=this.IsVisible()==true;this.getLibraryElement().tabs("destroy");if(this.GetConfigOptions().vertical==true){this.getLibraryElement().tabs().addClass("ui-tabs-vertical ui-helper-clearfix");this.getLibraryElement().find("li").removeClass("ui-corner-top").addClass("ui-corner-left")}else{this.getLibraryElement().tabs()}this.wireEvents();this._tabs=$A();var a=$A(this.getLibraryElement().find("div.ui-tabs-panel"));a.each(function(d){this._tabs.push(d.CM.Get())},this);var b=$A(this.getLibraryElement().find(".ui-tabs-nav li"));this._list._childControls=$A();b.each(function(d){this._list._childControls.push(d.CM.Get())},this);this.TabEventsRefreshedEvent.fire(this);if(c==true){this.Show()}else{this.Hide()}this.Show()},initializeUIElements:function(){this.getLibraryElement().tabs(this.GetConfigOptions());this._list=$$P.ul();this.AddChild(this._list);this.AddClassName("cmFloatLeft");this._tabs=$A()},wireEvents:function(){var a=this;this.getLibraryElement().unbind("tabsbeforeactivate");this.getLibraryElement().bind("tabsbeforeactivate",function(b,c){a._selectedIndex=c.index;a.TabBeforeSelectEvent.fire(this,{event:b,target:c.newTab[0].CM.Get()})});this.getLibraryElement().unbind("tabsactivate");this.getLibraryElement().bind("tabsactivate",function(b,c){a._selectedIndex=c.index;c.newPanel[0].removeAttribute("style");a.TabSelectEvent.fire(this,{event:b,target:c.newTab[0].CM.Get()})});this.getLibraryElement().find("li.ui-state-default a").unbind("hover");this.getLibraryElement().find("li.ui-state-default a").bind("hover",function(b,c){a.TabHoverEvent.fire(this,{event:b,target:b.target.CM.Get()})})},createEvents:function(){this.TabHoverEvent=new cm.event();this.TabBeforeSelectEvent=new cm.event();this.TabSelectEvent=new cm.event();this.TabEventsRefreshedEvent=new cm.event()},configureDefaultOptions:function(){return new cm.ui.common.TabControlConfigOptions()},postAppendTo:function(){this.Refresh()}});"cm.ui.common".namespace();cm.ui.common.TimeControlConfigOptions=Class.create(cm.ConfigOptions,{required:false,groupFieldName:"",titleCssClass:"",hourInputCssClass:"w20px",colonCssClass:"",minuteInputCssClass:"w20px",timePeriodInputCssClass:"ml5px mr5px w50px",timePeriodIncludeSelect:true});cm.ui.common.TimeControl=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.TimeControlConfigOptions()},render:function(){var a=$$P.span(this._id+"Controls");return $$E(a)},initializeData:function($super){$super();this._co=this.GetConfigOptions();if($$CM.isNull(this._co)){this._co=new Object()}this._timePeriodArray=$$DATE.getTimePeriodArray()},initializeUIElements:function(){var a=$$CM.uniqueID();if(this.Version()==2){this.AddClassName("cmTimeControl");this._ftxtHour=new $$FTXT2(null,{maxLength:2,classNames:"cmTimeControlSubControl cmTimeControlSubControlHour"});this.AddChild(this._ftxtHour);this.AddChild(new $$FLBL2(null,{value:":",classNames:"cmTimeControlSubControl cmTimeControlSubControlColon"}));this._ftxtMinute=new $$FTXT2(null,{maxLength:2,classNames:"cmTimeControlSubControl cmTimeControlSubControlMinute"});this.AddChild(this._ftxtMinute);this._fddlTimePeriod=new $$FDDL2(null,{classNames:"cmTimeControlSubControl cmTimeControlSubControlAMPM"});this.AddChild(this._fddlTimePeriod);if(this._co.timePeriodIncludeSelect==true){this._fddlTimePeriod.bindList(this._timePeriodArray,"","--",false)}else{this._fddlTimePeriod.bindList(this._timePeriodArray)}}else{this._ftxtHour=new $$FTXT("ftxtHour_"+a,{maxLength:2});this.AddChild(this._ftxtHour);if(this._co.clearStyles==true){this._ftxtHour.GetTitleControl().RemoveClassName("cmTitleBase");this._ftxtHour.GetTitleControl().RemoveClassName("cmTitleWidth");this._ftxtHour.GetTitleControl().RemoveClassName("cmTextTitleBase");if($$CM.isEmpty(this._ftxtHour.GetConfigOptions().label)){this._ftxtHour.RemoveChildControl(this._ftxtHour.GetTitleControl())}this._ftxtHour.GetInputControl().RemoveClassName("cmInputWidth")}if(!$$CM.isEmpty(this._co.hourInputCssClass)){this._ftxtHour.GetInputControl().AddClassName(this._co.hourInputCssClass)}this._strongColon=$$P.strong("",":",{});this.AddChild(this._strongColon);this._strongColon.AddClassName("ml1px mr1px");if(!$$CM.isEmpty(this._co.colonCssClass)){this._strongColon.AddClassName(this._co.colonCssClass)}this._ftxtMinute=new $$FTXT("ftxtMinute_"+a,{maxLength:2});this.AddChild(this._ftxtMinute);if(this._co.clearStyles==true){this._ftxtMinute.GetTitleControl().RemoveClassName("cmTitleBase");this._ftxtMinute.GetTitleControl().RemoveClassName("cmTitleWidth");this._ftxtMinute.GetTitleControl().RemoveClassName("cmTextTitleBase");if($$CM.isEmpty(this._ftxtMinute.GetConfigOptions().label)){this._ftxtMinute.RemoveChildControl(this._ftxtMinute.GetTitleControl())}this._ftxtMinute.GetInputControl().RemoveClassName("cmInputWidth")}if(!$$CM.isEmpty(this._co.minuteInputCssClass)){this._ftxtMinute.GetInputControl().AddClassName(this._co.minuteInputCssClass)}this._fddlTimePeriod=new $$FDDL("fddlTimePeriod_"+a,{});this.AddChild(this._fddlTimePeriod);if(this._co.timePeriodIncludeSelect==true){this._fddlTimePeriod.bindList(this._timePeriodArray,"","--",false)}else{this._fddlTimePeriod.bindList(this._timePeriodArray)}if(this._co.clearStyles==true){this._fddlTimePeriod.GetTitleControl().RemoveClassName("cmTitleBase");this._fddlTimePeriod.GetTitleControl().RemoveClassName("cmTitleWidth");this._fddlTimePeriod.GetTitleControl().RemoveClassName("cmDDLWidth");if($$CM.isEmpty(this._fddlTimePeriod.GetConfigOptions().label)){this._fddlTimePeriod.RemoveChildControl(this._fddlTimePeriod.GetTitleControl())}this._fddlTimePeriod.GetInputControl().RemoveClassName("cmFloatLeft")}if(!$$CM.isEmpty(this._co.timePeriodInputCssClass)){this._fddlTimePeriod.GetInputControl().AddClassName(this._co.timePeriodInputCssClass)}}this.SetValidation()},Bind:function(i,d){if(!$$CM.isEmpty(i)){if(d==true){var a=i.split("T");var f=i;if(a.length>1){f=a[1]}var g=f.split(":");if($$CM.isArray(g)&&g.length>=2){var c=Number(g[0]);var e=Number(g[1]);var h=((c/12)<1)?"AM":"PM";this._fddlTimePeriod.setSelectedValue(h);if(c>12){c-=12}if(c==0){c=12}this._ftxtHour.Bind($$CM.padZero(c));this._ftxtMinute.Bind($$CM.padZero(e))}}else{var b=new Date(i);if(!$$CM.isNull(b)){var c=b.getHours();var e=b.getMinutes();var h=((c/12)<1)?"AM":"PM";this._fddlTimePeriod.setSelectedValue(h);if(c>12){c-=12}if(c==0){c=12}this._ftxtHour.Bind($$CM.padZero(c));this._ftxtMinute.Bind($$CM.padZero(e))}}}},GetData:function(){var a=Number(this._ftxtHour.GetData());var b=Number(this._ftxtMinute.GetData());var c=this._fddlTimePeriod.getSelectedValue().toLowerCase();if(c=="pm"&&a<12){a+=12}if(c=="am"&&a==12){a=0}var d=$$CM.padZero(a)+":"+$$CM.padZero(b);return d},GetMinutes:function(){return parsethis._ftxtMinute.GetData()},Reset:function(){this._ftxtHour.Bind("");this._ftxtMinute.Bind("");this._fddlTimePeriod.setSelectedIndex(0)},SetValidation:function(a){this._ftxtHour.Validator.RemoveAll();this._ftxtMinute.Validator.RemoveAll();this._fddlTimePeriod.Validator.RemoveAll();var d=a;if($$CM.isEmpty(d)&&!$$CM.isEmpty(this._co.label)){d=this._co.label}if($$CM.isNull(d)){var b="";if(!$$CM.isEmpty(this.GetConfigOptions().groupFieldName)){b=this.GetConfigOptions().groupFieldName}d=b}var c=(this._co.required==true)?true:false;this._ftxtHour.Validator.addEvaluator($$EVAL.NUMBER({FieldName:d+"Hour",IsRequired:c,MinValue:1,MaxValue:12}));this._ftxtMinute.Validator.addEvaluator($$EVAL.NUMBER({FieldName:d+"Minute",IsRequired:c,MinValue:0,MaxValue:59}));this._fddlTimePeriod.Validator.addEvaluator($$EVAL.TEXT({FieldName:d+"Time Period",IsRequired:c}))},ToggleValidation:function(a){if(a==true){this._ftxtHour.Validator.Enable();this._ftxtMinute.Validator.Enable();this._fddlTimePeriod.Validator.Enable()}else{this._ftxtHour.Validator.Disable();this._ftxtMinute.Validator.Disable();this._fddlTimePeriod.Validator.Disable()}}});"cm.ui.common".namespace();cm.ui.common.ToTopButtonConfigOptions=Class.create(cm.ConfigOptions,{text:"To Top",displayHeight:"0",referenceControl:null,ratio:1,btnLocationClassName:"topBtnRightSideFixed",btnClassName:"btnToTop",upArrowClassName:"upArrow"});cm.ui.common.ToTopButton=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.common.ToTopButtonConfigOptions()},initializeData:function(){this._co=this.GetConfigOptions()},initializeUIElements:function(){this._toTopButton=new $$BTN("btnToTop",{text:this._co.text});this._toTopButton.AddClassName(this._co.btnClassName);this.AddChild(this._toTopButton);this._toTopButton.Hide();this._upArrow=$$P.span("upArrow");this._toTopButton.AddChild(this._upArrow);this._upArrow.AddClassName(this._co.upArrowClassName)},createEvents:function(){},wireEvents:function(){this._toTopButton.ClickEvent.subscribe(this.onToTop,this)},postInitialize:function(){var c=this;var e=this._co.referenceControl;var d=this._co.ratio;var a=this._co.btnLocationClassName;if(e!=null){jQuery(window).scroll(function(){if(jQuery(window).scrollTop()>(e._htmlElement.clientHeight*d)){c._toTopButton.Show();c._toTopButton.AssignStyle("margin-left","-10px");c._toTopButton.AddClassName(a)}else{c._toTopButton.Hide();c._toTopButton.RemoveClassName(a)}})}else{var b=this._co.displayHeight;jQuery(window).scroll(function(){if(jQuery(window).scrollTop()>(b*d)){c._toTopButton.Show();c._toTopButton.AssignStyle("margin-left","-10px");c._toTopButton.AddClassName(a)}else{c._toTopButton.Hide();c._toTopButton.RemoveClassName(a)}})}},onToTop:function(){jQuery("html, body").animate({scrollTop:0},500)}});"cm.ui.common".namespace();cm.ui.common.TreeConfigOptions=Class.create(cm.ConfigOptions,{animation:200,multi:false,autoOpen:true});$$TREE=cm.ui.common.Tree=Class.create(cm.ui.UILibraryControl,{_nodeArray:null,SelectEvent:null,LoadedEvent:null,createEvents:function(){this.SelectEvent=new cm.event();this.LoadedEvent=new cm.event()},wireEvents:function(){var a=this;this.getLibraryElement().bind("loaded.jstree",function(c,b){a.LoadedEvent.fire()})},initializeData:function(){this._nodeArray=$A()},configureDefaultOptions:function(){return new cm.ui.common.TreeConfigOptions()},postAppendTo:function(){this.activate()},Clear:function(){$$JQ(this).find("ul > li").remove()},GetSelected:function(){var a=this.getLibraryElement().jstree("get_selected");if(a.length>0){return a}else{return null}},GetSelectedData:function(){return this.GetNodeData(this.GetSelected())},GetNodeData:function(a){return a[0].data},GetNodeDepth:function(a){return a[0].depth},OpenNode:function(a,b){if(!$$CM.isNull(a)){this.getLibraryElement().jstree("open_node",a,b)}else{this.getLibraryElement().jstree("open_all",a,b)}},CloseNode:function(a,b){if(!$$CM.isNull(a)){this.getLibraryElement().jstree("close_node",a,b)}else{this.getLibraryElement().jstree("close_all",a,b)}},ToggleNode:function(a){this.getLibraryElement().jstree("toggle_node",a,skipAnim)},GetSourceNode:function(a){var b=this.getLibraryElement().jstree("get_path",a,true);if($$CM.isArray(b)){return jQuery("#"+b[0])}else{return null}},AddNode:function(g,e,a){var f=(!$$CM.isNull(e))?"#"+e[0].id:-1;var d=(!$$CM.isNull(e))?"last":"after";var b=($$CM.isNull(e))?0:e[0].depth+1;var c=this.getLibraryElement().jstree("create",f,"last",g,false,true);c[0].id="tn_"+$$CM.uniqueID();c[0].depth=b;c[0].data=a;return c},MoveNode:function(b,e,a){if($$CM.isNull(a)){a="before"}var c=(!$$CM.isEmpty(b.selector))?b.selector:b[0];var d=(!$$CM.isEmpty(e.selector))?e.selector:e[0];this.getLibraryElement().jstree("move_node",c,d,a)},UpdateNode:function(b,c,a){this.getLibraryElement().jstree("rename_node",b.selector,c);b[0].data=a},RenameNode:function(a,b){this.getLibraryElement().jstree("rename_node",a.selector,b)},RemoveNode:function(a){this.getLibraryElement().jstree("remove",a.selector);this._selected=null},SelectNode:function(a){this.getLibraryElement().jstree("deselect_all");this.getLibraryElement().jstree("select_node","#"+a[0].id)},FindNode:function(b,d){var a=this.getNodeArray();if(!$$CM.isNull(d)){a.sort(d)}var c=null;return a.find(b);return c},GetBranch:function(b){var c=this.getLibraryElement().jstree("get_json",($$CM.isNull(b))?-1:"#"+b[0].id,$A(["id"]));var a=$A();if(c.length>0&&$$CM.isArray(c[0].children)){c=c[0].children}c.each(function(d){a.push(this.Wrap("#"+d.attr.id))},this);return a},GetBranchNodeData:function(a){return this.getNodeArray(a).collect(function(b){return this.GetNodeData(b)},this)},getNodeArray:function(b){var c=this.getLibraryElement().jstree("get_json",($$CM.isNull(b))?-1:"#"+b[0].id,$A(["id"]));var a=this.parseNodes(c);return a},parseNodes:function(b){var a=$A();b.each(function(c){a.push(this.Wrap("#"+c.attr.id));if($$CM.isArray(c.children)&&c.children.length>0){a=a.concat(this.parseNodes(c.children))}},this);return a},activate:function(){var b=this;var a=this.GetConfigOptions();this.getLibraryElement().jstree("destroy");this.getLibraryElement().jstree({plugins:["ui","html_data","themes","json_data","crrm"],core:{animation:a.animation},ui:{select_multiple_modifier:(a.multi==true)?"ctrl":false,select_range_modifier:(a.multi==true)?"shift":false},themes:{icons:false,dots:true}});this.getLibraryElement().unbind("select_node.jstree");this.getLibraryElement().bind("select_node.jstree",function(e,d){var f=d.rslt.obj;var c=d.inst.get_text();b.SelectEvent.fire(f,c)})}});"cm.ui.common".namespace();cm.ui.common.UploaderConfigOptions=Class.create(cm.ConfigOptions,{src:"/ui/media/FileUpload",args:$A()});cm.ui.common.Uploader=Class.create(cm.ui.Control,{FileUploadStartEvent:null,FileUploadFinishEvent:null,FileUploadCompleteEvent:null,FileUploadErrorEvent:null,_initializedIFrame:false,OpenBrowse:function(){var b=this;var a=jQuery("#"+this.ID());var c=a.contents().find("#fileUpload");c.unbind("change");c.bind("change",function(){b.ChangeEvent.fire()});a.unbind("load");a.bind("load",function(){var d=b.getError();var e=b.getFileName();if(!$$CM.isNull(d)){b.FileUploadErrorEvent.fire(b,unescape(d))}else{if(!$$CM.isNull(e)){b.FileUploadCompleteEvent.fire(b,e)}else{b.FileUploadErrorEvent.fire(b,"An unknown error occurred")}}b.FileUploadFinishEvent.fire(b)});this.getDocument().getElementById("fileUpload").click()},Submit:function(){this.FileUploadStartEvent.fire(this);this.getDocument().getElementById("frmUpload").submit()},Clear:function(){this.getDocument().getElementById("fileUpload").value=""},configureDefaultOptions:function(){return new cm.ui.common.UploaderConfigOptions()},render:function(){var a=this.GetConfigOptions();var c=a.src+"?frameID="+this._id;a.args.each(function(d){c+="&"+d},this);var b=$$P.iframe(this._id,c,0,0);return $$E(b)},initializeUIElements:function(){this.SetAttribute("frameBorder","0");this.SetAttribute("scrolling","no")},createEvents:function(){this.FileUploadCompleteEvent=new cm.event();this.FileUploadErrorEvent=new cm.event();this.FileUploadStartEvent=new cm.event();this.FileUploadFinishEvent=new cm.event();this.AddChangeListener()},wireEvents:function(){},resetDocument:function(){},getDocument:function(){return jQuery("#"+this.ID()).contents()[0]},getFrameID:function(){return this.getQueryValue("frameID")},getSelectedFileName:function(){var b=this.getSelectedFilePath();var c=b.lastIndexOf("\\")+1;if(c<0){c=0}var a=b.substring(c);return a},getSelectedFilePath:function(){var a=this.getDocument().getElementById("fileUpload").value;return a},getFileName:function(){return this.getQueryValue("fileName")},getOriginalFileName:function(){return this.getQueryValue("originalFileName")},getError:function(){return this.getQueryValue("error")},getQuery:function(){return this.getDocument().location.search.substring(1)},getQueryValue:function(e){var c=this.getQuery().split("&");for(var a=0;a<c.length;a++){var d=c[a].indexOf("=");if(d>0){var b=c[a].substring(0,d);var f=c[a].substring(d+1);if(e==b){return f}}}return null}});"cm.ui.common".namespace();$$UPRDU=cm.ui.common.UPRDataUtility={GetFormattedAddress:function(a,d){var e=(!$$CM.isEmpty(a.AddressLine1))?a.AddressLine1:"";if(!$$CM.isNull(d)&&d==true){e=$$UPRDU.ParseMapLink(a)}e+=(!$$CM.isEmpty(a.AddressLine2))?"<br />"+a.AddressLine2:"";e+="<br />"+a.City;if(!$$CM.isEmpty(a.City)){e+=", "}e+=a.StateProvince+" "+a.PostalCode;var c="US";if(!$$CM.isEmpty($$CLIENT.Country)){c=$$CLIENT.Country}if(!$$CM.isEmpty(a.Country)&&c.toLowerCase()!=a.Country.toLowerCase()){var b=$$UPRDU.GetCountryNameByCode(a.Country);e+="<br />"+b}return e},GetCountryNameByCode:function(c){var b=FW.Data.Lists.CountryArray;if(!$$CM.isArray(b)){return c}var a=b.find(function(d){return d.Code.toLowerCase()==c.toLowerCase()},this);if(!$$CM.isNull(a)){return a.Name}return c},GetMapURLString:function(a){var b=$$UPRDU.ClearSpecialCharacters(a.AddressLine1);var c=$$UPRDU.ClearSpecialCharacters(a.City);var g=$$UPRDU.ClearSpecialCharacters(a.StateProvince);var f=$$UPRDU.ClearSpecialCharacters(a.PostalCode);var d=$$UPRDU.ClearSpecialCharacters($$UPRDU.GetCountryNameByCode(a.Country));var e=b+","+c+","+g+","+f+(!$$CM.isEmpty(d)?","+d:+"");return e},GetMapURL:function(a){var b=$$UPRDU.GetMapURLString(a);var c="http://maps.google.com/maps?f=q&q="+b;return c},ParseMapLink:function(a){var b=$$UPRDU.ClearSpecialCharacters(a.AddressLine1);var c=$$UPRDU.GetMapURL(a);return"<a target='_blank' href='"+c+"'>"+a.AddressLine1+"</a>"},ClearSpecialCharacters:function(a){return a.replaceAll(" ","+").replaceAll("#","")},IsPrimaryEntityAddress:function(b){var c=false;if(!$$CM.isNull(b)){var a=FW.Data.GetStore("Household").Get("EntityAddressArray",{TypeID:FW.Enums.EntityTypeFlag.Person,EntityID:$$ACTIVE_PERSONID(),ParentEntityAddressID:b.ID});if(a.length>0){c=true}}return c},GetPrimaryEntityAddress:function(b){var c=null;if($$CM.isInteger(b)&&b>0){var a=FW.Data.GetStore("Household").Get("EntityAddressArray",{TypeID:FW.Enums.EntityTypeFlag.Person,EID:b});c=a.find(function(d){return $$CM.isInteger(d.ParentEntityAddressID)&&d.ParentEntityAddressID>0},this)}return c},GetShirtSizeArray:function(){var a=$A();if(!$$CM.isNull(FW.Enums.Person)&&!$$CM.isNull(FW.Enums.Person.ShirtSize)){FW.Enums.Person.ShirtSize.GetArray().each(function(b){if(b.Name.toLowerCase()!="undefined"){a.push({ID:b.Name,Name:b.Name})}},this)}return a},GetDivisionArray:function(d){var c=$A();var a=FW.Data.GetStore("Lists").Get("DivisionArray");if(a.length>0){var b=$A();a.each(function(g){var f=$$CM.deepClone(g);var e=a.find(function(h){return Number(h.ParentID)==Number(g.ID)},this);if(d==true){if($$CM.isNull(e)){f.SortKey="0_"+f.Name}else{f.SortKey="1_"+f.Name}c.push(f)}else{if($$CM.isNull(e)&&(g.IsCamperEnrollment==true||g.IsStaffOnly==true)){f.SortKey=f.Name;c.push(f)}}},this);c.each(function(e){if(Number(e.ParentID)>0){var f=a.find(function(g){return Number(g.ID)==Number(e.ParentID)},this);if(!$$CM.isNull(f)){e.Name=e.Name+" ("+f.Name+")";e.SortKey=e.SortKey+" ("+f.Name+")"}}},this);c.sort($$CM.sortBySortKey)}return c},GetDivisionArrayByCriteria:function(c,a){var d=$A();var b=this.GetDivisionArray(false);if(!$$CM.isNull(c)){b.each(function(f){var e=false;if($$CM.isInteger(c.DivisionID)&&Number(c.DivisionID)==Number(f.ID)){e=true}else{e=true;if(e==true&&!$$CM.isEmpty(c.IsCamper)&&c.IsCamper==true){e=!(f.IsStaffOnly==c.IsCamper)}if(e==true&&$$CM.isInteger(c.Gender)){e=(Number(f.Gender)==Number(c.Gender)||(Number(f.Gender)==2))}}if(e==true){if(!$$CM.isEmpty(c.IsCamper)&&c.IsCamper==true&&!$$CM.isNull(a)){e=(Number(a.CampGradeID)>=Number(f.StartRange)&&Number(a.CampGradeID)<=Number(f.EndRange))}}if(e==true){d.push(f)}},this)}return d},GetDivisionName:function(b){var a=FW.Data.GetStore("Lists").GetFirst("DivisionArray",{ID:b});var c="";if(!$$CM.isNull(a)){c=a.Name}return c},GetPrimaryChildHousehold:function(d){var a=0;var b=FW.Data.GetStore("Person").GetFirst("FamilyPersonArray",{PersonID:d,RoleID:3});if(!$$CM.isNull(b)){a=b.FamilyID}var c=FW.Data.GetStore("Household").GetFirst("HouseholdArray",{ID:a});return c},GetPrincipalHousehold:function(d){var a=0;var b=FW.Data.GetStore("Person").GetFirst("FamilyPersonArray",function(e){return e.PersonID==d&&e.RoleID<3});if(!$$CM.isNull(b)){a=b.FamilyID}var c=FW.Data.GetStore("Household").GetFirst("HouseholdArray",{ID:a});return c},SortRelationshipArray:function(b,a){var a=a;var c=b.sort(function(d,f){var e=d.Name;var g=f.Name;if($$CM.isNumber(a)){if(a==FW.Enums.Gender.Female){e=d.FemaleContext;g=f.FemaleContext}else{if(a==FW.Enums.Gender.Male){e=d.MaleContext;g=f.MaleContext}else{e=d.Name;g=f.Name}}}if(d.OrderIndex<f.OrderIndex){return -1}else{if(d.OrderIndex>f.OrderIndex){return 1}else{if(d.OrderSortIndex<f.OrderSortIndex){return -1}else{if(d.OrderSortIndex>f.OrderSortIndex){return 1}else{if(e<g){return -1}else{if(e>g){return 1}else{return 0}}}}}}},this);return c},GetPersonPositionTypesSummary:function(a){var b="";if($$CM.isArray(a)){a.each(function(c){c.Name="";var d=this.GetPositionTypeName(c.PositionTypeID);if(!$$CM.isEmpty(d)){c.Name=d}},this);a=a.sort($$CM.sortByNameProperty);a.each(function(c){var d=this.GetPositionTypeName(c.PositionTypeID);if(!$$CM.isEmpty(d)){if(b.length>0){b+=", "}b+=d}},this)}return b},GetPositionTypeName:function(d){var a="";var c=FW.Data.GetStore("Lists").Get("PositionTypeArray");if(c.length>0){var b=c.find(function(e){return Number(e.ID)==Number(d)},this);if(!$$CM.isNull(b)){a+=b.Name.trim()}}return a},GetPositionTypeArray:function(){var a=FW.Data.GetStore("Lists").Get("PositionTypeArray");a=a.sort($$CM.sortByOrderIndex);return a},GetActivitiesSummary:function(a){var b="";if($$CM.isArray(a)){a=a.sort($$CM.sortByOrderIndex);a.each(function(d){var c=this.GetActivityName(d.ActivityID);if(!$$CM.isEmpty(c)){if(b.length>0){b+=", "}b+=c}},this)}return b},GetActivity:function(c){var a=null;var b=FW.Data.GetStore("Lists").Get("ActivityArray");if(b.length>0){a=b.find(function(d){return Number(d.ActivityID)==Number(c)},this)}return a},GetActivityName:function(b){var c="";var a=this.GetActivity(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetActivityCategory:function(c){var a=null;var b=FW.Data.GetStore("Lists").Get("ActivityCategoryArray");if(b.length>0){a=b.find(function(d){return Number(d.ID)==Number(c)},this)}return a},GetActivityCategoryName:function(b){var c="";var a=this.GetActivityCategory(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetCertificationsSummary:function(a){var b="";if($$CM.isArray(a)){a.each(function(d){d.Name="";var c=this.GetCertificationName(d.CertificationID);if(!$$CM.isEmpty(c)){d.Name=c}},this);a=a.sort($$CM.sortByNameProperty);a.each(function(c){if(!$$CM.isEmpty(c.Name)){if(b.length>0){b+=", "}b+=c.Name}},this)}return b},GetCertification:function(c){var a=null;var b=FW.Data.GetStore("Lists").Get("CertificationArray");if(b.length>0){a=b.find(function(d){return Number(d.ID)==Number(c)},this)}return a},GetCertificationName:function(b){var c="";var a=this.GetCertification(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetSkillsSummary:function(a){var b=FW.Enums.Settings.SkillLevelStringValue.GetArray();var c="";if($$CM.isArray(a)){a.each(function(d){d.Name="";d.Level="";var f=this.GetSkillName(d.SkillID);if(!$$CM.isEmpty(f)){d.Name=f}var e=b.find(function(g){return Number(g.ID)==Number(d.SkillLevel)});if(!$$CM.isNull(e)){d.Level="("+e.Name+")"}},this);a=a.sort($$CM.sortByNameProperty);a.each(function(d){if(!$$CM.isEmpty(d.Name)){if(c.length>0){c+=", "}c+=d.Name;if(!$$CM.isEmpty(d.Level)){c+=" "+d.Level}}},this)}return c},GetSkill:function(c){var a=null;var b=FW.Data.GetStore("Lists").Get("SkillArray");if(b.length>0){a=b.find(function(d){return Number(d.ID)==Number(c)},this)}return a},GetSkillName:function(c){var a="";var b=this.GetSkill(c);if(!$$CM.isNull(b)){a+=b.Name.trim()}return a},GetAgeGroupArray:function(){var a=FW.Data.GetStore("Lists").Get("AgeGroupArray");return a},GetAgeGroup:function(c){var a=null;var b=FW.Data.GetStore("Lists").Get("AgeGroupArray");if(b.length>0){a=b.find(function(d){return Number(d.AgeGroupID)==Number(c)},this)}return a},GetAgeGroupName:function(b){var c="";var a=this.GetAgeGroup(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetEducationLevelName:function(a){var b="";if(!$$CM.isNull(FW.Enums.Lists.EducationLevel)){b=FW.Enums.Lists.EducationLevel.GetName(a)}return b},GetStaffStatus:function(c){var a=null;var b=this.GetStaffStatusArray(false,true,false);if(b.length>0){a=b.find(function(d){return Number(d.StaffStatusID)==Number(c)},this)}return a},GetStaffStatusName:function(c){var a="";var b=this.GetStaffStatus(c);if(!$$CM.isNull(b)){a+=b.Name.trim()}return a},GetStaffManagementStatusNameFromFlag:function(b){var c="";var d=FW.Enums.Lists.StaffManagementStatus.GetArray();var a=d.find(function(e){return Number(e.ID)==Number(b)},this);if(!$$CM.isNull(a)){c=a.Name}return c},GetStaffManagementStatusArray:function(){return FW.Enums.Lists.StaffManagementStatus.GetArray()},GetStaffStatusArray:function(a,d,c,b){if($$CM.isNull(d)){d=false}if($$CM.isNull(c)){c=false}if($$CM.isNull(b)){b=false}var e=FW.Data.GetStore("Lists").Get("StaffStatusArray");if(!$$CM.isArray(e)){e=$A()}e.sort($$CM.sortByNameProperty);var f=$A();e.each(function(g){if(g.Name.toLowerCase()=="hired"){f.push(g)}},this);f.push({ID:"",Name:"--------------"});e.each(function(g){if(g.Name.toLowerCase()!="hired"){if(!(c==true&&(g.Name.toLowerCase()=="inquiry"||g.Name.toLowerCase()=="referred"))){f.push(g)}}},this);return f},GetStaffCategory:function(c){var a=null;var b=this.GetStaffCategoryArray();if(b.length>0){a=b.find(function(d){return Number(d.StaffCategoryID)==Number(c)},this)}return a},GetStaffCategoryName:function(c){var a="";var b=this.GetStaffCategory(c);if(!$$CM.isNull(b)){a+=b.Name.trim()}return a},GetStaffCategoryArray:function(){var a=FW.Data.GetStore("Lists").Get("StaffCategoryArray");if(!$$CM.isArray(a)){a=$A()}return a},GetStaffAgency:function(c){var a=null;var b=this.GetStaffAgencyArray();if(b.length>0){a=b.find(function(d){return Number(d.ID)==Number(c)},this)}return a},GetStaffAgencyName:function(c){var a="";var b=this.GetStaffAgency(c);if(!$$CM.isNull(b)){a+=b.Name.trim()}return a},GetStaffAgencyArray:function(){var a=FW.Data.GetStore("Staff").Get("Agencies");if(!$$CM.isArray(a)){a=$A()}return a},GetJob:function(c){var a=null;var b=this.GetJobArray();if(b.length>0){a=b.find(function(d){return Number(d.JobID)==Number(c)},this)}return a},GetJobName:function(b){var c="";var a=this.GetJob(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetJobArray:function(){var a=FW.Data.GetStore("Lists").Get("JobArray");if(!$$CM.isArray(a)){a=$A()}return a},GetBunk:function(c){var a=null;var b=this.GetBunkArray();if(b.length>0){a=b.find(function(d){return Number(d.ID)==Number(c)},this)}return a},GetBunkName:function(b){var c="";var a=this.GetBunk(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetBunkArray:function(){var a=FW.Data.GetStore("Lists").Get("BunkArray");if(!$$CM.isArray(a)){a=$A()}return a},GetBunkPlan:function(c){var a=null;var b=this.GetBunkPlanArray();if(b.length>0){a=b.find(function(d){return Number(d.ID)==Number(c)},this)}return a},GetBunkPlanName:function(b){var c="";var a=this.GetBunkPlan(b);if(!$$CM.isNull(a)){c+=a.Name.trim()}return c},GetBunkPlanArray:function(){var a=FW.Data.GetStore("Lists").Get("BunkPlanArray");if(!$$CM.isArray(a)){a=$A()}return a},GetBunkAssignmentSummary:function(a){var b="";if($$CM.isArray(a)){a.each(function(c){var d=this.GetBunkAssignmentName(c);if(!$$CM.isEmpty(d)){if(b.length>0){b+=", "}b+=d}},this)}return b},GetBunkAssignmentName:function(a){var d="";if(!$$CM.isNull(a)){var b=this.GetBunkName(a.BunkID);if(!$$CM.isEmpty(b)){d+=b;var c=this.GetBunkPlanName(a.BunkPlanID);if(!$$CM.isEmpty(c)){d+=" ("+c+")"}}}return d},GetHousingAssignmentSummary:function(a){var b="";if($$CM.isArray(a)){a.each(function(c){var d=this.GetHousingAssignmentName(c);if(!$$CM.isEmpty(d)){if(b.length>0){b+=", "}b+=d}},this)}return b},GetHousingAssignmentName:function(a){var d="";if(!$$CM.isNull(a)){var b=this.GetBunkName(a.StaffHousingID);if(!$$CM.isEmpty(b)){d+=b;var c=this.GetBunkPlanName(a.BunkPlanID);if(!$$CM.isEmpty(c)){d+=" ("+c+")"}}}return d},GetPersonStatus:function(f){var g=f.PersonPartition;var h=null;if(!$$CM.isNull(g)){var b=$$UPRDU.GetPartitionFlag(Number(g.Child));var i=$$UPRDU.GetPartitionFlag(Number(g.Staff));var e=$$UPRDU.GetPartitionFlag(Number(g.Parent));var a=$$UPRDU.GetPartitionFlag(Number(g.Adult));var d=$$UPRDU.GetPartitionFlag(Number(g.Donor));var c=$$UPRDU.GetPartitionFlag(Number(g.Contact));var h={};h.ChildDetails={Partition:b,Status:1,Years:b>1?1:0};h.StaffDetails={Partition:i,Status:1,Years:i>1?1:0};h.ParentDetails={Partition:e,Status:1,Years:e>1?1:0};h.AdultDetails={Partition:a,Status:1,Years:a>1?1:0};h.DonorDetails={Partition:d,Status:1,Years:d>1?1:0};h.ContactDetails={Partition:d,Status:1,Years:d>1?1:0};h.PersonID=f.PersonID}return h},GetPartitionFlag:function(a){switch(a){case 0:return 1;break;case 1:return 2|4;break;case 4:return 2|8;break;case 5:return 2|16;break;case 3:return 2;break}},GetPartition:function(c){var b={};var d={};d.Child=c.Child;d.Child.Exists=c.IsChild();d.Staff=c.Staff;d.Staff.Exists=c.IsStaff();d.Parent=c.Parent;d.Parent.Exists=c.IsParent();d.Adult=c.Adult;d.Adult.Exists=c.IsAdult();d.Donor=c.Donor;d.Donor.Exists=c.IsDonor();d.Contact=c.Contact;d.Contact.Exists=c.IsContact();for(var a in d){if(c.hasOwnProperty(a)){if(d[a].Exists){if(d[a].IsLead()){b[a]=1}else{if(d[a].IsApplied()||d[a].IsGuest()){b[a]=2}else{if(d[a].IsEnrolled()||d[a].IsUser()){b[a]=3}else{if(d[a].IsEligible()||d[a].IsMember()){b[a]=4}else{if(d[a].IsFormer()){b[a]=5}}}}}}else{b[a]=0}}}return b},AddPersonStatusAndPartition:function(b){var d=$$AR.SeasonID;var a=FW.Data.GetStore("Person").GetFirst("FamilyPersonArray",{PersonID:b.PersonID});if(!$$CM.isNull(a)){b.RoleID=a.RoleID}else{b.RoleID=1}b.PersonStatus=FW.Data.GetStore("Person").GetFirst("PersonStatusArray",{PersonID:b.PersonID,SeasonID:d});var c=new cm.ui.common.PersonStatus(b.PersonStatus);b.PersonPartition=$$UPRDU.GetPartition(c);return b},AddPersonAndRelationshipArrayToFamilyArray:function(a){var b=$$CLIENT.CurrentSeasonID;var c=$A();a.each(function(d){var e=FW.Data.GetStore("Person").GetFirst("PersonArray",{PersonID:d.PersonID});d.Person=e;d.Person.RoleID=d.RoleID;d.Person.PersonStatus=FW.Data.GetStore("Person").GetFirst("PersonStatusArray",{PersonID:d.PersonID,SeasonID:b});var f=FW.Data.GetStore("Person").Get("PersonRelationshipArray",{PersonID:d.PersonID});f.push({PersonID:d.PersonID,RelatedToPersonID:d.PersonID,RelationshipID:0});d.RelationshipArray=f;c.push(d)},this);return c},ValidateChildlessHousehold:function(b){var c=true;var a=$A();b.each(function(d){a.push(d.FamilyID)},this);a.each(function(e){var f=b.findAll(function(g){return Number(g.FamilyID)==Number(e)&&(g.RoleID==FW.Enums.FamilyPersonRole.Parent1||g.RoleID==FW.Enums.FamilyPersonRole.Parent2)},this);var d=b.findAll(function(g){return Number(g.FamilyID)==Number(e)&&(g.RoleID!=FW.Enums.FamilyPersonRole.Parent1&&g.RoleID!=FW.Enums.FamilyPersonRole.Parent2)},this);if(d.length==0){f.each(function(g){var h=new cm.ui.common.PersonStatus(g.Person.PersonStatus);if(h.IsParent()){var i=h.GetDetails(FW.Enums.Partition.Parent);c=false}},this)}},this);return c},GetCityState:function(a){var b="";if(!$$CM.isNull(a)){if(!$$CM.isEmpty(a.City)){b+=a.City}if(!$$CM.isEmpty(a.State)){if(b.length>0){b+=", "}b+=a.State}else{if(!$$CM.isEmpty(a.StateProvince)){if(b.length>0){b+=", "}b+=a.StateProvince}}if(b.length==0){b+="&nbsp;"}}return b},ModifyHousehold:function(a,i,c){var f=$A();var b=$A();var h=$A();var g=$A();a.FamilyPersonArray.each(function(k){f.push(k.Person);b.push(k);g.push(k.Person.PersonStatus);var l=k.RelationshipArray;if($$CM.isArray(l)){l.each(function(m){h.push(m)},this)}},this);var e=a.HouseholdInfo;var d=e.HomeAddress.Address;if($$CM.isNull(d)){d={}}var j=e.VacationSummerAddress.Address;if($$CM.isNull(j)){j={}}DAO.AddEdit.ModifyHousehold({PersonList:f,RelationshipList:h,FamilyPersonList:b,HomeAddress:d,VacationSummerAddress:j,PrimaryPersonID:a.PrimaryPersonID,Household:e,PersonStatusList:g,SendAlumniAcceptanceEmail:a.SendAlumniAcceptanceEmail},{scope:i,onSuccess:function(k){c.call(i,k.data)}})},GetHouseholdAddressID:function(c,a){var d=null;var b=FW.Data.GetStore("Household").Get("EntityAddressArray",{EID:c.EID});if($$CM.isArray(b)&&b.length>0){b.each(function(g){var f=g.AddressID;if($$CM.isNull(f)){var h=FW.Data.GetStore("Household").GetFirst("EntityAddressArray",{ID:g.ParentEntityAddressID});f=h.AddressID}if($$CM.isNumber(f)){var e=FW.Data.GetStore("Household").GetFirst("AddressArray",{ID:f});if(!$$CM.isNull(e)){if(g.AddressTypeID==a){d=f}}}},this)}return d},GetHouseholdAddress:function(c,a){var d=null;var b=FW.Data.GetStore("Household").Get("EntityAddressArray",{EID:c.EID});if($$CM.isArray(b)&&b.length>0){b.each(function(g){var f=g.AddressID;if($$CM.isNull(f)){var h=FW.Data.GetStore("Household").GetFirst("EntityAddressArray",{ID:g.ParentEntityAddressID});f=h.AddressID}if($$CM.isNumber(f)){var e=FW.Data.GetStore("Household").GetFirst("AddressArray",{ID:f});if(!$$CM.isNull(e)){if(g.AddressTypeID==a){d=e}}}},this)}return d},GetPersonAddresses:function(c){var a=$A();var b=FW.Data.GetStore("Household").Get("EntityAddressArray",{EID:c.EID});if($$CM.isArray(b)&&b.length>0){b.each(function(h){var k=null;if($$CM.isNumber(h.ParentEntityAddressID)&&Number(h.ParentEntityAddressID)>0){k=b.find(function(l){return Number(h.ParentEntityAddressID)==Number(l.ID)},this)}if($$CM.isNull(k)){var f=h.AddressID;var i=null;if($$CM.isNull(f)){i=FW.Data.GetStore("Household").GetFirst("EntityAddressArray",{ID:h.ParentEntityAddressID});if(!$$CM.isNull(i)){f=i.AddressID}}if($$CM.isNumber(f)){var e=FW.Data.GetStore("Household").GetFirst("AddressArray",{ID:f});if(!$$CM.isNull(e)){var g=h.AddressTypeID;var j=h.Label;if(!$$CM.isNull(i)){g=i.AddressTypeID;j=i.Label}var d={AddressTypeID:g,Address:e,Label:$$CM.isEmpty(j)?"Other":j};a.push(d)}}}},this)}return a},GetFamilyIDArrayForParent:function(c){var a=$A();var b=FW.Data.GetStore("Person").Get("FamilyPersonArray",function(d){return d.PersonID==c&&(d.RoleID==1||d.RoleID==2)});if($$CM.isArray(b)&&b.length>0){b.each(function(e){var d=a.find(function(f){return f==e.FamilyID},this);if($$CM.isNull(d)){a.push(e.FamilyID)}},this)}return a},GetCamperPersonIDArrayForParent:function(c){var a=$A();var b=$$UPRDU.GetFamilyIDArrayForParent(c);if($$CM.isArray(b)&&b.length>0){b.each(function(d){var e=FW.Data.GetStore("Person").Get("FamilyPersonArray",function(f){return f.FamilyID==d&&(f.RoleID==3||f.RoleID==4)});if($$CM.isArray(e)&&e.length>0){e.each(function(g){var f=a.find(function(h){return h==g.PersonID},this);if($$CM.isNull(f)){a.push(g.PersonID)}},this)}},this)}return a},ValidatePersonHistory:function(a){var b=$A();if($$CM.isArray(a)){a.each(function(d){var e=d.SeasonID;if($$CM.isArray(d.SessionProgramHistoryArray)&&d.SessionProgramHistoryArray.length>1){var c=$A();d.SessionProgramHistoryArray.each(function(i){var h=i.SessionID;var g=i.ProgramID;var f=c.find(function(j){return j.SessionID==h&&j.ProgramID==g},this);if($$CM.isNull(f)){c.push({SessionID:h,ProgramID:g})}else{b.push(e);throw $break}},this)}},this)}return b},GetTagPersonSeasonRenderList:function(b){var c=$A();var a=FW.Data.PersonTagging.PersonTagDefinitions;if($$CM.isArray(a)){b.each(function(d){var e=a.find(function(f){return d.TagID==f.ID},this);if(!$$CM.isNull(e)){d.Name=e.Name;d.OrderIndex=e.OrderIndex;if(e.Hidden==false){c.push(d)}}},this);c=c.sort($$CM.sortByOrderIndex)}return c},RelationshipListGet:function(b){var d=$$CM.deepClone(FW.Data.Lists.RelationshipArray);var a=$A();var e=$$UPRDU.SortRelationshipArray(d,FW.Enums.Gender.Female);e.each(function(i){a.push({ID:i.ID,Name:i.FemaleContext})},this);var c=$A();var f=$$UPRDU.SortRelationshipArray(d,FW.Enums.Gender.Male);f.each(function(i){c.push({ID:i.ID,Name:i.MaleContext})},this);var h=$A();var g=$$UPRDU.SortRelationshipArray(d,FW.Enums.Gender.Undefined);g.each(function(i){h.push({ID:i.ID,Name:i.Name})},this);if(b==FW.Enums.Gender.Female){return a}else{if(b==FW.Enums.Gender.Male){return c}}return h}};"cm.ui.common".namespace();cm.ui.common.VideoConfigOptions=Class.create(cm.ConfigOptions,{source:"",type:"mp4",width:0,height:0,controls:true,autoplay:true,loop:false});$$FVIDEO=cm.ui.common.Video=Class.create(cm.ui.Control,{LoadedMetaDataEvent:null,PlayEvent:null,PauseEvent:null,ProgressEvent:null,EndEvent:null,AbortEvent:null,WaitingEvent:null,LoadedMetaDataEvent:null,Play:function(){$$E(this).play()},Pause:function(){$$E(this).pause()},configureDefaultOptions:function(){return new cm.ui.common.VideoConfigOptions()},render:function(){var a=$$P.video(this.ID(),this.GetConfigOptions());return $$E(a)},initializeData:function(){},initializeUIElements:function(){var a=this.GetConfigOptions();if(a.width>0){this.SetAttribute("width",a.width)}if(a.height>0){this.SetAttribute("height",a.height)}if(a.controls==true){this.SetAttribute("controls",a.controls.toString())}if(a.autoplay==true){this.SetAttribute("autoplay",a.autoplay.toString())}if(a.loop==true){this.SetAttribute("loop",a.loop.toString())}var b=$$P.source(this.ID()+"_source");b.SetAttribute("src",a.source);b.SetAttribute("type","video/"+a.type);this.AddChild(b)},createEvents:function(){var a=this;this.PlayEvent=new cm.event();this.PauseEvent=new cm.event();this.EndEvent=new cm.event();this.ProgressEvent=new cm.event();this.AbortEvent=new cm.event();this.WaitingEvent=new cm.event();this.LoadedMetaDataEvent=new cm.event();$$E(this).addEventListener("play",function(b){a.PlayEvent.fire(a,b)});$$E(this).addEventListener("pause",function(b){a.PauseEvent.fire(a,b)});$$E(this).addEventListener("ended",function(b){a.EndEvent.fire(a,b)});$$E(this).addEventListener("progress",function(b){a.ProgressEvent.fire(a,b)});$$E(this).addEventListener("abort",function(b){a.AbortEvent.fire(a,b)});$$E(this).addEventListener("waiting",function(b){a.WaitingEvent.fire(a,b)});$$E(this).addEventListener("loadedmetadata",function(b){a.onMetaDataLoaded(b);a.LoadedMetaDataEvent.fire(a,b)})},wireEvents:function(){},onMetaDataLoaded:function(b){var a=this.GetConfigOptions();if(a.autoplay==true){this.Play()}}});