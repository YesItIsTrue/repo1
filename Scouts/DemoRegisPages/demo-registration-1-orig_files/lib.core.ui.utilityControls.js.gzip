"cm.ui.utilityControls".namespace();cm.ui.utilityControls.AnimatingDivScrollTriggeredConfigOptions=Class.create(cm.ConfigOptions,{speed:200,marginTop:98});cm.ui.utilityControls.AnimatingDivScrollTriggered=Class.create(cm.ui.UILibraryControl,{configureDefaultOptions:function(){return new cm.ui.utilityControls.AnimatingDivScrollTriggeredConfigOptions()},createEvents:function(){},postInitialize:function(){var c=this;var a=this.GetConfigOptions();var e=a.speed;var b=a.marginTop;var d=this.getLibraryElement();jQuery(window).scroll(function(){d.stop().animate({marginTop:(jQuery(window).scrollTop()<b?0:jQuery(window).scrollTop()-b)+"px"},600)})}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.ConfigOptionEditor=Class.create(cm.ui.Control,{_options:null,OptionChangedEvent:null,createEvents:function(){this.OptionChangedEvent=new cm.event()},initializeUIElements:function(){this.AddClassName("cmConfigOptionEditor")},Bind:function(a){if(!$$CM.isNull(a.GetConfigOptions())){this.ClearChildControls();var b=a.GetConfigOptions();var c=$A();for(var d in b){if(!$$CM.isFunction(b[d])&&!d.startsWith("__")){c.push(d)}}c.sort(function(e,f){if($$CM.isNull(b.GetMeta(e))||$$CM.isNull(b.GetMeta(e).priority)){return 1}if($$CM.isNull(b.GetMeta(f))||$$CM.isNull(b.GetMeta(f).priority)){return -1}return(b.GetMeta(e).priority-b.GetMeta(f).priority)});c.each(function(g){var f=($$CM.isNull(b.GetMeta(g)))?new Object():b.GetMeta(g);if(f.hidden!=true){var h=$$P.div();h.AddClassName("cmConfigOptionEditorRow");var e=$$P.div();e.AddClassName("cmConfigOptionEditorKey");var i=$$P.div();i.AddClassName("cmConfigOptionEditorValue");var j=$$FE(b[g],f);if(!$$CM.isNull(j.ChangeEvent)){j.ChangeEvent.subscribe(this.onFieldChanged,this)}e.propID=g;if(!$$CM.isNull(f.displayName)){e.update(f.displayName)}else{e.update(this.formatPropname(g))}i.AddChild(j);h.AddChild(e);h.AddChild(i);this.AddChild(h)}},this)}},formatPropname:function(b){var a=b.replace(new RegExp(/([A-Z])/g)," $&");a=a.substring(0,1).toUpperCase()+a.substring(1,a.length);return a},GetData:function(){var a=new cm.ConfigOptions();this.ChildControls().each(function(c){var b=c.ChildControls()[1].ChildControls()[0].GetData();if($$CM.isEmpty(b)||b=="null"){b=null}a.Set(c.ChildControls()[0].propID,b)});return a},loadConfigOptions:function(c){var a=($$CM.isNull(c.__customEditors))?new Object():c.__customEditors;for(var d in c){if(!$$CM.isFunction(c[d])&&!d.startsWith("__")){var e=$$P.tr();var b=$$P.td();var f=$$P.td();var g=$$FE(c[d],a[d]);g.ChangeEvent.subscribe(this.onFieldChanged,this);b.update(d);b.AssignStyle("font-weight","bold");f.AddChild(g);e.AddChild(b);e.AddChild(f);this.AddChild(e)}}},onFieldChanged:function(b,a){this.OptionChangedEvent.fire(b,a)}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.DatePickerConfigOptions=Class.create(cm.ConfigOptions,{noInput:false});cm.ui.utilityControls.DatePicker=Class.create(cm.ui.UILibraryControl,{OnChangeMonthYearEvent:null,OnCloseEvent:null,OnSelectEvent:null,configureDefaultOptions:function(){return new cm.ui.utilityControls.DatePickerConfigOptions()},render:function(){var a=$$CM.uniqueID();this._txtControl=$$P.txt(this._id+"_"+a);return $$E(this._txtControl)},postInitialize:function(){var a=this;this._cfo=this.GetConfigOptions();this.getLibraryElement().datepicker({onChangeMonthYear:function(d,c,b){a.date_onChangeMonthYear.call(a)},onClose:function(b,c){a.date_onClose.call(a)},onSelect:function(b,c){a.date_onSelect.call(a)}})},createEvents:function(){this.OnChangeMonthYearEvent=new cm.event();this.OnCloseEvent=new cm.event();this.OnSelectEvent=new cm.event()},wireEvents:function($super){$super();this.AddKeyUpListener();this.KeyUpEvent.subscribe(this.onKeyUp,this)},Destroy:function(){this.getLibraryElement().datepicker("destroy")},onKeyUp:function(){if(this._cfo.noInput==true){$$E(this).value=""}},date_onChangeMonthYear:function(){var a={};this.OnChangeMonthYearEvent.fire(this,a)},date_onClose:function(){var a={};this.OnCloseEvent.fire(this,a)},date_onSelect:function(){if(this._cfo.noInput==true){$$E(this).value=""}var a={};this.OnSelectEvent.fire(this,a)},HideDate:function(){this.getLibraryElement().datepicker("hide")},ShowDate:function(){this.getLibraryElement().datepicker("show")},SetOption:function(a,b){if(!$$CM.isNull(a)&&!$$CM.isNull(b)){this.getLibraryElement().datepicker("option",a,b)}},GetOption:function(a){if(!$$CM.isNull(a)){return this.getLibraryElement().datepicker("option",a)}return null},SetMaxDate:function(b,d,c,e){if($$CM.isNull(b)){b=0}if($$CM.isNull(d)){d=0}if($$CM.isNull(c)){c=0}if($$CM.isNull(e)){e=0}var a="+"+e+"y +"+c+"m +"+d+"w +"+b+"d";this.SetOption("maxDate",a)},SetMinDate:function(b,d,c,e){if($$CM.isNull(b)){b=0}if($$CM.isNull(d)){d=0}if($$CM.isNull(c)){c=0}if($$CM.isNull(e)){e=0}var a="-"+e+"y -"+c+"m -"+d+"w -"+b+"d";this.SetOption("minDate",a)}});"cm.ui.utilityControls".namespace();$$GROWL=cm.ui.utilityControls.growlBanner={ShowBanner:function(d,c,a){var e=1000;if(!$$CM.isNull(c)&&$$CM.isNumber(c)){e=c}var b="";if(!$$CM.isEmpty(a)){b=a}jQuery.jGrowl(d,{life:e,closer:false,theme:b})}};"cm.ui.utilityControls".namespace();cm.ui.utilityControls.ImageCropperConfigOptions=Class.create(cm.ConfigOptions,{width:336,height:252,aspectRatio:1,resizeRatio:1,adjustCoordinates:false});cm.ui.utilityControls.ImageCropper=Class.create(cm.ui.UILibraryControl,{configureDefaultOptions:function(){return new cm.ui.utilityControls.ImageCropperConfigOptions()},render:function(){var a=$$P.img(this._id);return $$E(a)},initializeUIElements:function(){this._cfo=this.GetConfigOptions()},createEvents:function($super){$super();this.onImageLoadedEvent=new cm.event()},wireEvents:function($super){$super();var a=this;$$E(this).onload=function(){a.onImageLoaded.call(a)}},Bind:function(b){this._imageData=b;var c=this._cfo.width;var a=this._cfo.height;if($$CM.isNumber(this._imageData.imageWidth)){c=this._imageData.imageWidth}if($$CM.isNumber(this._imageData.imageHeight)){a=this._imageData.imageHeight}this.SetWidth(c);this.SetHeight(a);this.AssignStyle("width",""+c+"px");this.AssignStyle("height",""+a+"px");this.SetImage(this._imageData.src)},GetData:function(){var a=this._coordinates;if(a.w==0||a.h==0){return null}else{var f=a.x;var i=a.y;var g=a.x2;var j=a.y2;var e=(g-f);var b=(j-i);if(this._cfo.adjustCoordinates==true){if(!$$CM.isNumber(this._resizeRatio)||this._resizeRatio==0){this._resizeRatio=1}f=Math.floor(f/this._resizeRatio);i=Math.floor(i/this._resizeRatio);g=Math.floor(g/this._resizeRatio);j=Math.floor(j/this._resizeRatio);e=Math.floor(e/this._resizeRatio);b=Math.floor(b/this._resizeRatio)}var d={x:f,y:i,x2:g,y2:j,w:e,h:b,width:e,height:b};return d}},SetImage:function(a){this.SetAttribute("src",a)},Destroy:function(){if(this._activated==true){$$(".jcrop-holder")[0].remove();this._activated=false}},onImageLoaded:function(){var d=this;var b=this._imageData;var a=this._cfo.aspectRatio;if(b.aspectRatio>0){a=b.aspectRatio}this._resizeRatio=this._cfo.resizeRatio;if($$CM.isNumber(b.resizeRatio)&&b.resizeRatio!=0){this._resizeRatio=b.resizeRatio}var f=[0,0,b.constraintW,b.constraintH];if(!$$CM.isNull(b.initialCrop)){f=[b.initialCrop.x,b.initialCrop.y,b.initialCrop.w,b.initialCrop.h]}else{if(a==b.constraintAspectRatio){f=[0,0,b.imageWidth,b.imageHeight]}}var e=[b.constraintW,b.constraintH];if(!$$CM.isNull(b.minSize)){e=b.minSize}var g=f;if(!$$CM.isNull(b.setSelect)){g=b.setSelect}if(!$$CM.isNull(e)&&this._cfo.adjustCoordinates==true){e[0]=e[0];e[1]=e[1]}if(this._cfo.adjustCoordinates==true){if(!$$CM.isNull(g)&&this._resizeRatio!=1){g=[Math.floor(g[0]*this._resizeRatio),Math.floor(g[1]*this._resizeRatio),Math.floor(g[2]*this._resizeRatio),Math.floor(g[3]*this._resizeRatio)]}}var c={onSelect:function(h){d.showCoords.call(d,h)},onChange:function(h){d.showCoords.call(d,h)},onRelease:this._cfo.onRelease,aspectRatio:a,minSize:e,setSelect:g};if(!$$CM.isEmpty(this._cfo.bgOpacity)){c.bgOpacity=this._cfo.bgOpacity}if(!$$CM.isEmpty(this._cfo.bgColor)){c.bgColor=this._cfo.bgColor}this.getLibraryElement().Jcrop(c);this._activated=true;this.onImageLoadedEvent.fire(this,{})},showCoords:function(a){this._coordinates=a}});"cm.ui.video".namespace();cm.ui.utilityControls.jwPlayerConfigOptions=Class.create(cm.ConfigOptions,{width:512,height:384,imageUrl:"/common/lib/plugins/jwplayer/images/colorBars.jpg",flashUrl:"/common/lib/plugins/jwplayer/jwplayer.flash.swf",watermarkUrl:"/common/lib/plugins/jwplayer/images/watermark.png",autostart:true});cm.ui.utilityControls.jwPlayer=Class.create(cm.ui.Control,{_jwPlayerLoaded:false,configureDefaultOptions:function(){return new cm.ui.utilityControls.jwPlayerConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();var a="";if(!$$CM.isEmpty(cm.hosts.common)){a=cm.hosts.common}this._defaultImageUrl=a+this._co.imageUrl;this._flashUrl=a+this._co.flashUrl;this._watermarkUrl=a+this._co.watermarkUrl;this._width=this._co.width;this._height=this._co.height},initializeUIElements:function(){jwplayer.key="UeFM1ls9er+zUI7Km0FKF7cwRGs2LYZno1CRYQ==";this.AddClassName("cmTVScreen");this._divWrapper=$$P.div("divJWPlayer");this.AddChild(this._divWrapper);this._divWrapper.Hide();this._divPlaceHolder=$$P.div("divJWPlaceholder");this._divPlaceHolder.AddClassName("videoPlaceholder");this.AddChild(this._divPlaceHolder)},createEvents:function($super){$super()},wireEvents:function($super){$super()},onScriptLoaded:function(){},destroy:function(){if(this._jwPlayerLoaded){jwplayer("divJWPlayer").stop();jwplayer("divJWPlayer").destroyPlayer()}this._jwPlayerLoaded=false},load:function(a){var b=this;if(!$$CM.isNull(a)){this._divPlaceHolder.Hide();this._divWrapper.Show();this._divWrapper.UpdateInnerHtml("");var c=new Array();if($$CM.isArray(a)){a.each(function(d){c.push(this.translateVideoForPlaylist(d))},this)}else{c.push(this.translateVideoForPlaylist(a))}this.destroy();jwplayer("divJWPlayer").setup({flashplayer:this._flashUrl,width:this._width,height:this._height,stretching:"uniform",playlist:c,primary:"html5",fallback:"flash",autostart:this._co.autostart,stagevideo:false,analytics:{enabled:false,cookies:false},logo:{hide:true}}).onReady(function(){b.onReady()});this._jwPlayerLoaded=true}},translateVideoForPlaylist:function(b){var a;if(b.imageUrl){a=b.imageUrl}else{a=this._defaultImageUrl}return{image:a,file:b.videoUrl,title:b.title}},onFullscreen:function(){var a=jwplayer("divJWPlayer").getFullscreen()},onReady:function(){},IsLoaded:function(){return this._jwPlayerLoaded}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.ProgressBarConfigOptions=Class.create(cm.ConfigOptions,{value:0});cm.ui.utilityControls.ProgressBar=Class.create(cm.ui.UILibraryControl,{_value:0,configureDefaultOptions:function(){return new cm.ui.utilityControls.ProgressBarConfigOptions()},Bind:function(a){this._value=a;this.getLibraryElement().progressbar("value",a)},postAppendTo:function(){this._value=this.GetConfigOptions().value;this.getLibraryElement().progressbar(this.GetConfigOptions())},GetValue:function(){return this._value}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.SelectorTokenizerConfigOptions=Class.create(cm.ConfigOptions,{url:"",hintText:"Type in the first 3 letters of the user's first or last name.",includeForMe:false,inputWidth:265,ignoreIDArray:$A()});cm.ui.utilityControls.SelectorTokenizer=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.utilityControls.SelectorTokenizerConfigOptions()},initializeDAOs:function($super){$super();this._securityDAO=new cm.dao.Security.DAO()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._co=this.GetConfigOptions();this._cmUserTokenArray=$A();if($$CM.isEmpty(this._co.url)){throw ("URL required")}this._url=this._co.url;this._hintText=this._co.hintText;this._inputWidth=this._co.inputWidth;this._ignoreIDArray=this._co.ignoreIDArray},initializeUIElements:function($super){$super()},createEvents:function($super){$super();this.DataChangedEvent=new cm.event();this.TokenSelectedEvent=new cm.event();this.TokenInsertedEvent=new cm.event();this.TokenDeletedEvent=new cm.event()},wireEvents:function($super){$super()},onBlur:function(b,a){this._hide_dropdown()},postInitialize:function($super){$super();this.renderAutoCompleteControls()},Bind:function(a){this._cmUserTokenArray=$A();if(!$$CM.isNull(a)){this._cmUserTokenArray=a}this.renderAutoCompleteControls()},SetURL:function(a){this._setURL(a)},SetIgnoreIDArray:function(a){this._ignoreIDArray=a;this._setIgnoreIDArray(a)},ClearTokens:function(){this._clearTokens()},renderAutoCompleteControls:function(){var a=this;this.DestroyChildControls();this.AddBlurListener();this.BlurEvent.subscribe(a.onBlur,a);this.AddClickAwayListener();this.ClickAwayEvent.subscribe(a.onBlur,a);var b=$$CM.uniqueID();this._txtControl=$$P.txt(this._id+"_"+b);this.AddChild(this._txtControl);this._txtControl.SetAttribute("placeHolder","Click to edit");jQuery($$E(this._txtControl)).tokenInput(this._url,{prePopulate:this._cmUserTokenArray,parentContainer:a,dataChangedDelegate:this.onData_changed,tokenSelectedDelegate:this.onToken_selected,tokenInsertedDelegate:this.onToken_inserted,tokenDeletedDelegate:this.onToken_deleted,tokenizerLoadedDelegate:this.onTokenizer_load,tokenizerID:this._id,ignoreIDArray:this._ignoreIDArray,minChars:3,hintText:this._hintText,classes:{tokenList:"token-input-list-cm",token:"token-input-token-cm",tokenValueSpan:"token-input-token-value-span-cm",tokenAlternate:"token-input-token-alternate-cm",tokenIcon:"token-input-token-icon-cm",tokenDelete:"token-input-delete-token-cm",selectedToken:"token-input-selected-token-cm",highlightedToken:"token-input-highlighted-token-cm",dropdown:"token-input-dropdown-cm",dropdownItem:"token-input-dropdown-item-even-cm",dropdownItem2:"token-input-dropdown-item-odd-cm",selectedDropdownItem:"token-input-selected-dropdown-item-cm",inputToken:"token-input-input-token-cm"}})},onData_changed:function(a){a.DataChangedEvent.fire()},onToken_selected:function(b,a){b.TokenSelectedEvent.fire(a)},onToken_inserted:function(b,a){b.TokenInsertedEvent.fire(a)},onToken_deleted:function(b,a){b.TokenDeletedEvent.fire(a)},onTokenizer_load:function(b,a){b._input_box=a.input_box;b._hide_dropdown=a.hide_dropdown;b._select_token=a.select_token;b._set_alternateClass=a.set_alternateClass;b._showIcon=a.showIcon;b._deselect_token=a.deselect_token;b._toggle_select_token=a.toggle_select_token;b._delete_token=a.delete_token;b._insert_token=a.insert_token;b._position=a.position;b._tokenElementHash=a.tokenElementHash;b._setURL=a.setURL;b._setIgnoreIDArray=a.setIgnoreIDArray;b._clearTokens=a.clearTokens},GetToken:function(a){var b=this._tokenElementHash[a];return b},GetTokenData:function(b){var c=this;var d=this.GetToken(b);var a=jQuery.data(d.get(0),"tokeninput");return a},GetInputBox:function(){return this._input_box},Hide_dropdown:function(){this._hide_dropdown()},Select_token:function(a){var b=this;var c=this.GetToken(a);if(!$$CM.isNull(c)){this._select_token(c)}},Set_alternateClass:function(a,b){var c=this.GetToken(a);if(!$$CM.isNull(c)){this._set_alternateClass(c,b)}},ShowIcon:function(a,b){var c=this.GetToken(a);if(!$$CM.isNull(c)){this._showIcon(c,b)}},Deselect_token:function(a){var b=this.GetToken(a);if(!$$CM.isNull(b)){this._deselect_token(b,this._position.END)}},Toggle_select_token:function(a){var b=this;var c=this.GetToken(a);if(!$$CM.isNull(c)){this._toggle_select_token(c)}},Delete_token:function(a){var b=this.GetToken(a);if(!$$CM.isNull(b)){this._delete_token(b)}},Insert_token:function(c,f,e,b){var d=e;if(!$$CM.isNull(d)){d=false}var a={};if(!$$CM.isNull(b)){a=b}this._insert_token(c,f,d,a)},GetData:function(){var a={};var c=$A();for(var b in this._tokenElementHash){if(this._tokenElementHash.hasOwnProperty(b)){c.push(b)}}a.PersonIDArray=c;return a}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.SortableConfigOptions=Class.create(cm.ConfigOptions,{revert:true,tolerance:"pointer",snap:true,scroll:true,handle:".handle",includeNestedUL:false});cm.ui.utilityControls.Sortable=Class.create(cm.ui.UILibraryControl,{_activated:false,onSortableListItemChangedEvent:null,onSortableListItemDragStartedEvent:null,configureDefaultOptions:function(){return new cm.ui.utilityControls.SortableConfigOptions()},render:function(){var a=$$P.ul(this._id);return $$E(a)},createEvents:function(){this.onSortableListItemChangedEvent=new cm.event();this.onSortableListItemDragStartedEvent=new cm.event()},Activate:function(){var b=this;var a=this.GetConfigOptions();if($$CM.isNull(a.containment)){a.containment=this.getLibraryElement()}a.stop=function(){b.onSortableListItem_changed.call(b)};a.start=function(){b.onSortableListItem_dragStarted.call(b)};if(a.includeNestedUL==false){this.getLibraryElement().sortable(a)}else{this.getLibraryElement().sortable(a);jQuery("#"+this.ID()+" ul").sortable(a)}this._activated=true},Destroy:function(){if(this._activated==true){this.getLibraryElement().sortable("destroy");this._activated=false}},onSortableListItem_changed:function(){var d=0;var c=false;var b=this.GetConfigOptions();oddClass=b.oddClass;evenClass=b.evenClass;if(!$$CM.isNull(oddClass)&&!$$CM.isNull(evenClass)){$A($$E(this).children).each(function(e){e.removeClassName(oddClass);e.removeClassName(evenClass);if(c){e.addClassName(oddClass)}else{e.addClassName(evenClass)}c=!c},this)}var a={};this.onSortableListItemChangedEvent.fire(this,a)},onSortableListItem_dragStarted:function(){var a={};this.onSortableListItemDragStartedEvent.fire(this,a)}});if(typeof deconcept=="undefined"){var deconcept=new Object()}if(typeof deconcept.util=="undefined"){deconcept.util=new Object()}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object()}deconcept.SWFObject=function(a,m,o,l,b,k,d,e,f,g,i){if(!document.getElementById){return}this.DETECT_KEY=i?i:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(a){this.setAttribute("swf",a)}if(m){this.setAttribute("id",m)}if(o){this.setAttribute("width",o)}if(l){this.setAttribute("height",l)}if(b){this.setAttribute("version",new deconcept.PlayerVersion(b.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(k){this.addParam("bgcolor",k)}var n=e?e:"high";this.addParam("quality",n);this.setAttribute("useExpressInstall",d);this.setAttribute("doExpressInstall",false);var j=(f)?f:window.location;this.setAttribute("xiRedirectUrl",j);this.setAttribute("redirectUrl","");if(g){this.setAttribute("redirectUrl",g)}};deconcept.SWFObject.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array();var c;var b=this.getVariables();for(c in b){a.push(c+"="+b[c])}return a},getSWFHTML:function(){var a="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn")}a='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var b=this.getParams();for(var f in b){a+=[f]+'="'+b[f]+'" '}var c=this.getVariablePairs().join("&");if(c.length>0){a+='flashvars="'+c+'"'}a+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX")}a='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var d=this.getParams();for(var f in d){a+='<param name="'+f+'" value="'+d[f]+'" />'}var e=this.getVariablePairs().join("&");if(e.length>0){a+='<param name="flashvars" value="'+e+'" />'}a+="</object>"}return a},write:function(a){if(this.getAttribute("useExpressInstall")){var b=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(b)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var c=(typeof a=="string")?document.getElementById(a):a;c.innerHTML=this.getSWFHTML();return true}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}return false}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var a=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var d=navigator.plugins["Shockwave Flash"];if(d&&d.description){a=new deconcept.PlayerVersion(d.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(c){try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a=new deconcept.PlayerVersion([6,0,21]);b.AllowScriptAccess="always"}catch(c){if(a.major==6){return a}}try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(c){}}if(b!=null){a=new deconcept.PlayerVersion(b.GetVariable("$version").split(" ")[1].split(","))}}return a};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.rev<a.rev){return false}return true};deconcept.util={getRequestParameter:function(a){var d=document.location.search||document.location.hash;if(d){var b=d.substring(1).split("&");for(var c=0;c<b.length;c++){if(b[c].substring(0,b[c].indexOf("="))==a){return b[c].substring((b[c].indexOf("=")+1))}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){if(window.opera||!document.all){return}var a=document.getElementsByTagName("OBJECT");for(var b=0;b<a.length;b++){a[b].style.display="none";for(var c in a[b]){if(typeof a[b][c]=="function"){a[b][c]=function(){}}}}};deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};if(typeof window.onunload=="function"){var a=window.onunload;window.onunload=function(){deconcept.SWFObjectUtil.cleanupSWFs();a()}}else{window.onunload=deconcept.SWFObjectUtil.cleanupSWFs}};if(typeof window.onbeforeunload=="function"){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){deconcept.SWFObjectUtil.prepUnload();oldBeforeUnload()}}else{window.onbeforeunload=deconcept.SWFObjectUtil.prepUnload}if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;"cm.ui.utilityControls".namespace();cm.ui.utilityControls.ToolbarConfigOptions=Class.create(cm.ConfigOptions,{revert:true,revertDuration:0,cursor:"move",helper:"clone",scope:"editor",opacity:0.5});cm.ui.utilityControls.Toolbar=Class.create(cm.ui.Control,{ToolDragStart:null,ToolDragStop:null,createEvents:function(){this.ToolDragStart=new cm.event();this.ToolDragStop=new cm.event()},configureDefaultOptions:function(){return new cm.ui.utilityControls.ToolbarConfigOptions()},initializeUIElements:function(){this.AddClassName("cmToolbar");var a=null;this.getToolArray().each(function(b){a=this.addTool(b.id,b.item,b.cfg)},this);if(!$$CM.isNull(a)){a.AddClassName("last")}},addTool:function(e,c,b){var d=this;if($$CM.isNull(b)){b=new cm.ConfigOptions()}b.item=c;this.GetConfigOptions().embed(b);var a=new cm.ui.utilityControls.ToolbarItem("tool_"+e,this.GetConfigOptions());a.DragStart.subscribe(this.onDragStart,this);a.DragStop.subscribe(this.onDragStop,this);this.AddChild(a);return a},getToolArray:function(){return $A()},SetEnabled:function($super,a){$super();this.ChildControls().each(function(b){b.SetActive(a)},this)},createContent:function(e,f,a){var d=$$P.div();var c=$$P.h4(null,e);var b=f;b.Bind(a);d.AddChild(c);d.AddChild(b);return d},getBlankDatasource:function(){return $A([{ID:0,Name:""},{ID:1,Name:""},{ID:2,Name:""},{ID:3,Name:""}])},onDragStart:function(b,a){this.ToolDragStart.fire(b,a)},onDragStop:function(b,a){this.ToolDragStop.fire(b,a)}});"cm.ui".namespace();cm.ui.utilityControls.ToolbarItemConfigOptions=Class.create(cm.ui.common.DraggableConfigOptions,{text:"",tip:"",active:true,content:null,zIndex:5000});cm.ui.utilityControls.ToolbarItem=Class.create(cm.ui.common.Draggable,{_item:null,initializeData:function(){this._item=this.GetConfigOptions().item},initializeUIElements:function(){this.AddClassName("cmToolbarItem");if(!$$CM.isNull(this.GetConfigOptions().content)){this.AddChild(this.GetConfigOptions().content);this.SetEnabled(false)}else{this.UpdateInnerHtml(this.GetConfigOptions().text.substring(0,3))}},configureDefaultOptions:function(){return new cm.ui.utilityControls.ToolbarItemConfigOptions()},getDragItem:function(){return this._item}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.UserSelectorTokenizerConfigOptions=Class.create(cm.ConfigOptions,{url:"",includeForMe:false,spanWidth:265,inputWidth:200});cm.ui.utilityControls.UserSelectorTokenizer=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.utilityControls.UserSelectorTokenizerConfigOptions()},initializeDAOs:function($super){$super();this._securityDAO=new cm.dao.Security.DAO()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();if($$CM.isEmpty(this._cfo.url)){throw ("URL required")}this._url=this._cfo.url;this._includeForMe=this._cfo.includeForMe;this._spanWidth=this._cfo.spanWidth;this._inputWidth=this._cfo.inputWidth},initializeUIElements:function(){var b=this.ID();this.SetWidth(this._spanWidth);this._divTokenizer=$$P.div("tokenizer_"+b);this.AddChild(this._divTokenizer);this._divPrivacyOption=$$P.div();this._divTokenizer.AddChild(this._divPrivacyOption);this._divPrivacyOption.AddClassName("ldp cmSubtle");this._divPrivacyOption.SetWidth(this._spanWidth);if(this._includeForMe==true){this._ctForMe=new $$FRB(b+"_rbForMe",{name:"privacyOption_"+b,label:"for me"});this._divPrivacyOption.AddChild(this._ctForMe);this._ctForMe.AddClassName("cmForButtons");this._cntForEveryone=new $$FRB(b+"_rbForEveryone",{name:"privacyOption_"+b,label:"for everyone"});this._divPrivacyOption.AddChild(this._cntForEveryone);this._cntForEveryone.AddClassName("cmForButtons");this._ctForOne=new $$FRB(b+"_rbForOne",{name:"privacyOption_"+b,label:"for person(s)"});this._divPrivacyOption.AddChild(this._ctForOne);this._ctForOne.AddClassName("cmForButtons")}else{this._ctForOne=new $$FRB(b+"_rbForOne",{name:"privacyOption_"+b,label:"for person(s)"});this._divPrivacyOption.AddChild(this._ctForOne);this._ctForOne.AddClassName("cmForButtons");this._cntForEveryone=new $$FRB(b+"_rbForEveryone",{name:"privacyOption_"+b,label:"for everyone"});this._divPrivacyOption.AddChild(this._cntForEveryone);this._cntForEveryone.AddClassName("cmForButtons")}this._divSelectorInputWrapper=$$P.div();this._divTokenizer.AddChild(this._divSelectorInputWrapper);this._divSelectorInput=$$P.div();this._divSelectorInputWrapper.AddChild(this._divSelectorInput);this._tokenizer=new cm.ui.utilityControls.SelectorTokenizer(b,{url:this._url,inputWidth:this._inputWidth});this._divSelectorInput.AddChild(this._tokenizer);var a=$$P.div();this._divTokenizer.AddChild(a);a.AddClassName("cmClear")},createEvents:function(){this.DataChangedEvent=new cm.event();this.TokenSelectedEvent=new cm.event();this.TokenInsertedEvent=new cm.event();this.TokenDeletedEvent=new cm.event()},wireEvents:function($super){$super();this._tokenizer.DataChangedEvent.subscribe(this.onData_changed,this);this._tokenizer.TokenSelectedEvent.subscribe(this.onToken_selected,this);this._tokenizer.TokenInsertedEvent.subscribe(this.onToken_inserted,this);this._tokenizer.TokenDeletedEvent.subscribe(this.onToken_deleted,this);if(this._includeForMe==true){this._ctForMe.ClickEvent.subscribe(this.onPrivacyOption_changed,this)}this._cntForEveryone.ClickEvent.subscribe(this.onPrivacyOption_changed,this);this._ctForOne.ClickEvent.subscribe(this.onPrivacyOption_changed,this)},postInitialize:function($super){$super();if(this._includeForMe==true){this._ctForMe.Bind(true)}else{this._ctForOne.Bind(true)}},onPrivacyOption_changed:function(){var a=this;if(this._cntForEveryone.GetData()||(this._includeForMe==true&&this._ctForMe.GetData())){this._divSelectorInput.Hide()}else{this._divSelectorInput.Show()}this.DataChangedEvent.fire(this)},IsPublic:function(){return this._cntForEveryone.GetData()},IsValid:function(){return !(this._cntForEveryone.GetData()&&this._tokenizer.GetData().PersonIDArray.length==0)},onData_changed:function(b,a){this.DataChangedEvent.fire(this)},onToken_selected:function(b,a){this.TokenSelectedEvent.fire(this)},onToken_inserted:function(b,a){this.TokenInsertedEvent.fire(this)},onToken_deleted:function(b,a){this.TokenDeletedEvent.fire(this)},GetToken:function(a){this._tokenizer.GetToken(a)},GetTokenData:function(a){return this._tokenizer.GetTokenData(a)},GetInputBox:function(){return this._tokenizer.GetInputBox()},Hide_dropdown:function(){this._tokenizer.Hide_dropdown()},Select_token:function(a){this._tokenizer.Select_token(a)},Set_alternateClass:function(a,b){this._tokenizer.Set_alternateClass(a,b)},ShowIcon:function(a,b){this._tokenizer.ShowIcon(a,b)},Deselect_token:function(a){this._tokenizer.Deselect_token(a)},Toggle_select_token:function(a){this._tokenizer.Toggle_select_token(a)},Delete_token:function(a){this._tokenizer.Delete_token(a)},Insert_token:function(b,d,c,a){this._tokenizer.Insert_token(b,d,c,a)},Reset:function(){this._cntForEveryone.Bind(true);this._tokenizer.Bind($A());this.onPrivacyOption_changed()},Bind:function(a){var b=$A();if(!$$CM.isNull(a)){this._cntForEveryone.Bind(a.IsPublic);if(this._includeForMe==true){this._ctForMe.Bind(!this._cntForEveryone.GetData());this._ctForOne.Bind(false)}else{this._ctForOne.Bind(!this._cntForEveryone.GetData())}a.PersonIDArray.each(function(e){var d=this._securityDAO.GetDataArray("CMUsersTokenArray");var c=d.find(function(f){return Number(f.ID)==Number(e)});if(!$$CM.isNull(c)){b.push(c)}},this)}this._tokenizer.Bind(b);this.onPrivacyOption_changed()},GetData:function(){var a={};a.IsPublic=this.IsPublic();a.IsValid=this.IsValid();var b=$A();if(this._includeForMe==true&&this._ctForMe.GetData()){b.push($$USER.PersonID)}else{b=this._tokenizer.GetData().PersonIDArray}a.PersonIDArray=b;return a}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.VideoFileMultipleUploaderConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.utilityControls.VideoFileMultipleUploader=Class.create(cm.ui.UILibraryControl,{configureDefaultOptions:function(){return new cm.ui.utilityControls.VideoFileMultipleUploaderConfigOptions()},initializeUIElements:function(){this._cfo=this.GetConfigOptions();this._fileUpload=new cm.ui.utilityControls.VideoFileUpload("videoFileUpload",this._cfo);this.AddChild(this._fileUpload)},createEvents:function($super){$super();this.DataChanged=new cm.event();this.ItemsDeleted=new cm.event();this.PreviewVideo=new cm.event()},wireEvents:function($super){$super();this._fileUpload.DataChanged.subscribe(this.onDataChanged,this);this._fileUpload.ItemsDeleted.subscribe(this.onItemsDeleted,this);this._fileUpload.PreviewVideo.subscribe(this.onPreviewVideo,this)},Bind:function(a){},GetData:function(){},Destroy:function(){},SetPostAction:function(a){this._fileUpload.SetPostAction(a)},InitiateFormUpload:function(){this._fileUpload.InitiateFormUpload()},ResetFileList:function(a,b){this._fileUpload.ResetFileList(a,b)},DataModified:function(){this._fileUpload.DataModified()},onDataChanged:function(b,a){this.DataChanged.fire(b,a)},onItemsDeleted:function(b,a){this.ItemsDeleted.fire(b,a)},onPreviewVideo:function(b,a){this.PreviewVideo.fire(b,a)}});"cm.ui.utilityControls".namespace();cm.ui.utilityControls.VideoFileUploadConfigOptions=Class.create(cm.ConfigOptions,{includeDefault:true,loadImages:true,loadVideos:false,itemLabel:"Item",errorMessages:{maxFileSize:"File is too big",minFileSize:"File is too small",acceptFileTypes:"Filetype not allowed",maxNumberOfFiles:"Max number of files exceeded",uploadedBytes:"Uploaded bytes exceed file size",emptyResult:"Empty file upload result"},errorLabel:"Error",startLabel:"Upload",cancelLabel:"Cancel",destroyLabel:"Delete",initialFileList:$A()});cm.ui.utilityControls.VideoFileUpload=Class.create(cm.ui.Control,{_uploadCount:0,_downloadCount:0,_seasonID:0,_newsVideoV2WithConstraints:false,configureDefaultOptions:function(){return new cm.ui.utilityControls.VideoFileUploadConfigOptions()},initializeData:function(){this._newsVideoV2WithConstraints=($$CLIENT.VersionBranch&4194304)==4194304},initializeUIElements:function(){var r=this;this._cfo=this.GetConfigOptions();this.setColumns();this._frmFileUpload=$$P.frm("fileupload");this.AddChild(this._frmFileUpload);this._frmFileUpload.SetAttribute("method","POST");this._frmFileUpload.SetAttribute("enctype","multipart/form-data");var c=$$P.div();this._frmFileUpload.AddChild(c);c.AddClassName("row fileupload-buttonbar");var n=$$P.div();c.AddChild(n);n.AddClassName("span7");var s=$$P.span();n.AddChild(s);s.AddClassName("btn btn-success fileinput-button");var p=$$P.i();s.AddChild(p);p.AddClassName("icon-plus icon-white");var t=$$P.span();s.AddChild(t);t.UpdateInnerHtml("Add files...");this._fileInput=$$P.fl("files[]");s.AddChild(this._fileInput);this._fileInput.SetAttribute("multiple","multiple");this._spanStartUpload=$$P.div("spanStartUpload");n.AddChild(this._spanStartUpload);this._spanStartUpload.AddClassName("btn btn-primary fileinput-button_alt start-fileU");var p=$$P.i();this._spanStartUpload.AddChild(p);p.AddClassName("icon-upload icon-white");var t=$$P.span();this._spanStartUpload.AddChild(t);t.UpdateInnerHtml("Upload All");this._spanCancelUpload=$$P.div("spanCancelUpload");n.AddChild(this._spanCancelUpload);this._spanCancelUpload.AddClassName("btn btn-warning fileinput-button_alt cancel-fileU");var p=$$P.i();this._spanCancelUpload.AddChild(p);p.AddClassName("icon-ban-circle icon-white");var t=$$P.span();this._spanCancelUpload.AddChild(t);t.UpdateInnerHtml("Cancel All");var m=$$P.div();c.AddChild(m);m.AddClassName("span5 fileupload-progress fade");var k=$$P.div();m.AddChild(k);k.AddClassName("progress progress-success progress-striped active");var d=$$P.div();k.AddChild(d);d.AddClassName("bar");d.AssignStyle("width","0%");var l=$$P.div();m.AddChild(l);l.AddClassName("progress-extended");l.UpdateInnerHtml("&nbsp;");var e=$$P.div();this._frmFileUpload.AddChild(e);e.AddClassName("fileupload-loading");var a=$$P.div();this._frmFileUpload.AddChild(a);a.AddClassName("cmClear");this._divUploadMessage=$$P.div("divUploadMessage");this._frmFileUpload.AddChild(this._divUploadMessage);this._divUploadMessage.AddClassName("cmClear");this._divUploadMessage.UpdateInnerHtml('There are no files selected for upload.<br />Select the "Add files..." button above or you may drag a file(s) directly onto this browser page.');this._divUpload=$$P.div("tableUpload");this._frmFileUpload.AddChild(this._divUpload);this._divUpload.AddClassName("table table-striped cmFileUploadTable tableUpload");var E=$$P.ul();this._divUpload.AddChild(E);var D=$$P.li();E.AddChild(D);E.AddClassName("tableHeader");var y=$$P.div("thFile_upload");D.AddChild(y);y.UpdateInnerHtml(this._cfo.itemLabel);y.SetWidth(this._resultColumns.previewColumn.ColumnWidth);var c=$$P.div("thObjectID_upload");D.AddChild(c);c.AddClassName("cmHidden");var c=$$P.div("thName_upload");D.AddChild(c);c.AddClassName("cmHidden");var z=$$P.div("thFriendlyName_upload");D.AddChild(z);z.UpdateInnerHtml(this._cfo.itemLabel+" Label");z.SetWidth(this._resultColumns.nameFriendlyColumn.ColumnWidth);var C=$$P.div("thFileSize_upload");D.AddChild(C);C.UpdateInnerHtml(this._resultColumns.sizeColumn.ColumnName);C.SetWidth(this._resultColumns.sizeColumn.ColumnWidth);var A=$$P.div("thProgress_upload");D.AddChild(A);A.SetWidth(this._resultColumns.progressColumn.ColumnWidth);A.UpdateInnerHtml("&nbsp;");var u=$$P.div("thButton1_upload");D.AddChild(u);u.SetWidth(this._resultColumns.startColumn.ColumnWidth);u.UpdateInnerHtml("&nbsp;");var v=$$P.div("thButton2_upload");D.AddChild(v);v.SetWidth(this._resultColumns.cancelColumn.ColumnWidth);v.UpdateInnerHtml("&nbsp;");var E=$$P.ul();this._divUpload.AddChild(E);E.AddClassName("filesUpload");E.SetAttribute("data-toggle","modal-gallery");E.SetAttribute("data-target","#modal-gallery");this._divDownloadWrapper=$$P.div("divDownloadWrapper");this._frmFileUpload.AddChild(this._divDownloadWrapper);var a=$$P.div();this._divDownloadWrapper.AddChild(a);a.AddClassName("cmClear");a.AssignStyle("padding-top","40px");var c=$$P.div();this._divDownloadWrapper.AddChild(c);c.AddClassName("row fileupload-buttonbar-download");var n=$$P.div();c.AddChild(n);n.AddClassName("span7");this._spanDelete=$$P.div("spanDelete");n.AddChild(this._spanDelete);this._spanDelete.AddClassName("btn btn-danger fileinput-button_alt delete-fileU");var p=$$P.i();this._spanDelete.AddChild(p);p.AddClassName("icon-trash icon-white");var t=$$P.span();this._spanDelete.AddChild(t);t.UpdateInnerHtml("Delete Checked");this._cbSelectAll=$$P.cb("cbSelectAll");n.AddChild(this._cbSelectAll);this._cbSelectAll.AddClassName("toggle");this._cbSelectAll.AssignStyle("margin-top","8px");var a=$$P.div();this._divDownloadWrapper.AddChild(a);a.AddClassName("cmClear");a.AssignStyle("padding-top","10px");var q=$$P.div();this._divDownloadWrapper.AddChild(q);q.AddClassName("cmClear");q.UpdateInnerHtml("Drag to reorder the rows of videos below to set the video listing order for CampInTouch.");var a=$$P.div();this._divDownloadWrapper.AddChild(a);a.AddClassName("cmClear");a.AssignStyle("padding-top","10px");this._divDownload=$$P.div("tableDownload");this._divDownloadWrapper.AddChild(this._divDownload);this._divDownload.AddClassName("table table-striped cmFileUploadTable tableDownload");var E=$$P.ul();this._divDownload.AddChild(E);var D=$$P.li("trDownloadHeader");E.AddChild(D);E.AddClassName("tableHeader");if(this._cfo.includeDefault){var w=$$P.div("thDefault_download");D.AddChild(w);w.UpdateInnerHtml(this._resultColumns.isDefaultColumn.ColumnName);w.SetWidth(this._resultColumns.isDefaultColumn.ColumnWidth)}var y=$$P.div("thFile_download");D.AddChild(y);y.UpdateInnerHtml(this._cfo.itemLabel);y.SetWidth(this._resultColumns.previewColumn.ColumnWidth);var c=$$P.div("thObjectID_download");D.AddChild(c);c.AddClassName("cmHidden");var c=$$P.div("thName_download");D.AddChild(c);c.AddClassName("cmHidden");var z=$$P.div("thFriendlyName_download");D.AddChild(z);z.UpdateInnerHtml(this._cfo.itemLabel+" Label");z.SetWidth(this._resultColumns.nameFriendlyDownloadColumn.ColumnWidth);if(this._newsVideoV2WithConstraints){var x=$$P.div("thDisplay_download");D.AddChild(x);x.UpdateInnerHtml("Display");x.SetWidth(this._resultColumns.displayDownloadColumn.ColumnWidth);var B=$$P.div("thSessions_download");D.AddChild(B);B.UpdateInnerHtml("Session Constraints (Campers)");B.SetWidth(this._resultColumns.sessionsDownloadColumn.ColumnWidth)}var C=$$P.div("thFileSize_download");D.AddChild(C);C.UpdateInnerHtml(this._resultColumns.sizeColumn.ColumnName);C.SetWidth(this._resultColumns.sizeColumn.ColumnWidth);var u=$$P.div("thButton1_download");D.AddChild(u);u.SetWidth(this._resultColumns.deleteColumn.ColumnWidth);u.UpdateInnerHtml("&nbsp;");this._ulDownload=$$P.ul();this._divDownload.AddChild(this._ulDownload);this._ulDownload.AddClassName("filesDownload");this._ulDownload.SetAttribute("data-toggle","modal-gallery");this._ulDownload.SetAttribute("data-target","#modal-gallery");this._divModalGallery=$$P.div("modal-gallery");this.AddChild(this._divModalGallery);this._divModalGallery.AddClassName("modal modal-gallery hide fade");var j=$$P.div("divModalHeader");this._divModalGallery.AddChild(j);j.AddClassName("modal-header");this._aModalGalleryClose=$$P.a("aModalGalleryClose");j.AddChild(this._aModalGalleryClose);this._aModalGalleryClose.AddClassName("close");this._aModalGalleryClose.AssignStyle("data-dismiss","modal");this._aModalGalleryClose.UpdateInnerHtml("&times;");var o=$$P.h3();j.AddChild(o);o.AddClassName("modal-title");var f=$$P.div("divModalBody");this._divModalGallery.AddChild(f);f.AddClassName("modal-body");var g=$$P.div("divModalBodyImage");f.AddChild(g);g.AddClassName("modal-image");var h=$$P.div("divModalFooter");this._divModalGallery.AddChild(h);h.AddClassName("modal-footer");this._aModalGalleryNext=$$P.a("aModalGalleryNext");j.AddChild(this._aModalGalleryNext);this._aModalGalleryNext.AddClassName("btn btn-primary modal-next");var s=$$P.span("spnNext","Next");this._aModalGalleryNext.AddChild(s);var p=$$P.i();this._aModalGalleryNext.AddChild(p);p.AddClassName("icon-arrow-right icon-white");this._aModalGalleryPrevious=$$P.a("aModalGalleryPrevious");j.AddChild(this._aModalGalleryPrevious);this._aModalGalleryPrevious.AddClassName("btn btn-info modal-prev");var p=$$P.i();this._aModalGalleryPrevious.AddChild(p);p.AddClassName("icon-arrow-left icon-white");var s=$$P.span("spnNext","Previous");this._aModalGalleryPrevious.AddChild(s);this._aModalGallerySlideshow=$$P.a("aModalGallerySlideshow");j.AddChild(this._aModalGallerySlideshow);this._aModalGallerySlideshow.AddClassName("btn btn-success modal-play modal-slideshow");this._aModalGallerySlideshow.AssignStyle("data-slideshow","5000");var p=$$P.i();this._aModalGallerySlideshow.AddChild(p);p.AddClassName("icon-play icon-white");var s=$$P.span("spnNext","Slideshow");this._aModalGallerySlideshow.AddChild(s);this._aModalGalleryDownload=$$P.a("aModalGalleryDownload");j.AddChild(this._aModalGalleryDownload);this._aModalGalleryDownload.AddClassName("btn modal-download");this._aModalGalleryDownload.AssignStyle("target","_blank");var p=$$P.i();this._aModalGalleryDownload.AddChild(p);p.AddClassName("icon-download");var s=$$P.span("spnNext","Download");this._aModalGalleryDownload.AddChild(s);this._divUpload.Hide();this._spanStartUpload.Hide();this._spanCancelUpload.Hide();this._divDownloadWrapper.Hide();var b={};b.containment=$$E(this._ulDownload);b.stop=function(){r.sortableChanged.call(r)};jQuery($$E(this._ulDownload)).sortable(b)},createEvents:function($super){$super();this.DataChanged=new cm.event();this.ItemsDeleted=new cm.event();this.PreviewVideo=new cm.event()},wireEvents:function($super){$super();this._spanDelete.AddClickListener();this._spanDelete.ClickEvent.subscribe(this.onDeleteAllClicked,this);this._cbSelectAll.AddClickListener();this._cbSelectAll.ClickEvent.subscribe(this.onDeleteCheckBoxClicked,this)},postInitialize:function($super){$super();var b=0;b+=this._resultColumns.previewColumn.ColumnWidth+16;b+=this._resultColumns.nameFriendlyColumn.ColumnWidth+16;b+=this._resultColumns.sizeColumn.ColumnWidth+16;b+=this._resultColumns.progressColumn.ColumnWidth+16;b+=this._resultColumns.startColumn.ColumnWidth+16;b+=this._resultColumns.cancelColumn.ColumnWidth+16;this._divUpload.SetWidth(b);var a=0;if(this._cfo.includeDefault){a+=this._resultColumns.isDefaultColumn.ColumnWidth+16}a+=this._resultColumns.previewColumn.ColumnWidth+16;a+=this._resultColumns.nameFriendlyColumn.ColumnWidth+16;if(this._newsVideoV2WithConstraints){a+=this._resultColumns.displayDownloadColumn.ColumnWidth+16;a+=this._resultColumns.sessionsDownloadColumn.ColumnWidth+16}a+=this._resultColumns.sizeColumn.ColumnWidth+16;a+=this._resultColumns.deleteColumn.ColumnWidth+16;this._divDownload.SetWidth(a)},Bind:function(a){},GetData:function(){},Destroy:function(){$("#fileupload").fileupload("destroy")},SetPostAction:function(a){this._frmFileUpload.SetAttribute("action",a)},InitiateFormUpload:function(){var e=this;e._seasonIDArray=$A();var b=$$CLIENT.FirstSeasonID;var d=$$CLIENT.LastSeasonID;e._seasonIDArray.push({ID:-1,Name:"All"});for(var c=d;c>=b;c--){e._seasonIDArray.push({ID:c,Name:c})}e._sessionIDArray=$A();cm.dao.Lists.Data.SessionDefinitionArray.each(function(f){if(f.IsActive){e._sessionIDArray.push(f)}},this);jQuery("#fileupload").fileupload({uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:function(f){var g=jQuery();jQuery.each(f.files,function(i,h){var j=jQuery('<li class="template-upload fade">'+e._resultColumns.previewColumn.RowSyntax+e._resultColumns.seasonIDColumn.RowSyntax+e._resultColumns.nameColumn.RowSyntax+e._resultColumns.nameFriendlyColumn.RowSyntax+e._resultColumns.sizeColumn.RowSyntax+(h.error?e._resultColumns.errorUploadColumn.RowSyntax:e._resultColumns.progressColumn.RowSyntax+e._resultColumns.startColumn.RowSyntax)+e._resultColumns.cancelColumn.RowSyntax+"</li>");if(!h.error){j.find(".start-fileU span").text(e._cfo.startLabel)}j.find(".seasonID input").prop("value",e._seasonID);j.find(".cancel-fileU span").text(e._cfo.cancelLabel);j.find(".name").find("input").prop("value",h.name);j.find(".nameFriendly input").prop("name","nameFriendly").prop("value",h.name);j.find(".size").text(f.formatFileSize(h.size));if(h.error){j.find(".error").find(".label").text(e._cfo.errorMessages[h.error]||h.error);j.find(".error").attr("style","width:"+e._resultColumns.errorUploadColumn.ColumnWidth+"px;")}g=g.add(j)});return g},downloadTemplate:function(f){var g=jQuery();jQuery.each(f.files,function(i,h){var j=jQuery('<li class="template-download fade handle'+(e._newsVideoV2WithConstraints?" newsVideoV2WithConstraints":"")+'">'+(h.error?(e._cfo.includeDefault?'<div width="'+e._resultColumns.isDefaultColumn.ColumnWidth+'px">&nbsp;</div>':""):(e._cfo.includeDefault?e._resultColumns.isDefaultColumn.RowSyntax:""))+e._resultColumns.previewColumn.RowSyntax+e._resultColumns.seasonIDColumn.RowSyntax+e._resultColumns.orderIndexColumn.RowSyntax+e._resultColumns.objectIDColumn.RowSyntax+e._resultColumns.nameColumn.RowSyntax+(h.error?e._resultColumns.nameFileColumn.RowSyntax:e._resultColumns.nameFriendlyDownloadColumn.RowSyntax)+(e._newsVideoV2WithConstraints?e._resultColumns.displayDownloadColumn.RowSyntax+e._resultColumns.sessionsDownloadColumn.RowSyntax:"")+e._resultColumns.sizeColumn.RowSyntax+(h.error?e._resultColumns.errorDownloadColumn.RowSyntax:e._resultColumns.deleteColumn.RowSyntax)+"</li>");j.find(".size").text(f.formatFileSize(h.size));if(h.error){j.find(".name").find("input").prop("value",h.FileName);j.find(".error").find(".error-message").text(e._cfo.errorLabel);j.find(".error").find(".label").text(e._cfo.errorMessages[h.error]||h.error)}else{j.find(".seasonID input").prop("value",e._seasonID);j.find(".orderIndex").text(h.orderIndex);j.find(".objectID").text(h.objectID);j.find(".name").find("input").prop("value",h.FileName);j.find(".nameFriendly").find("input").prop("value",h.FriendlyName);if(h.type.indexOf("video")<0){if(h.thumbnail_url){j.find(".preview").append("<a><img></a>").find("img").prop("src",h.thumbnail_url);j.find(".preview a").prop("title","Preview")}}else{j.find(".preview").append('<a title="Preview Video"><div class="previewVideo"></div></a>');j.find(".preview div").bind("click",function(){e.onPreviewVideo(h)})}if(h.IsDefault==true){j.find(".isDefault input").attr("checked","checked")}j.find(".delete-fileU span").text(e._cfo.destroyLabel)}if(e._newsVideoV2WithConstraints){if(h.IncludeAllSessions==true){j.find(".sessions input").attr("checked","checked")}if(h.IncludeAll==true){jQuery(j.find(".display input")[0]).attr("checked","checked")}if(h.IncludeStaff==true){jQuery(j.find(".display input")[1]).attr("checked","checked")}if(h.RestrictToSeason==true){jQuery(j.find(".display input")[2]).attr("checked","checked")}e._sessionIDArray.each(function(k){j.find(".sessions").find("select").append(jQuery("<option>",{value:k.ID,text:k.Name}))});j.find(".sessions").find("select").val(h.SessionIDArray);j.find(".sessions").find("select").prop("disabled",j.find(".sessions input").is(":checked"));e.allUsersCBClicked(j)}g=g.add(j)});return g}}).bind("fileuploadrendered",function(g,f){e.updateHeaders(g,f)});jQuery("#fileupload").fileupload("option","redirect",window.location.href.replace(/\/[^\/]*$/,"/ui/common/lib/jquery_plugins/fileUpload/cors/result.html?%s"));var a="";if(!$$CM.isNull(this._cfo.acceptFileTypes)){a=this._cfo.acceptFileTypes}else{if(this._cfo.loadImages==true&&this._cfo.loadVideos==false){a=/(\.|\/)(gif|jpe?g|png)$/i}if(this._cfo.loadImages==true&&this._cfo.loadVideos==true){a=/(\.|\/)(gif|jpe?g|png|mov|mpe?g|avi|flv|mp4|wmv)$/i}if(this._cfo.loadImages==false&&this._cfo.loadVideos==true){a=/(\.|\/)(mov|mpe?g|avi|flv|mp4|wmv)$/i}}jQuery("#fileupload").fileupload("option",{maxFileSize:500000000,resizeMaxWidth:1920,resizeMaxHeight:1200,filesContainer:".filesUpload",filesContainerDownload:".filesDownload",acceptFileTypes:a})},ResetFileList:function(b,c){if(!$$CM.isNull(c)){this._seasonID=c}this.clearRows();if($$CM.isArray(b)&&b.length>0){jQuery("#fileupload").each(function(){var e=this;jQuery(e).fileupload("option","done").call(e,null,{result:b})})}var d=$A();var a=$A(jQuery(".filesDownload").find("li"));a.each(function(f){var e=jQuery(f).find(".orderIndex").text();d.push({OrderIndex:e,Row:f})},this);d=d.sort($$CM.sortByOrderIndex);d.each(function(e){jQuery(".filesDownload").append(e.Row)},this);this.updateHeaders();this.clearUpdateLabelButtons()},DataModified:function(){this.clearUpdateLabelButtons()},updateHeaders:function(){var b=this;if($A(jQuery(".template-upload")).length>0){this._divUploadMessage.Hide();this._divUpload.Show();this._spanStartUpload.Show();this._spanCancelUpload.Show()}else{this._divUploadMessage.Show();this._divUpload.Hide();this._spanStartUpload.Hide();this._spanCancelUpload.Hide()}if($A(jQuery(".template-download")).length>0){this._divDownloadWrapper.Show()}else{this._divDownloadWrapper.Hide()}var a=$A(jQuery(".filesDownload").find("li"));a.each(function(j){var h=jQuery(j).find(".isDefault input");$(h[0]).stopObserving();$(h[0]).observe("change",this.dataChanged.bind(this));var f=jQuery(j).find(".nameFriendly button");$(f[0]).stopObserving();var g=jQuery(j).find(".nameFriendly input");$(g[0]).stopObserving();$(g[0]).observe("keyup",function(){b.labelChanged(j)});var e=jQuery(j).find(".delete-fileU div");$(e[0]).stopObserving();$(e[0]).observe("click",function(){b.deleteRow(j)});var d=jQuery(j).find(".delete-fileU input");$(d[0]).stopObserving();$(d[0]).observe("click",function(){b.deleteRowCheckBoxClicked()});if(this._newsVideoV2WithConstraints){var c=jQuery(j).find(".display input");$(c[0]).stopObserving();$(c[0]).observe("click",function(){b.allUsersCBClicked(j)});var m=jQuery(j).find(".display input");$(m[1]).stopObserving();$(m[1]).observe("click",function(){b.staffCBClicked(j)});var i=jQuery(j).find(".display input");$(i[2]).stopObserving();$(i[2]).observe("click",function(){b.restrictSeasonCBClicked(j)});var k=jQuery(j).find(".sessions input");$(k[0]).stopObserving();$(k[0]).observe("click",function(){b.sessionCBClicked(j)});var l=jQuery(j).find(".sessions select");$(l[0]).stopObserving();$(l[0]).observe("change",this.dataChanged.bind(this))}},this);this.resetOrderIndex()},getData:function(){var a=$A();var b=$A(jQuery(".filesDownload").find("li"));b.each(function(c){a.push(this.getDataRow(c))},this);return a},getDataRow:function(b){var a={};a.SeasonID=jQuery(b).find(".seasonID input").val();a.objectID=jQuery(b).find(".objectID").text();a.FileName=jQuery(b).find(".name input").val().toLowerCase();a.FriendlyName=jQuery(b).find(".nameFriendly input").val();if(this._newsVideoV2WithConstraints){a.IncludeAll=jQuery(b).find(".display input")[0].checked;a.IncludeStaff=jQuery(b).find(".display input")[1].checked;a.RestrictToSeason=jQuery(b).find(".display input")[2].checked;a.IncludeAllSessions=jQuery(b).find(".sessions input")[0].checked;a.SessionIDArray=jQuery(b).find(".sessions select").val();if($$CM.isNull(a.SessionIDArray)){a.SessionIDArray=$A()}}else{a.IncludeAll=true;a.IncludeStaff=true;a.RestrictToSeason=false;a.IncludeAllSessions=true;a.SessionIDArray=$A()}var c=parseFloat(jQuery(b).find(".size").text());a.size=parseInt(c*1000);a.IsDefault=jQuery(b).find(".isDefault input")[0].checked;a.orderIndex=jQuery(b).find(".orderIndex").text();return a},clearRows:function(b){var a=$A(jQuery(".filesDownload").find("li"));a.each(function(c){this.clearEventSubscriptions(c);jQuery(c).remove()},this)},clearEventSubscriptions:function(h){var f=jQuery(h).find(".isDefault input");$(f[0]).stopObserving();var d=jQuery(h).find(".nameFriendly button");$(d[0]).stopObserving();var e=jQuery(h).find(".nameFriendly input");$(e[0]).stopObserving();var c=jQuery(h).find(".delete-fileU div");$(c[0]).stopObserving();var b=jQuery(h).find(".delete-fileU input");$(b[0]).stopObserving();if(this._newsVideoV2WithConstraints){var a=jQuery(h).find(".display input");$(a[0]).stopObserving();var k=jQuery(h).find(".display input");$(k[1]).stopObserving();var g=jQuery(h).find(".display input");$(g[2]).stopObserving();var i=jQuery(h).find(".sessions input");$(i[0]).stopObserving();var j=jQuery(h).find(".sessions select");$(j[0]).stopObserving()}},deleteRow:function(c){var a="Are you sure you wish to delete this item?<br />&nbsp;<br />This action cannot be undone.";var b={title:"Confirm Delete",header:"",message:a,width:400,handlerOk:this.onDelete_confirm,handlerCancel:null,scope:this,args:c};$$CMD.Confirm(b)},onDelete_confirm:function(e,a){var d=a;var c=jQuery(d).find(".nameFriendly input").val();var b=$A();b.push(this.getDataRow(d));this.ItemsDeleted.fire(this,b);this.clearEventSubscriptions(d);jQuery(d).remove();this.updateHeaders()},labelSubmitted:function(c){var b=jQuery(c).find(".nameFriendly button");b[0].addClassName("disabled");var a=$A();a.push(this.getDataRow(c));this.DataChanged.fire(this,a)},labelChanged:function(c){var b=this;var a=jQuery(c).find(".nameFriendly button");$(a[0]).observe("click",function(){b.labelSubmitted(c);return false});a[0].removeClassName("disabled")},allUsersCBClicked:function(c){var b=this;var a=jQuery(jQuery(c).find(".display input")[0]);var f=jQuery(jQuery(c).find(".display input")[1]);var d=jQuery(jQuery(c).find(".display input")[2]);var e=jQuery(c).find(".sessions input");if(a.is(":checked")){$(f[0]).checked=true;$(d[0]).checked=false;$(e[0]).checked=true}f.prop("disabled",a.is(":checked"));d.prop("disabled",a.is(":checked"));e.prop("disabled",a.is(":checked"));this.sessionCBClicked(c)},staffCBClicked:function(b){var a=this;this.dataChanged()},restrictSeasonCBClicked:function(b){var a=this;this.dataChanged()},sessionCBClicked:function(b){var a=this;var c=jQuery(b).find(".sessions input");var d=jQuery(b).find(".sessions select");d.prop("disabled",c.is(":checked"));if(c.is(":checked")){jQuery(b).find(".sessions select").val($A())}this.dataChanged()},dataChanged:function(b){var a=this.getData();this.DataChanged.fire(this,a);this.clearUpdateLabelButtons()},sortableChanged:function(){this.resetOrderIndex();this.dataChanged()},resetOrderIndex:function(){var a=0;var b=$A(jQuery(".filesDownload").find("li"));b.each(function(c){jQuery(c).find(".orderIndex").text(a);a++},this)},clearUpdateLabelButtons:function(){var a=$A(jQuery(".filesDownload").find("li"));a.each(function(c){var b=jQuery(c).find(".nameFriendly button");$(b[0]).stopObserving();b[0].addClassName("disabled")},this)},onDeleteAllClicked:function(){var a=$$E(this._cbSelectAll).checked;var b="Are you sure you wish to delete all checked items?<br />&nbsp;<br />This action cannot be undone.";var c={title:"Confirm Delete",header:"",message:b,width:400,handlerOk:this.onDeleteAll_confirm,handlerCancel:null,scope:this};$$CMD.Confirm(c)},onDeleteAll_confirm:function(d,a){var b=$A();var c=$A(jQuery(".filesDownload").find("li"));c.each(function(f){var e=jQuery(f).find(".delete-fileU input");if($(e[0]).checked==true){b.push(this.getDataRow(f));this.clearEventSubscriptions(f);jQuery(f).remove()}},this);if(b.length>0){this.ItemsDeleted.fire(this,b);this.updateHeaders()}},onDeleteCheckBoxClicked:function(){var a=$$E(this._cbSelectAll).checked;var b=$A(jQuery(".filesDownload").find("li"));b.each(function(d){var c=jQuery(d).find(".delete-fileU input");$(c[0]).checked=a},this)},deleteRowCheckBoxClicked:function(){var a=true;var b=$A(jQuery(".filesDownload").find("li"));b.each(function(d){var c=jQuery(d).find(".delete-fileU input");if($(c[0]).checked==false){a=false}},this);$$E(this._cbSelectAll).checked=a},onPreviewVideo:function(a){this.PreviewVideo.fire(this,a)},setColumns:function(){this._resultColumns={isDefaultColumn:{ColumnName:"Default",ColumnWidth:50,RowSyntax:'<div class="isDefault" align="center" style="width:50px;"><input type="radio" name="isDefault" style="margin-left: 15px;" /></div>',DataProperty:"isDefault"},previewColumn:{ColumnName:"Item",ColumnWidth:80,RowSyntax:'<div class="preview" style="width:80px;"><span class="fade"></span></div>'},seasonIDColumn:{ColumnName:"",ColumnWidth:0,RowSyntax:'<div class="seasonID cmHidden"><input name="seasonID" type="hidden" /></div>'},orderIndexColumn:{ColumnName:"",ColumnWidth:0,RowSyntax:'<div class="orderIndex cmHidden"></div>'},objectIDColumn:{ColumnName:"",ColumnWidth:0,RowSyntax:'<div class="objectID cmHidden"></div>'},nameColumn:{ColumnName:"",ColumnWidth:0,RowSyntax:'<div class="name cmHidden"><input name="fileNameValue" type="hidden" /></div>'},nameFileColumn:{ColumnName:"",ColumnWidth:150,RowSyntax:'<div class="nameFile" style="width:150px;"></div>'},nameFriendlyColumn:{ColumnName:"Item Name",ColumnWidth:200,RowSyntax:'<div class="nameFriendly" style="width:200px;"><input style="width:170px" maxLength="200" /></div>'},nameFriendlyDownloadColumn:{ColumnName:"Item Name",ColumnWidth:200,RowSyntax:'<div class="nameFriendly" style="width:200px;"><input style="width:170px" maxLength="200" /><br /><button class="cmUpdateLabel cmGoButton disabled" onclick="return false;">Update Label</button></div>'},displayDownloadColumn:{ColumnName:"Display",ColumnWidth:140,RowSyntax:'<div class="display" style="width:140px;"><div style="float:left;padding-bottom:5px;"><input type="checkbox" value="1" style="margin-right:6px;float:left;"><div style="float:left;margin-top: 1px;">Include All Users</div></div><br /><div style="float:left;padding-bottom:5px;"><input type="checkbox" value="1" style="margin-right:6px;float:left;"><div style="float:left;margin-top: 1px;">Include Staff</div></div><br /><div style="float:left;padding-bottom:5px;"><input type="checkbox" value="1" style="margin-right:6px;float:left;"><div style="float:left;margin-top: 1px;">Restrict Camper/Staff<br />to Season</div></div></div>'},sessionsDownloadColumn:{ColumnName:"Session Constraints (Campers)",ColumnWidth:200,RowSyntax:'<div class="sessions" style="width:200px;"><div style="float:left;padding-bottom:5px;"><input type="checkbox" value="1" style="margin-right:6px;float:left;"><div style="float:left;margin-top: 1px;">Include All Sessions</div></div><br /><select multiple style="width:190px" size="4"></select></div>'},seasonDownloadColumn:{ColumnName:"Season",ColumnWidth:120,RowSyntax:'<div class="season" style="width:120px;"><select style="width:100px"></select></div>'},sizeColumn:{ColumnName:"Size",ColumnWidth:80,RowSyntax:'<div class="size" style="width:80px;"></div>'},progressColumn:{ColumnName:"&nbsp;",ColumnWidth:250,RowSyntax:'<div style="width:250px;"><div class="progress progress-success progress-striped active"><div class="bar" style="width:0%;"></div></div></div>'},startColumn:{ColumnName:"&nbsp;",ColumnWidth:90,RowSyntax:'<div class="start-fileU" style="width:90px;"><div class="btn btn-primary fileinput-button_alt"><i class="icon-upload icon-white"></i><span></span></div></div>'},cancelColumn:{ColumnName:"&nbsp;",ColumnWidth:85,RowSyntax:'<div class="cancel-fileU" style="width:85px;"><div class="btn btn-warning fileinput-button_alt"><i class="icon-ban-circle icon-white"></i><span></span></div></div>'},deleteColumn:{ColumnName:"&nbsp;",ColumnWidth:120,RowSyntax:'<div class="delete-fileU" style="width:120px;"><div class="btn btn-danger fileinput-button_alt"><i class="icon-trash icon-white"></i><span></span></div><input type="checkbox" name="delete" value="1" style="margin-top:8px;"></div>'},errorUploadColumn:{ColumnName:"&nbsp;",ColumnWidth:350,RowSyntax:'<div class="error"><span class="label label-important"></span><span class="error-message"></span></div>'},errorDownloadColumn:{ColumnName:"&nbsp;",ColumnWidth:120,RowSyntax:'<div class="error"><span class="label label-important"></span>&nbsp;<span class="error-message"></span></div>'}}}});