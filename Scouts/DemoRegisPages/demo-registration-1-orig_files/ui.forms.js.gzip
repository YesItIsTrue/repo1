"cm.ui.forms".namespace();cm.ui.forms.AccountCheckConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.forms.AccountCheck=Class.create(cm.ui.ComplexControl,{CheckEvent:null,SkipEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AccountCheckConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this._divBody=$$P.div("divBody");this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._pMessage1=$$P.p();this._divBody.AddChild(this._pMessage1);this._pMessage1.AddClassName("mt10px mb10px");this._spGreeting=$$P.span();this._pMessage1.AddChild(this._spGreeting);this._spGreeting.AddClassName("cmBold");var b=$$SETTINGSDU.GetEntityLabelSettings().EntityLabelInstitutionCap;this._spMessage1=$$P.span();this._pMessage1.AddChild(this._spMessage1);this._spMessage1.UpdateInnerHtml("You may already have an account with us. It could be from a previous summer, prior contact with the "+b+", or if you were referred to us by another family.");this._pMessage2=$$P.p();this._divBody.AddChild(this._pMessage2);this._pMessage2.AddClassName("mt10px mb10px");this._pMessage2.UpdateInnerHtml("Before we move to the next step, we want to check our records. Please enter any other email addresses that you have used in the past few years.");this._pEmail1=$$P.p();this._divBody.AddChild(this._pEmail1);this._pEmail1.AddClassName("cmCenter mtb5px");this._ftxtEmail1=new $$FTXT("ftxtEmail1",{label:"Email #1"});this._pEmail1.AddChild(this._ftxtEmail1);this._ftxtEmail1.GetInputControl().AddClassName("w180px");this._ftxtEmail1.Validator.addEvaluator($$EVAL.EMAIL({FieldName:"Email #1",IsRequired:true}));this._pEmail2=$$P.p();this._divBody.AddChild(this._pEmail2);this._pEmail2.AddClassName("cmCenter mtb5px");this._ftxtEmail2=new $$FTXT("ftxtEmail2",{label:"Email #2"});this._pEmail2.AddChild(this._ftxtEmail2);this._ftxtEmail2.GetInputControl().AddClassName("w180px");this._ftxtEmail2.Validator.addEvaluator($$EVAL.EMAIL({FieldName:"Email #2",IsRequired:false}));this._pEmail3=$$P.p();this._divBody.AddChild(this._pEmail3);this._pEmail3.AddClassName("cmCenter mtb5px");this._ftxtEmail3=new $$FTXT("ftxtEmail3",{label:"Email #3"});this._pEmail3.AddChild(this._ftxtEmail3);this._ftxtEmail3.GetInputControl().AddClassName("w180px");this._ftxtEmail3.Validator.addEvaluator($$EVAL.EMAIL({FieldName:"Email #3",IsRequired:false}));var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mtb10px");this._divFooter=$$P.div("divFooter");this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnCheck=new $$BTN("btnCheck",{text:"Check"});this._divFooter.AddChild(this._btnCheck);this._btnCheck.AddClassName("cmGoButton cmFloatRight");this._btnSkip=new $$BTN("btnSkip",{text:"Skip"});this._divFooter.AddChild(this._btnSkip);this._btnSkip.AddClassName("cmGoButton")},createEvents:function($super){$super();this.CheckEvent=new cm.event();this.SkipEvent=new cm.event();this.AddEnterPressListener()},wireEvents:function($super){$super();this._btnCheck.ClickEvent.subscribe(this.onCheck,this);this._btnSkip.ClickEvent.subscribe(this.onSkip,this);this.EnterPressEvent.subscribe(this.onCheck,this)},onCheck:function(){if(this.IsValid(true)){var a=this.GetData();this.CheckEvent.fire(this,{data:a})}},onSkip:function(){var a=this.GetData();this.SkipEvent.fire(this,{data:a})},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxtEmail1.Bind(null);this._ftxtEmail2.Bind(null);this._ftxtEmail3.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){var b=a}},GetData:function(){var a=$A();if(!$$CM.isEmpty(this._ftxtEmail1.GetData())){a.push(this._ftxtEmail1.GetData())}if(!$$CM.isEmpty(this._ftxtEmail2.GetData())){a.push(this._ftxtEmail2.GetData())}if(!$$CM.isEmpty(this._ftxtEmail3.GetData())){a.push(this._ftxtEmail3.GetData())}return a}});"cm.ui.forms".namespace();cm.ui.forms.AccountCreateConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.forms.AccountCreate=Class.create(cm.ui.ComplexControl,{ContinueEvent:null,CloseEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AccountCreateConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this._divBody=$$P.div("divBody");this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._pGreeting=$$P.p();this._divBody.AddChild(this._pGreeting);this._pGreeting.AddClassName("mt10px mb10px");this._strongGreeting=$$P.strong();this._pGreeting.AddChild(this._strongGreeting);this._pMessage1=$$P.p();this._divBody.AddChild(this._pMessage1);this._pMessage1.AddClassName("mt10px mb10px");this._pMessage1.UpdateInnerHtml("We are going to create an account for you before you move to the next screen. The email you entered is:");this._pEmail=$$P.p();this._divBody.AddChild(this._pEmail);this._pEmail.AddClassName("cmBold cmCenter mt10px mb10px");this._strongEmail=$$P.strong();this._pEmail.AddChild(this._strongEmail);this._pMessage2=$$P.p();this._divBody.AddChild(this._pMessage2);this._pMessage2.AddClassName("mt10px mb10px");this._pMessage2.UpdateInnerHtml("Now, please enter a password that is at least 5 characters long.");this._pPassword1=$$P.p();this._divBody.AddChild(this._pPassword1);this._pPassword1.AddClassName("cmCenter mtb5px");this._ftxtPassword1=new $$FPSWD("ftxtPassword1",{label:"Password",maxLength:50});this._pPassword1.AddChild(this._ftxtPassword1);this._ftxtPassword1.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Password",IsRequired:true,MinLength:5,MaxLength:50,DisAllow:"&"}));this._passwordStrengthCheck=new cm.ui.common.PasswordStrengthCheck("PasswordStrengthCheck",{ftxtPasswordControl:this._ftxtPassword1});this._pPassword1.AddChild(this._passwordStrengthCheck);this._pPassword2=$$P.p();this._divBody.AddChild(this._pPassword2);this._pPassword2.AddClassName("cmCenter mt5px mb20px cmFloatLeft");this._ftxtPassword2=new $$FPSWD("ftxtPassword2",{label:"Re-type",maxLength:50});this._pPassword2.AddChild(this._ftxtPassword2);this._ftxtPassword2.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Re-type",IsRequired:true,MinLength:5,MaxLength:50,DisAllow:"&"}));this._ftxtPassword2.Validator.addEvaluator($$EVAL.COMPARE({FieldName:"Re-type",comparisonControl:this._ftxtPassword1,comparison:$$CONDITION.EQUALS(),failureMessage:"The two password fields must match."}));var a=$$P.div();this._divBody.AddChild(a);a.AddClassName("cmFormRow mtb10px");this._divFooter=$$P.div("divFooter");this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnContinue=new $$BTN("btnContinue",{text:"Continue"});this._divFooter.AddChild(this._btnContinue);this._btnContinue.AddClassName("cmGoButton cmFloatRight");this._btnClose=new $$BTN("btnClose",{text:"Cancel"});this._divFooter.AddChild(this._btnClose);this._btnClose.AddClassName("cmCancelDeleteButton cmFloatleft")},createEvents:function($super){$super();this.ContinueEvent=new cm.event();this.CloseEvent=new cm.event();this.AddEnterPressListener()},wireEvents:function($super){$super();this._btnContinue.ClickEvent.subscribe(this.onContinue,this);this._btnClose.ClickEvent.subscribe(this.onClose,this);this.EnterPressEvent.subscribe(this.onContinue,this)},onContinue:function(){if(this.IsValid(true)){var a=this.GetData();this.ContinueEvent.fire(this,{data:a})}},onClose:function(){this.CloseEvent.fire(this,{})},SetFocus:function(){this._ftxtPassword1.GetInputControl().Focus()},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._strongGreeting.UpdateInnerHtml("Hi,");this._strongEmail.UpdateInnerHtml("");this._ftxtPassword1.Bind(null);this._ftxtPassword2.Bind(null);this._passwordStrengthCheck.clear()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){var b=a;if(!$$CM.isEmpty(b.FirstName)){this._strongGreeting.UpdateInnerHtml(" Hi "+b.FirstName+",")}if(!$$CM.isEmpty(b.Email)){this._strongEmail.UpdateInnerHtml(b.Email)}}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.Password1=this._ftxtPassword1.GetData();a.Password2=this._ftxtPassword2.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.AccountEmailNameMismatchConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.forms.AccountEmailNameMismatch=Class.create(cm.ui.ComplexControl,{ContinueEvent:null,CloseEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AccountEmailNameMismatchConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this._divBody=$$P.div("divBody");this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._pGreeting=$$P.p();this._divBody.AddChild(this._pGreeting);this._pGreeting.AddClassName("mt10px mb10px");this._strongGreeting=$$P.strong();this._pGreeting.AddChild(this._strongGreeting);this._pMessage1=$$P.p();this._divBody.AddChild(this._pMessage1);this._pMessage1.AddClassName("mt10px mb10px");this._pMessage1.UpdateInnerHtml("An account already exists with the email address you provided, but the name associated with it is different.<br /><br />It is critical that each applicant apply using their own unique email address and not that of a parent, guardian, or other person.<br /><br />Continuing will associate your staff application with the account that already exists.<br /><br />Do you wish to continue using this email address?");var a=$$P.div();this._divBody.AddChild(a);a.AddClassName("cmFormRow mtb10px");this._divFooter=$$P.div("divFooter");this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnContinue=new $$BTN("btnContinue",{text:"Continue"});this._divFooter.AddChild(this._btnContinue);this._btnContinue.AddClassName("cmGoButton cmFloatRight");this._btnClose=new $$BTN("btnClose",{text:"Cancel"});this._divFooter.AddChild(this._btnClose);this._btnClose.AddClassName("cmCancelDeleteButton cmFloatleft")},createEvents:function($super){$super();this.ContinueEvent=new cm.event();this.CloseEvent=new cm.event();this.AddEnterPressListener()},wireEvents:function($super){$super();this._btnContinue.ClickEvent.subscribe(this.onContinue,this);this._btnClose.ClickEvent.subscribe(this.onClose,this);this.EnterPressEvent.subscribe(this.onContinue,this)},onContinue:function(){this.ContinueEvent.fire(this,{})},onClose:function(){this.CloseEvent.fire(this,{})}});"cm.ui.forms".namespace();cm.ui.forms.AccountLoginConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.forms.AccountLogin=Class.create(cm.ui.ComplexControl,{LoginEvent:null,CloseEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AccountLoginConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this._divBody=$$P.div("divBody");this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._pGreeting=$$P.p();this._divBody.AddChild(this._pGreeting);this._pGreeting.AddClassName("mtb5px");this._strongGreeting=$$P.strong();this._pGreeting.AddChild(this._strongGreeting);this._pMessage1=$$P.p();this._divBody.AddChild(this._pMessage1);this._pMessage1.AddClassName("mtb10px");this._pMessage1.UpdateInnerHtml("Did you know that you already have an account with us? You may have an account from a previous season, an online information request, or if you were referred to us by another family.");this._pMessage2=$$P.p();this._divBody.AddChild(this._pMessage2);this._pMessage2.AddClassName("mtb10px");this._pMessage2.UpdateInnerHtml("If you know the password for this account, type it below. If you do not know it, we can ");this._spanMessage2_2=$$P.span();this._pMessage2.AddChild(this._spanMessage2_2);this._aResetAccount=new $$A("aResetAccount",{text:"email a reset account invitation"});this._spanMessage2_2.AddChild(this._aResetAccount);this._aResetAccount.AssignStyle("text-decoration","underline");this._spanMessage2_3=$$P.span();this._pMessage2.AddChild(this._spanMessage2_3);this._spanMessage2_3.UpdateInnerHtml(".");this._pPassword=$$P.p();this._divBody.AddChild(this._pPassword);this._pPassword.AddClassName("cmCenter mtb10px cmFloatLeft");this._ftxtPassword=new $$FPSWD("ftxtPassword",{label:"Password"});this._pPassword.AddChild(this._ftxtPassword);this._ftxtPassword.AddClassName("cmInputLabel");this._ftxtPassword.GetTitleControl().AddClassName("cmInputText");this._ftxtPassword.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Password",IsRequired:true}));var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mtb10px");this._divFooter=$$P.div("divFooter");this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnLogin=new $$BTN("btnLogin",{text:"Login"});this._divFooter.AddChild(this._btnLogin);this._btnLogin.AddClassName("cmGoButton cmFloatRight");this._btnClose=new $$BTN("btnClose",{text:"Cancel"});this._divFooter.AddChild(this._btnClose);this._btnClose.AddClassName("cmCancelDeleteButton")},createEvents:function($super){$super();this.LoginEvent=new cm.event();this.CloseEvent=new cm.event();this.ResetAccountEvent=new cm.event();this.AddEnterPressListener()},wireEvents:function($super){$super();this.EnterPressEvent.subscribe(this.onLogin,this);this._btnLogin.ClickEvent.subscribe(this.onLogin,this);this._btnClose.ClickEvent.subscribe(this.onClose,this);this._aResetAccount.ClickEvent.subscribe(this.onResetAccount,this)},onLogin:function(){if(this.IsValid(true)){var a=this.GetData();this.LoginEvent.fire(this,{data:a})}},onClose:function(b,a){this.CloseEvent.fire(this,{})},onResetAccount:function(b,a){this.ResetAccountEvent.fire(this,{})},SetFocus:function(){this._ftxtPassword.GetInputControl().Focus()},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._strongGreeting.UpdateInnerHtml("Hi,");this._ftxtPassword.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){var b=a;if(!$$CM.isEmpty(b.FirstName)){this._strongGreeting.UpdateInnerHtml(" Hi "+b.FirstName+",")}if(!$$CM.isNull(b.EmaiNameMismatch)&&b.EmaiNameMismatch==true){this._pMessage1.UpdateInnerHtml("There is an existing account with us under the email address you entered, but with a different name associated with it.")}else{this._pMessage1.UpdateInnerHtml("Did you know that you already have an account with us? You may have an account from a previous season, an online information request, or if you were referred to us by another family.")}}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.Password=this._ftxtPassword.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.AccountLoginSessionExpiredConfigOptions=Class.create(cm.ConfigOptions,{});cm.ui.forms.AccountLoginSessionExpired=Class.create(cm.ui.Control,{LoginSessionExpiredEvent:null,CloseSessionExpiredEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AccountLoginSessionExpiredConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){this._divBody=$$P.div("divBody");this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._pMessage1=$$P.p();this._divBody.AddChild(this._pMessage1);this._pMessage1.AddClassName("mtb10px");this._pMessage1.UpdateInnerHtml("Your current user session has expired, please login again to continue.");this._pPassword=$$P.p();this._divBody.AddChild(this._pPassword);this._pPassword.AddClassName("cmCenter mtb10px cmFloatLeft");this._ftxtEmail=new $$FTXT("ftxtEmail",{label:"Email"});this._pPassword.AddChild(this._ftxtEmail);this._ftxtEmail.AddClassName("cmInputLabel");this._ftxtEmail.GetTitleControl().AddClassName("cmInputText");this._ftxtEmail.Validator.addEvaluator($$EVAL.EMAIL({FieldName:"Email",IsRequired:true}));this._ftxtPassword=new $$FPSWD("ftxtPassword",{label:"Password"});this._pPassword.AddChild(this._ftxtPassword);this._ftxtPassword.AddClassName("cmInputLabel");this._ftxtPassword.GetTitleControl().AddClassName("cmInputText");this._ftxtPassword.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Password",IsRequired:true}));this._pMessage2=$$P.p();this._divBody.AddChild(this._pMessage2);this._pMessage2.AddClassName("mtb10px");this._pMessage2.UpdateInnerHtml("If you do not remember your password, we can ");this._spanMessage2_2=$$P.span();this._pMessage2.AddChild(this._spanMessage2_2);this._aResetAccount=new $$A("aResetAccount",{text:"email a reset account invitation"});this._spanMessage2_2.AddChild(this._aResetAccount);this._spanMessage2_3=$$P.span();this._pMessage2.AddChild(this._spanMessage2_3);this._spanMessage2_3.UpdateInnerHtml(" so you can log back in through another browser tab and then continue your action from this browser tab.");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mtb10px");this._divFooter=$$P.div("divFooter");this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnLogin=new $$BTN("btnLogin",{text:"Login"});this._divFooter.AddChild(this._btnLogin);this._btnLogin.AddClassName("cmGoButton cmFloatRight");this._btnClose=new $$BTN("btnClose",{text:"Cancel"});this._divFooter.AddChild(this._btnClose);this._btnClose.AddClassName("cmCancelDeleteButton")},createEvents:function($super){$super();this.LoginSessionExpiredEvent=new cm.event();this.CloseSessionExpiredEvent=new cm.event();this.ResetAccountSessionExpiredEvent=new cm.event();this.AddEnterPressListener()},wireEvents:function($super){$super();this.EnterPressEvent.subscribe(this.onLogin,this);this._btnLogin.ClickEvent.subscribe(this.onLogin,this);this._btnClose.ClickEvent.subscribe(this.onClose,this);this._aResetAccount.ClickEvent.subscribe(this.onResetAccount,this)},onLogin:function(){if(this.IsValid(true)){var a=this.GetData();this.LoginSessionExpiredEvent.fire(this,{data:a})}},onClose:function(b,a){this.CloseSessionExpiredEvent.fire(this,{})},onResetAccount:function(b,a){this.ResetAccountSessionExpiredEvent.fire(this,{})},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxtEmail.Bind(null);this._ftxtPassword.Bind(null)},Bind:function(a){this.ClearFields();this._returnHandlerObject=a},GetData:function(){var a=new Object();a.Email=this._ftxtEmail.GetData();a.Password=this._ftxtPassword.GetData();a.handler=this._returnHandlerObject;return a}});"cm.ui.forms".namespace();cm.ui.forms.AchAccountSelectorConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"<h5>eCheck Accounts</h5>",legendCssClass:"w100prct mb10px",personID:0,achAccountArray:$A(),billingData:null,disabled:false,disabledText:null,enableEdit:true});cm.ui.forms.AchAccountSelector=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.AchAccountSelectorConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._bankAccountTypeEnum=cm.dao.Financial.Enums.BankAccountType.asEnum();this._achAccountArray=$A();if($$CM.isArray(this._co.achAccountArray)){this._achAccountArray=this._co.achAccountArray}if(!$$CM.isNull(this._co.billingData)){this._billingData=this._co.billingData}this._disabled=this._co.disabled;this._disabledText=this._co.disabledText;this._enableEdit=this._co.enableEdit;this._ctrAchAccountSelectorRowArray=$A()},initializeUIElements:function(){if(this._co.disabled==true&&!$$CM.isEmpty(this._co.disabledText)){var b=$$CM.getCMFormattedText(this._co.disabledText);b=$$CM.convertToCamperLabelString(b);var a=new cm.ui.forms.SectionMessage("divAchAccountSDisabledText_"+this._uniqueID,{message:b,cssClass:"cmInfo cmClear mtb0px"});this.AddChild(a)}this._fsWrapper=new $$FS("fsAchAccountS_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsWrapper);if(!$$CM.isEmpty(this._co.headerMessage)){var d=$$CM.getCMFormattedText(this._co.headerMessage);d=$$CM.convertToCamperLabelString(d);this._ctrHeaderMessage=new cm.ui.forms.SectionMessage("divAchAccountSSectionMessage_"+this._uniqueID,{message:d,cssClass:"cmInfo cmClear mtb0px"});this._fsWrapper.AddChild(this._ctrHeaderMessage)}this._pNoAchAccount=$$P.p("pAchAccountSNoAchAccount_"+this._uniqueID);this._fsWrapper.AddChild(this._pNoAchAccount);this._pNoAchAccount.UpdateInnerHtml("You currently have no eCheck accounts on file.");this._pNoAchAccount.AddClassName("cmClear mt0px mb10px");this._divAchAccountList=$$P.div("divAchAccountSAchAccountList_"+this._uniqueID);this._fsWrapper.AddChild(this._divAchAccountList);this._divAchAccountList.AddClassName("cmFormRow cmClear w100prct mt0px mb10px");var c=$$P.div();this._fsWrapper.AddChild(c);c.AddClassName("cmClear");this._pAchAccountAdd=$$P.p("pAchAccountSAchAccountAdd_"+this._uniqueID);this._fsWrapper.AddChild(this._pAchAccountAdd);this._pAchAccountAdd.AddClassName("cmClear mtb0px");this._aAchAccountAdd=new $$A("aAchAccountSAchAccountAdd_"+this._uniqueID,{text:"Add an eCheck Account"});this._pAchAccountAdd.AddChild(this._aAchAccountAdd);if(this._disabled==true){this._fsWrapper.Hide()}this.initializeModals()},initializeModals:function(){this._divModals=$$P.div("divAchAccountSModals_"+this._uniqueID);this.AddChild(this._divModals);this._mdlAchAccountEdit=new cm.ui.dialog.ModalDialog("mdlAchAccountEdit_"+this._uniqueID,{title:"eCheck Account",width:530,draggable:false,dialogClass:"cmGoDialog"});this._divModals.AddChild(this._mdlAchAccountEdit);this._ctrAchAccountEdit=new cm.ui.merchant.achaccount.AchAccountEdit("divAchAccountEdit_"+this._uniqueID,{billingData:this._billingData,personID:this._co.personID});this._mdlAchAccountEdit.AddChild(this._ctrAchAccountEdit);this._divModals.Hide()},wireEvents:function($super){$super();this._aAchAccountAdd.ClickEvent.subscribe(this.onAchAccountAdd,this);this._ctrAchAccountEdit.SaveEvent.subscribe(this.onAchAccountModalSave,this);this._ctrAchAccountEdit.CancelEvent.subscribe(this.onAchAccountModalCancel,this)},onAchAccountAdd:function(b,a){this._mdlAchAccountEdit.SetTitle("Add eCheck Account");this._ctrAchAccountEdit.Bind(null);this._mdlAchAccountEdit.Show()},onAchAccountModalSave:function(e,c){var d=c.data;var b=this._achAccountArray.find(function(f){return f.ID==d.ID},this);if(!$$CM.isNull(b)){var a=$A();this._achAccountArray.each(function(f){if(f.ID==d.ID){d.IsModified=this.isACHChanged(b,d);a.push(d)}else{a.push(f)}},this);this._achAccountArray=a}else{this._achAccountArray.each(function(f){f.IsDefault=false},this);d.IsModified=true;this._achAccountArray.push(d)}this.bindAchAccountArray(this._achAccountArray);this._mdlAchAccountEdit.Hide()},onAchAccountModalCancel:function(b,a){this._mdlAchAccountEdit.Hide()},onAchAccountSelectChanged:function(c,a){var b=a.data;this._achAccountArray.each(function(d){if(d.ID==b.ID){d.IsDefault=true;d.IsModified=true;this._defaultAchAccount=d}else{d.IsDefault=false}},this);this.bindAchAccountArray(this._achAccountArray)},onAchAccountEditClicked:function(c,b){var a=b.data;this._mdlAchAccountEdit.SetTitle("Update eCheck Account");this._ctrAchAccountEdit.Bind(a);this._mdlAchAccountEdit.Show()},onAchAccountRemoveClicked:function(d,b){var c=b.data;var a=$A();this._achAccountArray.each(function(e){if(e.ID==c.ID){e.IsDeleted=true}},this);this.bindAchAccountArray(this._achAccountArray)},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._pNoAchAccount.Hide();this._divAchAccountList.Hide();this._ctrAchAccountSelectorRowArray=$A();this._divAchAccountList.DestroyChildControls(true);this._pAchAccountAdd.Hide()},bindAchAccountListHeader:function(){var c=$$P.div();this._divAchAccountList.AddChild(c);c.AddClassName("cmFormRow cmClear w100prct mt0px mb5px");var f=$$P.div();c.AddChild(f);f.AddClassName("cmFloatLeft w25px");f.UpdateInnerHtml("&nbsp;");var a=$$P.div();c.AddChild(a);a.AddClassName("cmFloatLeft w155px mr5px cmBold");a.UpdateInnerHtml("Account Holder");var g=$$P.div();c.AddChild(g);g.AddClassName("cmFloatLeft w65px mr5px cmBold");g.UpdateInnerHtml("Type");var e=$$P.div();c.AddChild(e);e.AddClassName("cmFloatLeft w85px mr5px cmBold");e.UpdateInnerHtml("Routing #<!--Number-->");var b=$$P.div();c.AddChild(b);b.AddClassName("cmFloatLeft w85px mr5px cmBold");b.UpdateInnerHtml("Account #<!--Number-->");var d=$$P.div();c.AddChild(d);d.AddClassName("cmFloatLeft w95px")},BindBillingData:function(a){if(!$$CM.isNull(a)){this._billingData=a}this._ctrAchAccountEdit.BindBillingData(this._billingData)},bindAchAccountArray:function(a){this._divAchAccountList.DestroyChildControls(true);this._achAccountArray=a;this._ctrAchAccountSelectorRowArray=$A();if(!$$CM.isNull(this._achAccountArray)&&$$CM.isArray(this._achAccountArray)&&this._achAccountArray.length>0){this.bindAchAccountListHeader();var b="AchAccount_"+this._uniqueID;this._achAccountArray.each(function(c){if(c.IsDeleted!=true){var d=new cm.ui.forms.AchAccountSelectorRow("divAchAccountSAchAccount_"+this._uniqueID+"_"+c.ID,{uniqueID:this._uniqueID,achAccount:c,groupName:b,enableEdit:this._enableEdit});this._divAchAccountList.AddChild(d);d.SelectEvent.subscribe(this.onAchAccountSelectChanged,this);d.EditEvent.subscribe(this.onAchAccountEditClicked,this);d.RemoveEvent.subscribe(this.onAchAccountRemoveClicked,this);if(!$$CM.isNull(this._defaultAchAccount)&&c.IsDefault==true){this._defaultAchAccount=c}this._ctrAchAccountSelectorRowArray.push(d)}},this);this._divAchAccountList.Show()}else{this._pNoAchAccount.Show()}},isACHChanged:function(c,b){var a=false;if(!$$CM.isNull(c)&&!$$CM.isNull(b)){if(c.FirstName!=b.FirstName){a=true}if(c.LastName!=b.LastName){a=true}if(!$$CM.addressesMatch(c.Address,b.Address,true)){a=true}}return a},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if($$CM.isArray(b)){var a=b;this.bindAchAccountArray(a)}if(this._enableEdit==true||(this._enableEdit==false&&this._vaultType==1)){this._pAchAccountAdd.Show()}},GetData:function(){var a=this._achAccountArray;return a}});cm.ui.forms.AchAccountSelectorRowConfigOptions=Class.create(cm.ConfigOptions,{achAccount:new Object(),groupName:"AchAccountSelectorRow",enableEdit:true});cm.ui.forms.AchAccountSelectorRow=Class.create(cm.ui.Control,{SelectEvent:null,EditEvent:null,RemoveEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AchAccountSelectorRowConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._bankAccountTypeEnum=cm.dao.Financial.Enums.BankAccountType.asEnum();this._achAccount=this._co.achAccount;if($$CM.isNull(this._achAccount)){this._achAccount=new Object()}this._groupName=this._co.groupName;this._enableEdit=this._co.enableEdit},initializeUIElements:function(){this.AddClassName("cmFormRow cmClear w100prct mt0px mb5px");var c="";if(!$$CM.isEmpty(this._achAccount.FirstName)&&!$$CM.isEmpty(this._achAccount.LastName)){c=this._achAccount.FirstName+" "+this._achAccount.LastName}this._frbAchAccount=new $$FRB("frbAchAccountSAchAccount_"+this._uniqueID+"_"+this._achAccount.ID,{value:this._achAccount.ID,label:c,name:this._groupName,labelClass:"w180px pt0px"});this.AddChild(this._frbAchAccount);this._frbAchAccount.GetTitleControl().AddClassName("w155px");this._divType=$$P.div();this.AddChild(this._divType);this._divType.AddClassName("cmFloatLeft w65px pt2px mr5px");var b=this._bankAccountTypeEnum.GetName(this._achAccount.AccountTypeID);this._divType.UpdateInnerHtml(b);this._divRoutingNumber=$$P.div();this.AddChild(this._divRoutingNumber);this._divRoutingNumber.AddClassName("cmFloatLeft w85px pt2px mr5px");var d=!$$CM.isEmpty(this._achAccount.RoutingNumberLastFour)?this._achAccount.RoutingNumberLastFour:"";this._divRoutingNumber.UpdateInnerHtml($$CM.obfuscate(d,1,3,10));this._divAccountNumber=$$P.div();this.AddChild(this._divAccountNumber);this._divAccountNumber.AddClassName("cmFloatLeft w85px pt2px mr5px");var a=!$$CM.isEmpty(this._achAccount.AccountNumberLastFour)?this._achAccount.AccountNumberLastFour:"";this._divAccountNumber.UpdateInnerHtml($$CM.obfuscate(a,1,3,10));this._divLinks=$$P.div();this.AddChild(this._divLinks);this._divLinks.AddClassName("cmFloatLeft w95px pt2px");this._spEncloseStart=$$P.span(null,"(");this._divLinks.AddChild(this._spEncloseStart);this._aEdit=new $$A("aAchAccountSAchAccountEdit_"+this._uniqueID+"_"+this._achAccount.ID,{text:"Edit"});this._divLinks.AddChild(this._aEdit);this._spSeparator=$$P.span(null,"|");this._divLinks.AddChild(this._spSeparator);this._aRemove=new $$A("aAchAccountSAchAccountRemove_"+this._uniqueID+"_"+this._achAccount.ID,{text:"Remove"});this._divLinks.AddChild(this._aRemove);this._spEncloseEnd=$$P.span(null,")");this._divLinks.AddChild(this._spEncloseEnd);if(this._achAccount.IsDefault!=true){this._spSeparator.Show();this._aRemove.Show()}else{this._frbAchAccount.SetChecked(true);this._spSeparator.Hide();this._aRemove.Hide()}if(this._enableEdit==true||(this._enableEdit==false&&this._vaultType==1)){this._divLinks.Show()}else{this._divLinks.Hide()}},createEvents:function(){this.SelectEvent=new cm.event();this.EditEvent=new cm.event();this.RemoveEvent=new cm.event()},wireEvents:function($super){$super();this._frbAchAccount.ChangeEvent.subscribe(this.onSelectChanged,this);this._aEdit.ClickEvent.subscribe(this.onEditClicked,this);this._aRemove.ClickEvent.subscribe(this.onRemoveClicked,this)},onSelectChanged:function(c,a){var b=this.GetData();this.SelectEvent.fire(c,{data:b})},onEditClicked:function(c,a){var b=this.GetData();this.EditEvent.fire(c,{data:b})},onRemoveClicked:function(c,a){var b=this.GetData();this.RemoveEvent.fire(c,{data:b})},ToggleIsDefault:function(a){this._achAccount.IsDefault=a;this._frbAchAccount.SetChecked(a)},GetData:function(){var a=this._achAccount;return a}});"cm.ui.forms".namespace();cm.ui.forms.ActivityConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"",legendCssClass:"cmLegendBasic cmSubSectionHeader w300px",categoryArray:$A(),activityArray:$A(),teachingLevelArray:$A(),orderIndex:0,required:false});cm.ui.forms.Activity=Class.create(cm.ui.ComplexControl,{ActivityChangedEvent:null,RemoveEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.ActivityConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._categoryArray=this._cfo.categoryArray;this._activityArray=this._cfo.activityArray;this._teachingLevelArray=this._cfo.teachingLevelArray;this.OrderIndex=this._cfo.orderIndex;this.Required=this._cfo.required;this.InDB=false;this.ActivityNumber=this.OrderIndex+1;this.ActivityLabel=this.getActivityTitle(this.ActivityNumber)},initializeUIElements:function(){this.UniqueKey=this.ID();this.AddClassName("cmFloatLeft activityWrapper");var b="_"+this.UniqueKey+"_";var a=$$P.div();this.AddChild(a);a.AddClassName("handle cmHandle");a.SetAttribute("style","background-color: #666666;");this._divDraggableActivity=$$P.div();this._divDraggableActivity.AddClassName("cmDraggable cmInlineBlock w90prct");this.AddChild(this._divDraggableActivity);this._fsCategoryActivity=new $$FS(b,{legendLabel:this.ActivityLabel,legendCssClass:this._cfo.legendCssClass+" cmInlineLegend",isInlineDiv:true});this._divDraggableActivity.AddChild(this._fsCategoryActivity);this._btnRemove=new $$A("aRemove",{text:"Remove"});this._fsCategoryActivity.AddChild(this._btnRemove);this._btnRemove.AddClassName("cmFloatRight");if(this._cfo.required==true){this._btnRemove.Hide()}var a=$$P.div();this._fsCategoryActivity.AddChild(a);a.AddClassName("cmClear");this._divCategoryActivity=$$P.div("div"+b+"CategoryActivity");this._fsCategoryActivity.AddChild(this._divCategoryActivity);this._divCategoryActivity.AddClassName("cmFormRow");this._fddlCategory=new $$FDDL("fddl"+b+"Category",{name:this.ActivityLabel+" - Category",label:"Category",inputWidth:"225",isRequired:this.Required==true});this._divCategoryActivity.AddChild(this._fddlCategory);this._fddlCategory.bindList(this._categoryArray,"","Select Category",false);this._fddlCategory.ChangeEvent.subscribe(this.onCategoryChanged,this);if(this.Required==true){this._fddlCategory.Validator.addEvaluator($$EVAL.SELECT({IsRequired:true}))}this._fddlActivity=new $$FDDL("fddl"+b+"Activity",{name:this.ActivityLabel+" - Activity",label:"Activity",inputWidth:"225",isRequired:this.Required==true});this._divCategoryActivity.AddChild(this._fddlActivity);this._fddlActivity.ChangeEvent.subscribe(this.onActivityChanged,this);if(this.Required==true){this._fddlActivity.Validator.addEvaluator($$EVAL.SELECT({IsRequired:true}))}this._divExperience=$$P.div("div"+b+"Experience");this._fsCategoryActivity.AddChild(this._divExperience);this._divExperience.AddClassName("cmFormRow");this._ftxaExperience=new $$FTXA("_ftxa"+b+"Experience",{name:this.ActivityLabel+" - Experience",label:"Experience",width:"450",maxLength:700,fieldTip:"700 Char Max"});this._divExperience.AddChild(this._ftxaExperience);this._ftxaExperience.AddClassName("cmInputLabel");this._ftxaExperience.GetFieldTipControl().AssignStyle("margin-left","0px");this._ftxaExperience.GetTitleControl().AddClassName("cmInputText");this._ftxaExperience.GetInputControl().AddClassName("w450px h30px");var a=$$P.div();this._fsCategoryActivity.AddChild(a);a.AddClassName("cmFormRow mb5px");this._divTeachingLevel=$$P.div("divExtraInfo");this._fsCategoryActivity.AddChild(this._divTeachingLevel);this._divTeachingLevel.AddClassName("cmFormRow cmValidationFont");this._fsrblTeachingLevel=new $$FSRBL(b+"TeachingLevel",{name:this.ActivityLabel+" - Teaching Level",legendLabel:"Teaching Level",legendCssClass:"cmLegendBasic cmLegendLeft w110px pr0px pt5px",labelCssClass:"wAuto",inputCssClass:"wAuto",isRequired:this.Required==true,isInlineDiv:true});this._fsrblTeachingLevel.AddClassName("w100prct");this._divTeachingLevel.AddChild(this._fsrblTeachingLevel);if(this.Required==true){this._fsrblTeachingLevel.Validator.addEvaluator($$EVAL.GROUP({IsRequired:true}))}var c=b+"TeachingLevel"+$$CM.uniqueID();this._teachingLevelArray.each(function(d){this._fsrblTeachingLevel.AddFormRadioButton({ID:d.ID,Name:d.Name,GroupName:c})},this);this.onCategoryChanged()},createEvents:function(){this.ActivityChangedEvent=new cm.event();this.RemoveEvent=new cm.event()},wireEvents:function($super){$super();this._btnRemove.ClickEvent.subscribe(this.onRemoveClicked,this)},RefreshLabels:function(a){this.ActivityNumber=this.OrderIndex+1;this.ActivityLabel=this.getActivityTitle(this.ActivityNumber);this._fsCategoryActivity.GetLegendControl().UpdateInnerHtml(this.ActivityLabel);this._fddlCategory.GetConfigOptions().Set("name",this.ActivityLabel+" - Category");this._fddlActivity.GetConfigOptions().Set("name",this.ActivityLabel+" - Activity");this._fsrblTeachingLevel.GetConfigOptions().Set("name",this.ActivityLabel+" - Teaching Level")},getActivityTitle:function(c){var b=this._cfo.legendLabel;var d="";switch(c){case 1:d="1st";break;case 2:d="2nd";break;case 3:d="3rd";break;case 4:d="4th";break;case 5:d="5th";break;case 6:d="6th";break;case 7:d="7th";break;case 8:d="8th";break;case 9:d="9th";break;case 10:d="10th";break}var a=b+" "+c;if(!$$CM.isEmpty(d)){a=d+" "+b}return a},onRemoveClicked:function(c,a){var b={title:"Delete Activity Preference?",header:"",message:"<p>This will permanently delete this activity preference.<br />&nbsp;<br />Are you sure you want to continue?</p><p>&nbsp;</p>",handlerOk:this.onRemoveConfirmed,scope:this,width:300,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)},onRemoveConfirmed:function(){this.RemoveEvent.fire(this,{uniqueKey:this.UniqueKey})},onCategoryChanged:function(b){var c=parseInt(this._fddlCategory.GetData());var a=this._activityArray.findAll(function(d){return d.ParentID==c},this);if($$CM.isArray(a)&&a.length>0){this._fddlActivity.bindList(a,"","Select Activity",false);$$E(this._fddlActivity.GetInputControl()).disabled=false;this._fddlActivity.Bind(b)}else{this._fddlActivity.bindList($A(),"","Select Activity",true);$$E(this._fddlActivity.GetInputControl()).disabled=true}},onActivityChanged:function(){var b=parseInt(this._fddlCategory.GetData());var a=parseInt(this._fddlActivity.GetData());this.ActivityChangedEvent.fire(this,{categoryID:b,activityID:a})},AddActivityValidationErrorClass:function(){this._fddlActivity.Validator.Clear();this._fddlActivity.AddClassName("cmValidationError")},RemoveActivityValidationErrorClass:function(){this._fddlActivity.Validator.Clear();this._fddlActivity.RemoveClassName("cmValidationError")},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=this.ValidateIncomplete();if(c.IsValid()!=true){b.AppendResult(c)}}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ValidateIncomplete:function(){var c=new cm.validation.ValidationResult("");if(this.Required!=true&&this.PartiallyFilled()){var a=this._fddlActivity.GetData();if(!$$CM.isNumber(a)||a<=0){c.AddError("<b>"+this.ActivityLabel+" - Activity:</b> Field is required");this._fddlCategory.RemoveClassName("cmValidationError");this._fddlActivity.AddClassName("cmValidationError")}var b=this._fsrblTeachingLevel.GetData();if(!$$CM.isNumber(b)||b<=0){c.AddError("<b>"+this.ActivityLabel+" - Teaching Level:</b> Field is required");this._fddlActivity.RemoveClassName("cmValidationError");this._fsrblTeachingLevel.AddClassName("cmValidationError")}}return c},PartiallyFilled:function(){var a=false;if(!$$CM.isEmpty(this._fddlCategory.GetData())){return true}if(!$$CM.isEmpty(this._fddlActivity.GetData())){return true}if(!$$CM.isEmpty(this._ftxaExperience.GetData())){return true}if($$CM.isNumber(this._fsrblTeachingLevel.GetData())){return true}return a},ClearFields:function(){this.Validator.Clear();this._fddlCategory.Bind(null);this._ftxaExperience.Bind(null);this._fsrblTeachingLevel.Bind(null)},onDataUpdated:function(){var c=this.GetBoundData();if(!$$CM.isNull(c)){this._ftxaExperience.Bind(c.Experience);this._fsrblTeachingLevel.Bind(c.TeachingLevel);var a=this._activityArray.find(function(d){return d.ID+""==c.ActivityID+""},this);var b=null;if(!$$CM.isNull(a)){b=this._categoryArray.find(function(d){return d.ID+""==a.ParentID+""},this)}if(!$$CM.isNull(b)){this._fddlCategory.Bind(b.ID)}this.onCategoryChanged(c.ActivityID);if(!$$CM.isEmpty(c.InDB)&&c.InDB==true){this.InDB=true}}else{this.onCategoryChanged()}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.ActivityID=this._fddlActivity.GetData();a.Experience=this._ftxaExperience.GetData();var b=this._fsrblTeachingLevel.GetData();if($$CM.isNumber(b)){a.TeachingLevel=parseInt(b)}else{a.TeachingLevel=0}a.OrderIndex=this.OrderIndex;return a}});"cm.ui.forms".namespace();cm.ui.forms.ActivityListConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Activities",legendCssClass:"cmSectionHeader",activitiesDisplayed:0,activitiesRequired:0,activitiesMaximum:8,activityCategoryArray:$A(),teachingLevelArray:$A()});cm.ui.forms.ActivityList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.ActivityListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._activitiesDisplayed=this._cfo.activitiesDisplayed;this._activitiesRequired=this._cfo.activitiesRequired;this._activitiesMaximum=this._cfo.activitiesMaximum;this._categoryArray=$A();this._activityArray=$A();this._activityCategoryArray=$A();if($$CM.isArray(this._cfo.activityCategoryArray)){this._activityCategoryArray=this._cfo.activityCategoryArray}if(this._activityCategoryArray.length<=0&&$$CM.isArray(cm.dao.Settings.Data.ActivityCategoryArray)){this._activityCategoryArray=cm.dao.Settings.Data.ActivityCategoryArray;this._activityCategoryArray=this._activityCategoryArray.findAll(function(b){return b.Deleted==false},this);if($$CM.isArray(this._activityCategoryArray)){this._activityCategoryArray=this._activityCategoryArray.sort($$CM.sortByNameProperty)}this._activityCategoryArray.each(function(b){var c=b.ItemArray.findAll(function(d){return d.Deleted==false},this);b.ItemArray=c;if($$CM.isArray(b.ItemArray)){b.ItemArray=b.ItemArray.sort($$CM.sortByNameProperty)}},this)}if($$CM.isArray(this._activityCategoryArray)){this._activityCategoryArray.each(function(b){if($$CM.isArray(b.ItemArray)&&b.ItemArray.length>0){this._categoryArray.push({ID:b.ID,Name:b.Name});b.ItemArray.each(function(c){this._activityArray.push(c)},this)}},this)}this._teachingLevelArray=$A();if($$CM.isArray(this._cfo.teachingLevelArray)){this._teachingLevelArray=this._cfo.teachingLevelArray}if(this._teachingLevelArray<=0&&$$CM.isArray(cm.dao.Forms.Enums.TeachingLevel)){var a=cm.dao.Forms.Enums.TeachingLevel;a.each(function(c){if(c.ID>0){var b=c.ID;var d=c.Name.replace(/_/gi," ");this._teachingLevelArray.push({ID:b,Name:d})}},this)}this._ctrActivityArray=$A();this._deletedActivityAssignmentDataArray=$A()},initializeUIElements:function(){var b=this.ID();this._fsActivityContainer=new $$FS("ActivityContainer",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass+" mb20px"});this.AddChild(this._fsActivityContainer);this._fsActivityContainer.AddClassName("pt10px");this._fslActivities=new $$FSL("divActivities",{});this._fsActivityContainer.AddChild(this._fslActivities);this.setSortableList(this._fslActivities);this._fslActivities.AddClassName("cmFormRow");this._fslActivities.GetListControl().AddClassName("cmActivityList");this._divAddActivity=$$P.div("divAddActivity");this._fsActivityContainer.AddChild(this._divAddActivity);this._divAddActivity.AddClassName("");this._btnAddActivity=new $$BTN("btnAddActivity",{text:"Add Activity"});this._divAddActivity.AddChild(this._btnAddActivity);this._btnAddActivity.AddClassName("cmGoButton cmFloatRight");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px");this.renderActivities()},wireEvents:function($super){$super();this._btnAddActivity.ClickEvent.subscribe(this.onAddActivityClicked,this);this._fslActivities.onSortableListItemChangedEvent.subscribe(this.onSortableListItem_changed,this)},renderActivities:function(){for(var a=1;a<=this._activitiesDisplayed;a++){var b=(a<=this._activitiesRequired);this.AddActivity(b,null)}},setSortableList:function(a){this._fslActivities.ActivateSortable()},onSortableListItem_changed:function(){var a=0;$A($$E(this._fslActivities.GetListControl()).children).each(function(c){var b=this._ctrActivityArray.find(function(d){return d.UniqueKey==c.id});if(!$$CM.isNull(b)){b.OrderIndex=a;a++}},this);this.sortActivitiesAsc();this.refreshActivityControls()},sortActivitiesAsc:function(){if(!$$CM.isNull(this._ctrActivityArray)&&this._ctrActivityArray.length>0){this._ctrActivityArray.sort(function(c,d){var e=parseInt(c.OrderIndex);var f=parseInt(d.OrderIndex);return((e<f)?-1:((e>f)?1:0))})}},onAddActivityClicked:function(){this.AddActivity(false,null)},AddActivity:function(d,a){if(this._ctrActivityArray.length<this._activitiesMaximum){var c=this._ctrActivityArray.length;var b=new cm.ui.forms.Activity($$CM.uniqueID(),{legendLabel:"Preference",legendCssClass:"cmLegendBasic cmSubSectionHeader w300px",required:d,categoryArray:this._categoryArray,activityArray:this._activityArray,teachingLevelArray:this._teachingLevelArray,orderIndex:c});this._fslActivities.AddListItemControl(b);b.ActivityChangedEvent.subscribe(this.onActivityChanged,this);b.RemoveEvent.subscribe(this.onActivityRemoved,this);this._ctrActivityArray.push(b);if(!$$CM.isNull(a)){b.Bind(a)}}this.toggleAddButton()},toggleAddButton:function(){if(this._ctrActivityArray.length<this._activitiesMaximum){this._divAddActivity.Show(false)}else{this._divAddActivity.Hide(false)}},onActivityChanged:function(b,a){this.ValidateOnDemand(true)},onActivityRemoved:function(d,a){var e=a.uniqueKey;var c=0;var b=$A();this._ctrActivityArray.each(function(g){if(g.UniqueKey==e){if(g.InDB==true){var f=g.GetData();f.Deleted=true;this._deletedActivityAssignmentDataArray.push(f)}}else{g.OrderIndex=c;c++;b.push(g)}},this);this._ctrActivityArray=b;this.refreshActivityControls();this.toggleAddButton()},refreshActivityControls:function(){this._fslActivities.GetListControl().ClearChildControls(false);this._ctrActivityArray.each(function(a){a.RefreshLabels();this._fslActivities.AddListItemControl(a)},this)},ValidateForDuplicates:function(){var c=new cm.validation.ValidationResult("");var a=$A();this._ctrActivityArray.each(function(e){var d=e.GetData();if(!$$CM.isNull(d)){a.push(d)}},this);if($$CM.isArray(this._ctrActivityArray)&&this._ctrActivityArray.length>0){var b=false;this._ctrActivityArray.each(function(f){f.RemoveActivityValidationErrorClass();var d=f.GetData();if(!$$CM.isEmpty(d.ActivityID)&&d.ActivityID>0){var e=a.findAll(function(g){return g.ActivityID==d.ActivityID},this);if($$CM.isArray(e)&&e.length>1){b=true;f.AddActivityValidationErrorClass()}}},this);if(b==true){c.AddError("You have selected the same activity twice.")}}return c},ValidateOnDemand:function(a){var b=this.ValidateForDuplicates();if(a==true){this.Validator.ShowErrors(b)}},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=new cm.validation.ValidationResult("");this._ctrActivityArray.findAll(function(e){var f=e.Validate(false);if(f.IsValid()!=true){c.AppendResult(f)}},this);b.AppendResult(c)}if(b.IsValid()==true){var d=this.ValidateForDuplicates();b.AppendResult(d)}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrActivityArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){var b=0;a.each(function(c){if(c.Deleted!=true){var d=null;if(b<this._ctrActivityArray.length){d=this._ctrActivityArray[b]}if(!$$CM.isNull(d)){d.Bind(c)}else{this.AddActivity(false,c)}b++}},this)}},GetData:function(){var b=this.GetBoundData();if(!$$CM.isArray(b)){b=$A()}var a=$A();this._ctrActivityArray.each(function(d){var c=d.GetData();if(!$$CM.isNull(c)){if($$CM.isNumber(c.ActivityID)&&c.ActivityID>0&&$$CM.isNumber(c.TeachingLevel)&&c.TeachingLevel>0){a.push(c)}}},this);this._deletedActivityAssignmentDataArray.each(function(c){a.push(c)},this);b.each(function(c){var d=a.find(function(e){return c.ActivityID==e.ActivityID});if(d==null){a.push(c)}},this);b=a;return b}});"cm.ui.forms".namespace();cm.ui.forms.AdditionalOptionConfigOptions=Class.create(cm.ConfigOptions,{settings:new Object(),definition:new Object(),groupName:"AO_"+$$CM.uniqueID()});cm.ui.forms.AdditionalOption=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.AdditionalOptionConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._settings=this._co.settings;this._definition=new Object();if(!$$CM.isNull(this._co.definition)){this._definition=this._co.definition}this._additionalOptionDefinitionArray=$A();if($$CM.isArray(cm.dao.Lists.Data.AdditionalOptionDefinitionArray)){this._additionalOptionDefinitionArray=cm.dao.Lists.Data.AdditionalOptionDefinitionArray;this._additionalOptionDefinitionArray=this._additionalOptionDefinitionArray.sort($$CM.sortByOrderIndex)}this._isSelected=false;this._inDB=false},initializeUIElements:function(){this.AddClassName("cmAdditionalOption");var d="";if($$CM.isNumber(this._definition.Amount)){d=$$CM.getFormattedCurrency(this._definition.Amount,cm.dao.Settings.Data.FinancialSettings.CurrencySymbol,false)}var c=this._definition.EnableQuantity;var h=this._definition.QuantityMin;var g=this._definition.QuantityMax;var f=(c==true)?360:520;this._divDetails=$$P.div("divAODetails_"+this._uniqueID);this.AddChild(this._divDetails);this._divDetails.AddClassName("cmAdditionalOptionDetails");this._divDetailsLeft=$$P.div("divAODetailsLeft_"+this._uniqueID);this._divDetails.AddChild(this._divDetailsLeft);this._divDetailsLeft.AddClassName("cmFloatLeft w"+f+"px cmAdditionalOptionDetailsLeft");var e="<span class='cmFloatRight'>"+d+"</span><span class='input'>"+this._definition.Name+"</span>";this._fcbAdditionalOption=new $$FCB("fcbAO_"+this._uniqueID,{value:this._definition.ID,label:e,name:this._co.groupName});this._divDetailsLeft.AddChild(this._fcbAdditionalOption);this._fcbAdditionalOption.AddClassName("w"+f+"px mt0px pt0px");this._fcbAdditionalOption.GetTitleControl().RemoveClassName("cmCheckboxTitleBase");this._fcbAdditionalOption.GetTitleControl().AddClassName("cmBold w"+(f-25)+"px pl0px pr5px mt0px pt1px");this._fcbAdditionalOption.GetInputControl().AddClassName("pt0px");this._divDetailsRight=$$P.div("divAODetailsRight_"+this._uniqueID);this._divDetails.AddChild(this._divDetailsRight);this._divDetailsRight.AddClassName("w150px cmFloatRight pl10px cmAdditionalOptionDetailsRight");this._spQuantityLegend=$$P.span();this._divDetailsRight.AddChild(this._spQuantityLegend);this._spQuantityLegend.AddClassName("cmQuantityLegend cmFloatRight w50px");this._spQuantityLegend.UpdateInnerHtml("("+h+"-"+g+")");if(c!=true){this._divDetailsRight.Hide()}this._ftxtQuantity=new $$FTXT("ftxtQty_"+this._uniqueID,{label:"Quantity",maxLength:4});this._divDetailsRight.AddChild(this._ftxtQuantity);this._ftxtQuantity.AddClassName("w100px mt0px pt0px cmFloatRight");this._ftxtQuantity.GetTitleControl().AddClassName("cmBold w65px pl0px mt0px pt0px");this._ftxtQuantity.GetInputControl().AddClassName("mt0px pt0px w25px");this._ftxtQuantity.Validator.addEvaluator($$EVAL.NUMBER({DataType:"int",ErrorMessage:"Must be of type INTEGER",FieldName:this._ftxtQuantity.GetName(),MinValue:h,MaxValue:g,IsRequired:true}));this._divDescription=$$P.div("divAODescription_"+this._uniqueID);this.AddChild(this._divDescription);this._divDescription.AddClassName("cmAdditionalOptionDescription");if(!$$CM.isEmpty(this._definition.Description)){var a=$$CM.getCMFormattedText(this._definition.Description);this._divDescription.UpdateInnerHtml(a)}else{this._divDescription.Hide()}this._divMemo=$$P.div("divAOMemo_"+this._uniqueID);this.AddChild(this._divMemo);this._divMemo.AddClassName("cmAdditionalOptionMemo");this._ftxtMemo=new $$FTXT("ftxtMemo_"+this._uniqueID,{label:"Memo"});this._divMemo.AddChild(this._ftxtMemo);this._ftxtMemo.AddClassName("w495px  mt0px pt0px");this._ftxtMemo.GetTitleControl().AddClassName("w50px pl0px mt0px pt1px");this._ftxtMemo.GetInputControl().AddClassName("mt0px pt0px w435px");if(!this._definition.EnableMemo){this._divMemo.Hide()}var b=$$P.div();this.AddChild(b);b.AddClassName("cmClear")},postInitialize:function($super){$super();this.SetEnabled()},wireEvents:function($super){$super();this._fcbAdditionalOption.ClickEvent.subscribe(this.onAdditionalOptionClicked,this)},onAdditionalOptionClicked:function(c,a){if(this._inDB==true){var b="This camper has already applied for this additional option, and it was added on the family ledger.  If you would like to make changes, please call us.";if(this._settings&&this._settings.GeneralSettings){b=$$SETTINGSDU.GetFormattedCallUsMessage("This camper has already applied for this additional option, and it was added on the family ledger.  If you would like to make changes",this._settings.GeneralSettings)}b=$$CM.convertToEntityLabelString(b,$$SETTINGSDU.GetEntityLabelSettings());$$CMD.AlertCancel({title:"Error",header:"",message:b});this.Select();return}this._isSelected=!this._isSelected;if(this._isSelected==true){this.Select()}else{this.Deselect()}},Select:function(){this._isSelected=true;this._fcbAdditionalOption.Bind(this._isSelected);this._fcbAdditionalOption.RemoveClassName("selected");this._fcbAdditionalOption.AddClassName("selected");this.SetEnabled()},Deselect:function(){this._isSelected=false;this._fcbAdditionalOption.Bind(this._isSelected);this._fcbAdditionalOption.RemoveClassName("selected");this.SetEnabled()},SetEnabled:function(){var a=(this._isSelected==true);if(this._definition.EnableQuantity==true){this._ftxtQuantity.SetEnabled(a)}if(a){this._ftxtMemo.Show();if(this._definition.RequireMemo){this._ftxtMemo.GetTitleControl().AddClassName("cmRequiredField");this._ftxtMemo.Validator.addEvaluator($$EVAL.STRING({FieldName:"Memo",IsRequired:this._definition.RequireMemo}))}else{this._ftxtMemo.GetTitleControl().RemoveClassName("cmRequiredField")}}else{this._ftxtMemo.Hide();this._ftxtMemo.Validator.Clear()}this.Validator.Clear();if(a==true){this.Validator.Enable()}else{this.Validator.Disable()}},IsSelected:function(){return this._isSelected},InDB:function(){return this._inDB},InLog:function(){return this._inLog},Validate:function(d){var e=this.Validator.validate();if(this.IsSelected()==true&&e.IsValid()==true){if(this._inDB==true){var c=this.GetBoundData();var b=this.GetData();if(!$$CM.isNull(c)&&!$$CM.isNull(b)&&b.Quantity<c.Quantity){var a=new cm.validation.ValidationResult("",null);a.AddError("Quantity of "+c.Quantity+" was already applied, and it was added on the family ledger. You may only inrease this quantity.");this._ftxtQuantity.AddClassName("cmValidationError");e.AppendResult(a)}}}if(d==true){this.Validator.ShowErrors(e)}return e},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();if(this._definition.EnableQuantity==true){this._ftxtQuantity.Bind()}if(this._definition.EnableMemo==true){this._ftxtMemo.Bind()}},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){if(this._definition.EnableQuantity==true&&!$$CM.isNull(a.Quantity)){this._ftxtQuantity.Bind(a.Quantity)}if(this._definition.EnableMemo==true&&!$$CM.isNull(a.Memo)){this._ftxtMemo.Bind(a.Memo)}this._inDB=(a.InDB==true);this._inLog=(a.InLog==true);this.Select()}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object();a.ID=0;a.SeasonID=this._definition.SeasonID;a.LineItemID=this._definition.LineItemID;a.LineItemSeasonID=this._definition.LineItemSeasonID;a.InDB=false}if(this._definition.EnableQuantity==true&&$$CM.isInteger(this._ftxtQuantity.GetData())){a.Quantity=parseInt(this._ftxtQuantity.GetData())}else{a.Quantity=1}if(this._definition.EnableMemo==true&&!$$CM.isEmpty(this._ftxtMemo.GetData())){a.Memo=this._ftxtMemo.GetData()}a.Amount=this._definition.Amount;return a}});"cm.ui.forms".namespace();cm.ui.forms.AdditionalOptionCategoryConfigOptions=Class.create(cm.ConfigOptions,{settings:new Object(),definition:new Object(),groupName:"AOC"});cm.ui.forms.AdditionalOptionCategory=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.AdditionalOptionCategoryConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();if(!$$CM.isEmpty(this._cfo.uniqueID)){this._uniqueID=this._cfo.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._settings=this._cfo.settings;this._definition=new Object();if(!$$CM.isNull(this._cfo.definition)){this._definition=this._cfo.definition}this._definition.GroupName=this._cfo.groupName;this._additionalOptionArray=$A();if($$CM.isArray(this._cfo.additionalOptionArray)){this._additionalOptionArray=this._cfo.additionalOptionArray}if($$CM.isArray(this._additionalOptionArray)){this._additionalOptionArray=$$FDU.SortLineItemSeasonArray(this._additionalOptionArray)}this._isCollapsed=false;this._ctrItemArray=$A()},initializeUIElements:function(){this.AddClassName("cmAdditionalOptionCategory");this._h5Name=$$P.h5("h5AOCName_"+this._uniqueID);this.AddChild(this._h5Name);if(!$$CM.isEmpty(this._definition.Name)){this._h5Name.UpdateInnerHtml(this._definition.Name)}this._pDescription=$$P.p("pAOCDescription_"+this._uniqueID);this.AddChild(this._pDescription);this._pDescription.AddClassName("mb10px");if(!$$CM.isEmpty(this._cfo.definition.Description)){var a=$$CM.getCMFormattedText(this._definition.Description);this._pDescription.UpdateInnerHtml(a)}else{this._pDescription.Hide()}this._divAdditionalOptionList=$$P.div("divAOList_"+this._uniqueID);this.AddChild(this._divAdditionalOptionList);this.RenderAdditionalOptionArray();if(this._settings.EnableOptionsExpandCollapse==true){this.RenderToggleLink()}},RenderAdditionalOptionArray:function(){var a="AO_"+this._uniqueID;if($$CM.isArray(this._additionalOptionArray)){this._additionalOptionArray.each(function(b){var d=$$CM.uniqueID();var c=new cm.ui.forms.AdditionalOption("divAO_"+d,{settings:this._settings,definition:b,uniqueID:d,groupName:a});this._divAdditionalOptionList.AddChild(c);this._ctrItemArray.push(c)},this)}},RenderToggleLink:function(){this._aToggle=new $$A("aAOCToggle_"+this._uniqueID,{text:"Show "+this._cfo.definition.Name+" Options"});this.AddChild(this._aToggle);this._aToggle.AddClassName("ptb10px");this._aToggle.ClickEvent.subscribe(this.onToggleClicked,this);this.Collapse(false)},onToggleClicked:function(b,a){if(this._isCollapsed){this.Expand(true)}else{this.Collapse(true)}},Collapse:function(a){if(this._settings.EnableOptionsExpandCollapse==true){this._aToggle.Hide()}var b={expanded:false,animate:a};this._divAdditionalOptionList.Hide(a,1000,"blind",{direction:"vertical"},this.onAnimationCompleted,this,b);if(a!=true){this.onAnimationCompleted(b)}},Expand:function(a){if(this._settings.EnableOptionsExpandCollapse==true){this._aToggle.Hide()}var b={expanded:true,animate:a};this._divAdditionalOptionList.Show(a,1000,"blind",{direction:"vertical"},this.onAnimationCompleted,this,b);if(a!=true){this.onAnimationCompleted(b)}},onAnimationCompleted:function(a){if(this._settings.EnableOptionsExpandCollapse==true){if(a.expanded==true){this._isCollapsed=false;this._aToggle.UpdateInnerHtml("Hide "+this._cfo.definition.Name+" Options")}else{this._isCollapsed=true;this._aToggle.UpdateInnerHtml("Show "+this._cfo.definition.Name+" Options")}this._aToggle.Show(a.animate)}},onDescriptionShowMoreClicked:function(){var a=this._definition.Description;this._spDescription.UpdateInnerHtml(a);this._lnkDescriptionShowMore.Hide()},onDescriptionShowLessClicked:function(){var a=definition.Description.substring(0,160);this._spDescription.UpdateInnerHtml(a);this._lnkDescriptionShowMore.Show()},Validate:function(a){var b=new cm.validation.ValidationResult("",null);if($$CM.isArray(this._ctrItemArray)){this._ctrItemArray.each(function(c){var d=c.Validate();b.AppendResult(d)},this)}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear()},onDataUpdated:function(){this.ClearFields();var c=this.GetBoundData();if($$CM.isArray(c)){this._ctrItemArray.each(function(e){var d=c.find(function(f){return Number(f.LineItemSeasonID)==Number(e._definition.LineItemSeasonID)},this);e.Bind(d)},this);var b=this._ctrItemArray.find(function(d){return d.IsSelected()==true},this);if(!$$CM.isNull(b)){this._isSelected=true;this.Expand(false)}var a=this._ctrItemArray.find(function(d){return d.InDB()==true},this);if(!$$CM.isNull(a)){this._inDB=true}}},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}var b=$A();this._ctrItemArray.each(function(c){if(c.IsSelected()){var d=c.GetData();b.push(d)}},this);a=b;return a}});"cm.ui.forms".namespace();cm.ui.forms.AdditionalOptionSelectorConfigOptions=Class.create(cm.ConfigOptions,{settings:new Object(),existingStatus:0,legendLabel:"Additional Options",legendCssClass:"",sectionMessage:"",sectionMessageCssClass:"",additionalOptionDefinitionArray:$A(),additionalOptionCategoryDefinitionArray:$A(),seasonAdditionalOptionArray:$A(),required:false,formID:101});cm.ui.forms.AdditionalOptionSelector=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.AdditionalOptionSelectorConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._formID=this._co.formID;this._settings=new Object();if(!$$CM.isNull(this._co.settings)){this._settings=this._co.settings}this._required=this._co.required;this._entityLabelSettings=$$SETTINGSDU.GetEntityLabelSettings();this._additionalOptionDefinitionArray=$A();if($$CM.isArray(cm.dao.Lists.Data.AdditionalOptionDefinitionArray)){this._additionalOptionDefinitionArray=cm.dao.Lists.Data.AdditionalOptionDefinitionArray;this._additionalOptionDefinitionArray=this._additionalOptionDefinitionArray.sort($$CM.sortByNameProperty)}this._additionalOptionCategoryDefinitionArray=$A();if($$CM.isArray(cm.dao.Lists.Data.AdditionalOptionCategoryDefinitionArray)){this._additionalOptionCategoryDefinitionArray=cm.dao.Lists.Data.AdditionalOptionCategoryDefinitionArray;this._additionalOptionCategoryDefinitionArray=this._additionalOptionCategoryDefinitionArray.sort($$CM.sortByOrderIndex)}this._additionalOptionArray=$A();if($$CM.isArray(this._co.additionalOptionArray)){this._additionalOptionArray=this._co.additionalOptionArray;this._additionalOptionArray=this._additionalOptionArray.sort($$CM.sortByOrderIndex)}this._ctrItemArray=$A()},initializeUIElements:function(){this._fsSelector=new $$FS("fsAOS_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsSelector);if(!$$CM.isEmpty(this._co.sectionMessage)){var b=$$CM.getCMFormattedText(this._co.sectionMessage);b=$$CM.convertToEntityLabelString(b,this._entityLabelSettings);this._ctrSectionMessage=new cm.ui.forms.SectionMessage("divAOSSectionMessage_"+this._uniqueID,{message:b,cssClass:"cmClear mtb0px"});this._fsSelector.AddChild(this._ctrSectionMessage);if(!$$CM.isEmpty(this._co.sectionMessageCssClass)){this._ctrSectionMessage.AddClassName(this._co.sectionMessageCssClass)}}if($$CM.isArray(this._additionalOptionCategoryDefinitionArray)){var a="AOC_"+this._uniqueID;this._additionalOptionCategoryDefinitionArray.each(function(e){var d=this._additionalOptionDefinitionArray.findAll(function(h){return Number(h.LineItemCategoryID)==Number(e.LineItemCategoryID)},this);var c=this._additionalOptionArray.findAll(function(i){var j=false;var h=d.find(function(k){return Number(k.LineItemID)==Number(i.LineItemID)},this);if(!$$CM.isNull(h)){if($$CM.isEmpty(i.Name)){i.Name=h.Name}i.Description=h.Description;j=this.IsApplicableAdditionalOption(i)}return j&&i.IsActive},this);if($$CM.isArray(c)&&c.length>0){c=c.sort(function(h,i){var k=Number(h.OrderIndex);var m=Number(i.OrderIndex);if(k<m){return -1}else{if(k>m){return 1}else{var j=Number(h.Name);var l=Number(i.Name);return((j<l)?-1:((j>l)?1:0))}}});var g=$$CM.uniqueID();var f=new cm.ui.forms.AdditionalOptionCategory("divAOC_"+g,{uniqueID:g,groupName:a,settings:this._settings,definition:e,additionalOptionArray:c});this._fsSelector.AddChild(f);this._ctrItemArray.push(f)}},this)}},SetCamper:function(a){this._camperData=a},IsApplicableAdditionalOption:function(a){var b=false;if(!$$CM.isNull(a)){if(this._formID==101&&a.ShowOnCamperApplication==true){b=true}else{if(this._formID==106&&a.ShowOnAdditionalOptionForm==true){b=true}else{if(this._formID==124&&a.ShowOnAdultApplication==true){b=true}}}}return b},IsApplicable:function(){var a=($$CM.isArray(this._ctrItemArray)&&this._ctrItemArray.length>0);return a},Validate:function(b){var c=new cm.validation.ValidationResult("",null);this._ctrItemArray.each(function(d){var e=d.Validate();c.AppendResult(e)},this);if(c.IsValid()==true&&this._required==true){var a=this.GetData();if(!$$CM.isArray(a)||a.length<=0){c.AddError("You must select at least one Optional Activity.")}}if(b==true){this.Validator.ShowErrors(c)}return c},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrItemArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();this._originalData=a;if($$CM.isArray(a)){this._ctrItemArray.each(function(b){b.Bind(a)},this)}},GetData:function(){var b=this.GetBoundData();if(!$$CM.isArray(b)){b=$A()}var a=$A();this._ctrItemArray.each(function(d){var c=d.GetData();if($$CM.isArray(c)){c.each(function(e){if(!$$CM.isNull(this._camperData)){e.PersonID=this._camperData.PersonID}a.push(e)},this)}},this);b=a;if($$CM.isArray(b)&&$$CM.isArray(this._originalData)){b.each(function(c){var d=this._originalData.find(function(e){return e.InDB==true&&e.LineItemID==c.LineItemID},this);c.IsUpgrade=(d&&c.Quantity>d.Quantity)},this)}return b}});"cm.ui.forms".namespace();cm.ui.forms.AdditionalQuestionConfigOptions=Class.create(cm.ConfigOptions,{existingStatus:0,legendLabel:"Question",legendCssClass:"w100prct",rowCssClass:"cmFormRow w100prct",definition:new Object()});cm.ui.forms.AdditionalQuestion=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.AdditionalQuestionConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._existingStatus=this._cfo.existingStatus;this._definition=null;this._memoShow=null;this._memoRequireFlag=null;if(!$$CM.isNull(this._cfo.definition)){this._definition=this._cfo.definition;this._requireFlag=false;if(!$$CM.isNull(this._definition)){this._requireFlag=(this._definition.RequireFlag&this._existingStatus)==this._existingStatus}}},initializeUIElements:function(){var a=this.ID();this.AddClassName(this._cfo.rowCssClass);this.AddClassName("cmUnderline pb10px mb10px");this._fsrblbAnswer=new $$FSRBLB(a+this._definition.ID,{legendLabel:this._definition.Name,legendCssClass:this._cfo.legendCssClass+" cmBasicText",isRequired:this._requireFlag==true});this.AddChild(this._fsrblbAnswer);this._fsrblbAnswer.AddClassName(this._cfo.rowCssClass+"pb10px");this._fsrblbAnswer.SelectionChangedEvent.subscribe(this.onYesNoChanged,this);this._divMemo=$$P.div("div"+a+"Explanation");this.AddChild(this._divMemo);this._divMemo.AddClassName("cmFormRow");this._ftxaMemo=new $$FTXA("ftxa"+a+"Explanation",{label:this._definition.MemoLabel,isRequired:true,maxLength:500,fieldTip:"500 Char Max"});this._divMemo.AddChild(this._ftxaMemo);this._ftxaMemo.AddClassName("cmTopLabel w505px");this._ftxaMemo.GetTitleControl().AddClassName("cmBasicText w495px");this._ftxaMemo.GetInputControl().AddClassName("w495px");this._ftxaMemo.GetFieldTipControl().AssignStyle("margin-left","0px");if(this._requireFlag==true){this._fsrblbAnswer.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Additional Question",IsRequired:true,AlwaysEvaluate:true}),this._fsrblbAnswer.SelectionChangedEvent);this._ftxaMemo.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Additional Question Memo",IsRequired:true}))}this._divMemo.Hide(false);this._ftxaMemo.Validator.Disable()},onYesNoChanged:function(){this.toggleMemo(true)},toggleMemo:function(a){var b=this._fsrblbAnswer.GetData();if(b==true){if(this._definition.AskMemoFlag==0&&$$E(this._divMemo).visible()==true){this._divMemo.Hide(a);this._ftxaMemo.Validator.Disable()}else{if(this._definition.AskMemoFlag==1&&$$E(this._divMemo).visible()==false){this._divMemo.Show(a);this._ftxaMemo.Validator.Enable()}}}else{if(b==false){if(this._definition.AskMemoFlag==0&&$$E(this._divMemo).visible()==false){this._divMemo.Show(a);this._ftxaMemo.Validator.Enable()}else{if(this._definition.AskMemoFlag==1&&$$E(this._divMemo).visible()==true){this._divMemo.Hide(a);this._ftxaMemo.Validator.Disable()}}}}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fsrblbAnswer.Bind(null);this._ftxaMemo.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fsrblbAnswer.Bind(a.Answer);this._ftxaMemo.Bind(a.Memo);this.toggleMemo(false)}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.AdditionalQuestionID=parseInt(this._definition.ID);a.Answer=this._fsrblbAnswer.GetData();a.Memo=null;if((a.Answer==true&&this._definition.AskMemoFlag==1)||(a.Answer==false&&this._definition.AskMemoFlag==0)){a.Memo=this._ftxaMemo.GetData()}return a}});"cm.ui.forms".namespace();cm.ui.forms.AdditionalQuestionListConfigOptions=Class.create(cm.ConfigOptions,{existingStatus:0,legendLabel:"Additional Questions",legendCssClass:"cmSectionHeader",additionalQuestionArray:$A()});cm.ui.forms.AdditionalQuestionList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.AdditionalQuestionListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._existingStatus=this._cfo.existingStatus;this._additionalQuestionArray=$A();if($$CM.isArray(this._cfo.additionalQuestionArray)){this._additionalQuestionArray=this._cfo.additionalQuestionArray}this._ctrAdditionalQuestionArray=$A()},initializeUIElements:function(){var b=this.ID();if($$CM.isArray(this._additionalQuestionArray)){this._fsAdditionalQuestions=new $$FS("fs"+b+"AdditionalQuestions",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsAdditionalQuestions);this._fsAdditionalQuestions.AddClassName("pt10px");this._additionalQuestionArray.each(function(c){var e=(c.ShowFlag&this._existingStatus)==this._existingStatus;if(e==true){var d=new cm.ui.forms.AdditionalQuestion(b+"_"+c.ID,{existingStatus:this._existingStatus,definition:c,legendCssClass:"cmLegendBasic w100prct",rowCssClass:"cmFormRow w100prct"});this._fsAdditionalQuestions.AddChild(d);this._ctrAdditionalQuestionArray.push(d)}},this)}var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px")},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrAdditionalQuestionArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){this._ctrAdditionalQuestionArray.each(function(c){var b=a.find(function(d){return parseInt(d.AdditionalQuestionID)==parseInt(c._definition.ID)},this);c.Bind(b)},this)}},GetData:function(){var b=this.GetBoundData();if(!$$CM.isArray(b)){b=$A()}var a=$A();this._ctrAdditionalQuestionArray.each(function(d){var c=d.GetData();if(!$$CM.isNull(c)&&!$$CM.isNull(c.Answer)){a.push(c)}},this);b=a;return b}});"cm.ui.forms".namespace();cm.ui.forms.AgeGroupSelectorConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Age Group Preference",legendCssClass:"cmSectionHeader",ageGroupArray:$A(),choice1ShowFlag:true,choice1RequireFlag:false,choice2ShowFlag:true,choice2RequireFlag:false});cm.ui.forms.AgeGroupSelector=Class.create(cm.ui.ComplexControl,{SelectionChangedEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.AgeGroupSelectorConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();this._ageGroupArray=this._co.ageGroupArray;this._choice1ShowFlag=this._co.choice1ShowFlag;this._choice1RequireFlag=this._co.choice1RequireFlag;this._choice2ShowFlag=this._co.choice2ShowFlag;this._choice2RequireFlag=this._co.choice2RequireFlag},initializeUIElements:function(){var b=this.ID();this._co=this.GetConfigOptions();this.AddClassName("cmFormRow");this._fsPreferences=new $$FS("AgeGroupPreferences",{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass+" mb20px"});this.AddChild(this._fsPreferences);this._fsPreferences.AddClassName("cmFormRow pt10px");this._divRow1=$$P.div("divRow1");this._fsPreferences.AddChild(this._divRow1);this._divRow1.AddClassName("cmFormRow");this._fddlChoice1=new $$FDDL("fddl"+b+"Choice1",{label:"First choice",isRequired:this._choice1RequireFlag==true});this._divRow1.AddChild(this._fddlChoice1);this._fddlChoice1.AddClassName("cmTopLabel w50prct");this._fddlChoice1.GetTitleControl().AddClassName("mb5px");this._fddlChoice1.GetInputControl().AddClassName("w250px");this._fddlChoice1.Hide();this._fddlChoice1.bindList(this._ageGroupArray,"","Select Age Group",false);if(this._choice1ShowFlag==true){this._fddlChoice1.Show();if(this._choice1RequireFlag==true){this._fddlChoice1.Validator.addEvaluator($$EVAL.SELECT({FieldName:"First Choice",IsRequired:true}))}}else{this._fddlChoice1.Hide()}this._fddlChoice2=new $$FDDL("fddl"+b+"Choice2",{label:"Second Choice",isRequired:this._choice2RequireFlag==true});this._divRow1.AddChild(this._fddlChoice2);this._fddlChoice2.AddClassName("cmTopLabel w50prct");this._fddlChoice2.GetTitleControl().AddClassName("mb5px");this._fddlChoice2.GetInputControl().AddClassName("w250px");this._fddlChoice2.Hide();this._fddlChoice2.bindList(this._ageGroupArray,"","Select Age Group",false);if(this._choice2ShowFlag==true){this._fddlChoice2.Show();if(this._choice2RequireFlag==true){this._fddlChoice2.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Second Choice",IsRequired:true}))}}else{this._fddlChoice2.Hide()}var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px")},createEvents:function(){this.SelectionChangedEvent=new cm.event()},ValidateForDuplicates:function(){var d=new cm.validation.ValidationResult("");if(this._choice1ShowFlag==true&&this._choice1ShowFlag==true){var c=this.GetData();var a=c.AgeGroupAssignmentChoice1;var b=c.AgeGroupAssignmentChoice2;if(!$$CM.isEmpty(a)&&!$$CM.isEmpty(b)&&a==b){d.AddError("You have selected same age group twice.");this._fddlChoice1.Validator.Clear();this._fddlChoice1.AddClassName("cmValidationError");this._fddlChoice2.Validator.Clear();this._fddlChoice2.AddClassName("cmValidationError")}}return d},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=this.ValidateForDuplicates();b.AppendResult(c)}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fddlChoice1.Bind(null);this._fddlChoice2.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fddlChoice1.Bind(a.AgeGroupAssignmentChoice1);this._fddlChoice2.Bind(a.AgeGroupAssignmentChoice2)}},GetData:function(){var c=this.GetBoundData();if($$CM.isNull(c)){c=new Object()}c.AgeGroupAssignmentChoice1=null;var a=this._fddlChoice1.GetData();if(this._choice1ShowFlag==true&&!$$CM.isEmpty(a)){c.AgeGroupAssignmentChoice1=a}c.AgeGroupAssignmentChoice2=null;var b=this._fddlChoice2.GetData();if(this._choice2ShowFlag==true&&!$$CM.isEmpty(b)){c.AgeGroupAssignmentChoice2=b}return c}});"cm.ui.forms".namespace();cm.ui.common.AvailabilityDatesConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Availability Dates",legendCssClass:"cmSectionHeader",desiredSalaryShowFlag:true,desiredSalaryRequireFlag:false});cm.ui.forms.AvailabilityDates=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.AvailabilityDatesConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._ctrUnavailableDatesArray=$A()},initializeUIElements:function(){var b=this.ID();this._fsAvailabilityDates=new $$FS(b,{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsAvailabilityDates);this._fsAvailabilityDates.AddClassName("pt10px");this._divRow1=$$P.div("div"+b+"Row1");this._fsAvailabilityDates.AddChild(this._divRow1);this._divRow1.AddClassName("cmFormRow");this._fdateEarliestStartingDate=new $$FDATE("fdate"+b+"EarliestStartingDate",{name:"Earliest Starting Date",label:"Earliest Starting Date",isRequired:this._cfo.startingDateRequireFlag==true});this._divRow1.AddChild(this._fdateEarliestStartingDate);this._fdateEarliestStartingDate.GetInputControl().Validator.addEvaluator($$EVAL.DATE({FieldName:"Earliest Starting Date",IsRequired:this._cfo.startingDateRequireFlag==true}));if(this._cfo.startingDateShowFlag==true){this._fdateEarliestStartingDate.Show()}else{this._fdateEarliestStartingDate.Hide()}this._fdateLatestEndingDate=new $$FDATE("fdate"+b+"LatestEndingDate",{label:"Latest Ending Date",isRequired:this._cfo.endingDateRequireFlag==true});this._divRow1.AddChild(this._fdateLatestEndingDate);this._fdateLatestEndingDate.GetInputControl().Validator.addEvaluator($$EVAL.DATE({FieldName:"Latest Ending Date",IsRequired:this._cfo.endingDateRequireFlag==true}));if(this._cfo.endingDateShowFlag==true){this._fdateLatestEndingDate.Show()}else{this._fdateLatestEndingDate.Hide()}this._divDesiredSalary=$$P.div("div"+b+"Row2");this._fsAvailabilityDates.AddChild(this._divDesiredSalary);this._divDesiredSalary.AddClassName("cmFormRow");this._ftxtDesiredSalary=new $$FTXT("ftxt"+b+"DesiredSalary",{label:"Desired Salary",isRequired:this._cfo.desiredSalaryRequireFlag==true,maxLength:100,fieldTip:"100 Char Max"});this._divDesiredSalary.AddChild(this._ftxtDesiredSalary);if(this._cfo.desiredSalaryShowFlag==true){this._divDesiredSalary.Show();if(this._cfo.desiredSalaryRequireFlag==true){this._ftxtDesiredSalary.Validator.addEvaluator($$EVAL.STRING({FieldName:"Desired Salary",IsRequired:true}))}}else{this._divDesiredSalary.Hide()}this._divRow3=$$P.div("div"+b+"Row3");this._fsAvailabilityDates.AddChild(this._divRow3);this._divRow3.AddClassName("cmFormRow");this._ftxaUnavailableDates=new $$FTXA("ftxa"+b+"UnavailableDates",{label:"If there are any dates during this time period for which you will be unavailable, please specify them below:",maxLength:250,fieldTip:"250 Char Max"});this._divRow3.AddChild(this._ftxaUnavailableDates);this._ftxaUnavailableDates.AddClassName("w505px mt10px");this._ftxaUnavailableDates.GetTitleControl().AddClassName("w100prct");this._ftxaUnavailableDates.GetInputControl().AddClassName("w100prct");this._ftxaUnavailableDates.GetFieldTipControl().AssignStyle("margin-left","0px");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px")},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=this.ValidateDates();if(c.IsValid()!=true){b.AppendResult(c)}}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ValidateDates:function(){var f=new cm.validation.ValidationResult("");var e=new Date();var g=this._fdateEarliestStartingDate.GetData();var h=this._fdateLatestEndingDate.GetData();if(!$$CM.isNull(g)&&!$$CM.isNull(h)){var a=new $$CMDATE(g);var c=new Date(a.getFormattedDate(false,true));if(c<e){f.AddError("<b>Earliest Starting Date:</b> has to be later than today");this._fdateEarliestStartingDate.AddClassName("cmValidationError")}var b=new $$CMDATE(h);var d=new Date(b.getFormattedDate(false,true));if(d<e){f.AddError("<b>Latest Ending Date:</b> has to be later than today");this._fdateLatestEndingDate.AddClassName("cmValidationError")}if(f.IsValid()==true){if(d<=c){f.AddError("<b>Latest Ending Date</b> has to be later than <b>Earliest Starting Date</b>");this._fdateLatestEndingDate.AddClassName("cmValidationError")}}}else{if(!$$CM.isNull(g)){var a=new $$CMDATE(g);var c=new Date(a.getFormattedDate(false,true));if(c<e){f.AddError("<b>Earliest Starting Date:</b> has to be later than today");this._fdateEarliestStartingDate.AddClassName("cmValidationError")}}else{if(!$$CM.isNull(h)){var b=new $$CMDATE(h);var d=new Date(b.getFormattedDate(false,true));if(d<e){f.AddError("<b>Latest Ending Date:</b> has to be later than today");this._fdateLatestEndingDate.AddClassName("cmValidationError")}}}}return f},ClearFields:function(){this.Validator.Clear();this._fdateEarliestStartingDate.Bind(null);this._fdateLatestEndingDate.Bind(null);this._ftxtDesiredSalary.Bind(null);this._ftxaUnavailableDates.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fdateEarliestStartingDate.Bind(a.EarliestStartingDateAsString);this._fdateLatestEndingDate.Bind(a.LatestEndingDateAsString);this._ftxtDesiredSalary.Bind(a.DesiredSalary);this._ftxaUnavailableDates.Bind(a.UnavailableDates)}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.EarliestStartingDateAsString=this._fdateEarliestStartingDate.GetData();a.LatestEndingDateAsString=this._fdateLatestEndingDate.GetData();a.DesiredSalary=this._ftxtDesiredSalary.GetData();a.UnavailableDates=this._ftxaUnavailableDates.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.BunkInfoBlockConfigOptions=Class.create(cm.ConfigOptions,{titleMessage:"",optionalMessage:"",required:false});cm.ui.forms.BunkInfoBlock=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.BunkInfoBlockConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._titleMessage=this._cfo.titleMessage;this._optionalMessage=this._cfo.optionalMessage;this._equired=this._cfo.required},initializeUIElements:function(){var c=this.ID();this._pHeader=$$P.p(c+"_Header");this.AddChild(this._pHeader);this._pHeader.AddClassName("mtb10px");if(!$$CM.isEmpty(this._titleMessage)){this._pHeader.UpdateInnerHtml(this._titleMessage)}else{this._pHeader.Hide()}this._divMessageWrapper=$$P.div(c+"_MessageWrapper");this.AddChild(this._divMessageWrapper);this._divMessageWrapper.AddClassName("cmFloatRight w50prct");this._divMessage=$$P.div(c+"_Message");this._divMessageWrapper.AddChild(this._divMessage);this._divMessage.AddClassName("cmInfo mtb0px");if(!$$CM.isEmpty(this._optionalMessage)){var d=$$CM.getCMFormattedText(this._optionalMessage);this._divMessage.UpdateInnerHtml(d)}else{this._divMessage.Hide()}this._divInput=$$P.div(c+"_InputWrapper");this.AddChild(this._divInput);this._divInput.AddClassName("cmFloatLeft w50prct");this._ftxaInput=new $$FTXA("ftxaInput_"+c,{label:""});this._divInput.AddChild(this._ftxaInput);this._ftxaInput.AddClassName("mtb0px");this._ftxaInput.GetTitleControl().RemoveClassName("cmTextTitleBase");this._ftxaInput.GetInputControl().AddClassName("w250px h70px");var a=$$P.div();this.AddChild(a);a.AddClassName("cmClear");var b=$$P.div();this.AddChild(b);b.AddClassName("cmDivider")},wireEvents:function($super){$super()},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxaInput.Bind()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isEmpty(a)){this._ftxaInput.Bind(a)}},GetData:function(){var a=this._ftxaInput.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.BunkInfoBlockListConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"",legendCssClass:""});cm.ui.forms.BunkInfoBlockList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.BunkInfoBlockListConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();this._settings=this._co.settings;this._entityLabelSettings=$$SETTINGSDU.GetEntityLabelSettings();this._applicable=false;if(!$$CM.isNull(this._settings)){this._sectionMessage=this._settings.BunkInformationHeaderMessage;this._sectionMessageCssClass=this._settings.BunkInformationHeaderMessageCssClass;this._applicable=this._settings.EnableBunkWithRequests==true||this._settings.EnableDoNotBunkWithRequests==true||this._settings.EnableCounselorRequests==true||this._settings.EnableBunkBedRequests==true}},initializeUIElements:function(){var a=$$CM.uniqueID();this._fsBunkInfoBlockList=new $$FS("BunkInfoBlockList",{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsBunkInfoBlockList);this.renderBunkInfoBlocks()},renderBunkInfoBlocks:function(){if(this._applicable==true&&!$$CM.isEmpty(this._sectionMessage)){this._sectionMessage=$$CM.getCMFormattedText(this._sectionMessage);this._sectionMessage=$$CM.convertToEntityLabelString(this._sectionMessage,this._entityLabelSettings);this._ctrSectionMessage=new cm.ui.forms.SectionMessage("divBunkInfoSectionMessage_"+this._uniqueID,{message:this._sectionMessage,cssClass:"cmClear mtb0px"});this._fsBunkInfoBlockList.AddChild(this._ctrSectionMessage);if(!$$CM.isEmpty(this._sectionMessageCssClass)){this._ctrSectionMessage.AddClassName(this._sectionMessageCssClass)}}var b="Enter up to "+this._settings.BunkWithMaxRequests+" "+this._settings.BunkWithAltLabel;var a={titleMessage:b,optionalMessage:this._settings.BunkWithOptionalMessage};this._ctrBunkWith=new cm.ui.forms.BunkInfoBlock($$CM.uniqueID(),a);this._fsBunkInfoBlockList.AddChild(this._ctrBunkWith);if(this._settings.EnableBunkWithRequests!=true){this._ctrBunkWith.Hide()}var b=this._settings.DoNotBunkWithAltLabel;var a={titleMessage:b,optionalMessage:this._settings.DoNotBunkWithOptionalMessage};this._ctrDoNotBunkWith=new cm.ui.forms.BunkInfoBlock($$CM.uniqueID(),a);this._fsBunkInfoBlockList.AddChild(this._ctrDoNotBunkWith);if(this._settings.EnableDoNotBunkWithRequests!=true){this._ctrDoNotBunkWith.Hide()}var b="Enter any <strong>counselor requests</strong> below.";var a={titleMessage:b,optionalMessage:this._settings.CounselorRequestsOptionalMessage};this._ctrCounselorRequests=new cm.ui.forms.BunkInfoBlock($$CM.uniqueID(),a);this._fsBunkInfoBlockList.AddChild(this._ctrCounselorRequests);if(this._settings.EnableCounselorRequests!=true){this._ctrCounselorRequests.Hide()}var b="Enter any <strong>bed requests</strong> below.";var a={titleMessage:b,optionalMessage:this._settings.BunkBedRequestsOptionalMessage};this._ctrBunkBedRequests=new cm.ui.forms.BunkInfoBlock($$CM.uniqueID(),a);this._fsBunkInfoBlockList.AddChild(this._ctrBunkBedRequests);if(this._settings.EnableBunkBedRequests!=true){this._ctrBunkBedRequests.Hide()}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrBunkWith.Bind();this._ctrDoNotBunkWith.Bind();this._ctrCounselorRequests.Bind();this._ctrBunkBedRequests.Bind()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._ctrBunkWith.Bind(a.BunkWith);this._ctrDoNotBunkWith.Bind(a.DoNotBunkWith);this._ctrCounselorRequests.Bind(a.CounselorRequests);this._ctrBunkBedRequests.Bind(a.BunkBedRequests)}},GetData:function(){var b=null;var a=this.GetBoundData();if(!$$CM.isNull(a)){b=a}if($$CM.isNull(b)){b=new Object()}b.BunkWith=this._ctrBunkWith.GetData();b.DoNotBunkWith=this._ctrDoNotBunkWith.GetData();b.CounselorRequests=this._ctrCounselorRequests.GetData();b.BunkBedRequests=this._ctrBunkBedRequests.GetData();return b}});"cm.ui.forms".namespace();cm.ui.forms.CertificationConfigOptions=Class.create(cm.ConfigOptions,{definition:new Object()});cm.ui.forms.Certification=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.CertificationConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._definition=this._cfo.definition;this._certificationLevelArray=this._cfo.certificationLevelArray;this.InDB=false},initializeUIElements:function(){var a=this.ID();this.AddClassName("cmFormRow");this._fcbApplicable=new $$FCB(a+"Applicable",{value:this._definition.ID,label:this._definition.Name,name:this._definition.GroupName});this.AddChild(this._fcbApplicable);this._fcbApplicable.AddClassName("cmBool w200px");this._fcbApplicable.GetTitleControl().RemoveClassName("cmCheckboxTitleBase");this._fcbApplicable.GetTitleControl().AddClassName("cmBold w180px");this._fcbApplicable.ChangeEvent.subscribe(this.onApplicableChanged,this);this._ftxtCertifyingBody=new $$FTXT(a+"CertifyingBody",{inputWidth:"180",spanWidth:"0",width:"190"});this.AddChild(this._ftxtCertifyingBody);$$E(this._ftxtCertifyingBody.GetInputControl()).disabled=true;this._ftxtExpirationDate=new $$FTXT(a+"ExpirationDate",{inputWidth:"120",spanWidth:"0",width:"130"});this.AddChild(this._ftxtExpirationDate);$$E(this._ftxtExpirationDate.GetInputControl()).disabled=true},onApplicableChanged:function(c,b){var a=this._fcbApplicable.GetData();if(a==true){$$E(this._ftxtCertifyingBody.GetInputControl()).disabled=false;if(this._definition.ShowExpiration==true){$$E(this._ftxtExpirationDate.GetInputControl()).disabled=false}else{$$E(this._ftxtExpirationDate.GetInputControl()).disabled=true}}else{$$E(this._ftxtCertifyingBody.GetInputControl()).disabled=true;$$E(this._ftxtExpirationDate.GetInputControl()).disabled=true}},IsChecked:function(){return this._fcbApplicable.GetData()},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fcbApplicable.Bind(null);this._ftxtCertifyingBody.Bind(null);this._ftxtExpirationDate.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fcbApplicable.Bind(!$$CM.isEmpty(a.CertificationID));this._ftxtCertifyingBody.Bind(a.CertifyingBody);this._ftxtExpirationDate.Bind(a.ExpirationDate);if(!$$CM.isEmpty(a.InDB)&&a.InDB==true){this.InDB=true}}this.onApplicableChanged()},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.CertificationID=parseInt(this._definition.ID);a.CertifyingBody=this._ftxtCertifyingBody.GetData();a.ExpirationDate=this._ftxtExpirationDate.GetData();a.Deleted=this._fcbApplicable.GetData()!=true;return a}});"cm.ui.forms".namespace();cm.ui.forms.CertificationListConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Certifications",legendCssClass:"cmSectionHeader",certificationArray:$A(),certificationLevelArray:$A()});cm.ui.forms.CertificationList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.CertificationListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._certificationArray=$A();if($$CM.isArray(this._cfo.certificationArray)){this._certificationArray=this._cfo.certificationArray}if(this._certificationArray.length<=0&&$$CM.isArray(cm.dao.Settings.Data.CertificationArray)){this._certificationArray=cm.dao.Settings.Data.CertificationArray;this._certificationArray=this._certificationArray.findAll(function(a){return a.Deleted==false},this);if($$CM.isArray(this._certificationArray)){this._certificationArray=this._certificationArray.sort($$CM.sortByNameProperty)}}this._ctrCertificationArray=$A()},initializeUIElements:function(){var e=this.ID();var a=this.GetConfigOptions();this._fsCertificationList=new $$FS("CertificationList",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass+" mb20px"});this._divRow1=$$P.div("divRow1");this._fsCertificationList.AddChild(this._divRow1);this._divRow1.AddClassName("cmFormRow");var c=$$P.span("header1","Certifying Body");c.AddClassName("cmBold ml205px");this._divRow1.AddChild(c);var d=$$P.span("header2","Expiration Date");d.AddClassName("cmBold ml78px");this._divRow1.AddChild(d);this.AddChild(this._fsCertificationList);this._fsCertificationList.AddClassName("pt10px");this._certificationArray.each(function(f){var g=new cm.ui.forms.Certification("Certification"+f.ID,{definition:f});this._fsCertificationList.AddChild(g);this._ctrCertificationArray.push(g)},this);var b=$$P.div();this.AddChild(b);b.AddClassName("cmFormRow mb20px")},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrCertificationArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){this._ctrCertificationArray.each(function(c){var b=a.find(function(d){return d.CertificationID==parseInt(c._definition.ID)},this);c.Bind(b)},this)}},GetData:function(){var b=this.GetBoundData();if(!$$CM.isArray(b)){b=$A()}var a=$A();this._ctrCertificationArray.each(function(d){var c=d.GetData();if(d.IsChecked()==true||d.InDB==true){a.push(c)}},this);b=a;return b}});"cm.ui.forms".namespace();cm.ui.forms.ContactInformationConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"",legendCssClass:"",phoneCellShowFlag:true,phoneCellRequireFlag:false,phoneOtherShowFlag:true,phoneOtherRequireFlag:false,bestTimeToReachShowFlag:true,bestTimeToReachRequireFlag:false,initialTabIndex:1});cm.ui.forms.ContactInformation=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.ContactInformationConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions()},initializeUIElements:function(){var b=this.ID();var c=this.GetConfigOptions().initialTabIndex;this._fsContactInfo=new $$FS("ContactInfo",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsContactInfo);this._fsContactInfo.AddClassName("pt10px");this._divContactInfo=$$P.div("divContactInfo");this._fsContactInfo.AddChild(this._divContactInfo);this._divContactInfo.AddClassName("cmFormRow");this._divRow1=$$P.div("divRow1");this._divContactInfo.AddChild(this._divRow1);this._divRow1.AddClassName("cmFormRow");this._ftxtPhoneCell=new $$FTXT("ftxtContactInfoPhoneCell",{label:"Cell Phone",isRequired:this._cfo.phoneCellRequireFlag==true,maxLength:15});this._divRow1.AddChild(this._ftxtPhoneCell);if(this._cfo.phoneCellShowFlag==true){this._ftxtPhoneCell.Show();this._ftxtPhoneCell.Validator.addEvaluator($$EVAL.STRING({FieldName:"Cell Phone",IsRequired:this._cfo.phoneCellRequireFlag==true}))}else{this._ftxtPhoneCell.Hide()}this._ftxtPhoneCell.SetTabIndex(c);this._ftxtPhoneOther=new $$FTXT("ftxtContactInfoPhoneOther",{label:"Other Phone",isRequired:this._cfo.phoneOtherRequireFlag==true,maxLength:15});this._divRow1.AddChild(this._ftxtPhoneOther);if(this._cfo.phoneOtherShowFlag==true){this._ftxtPhoneOther.Show();this._ftxtPhoneOther.Validator.addEvaluator($$EVAL.STRING({FieldName:"Other Phone",IsRequired:this._cfo.phoneOtherRequireFlag==true}))}else{this._ftxtPhoneOther.Hide()}this._ftxtPhoneOther.SetTabIndex(++c);this._divRow2=$$P.div("divRow2");this._divContactInfo.AddChild(this._divRow2);this._divRow2.AddClassName("cmFormRow");this._ftxtBestTimeToReach=new $$FTXT("ftxt"+b+"BestTimeToReach",{label:"Best Time to Reach",isRequired:this._cfo.bestTimeToReachRequireFlag==true,maxLength:50});this._divRow2.AddChild(this._ftxtBestTimeToReach);if(this._cfo.bestTimeToReachShowFlag==true){this._ftxtBestTimeToReach.Show();this._ftxtBestTimeToReach.Validator.addEvaluator($$EVAL.STRING({FieldName:"Best Time to Reach",IsRequired:this._cfo.bestTimeToReachRequireFlag==true}))}else{this._ftxtBestTimeToReach.Hide()}this._ftxtBestTimeToReach.SetTabIndex(++c);var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px")},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxtPhoneCell.Bind(null);this._ftxtPhoneOther.Bind(null);this._ftxtBestTimeToReach.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._ftxtPhoneCell.Bind(a.PhoneCell);this._ftxtPhoneOther.Bind(a.PhoneOther);this._ftxtBestTimeToReach.Bind(a.BestTimeToReach)}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}if(this._cfo.phoneCellShowFlag==true){a.PhoneCell=this._ftxtPhoneCell.GetData()}else{a.PhoneCell=null}if(this._cfo.phoneOtherShowFlag==true){a.PhoneOther=this._ftxtPhoneOther.GetData()}else{a.PhoneOther=null}if(this._cfo.bestTimeToReachShowFlag==true){a.BestTimeToReach=this._ftxtBestTimeToReach.GetData()}else{a.BestTimeToReach=null}return a}});"cm.ui.forms".namespace();cm.ui.forms.ContactInformationUPRControlConfigOptions=Class.create(cm.ConfigOptions,{initialTabIndex:1,includeParentNotes:true,includeDOB:false});cm.ui.forms.ContactInformationUPRControl=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.ContactInformationUPRControlConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._isUPR=$$CM.IsUPR()},initializeUIElements:function(){var c=this.ID();var d=this._co.initialTabIndex;this.AddClassName("cmContactInformationSection");this._fsContactName=new $$FS(null,{legendLabel:"Contact Information",legendCssClass:"cmSectionHeader mb15px"});this.AddChild(this._fsContactName);this._fsContactName.AddClassName("pt15px");this._title=new $$FDDL("ddlTitle_"+c,{label:"Title",inputWidth:193});this._fsContactName.AddChild(this._title);this._title.AddClassName("cmFamilyUpdateRow");this._title.SetTabIndex(d);this._firstName=new $$FTXT("txtFirstName_"+c,{label:"First Name",inputWidth:189});this._fsContactName.AddChild(this._firstName);this._firstName.Validator.addEvaluator($$EVAL.STRING({FieldName:"First Name",IsRequired:true}));this._firstName.GetTitleInnerControl().AddClassName("cmRequiredField");this._firstName.AddClassName("cmFamilyUpdateRow");this._firstName.SetTabIndex(++d);this._lastName=new $$FTXT("txtLastName_"+c,{label:"Last Name",inputWidth:189});this._fsContactName.AddChild(this._lastName);this._lastName.Validator.addEvaluator($$EVAL.STRING({FieldName:"Last Name",IsRequired:true}));this._lastName.GetTitleInnerControl().AddClassName("cmRequiredField");this._lastName.AddClassName("cmFamilyUpdateRow");this._lastName.SetTabIndex(++d);this._middleName=new $$FTXT("txtMiddleName_"+c,{label:"Middle Name",inputWidth:189});this._fsContactName.AddChild(this._middleName);this._middleName.AddClassName("cmFamilyUpdateRow");this._middleName.SetTabIndex(++d);this._nickName=new $$FTXT("txtNickName_"+c,{label:"Nickname",inputWidth:189});this._fsContactName.AddChild(this._nickName);this._nickName.AddClassName("cmFamilyUpdateRow");this._nickName.SetTabIndex(++d);this._maidenName=new $$FTXT("txtMaidenName_"+c,{label:"Maiden Name",inputWidth:189});this._fsContactName.AddChild(this._maidenName);this._maidenName.AddClassName("cmFamilyUpdateRow");this._maidenName.SetTabIndex(++d);this._suffix=new $$FDDL("ddlSuffix_"+c,{label:"Suffix",inputWidth:193});this._fsContactName.AddChild(this._suffix);this._suffix.AddClassName("cmFamilyUpdateRow");this._suffix.SetTabIndex(++d);if(!this._isUPR){this._title.Hide();this._suffix.Hide()}this._fsPhoneNumbers=new $$FS(null,{legendLabel:"Phone Numbers",legendCssClass:"cmSectionHeader mb15px"});this.AddChild(this._fsPhoneNumbers);if(this._co.includeParentNotes){var a=$$P.div(null,"Phone numbers for custodial parents only!  Include area code.");this._fsPhoneNumbers.AddChild(a);a.AddClassName("cmFamilyUpdateRow cmSubtle mb10px")}this._cellPhone=new $$FTXT("txtCellPhone_"+c,{label:"Cell Phone",inputWidth:189,maxLength:15});this._fsPhoneNumbers.AddChild(this._cellPhone);this._cellPhone.AddClassName("cmFamilyUpdateRow");this._cellPhone.SetTabIndex(++d);this._workPhone=new $$FTXT("txtWorkPhone_"+c,{label:"Work Phone",inputWidth:189,maxLength:15});this._fsPhoneNumbers.AddChild(this._workPhone);this._workPhone.AddClassName("cmFamilyUpdateRow");this._workPhone.SetTabIndex(++d);this._otherPhone=new $$FTXT("txtOtherPhone_"+c,{label:"Other Phone",inputWidth:189,maxLength:15});this._fsPhoneNumbers.AddChild(this._otherPhone);this._otherPhone.AddClassName("cmFamilyUpdateRow");this._otherPhone.SetTabIndex(++d);this._faxPhone=new $$FTXT("txtFaxPhone_"+c,{label:"Personal Fax",inputWidth:189,maxLength:15});this._fsPhoneNumbers.AddChild(this._faxPhone);this._faxPhone.AddClassName("cmFamilyUpdateRow");this._faxPhone.SetTabIndex(++d);this._fsEmail=new $$FS(null,{legendLabel:"Email",legendCssClass:"cmSectionHeader mb15px"});this.AddChild(this._fsEmail);var b="For purposes of logging in to your account, each person must have a unique email address. This address will 'belong' to the first person for which it is entered. If it is to be 'shared,' it must be entered as the 'Alternate Email' for the second person.";if(this._co.includeParentNotes){b="For purposes of logging in to your account, each parent/guardian must have a unique email address. This address will 'belong' to the first person for which it is entered. If it is to be 'shared,' it must be entered as the 'Alternate Email' for the second person."}var a=$$P.div(null,b);this._fsEmail.AddChild(a);a.AddClassName("cmFamilyUpdateRow cmSubtle mb15px");this._email=new $$FEMAIL("txtEmail_"+c,{label:"Login/Email",inputWidth:189,maxLength:100});this._email.Validator.addEvaluator($$EVAL.EMAIL({FieldName:"Login/Email",IsRequired:true,AlwaysEvaluate:true}),this._email.GetInputControl().KeyUpEvent);this._email.GetTitleInnerControl().AddClassName("cmRequiredField");this._fsEmail.AddChild(this._email);this._email.AddClassName("cmFamilyUpdateRow");this._email.SetTabIndex(++d);this._email2=new $$FEMAIL("txtEmail2_"+c,{label:"Alternate Email",inputWidth:189,maxLength:100});this._email2.Validator.addEvaluator($$EVAL.EMAIL({FieldName:"Alternate Email",IsRequired:false,AlwaysEvaluate:true}),this._email2.GetInputControl().KeyUpEvent);this._fsEmail.AddChild(this._email2);this._email2.AddClassName("cmFamilyUpdateRow");this._email2.SetTabIndex(++d);this._fsMiscellaneous=new $$FS(null,{legendLabel:"Miscellaneous",legendCssClass:"cmSectionHeader mb15px"});this.AddChild(this._fsMiscellaneous);this._birthdate=new $$FDATE("txtDateOfBirth_"+c,{label:"Date of Birth",inputWidth:70});this._fsMiscellaneous.AddChild(this._birthdate);this._birthdate.AddClassName("cmFamilyUpdateRow");this._birthdate.SetTabIndex(++d);if(this._co.includeDOB==false){this._birthdate.Hide()}this._occupation=new $$FTXT("txtOccupation_"+c,{label:"Occupation",inputWidth:189});this._fsMiscellaneous.AddChild(this._occupation);this._occupation.AddClassName("cmFamilyUpdateRow");this._occupation.SetTabIndex(++d);this._maritalStatus=new $$FDDL("ddlMaritalStatus_"+c,{label:"Marital Status",inputWidth:193});this._fsMiscellaneous.AddChild(this._maritalStatus);this._maritalStatus.AddClassName("cmFamilyUpdateRow");this._maritalStatus.SetTabIndex(++d);this._skype=new $$FTXT("txtSkype_"+c,{label:"Skype",inputWidth:189});this._fsMiscellaneous.AddChild(this._skype);this._skype.AddClassName("cmFamilyUpdateRow");this._skype.SetTabIndex(++d);this._facebook=new $$FTXT("txtFacebook_"+c,{label:"Facebook",inputWidth:189});this._fsMiscellaneous.AddChild(this._facebook);this._facebook.AddClassName("cmFamilyUpdateRow");this._facebook.SetTabIndex(++d);this._twitter=new $$FTXT("txtTwitter_"+c,{label:"Twitter",inputWidth:189});this._fsMiscellaneous.AddChild(this._twitter);this._twitter.AddClassName("cmFamilyUpdateRow");this._twitter.SetTabIndex(++d);this._linkedIn=new $$FTXT("txtLinkedIn_"+c,{label:"LinkedIn",inputWidth:189});this._fsMiscellaneous.AddChild(this._linkedIn);this._linkedIn.AddClassName("cmFamilyUpdateRow");this._linkedIn.SetTabIndex(++d);this._maritalStatus.Hide();this._skype.Hide();this._facebook.Hide();this._twitter.Hide();this._linkedIn.Hide()},wireEvents:function($super){$super()},postInitialize:function(){var a=this;this.bindLists()},bindLists:function(){var c=FW.Enums.PersonTitle.GetArray();this._title.bindList(c);var b=FW.Enums.PersonSuffix.GetArray();this._suffix.bindList(b);var a=FW.Data.Lists.MaritalStatusArray;if($$CM.isArray(a)){var d=$A();a.each(function(e){var f=e.Name;if(f=="Undefined"){f="None"}d.push({ID:e.ID,Name:f})},this);this._maritalStatus.bindList(d)}},ClearFields:function(){this.Validator.Clear();this._title.Bind(0);this._firstName.Bind("");this._middleName.Bind("");this._lastName.Bind("");this._nickName.Bind("");this._maidenName.Bind("");this._suffix.Bind(0);this._email.Bind("");this._email2.Bind("");this._cellPhone.Bind("");this._workPhone.Bind("");this._otherPhone.Bind("");this._faxPhone.Bind("");this._occupation.Bind("");this._maritalStatus.Bind(0);this._skype.Bind("");this._facebook.Bind("");this._twitter.Bind("");this._linkedIn.Bind("");this._birthdate.Bind("")},onDataUpdated:function(){var g=this.GetBoundData();var a=FW.Enums.ContactLocationFlag;var h=FW.Enums.PhoneNumberType;var e=FW.Data.GetStore("Person").GetFirst("PersonArray",{PersonID:g});if(!$$CM.isNull(e)){var c=e.Name;if(!$$CM.isNull(c)){if(!$$CM.isEmpty(c.FirstName)){this._firstName.Bind(c.FirstName)}if(!$$CM.isEmpty(c.MiddleName)){this._middleName.Bind(c.MiddleName)}if(!$$CM.isEmpty(c.LastName)){this._lastName.Bind(c.LastName)}if(!$$CM.isEmpty(c.NickName)){this._nickName.Bind(c.NickName)}if(!$$CM.isEmpty(c.MaidenName)){this._maidenName.Bind(c.MaidenName)}if($$CM.isNumber(c.TitleID)){this._title.Bind(Number(c.TitleID))}if($$CM.isNumber(c.SuffixID)){this._suffix.Bind(Number(c.SuffixID))}}if(!$$CM.isEmpty(e.LoginEmail)){this._email.Bind(e.LoginEmail)}if(!$$CM.isEmpty(e.Email2)){this._email2.Bind(e.Email2)}if(!$$CM.isEmpty(e.Occupation)){this._occupation.Bind(e.Occupation)}if($$CM.isNumber(e.MaritalStatusID)){this._maritalStatus.Bind(Number(e.MaritalStatusID))}if(!$$CM.isEmpty(e.Skype)){this._skype.Bind(e.Skype)}if(!$$CM.isEmpty(e.Facebook)){this._facebook.Bind(e.Facebook)}if(!$$CM.isEmpty(e.Twitter)){this._twitter.Bind(e.Twitter)}if(!$$CM.isEmpty(e.LinkedIn)){this._linkedIn.Bind(e.LinkedIn)}if(!$$CM.isEmpty(e.DOBAsString)&&e.DOBAsString!="0001-01-01T00:00:00"&&e.DOBAsString!="0001-01-01T00:00:00.0000000"){this._birthdate.Bind(e.DOBAsString)}if(!$$CM.isNull(e.ContactDetails)&&$$CM.isArray(e.ContactDetails.Numbers)){var b=e.ContactDetails.Numbers.find(function(j){return h.TestFlag(j.TypeID,"Mobile")});var i=e.ContactDetails.Numbers.find(function(j){return a.TestFlag(j.LocationFlagID,"Work")});var d=e.ContactDetails.Numbers.find(function(j){return a.TestFlag(j.LocationFlagID,"Other")});var f=e.ContactDetails.Numbers.find(function(j){return a.TestFlag(j.LocationFlagID,"Home")&&h.TestFlag(j.TypeID,"Fax")});if(!$$CM.isNull(b)&&!$$CM.isEmpty(b.Number)){this._cellPhone.Bind(b.Number)}if(!$$CM.isNull(i)&&!$$CM.isEmpty(i.Number)){this._workPhone.Bind(i.Number)}if(!$$CM.isNull(d)&&!$$CM.isEmpty(d.Number)){this._otherPhone.Bind(d.Number)}if(!$$CM.isNull(f)&&!$$CM.isEmpty(f.Number)){this._faxPhone.Bind(f.Number)}}}},GetData:function(){var h=this.GetBoundData();var b=FW.Enums.ContactLocationFlag;var j=FW.Enums.PhoneNumberType;var i=FW.Data.GetStore("Person").GetFirst("PersonArray",{PersonID:h});var g=null;if(!$$CM.isNull(i)){g=$$CM.deepClone(i);var c=g.Name;if($$CM.isNull(c)){c={}}if(!$$CM.isNull(c)){c.FirstName=this._firstName.GetData();c.MiddleName=this._middleName.GetData();c.LastName=this._lastName.GetData();c.NickName=this._nickName.GetData();c.MaidenName=this._maidenName.GetData();c.TitleID=Number(this._title.GetData());c.SuffixID=Number(this._suffix.GetData())}g.LoginEmail=this._email.GetData();g.Email2=this._email2.GetData();g.Occupation=this._occupation.GetData();g.MaritalStatusID=Number(this._maritalStatus.GetData());g.Skype=this._skype.GetData();g.Facebook=this._facebook.GetData();g.Twitter=this._twitter.GetData();g.LinkedIn=this._linkedIn.GetData();g.DOBAsString=this._birthdate.GetData();var a=g.ContactDetails;if($$CM.isNull(c)){a={}}var e=g.ContactDetails.Numbers;if(!$$CM.isArray(e)){e=$A()}var d={LocationFlagID:0,Number:this._cellPhone.GetData(),TypeID:3};var f=e.find(function(k){return k.LocationFlagID==d.LocationFlagID&&k.TypeID==d.TypeID},this);if(!$$CM.isNull(f)){f.Number=d.Number}else{e.push(d)}var d={LocationFlagID:2,Number:this._workPhone.GetData(),TypeID:2};var f=e.find(function(k){return k.LocationFlagID==d.LocationFlagID&&k.TypeID==d.TypeID},this);if(!$$CM.isNull(f)){f.Number=d.Number}else{e.push(d)}var d={LocationFlagID:16,Number:this._otherPhone.GetData(),TypeID:2};var f=e.find(function(k){return k.LocationFlagID==d.LocationFlagID&&k.TypeID==d.TypeID},this);if(!$$CM.isNull(f)){f.Number=d.Number}else{e.push(d)}var d={LocationFlagID:1,Number:this._faxPhone.GetData(),TypeID:4};var f=e.find(function(k){return k.LocationFlagID==d.LocationFlagID&&k.TypeID==d.TypeID},this);if(!$$CM.isNull(f)){f.Number=d.Number}else{e.push(d)}}return g}});"cm.ui.forms".namespace();cm.ui.forms.CreditCardEditConfigOptions=Class.create(cm.ConfigOptions,{title:"Credit Card Details",creditCardTypeIDArray:$A()});cm.ui.forms.CreditCardEdit=Class.create(cm.ui.ComplexControl,{CancelEvent:null,SaveEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.CreditCardEditConfigOptions()},initializeDAOs:function($super){$super()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._creditCardTypeEnum=cm.dao.Financial.Enums.CreditCardType.asEnum();this._creditCardTypeIDArray=$A();if($$CM.isArray(this._co.creditCardTypeIDArray)){this._creditCardTypeIDArray=this._co.creditCardTypeIDArray}},initializeUIElements:function(){this._divBody=$$P.div("divCCBody_"+this._uniqueID);this.AddChild(this._divBody);this._divBody.AddClassName("bd");this._divAccepedTypes=$$P.div("divCCAccepedTypes_"+this._uniqueID);this._divBody.AddChild(this._divAccepedTypes);this._divAccepedTypes.AddClassName("mt10px mb20px");var d="";var e="";this._creditCardTypeIDArray.each(function(h){var i=this._creditCardTypeEnum.GetName(h);if(!$$CM.isEmpty(i)){if(!$$CM.isEmpty(e)){e+=", "}e+="<b>"+i+"</b>"}},this);if(!$$CM.isEmpty(e)){d="We accept "+e+".";this._divAccepedTypes.UpdateInnerHtml(d);this._divAccepedTypes.Show()}else{this._divAccepedTypes.Hide()}this._divMessage=$$P.div("divCCMessage_"+this._uniqueID);this._divBody.AddChild(this._divMessage);this._divMessage.AddClassName("mt10px mb20px");this._divMessage.UpdateInnerHtml("Please enter your name and address exactly as they appear on your credit card statement.");this._divNumber=$$P.div("divCCNumber_"+this._uniqueID);this._divBody.AddChild(this._divNumber);this._divNumber.AddClassName("ldp cmClear");this._ftxtNumber=new $$FTXT("ftxtCCNumber_"+this._uniqueID,{label:"Number",isRequired:true,inputWidth:385,maxLength:16});this._divNumber.AddChild(this._ftxtNumber);this._ftxtNumber.SetPlaceholderText("Click to edit");this._ftxtNumber.AddClassName("w100prct");this._ftxtNumber.GetTitleControl().AddClassName("w105px");this._ftxtNumber.GetInputControl().AddClassName("w385px");this._ftxtNumber.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Number",IsRequired:true}));this._divNumberObfuscated=$$P.div("divNumberObfuscated_"+this._uniqueID);this._divBody.AddChild(this._divNumberObfuscated);this._divNumberObfuscated.AddClassName("ldp cmClear");this._divNumberObfuscated.Hide();this._divNumberObfuscatedTitle=$$P.div("divNumberObfuscatedTitle_"+this._uniqueID,"Number");this._divNumberObfuscated.AddChild(this._divNumberObfuscatedTitle);this._divNumberObfuscatedTitle.AddClassName("cmFloatLeft cmBold w105px");this._divNumberObfuscatedValue=$$P.span("divNumberObfuscatedValue_"+this._uniqueID);this._divNumberObfuscated.AddChild(this._divNumberObfuscatedValue);this._divNumberObfuscatedValue.AddClassName("cmBold_ w385px");this._divExpiration=$$P.div("divCCExpiration_"+this._uniqueID);this._divBody.AddChild(this._divExpiration);this._divExpiration.AddClassName("ldp cmClear mb10px");this._fddlExpMonth=new $$FDDL("fddlCCExpirationMonth_"+this._uniqueID,{label:"Expiration",isRequired:true,labelClass:"w200px"});this._divExpiration.AddChild(this._fddlExpMonth);this._fddlExpMonth.GetTitleControl().AddClassName("w105px");this._fddlExpMonth.GetInputControl().AddClassName("w90px");this._fddlExpMonth.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Month",IsRequired:true}));var c=$$DATE.getMonthArray(false);this._fddlExpMonth.bindList(c,"","--Month--",false);this._fddlExpYear=new $$FDDL("fddlCCExpirationYear_"+this._uniqueID,{label:"",isRequired:true,labelClass:"w70px"});this._divExpiration.AddChild(this._fddlExpYear);this._fddlExpYear.RemoveChildControl(this._fddlExpYear.GetTitleControl());this._fddlExpYear.GetInputControl().AddClassName("w70px");this._fddlExpYear.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Year",IsRequired:true}));var b=new Date().getFullYear();var g=$A();for(var f=b;f<=b+10;f++){g.push({ID:f,Name:f})}this._fddlExpYear.bindList(g,b,"--Year--",false);this._divName=$$P.div("divCCName_"+this._uniqueID);this._divBody.AddChild(this._divName);this._divName.AddClassName("ldp cmClear");this._ftxtFirstName=new $$FTXT("ftxtCCFirstName_"+this._uniqueID,{label:"First Name",isRequired:true});this._divName.AddChild(this._ftxtFirstName);this._ftxtFirstName.SetPlaceholderText("Click to edit");this._ftxtFirstName.Validator.addEvaluator($$EVAL.TEXT({FieldName:"First Name",IsRequired:true}));this._ftxtLastName=new $$FTXT("ftxtCCLastName_"+this._uniqueID,{label:"Last Name",isRequired:true});this._divName.AddChild(this._ftxtLastName);this._ftxtLastName.SetPlaceholderText("Click to edit");this._ftxtLastName.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Last Name",IsRequired:true}));var a={enabled:true,legendLabel:"",legendCssClass:"",controlTitleCssClass:"w105px",controlInputCssClass:"",groupFieldName:"",required:true,defaultCountry:$$CLIENT.Country};this._ctrAddress=new $$FADDRESS("divBIAddress_"+this._uniqueID,a);this._divBody.AddChild(this._ctrAddress);this._divFooter=$$P.div("divBIFooter_"+this._uniqueID);this.AddChild(this._divFooter);this._divFooter.AddClassName("ft");this._btnSave=new $$BTN("btnBISave_"+this._uniqueID,{text:"Save"});this._divFooter.AddChild(this._btnSave);this._btnSave.AddClassName("cmGoButton cmFloatRight");this._btnDelete=new $$BTN("btnBIDelete_"+this._uniqueID,{text:"Delete"});this._divFooter.AddChild(this._btnDelete);this._btnDelete.AddClassName("cmCancelDeleteButton cmFloatRight");this._btnDelete.Hide();this._btnCancel=new $$BTN("btnBICancel_"+this._uniqueID,{text:"Cancel"});this._divFooter.AddChild(this._btnCancel);this._btnCancel.AddClassName("cmCancelDeleteButton")},createEvents:function($super){$super();this.CancelEvent=new cm.event();this.SaveEvent=new cm.event()},wireEvents:function($super){$super();this._btnCancel.ClickEvent.subscribe(this.onCancel,this);this._btnSave.ClickEvent.subscribe(this.onSave,this)},onCancel:function(b,a){this.CancelEvent.fire(this,{})},onSave:function(c,a){if(this.IsValid(false)){var b=this.GetData();this.SaveEvent.fire(this,{data:b})}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxtNumber.Bind(null);this._divNumberObfuscatedValue.UpdateInnerHtml("");this._fddlExpMonth.Bind(null);this._fddlExpYear.Bind(null);this._ftxtFirstName.Bind(null);this._ftxtLastName.Bind(null);this._ctrAddress.Bind(null)},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if(!$$CM.isNull(b)){if($$CM.isNumber(b.ID)&&b.ID>0){if(!$$CM.isEmpty(b.NumberLastFour)){var e="************"+b.NumberLastFour;this._divNumberObfuscatedValue.UpdateInnerHtml(e)}this._divNumber.Hide();this._divNumberObfuscated.Show()}else{this._ftxtNumber.Bind(b.Number);this._divNumber.Show();this._divNumberObfuscated.Hide()}if(!$$CM.isEmpty(b.ExpirationAsString)){var a=new $$CMDATE(b.ExpirationAsString);var c=a.getMonth()+1;var d=a.getFullYear();this._fddlExpMonth.Bind(c);this._fddlExpYear.Bind(d)}if(!$$CM.isEmpty(b.FirstName)){this._ftxtFirstName.Bind(b.FirstName)}if(!$$CM.isEmpty(b.LastName)){this._ftxtLastName.Bind(b.LastName)}if(!$$CM.isNull(b.Address)){this._ctrAddress.Bind(b.Address)}}else{this._divNumber.Show();this._divNumberObfuscated.Hide()}},GetData:function(){var b=this.GetBoundData();if($$CM.isNull(b)){b=new Object();b.ID=$$CM.uniqueID();b.IsDefault=true}if(!$$CM.isNumber(b.ID)||b.ID<=0){b.Number=this._ftxtNumber.GetData();b.NumberLastFour=b.Number.substring(12)}var c=this._fddlExpMonth.GetData();var d=this._fddlExpYear.GetData();if(c<10){c="0"+c}var a=new $$CMDATE(d+"-"+c+"-28T00:00:00");b.ExpirationAsString=a.getData();b.FirstName=this._ftxtFirstName.GetData();b.LastName=this._ftxtLastName.GetData();b.Address=this._ctrAddress.GetData();return b}});"cm.ui.forms".namespace();cm.ui.forms.CreditCardSelectorConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"<h5>Credit Card</h5>",legendCssClass:"w100prct mb10px",billingData:null,vaultType:0,objectID:0,creditCardGatewayTypeID:0,creditCardCategoryID:0,creditCardTypeIDArray:$A(),disabled:false,disabledText:null,enableEdit:true,creditCardVaultCategoryTypeID:0});cm.ui.forms.CreditCardSelector=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.CreditCardSelectorConfigOptions()},initializeDAOs:function($super){this._merchantDAO=new cm.dao.Merchant.DAO()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}if(!$$CM.isNull(this._co.billingData)){this._billingData=this._co.billingData}this._creditCardTypeEnum=cm.dao.Financial.Enums.CreditCardType.asEnum();this._vaultType=this._co.vaultType;this._creditCardGatewayTypeID=this._co.creditCardGatewayTypeID;this._creditCardCategoryID=this._co.creditCardCategoryID;this._financialSettings=this._co.financialSettings;if($$CM.isNull(this._financialSettings)){this._financialSettings=FW.Data.GetStore("Settings").GetFirst("FinancialSettings")}this._creditCardTypeIDArray=$A();this._acceptedCreditCardTypeArray=$A();if($$CM.isArray(this._co.creditCardTypeIDArray)){this._creditCardTypeIDArray=this._co.creditCardTypeIDArray;this._creditCardTypeIDArray.each(function(a){var b=this._creditCardTypeEnum.GetName(a);this._acceptedCreditCardTypeArray.push({ID:a,Name:b})},this)}this._disabled=this._co.disabled;this._disabledText=this._co.disabledText;this._enableEdit=this._co.enableEdit;if((!$$CM.isArray(this._creditCardTypeIDArray)||this._creditCardTypeIDArray.length<=0)||($$CM.isNull(this._financialSettings)||!this._financialSettings.ProcessesCards)){this._disabled=true;this._disabledText="We do not process credit cards at this time."}this._defaultCreditCard=null;this._creditCardArray=$A();this._ctrCreditCardSelectorRowArray=$A()},initializeUIElements:function(){if(this._disabled==true&&!$$CM.isEmpty(this._disabledText)){var b=$$CM.getCMFormattedText(this._disabledText);b=$$CM.convertToCamperLabelString(b);var a=new cm.ui.forms.SectionMessage("divCCSDisabledText_"+this._uniqueID,{message:b,cssClass:"cmInfo cmClear mtb0px"});this.AddChild(a)}this._fsWrapper=new $$FS("fsCCS_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsWrapper);if(!$$CM.isEmpty(this._co.headerMessage)){var d=$$CM.getCMFormattedText(this._co.headerMessage);d=$$CM.convertToCamperLabelString(d);this._ctrHeaderMessage=new cm.ui.forms.SectionMessage("divCCSSectionMessage_"+this._uniqueID,{message:d,cssClass:"cmInfo cmClear mtb0px"});this._fsWrapper.AddChild(this._ctrHeaderMessage)}if($$CM.isArray(this._creditCardTypeIDArray)&&this._creditCardTypeIDArray.length>0){var e=$$P.p("pCCSCreditCardTypes"+this._uniqueID);this._fsWrapper.AddChild(e);e.AddClassName("cmClear mt0px mb10px");this._creditCardTypeIDArray.each(function(f){var g=this._creditCardTypeEnum.GetName(f);var i="/v2/common/images/creditCards/"+g+".png";var h=$$P.img(null,i,{});e.AddChild(h);h.AddClassName("w70px h45px")},this)}this._pNoCards=$$P.p("pCCSNoCreditCards_"+this._uniqueID);this._fsWrapper.AddChild(this._pNoCards);this._pNoCards.UpdateInnerHtml("You currently have no credit cards on file.");this._pNoCards.AddClassName("cmClear mt0px mb10px");this._divCreditCardList=$$P.div("divCCSCreditCardList_"+this._uniqueID);this._fsWrapper.AddChild(this._divCreditCardList);this._divCreditCardList.AddClassName("cmFormRow cmClear w100prct mt0px mb10px");var c=$$P.div();this._fsWrapper.AddChild(c);c.AddClassName("cmClear");this._pCreditCardAdd=$$P.p("pCCSCreditCardAdd_"+this._uniqueID);this._fsWrapper.AddChild(this._pCreditCardAdd);this._pCreditCardAdd.AddClassName("cmClear mt0px mb0px");this._aCreditCardAdd=new $$A("aCCSCreditCardAdd_"+this._uniqueID,{text:"Add a credit card"});this._pCreditCardAdd.AddChild(this._aCreditCardAdd);if(this._disabled==true){this._fsWrapper.Hide()}this.initializeModals()},initializeModals:function(){this._divModals=$$P.div("divCCSModals_"+this._uniqueID);this._divModals.Hide();this.AddChild(this._divModals);this._mdlCreditCardEdit=new cm.ui.merchant.creditcard.CreditCardVaultDialog("mdlCreditCardEdit_"+this._uniqueID,{vaultConfigOptions:{title:"Credit Card",width:704,draggable:false,dialogClass:"cmGoDialog",objectID:this._co.objectID,creditCardGatewayTypeID:this._co.creditCardGatewayTypeID,creditCardCategoryID:this._co.creditCardCategoryID,creditCardTypeIDArray:this._co.creditCardTypeIDArray,financialSettings:this._financialSettings,billingData:this._co.billingData},financialSettings:this._financialSettings});this._divModals.AddChild(this._mdlCreditCardEdit);var b=704;var a=(this._financialSettings.RequiresEmail==true)?475:455;this._mdlCreditCardAdd=new cm.ui.merchant.creditcard.CreditCardAddVaultDialog(null,{title:"Add Credit Card",classNames:"modalOverflowNone",width:704,draggable:false,vaultClientScriptResourceUrl:"/ui/merchant/creditcard/vault/JS?r=merchant%2Fcreditcard%2Fvaultclient%2FvaultClient.js",iFrameConfigOptions:{src:null,width:b,height:a},financialSettings:this._financialSettings});this._divModals.AddChild(this._mdlCreditCardAdd)},wireEvents:function($super){$super();this._mdlCreditCardEdit.SaveEvent.subscribe(this.onCreditCardModalSave,this);this._mdlCreditCardEdit.CancelEvent.subscribe(this.onCreditCardModalCancel,this);this._aCreditCardAdd.ClickEvent.subscribe(this.onCreditCardAdd,this);this._mdlCreditCardAdd.SavedEvent.subscribe(this.onCreditCardAddModalSave,this);this._mdlCreditCardAdd.CancelEvent.subscribe(this.onCreditCardAddModalCancel,this);this._mdlCreditCardAdd.ErrorEvent.subscribe(this.onCreditCardAddModalError,this);this._merchantDAO.GetCreditCardArrayEvent.subscribe(this.onGetCreditCardArrayEvent,this)},onCreditCardAdd:function(d,b){var c=new Object();c.CreditCardVaultCategoryTypeID=this._co.creditCardVaultCategoryTypeID;c.ObjectID=this._billingData.FamilyID;var a=this._billingData.Address;c.Address={Address1:a.AddressLine1,Address2:a.AddressLine2,City:a.City,StateProvince:a.StateProvince,PostalCode:a.PostalCode,Country:a.Country};this._mdlCreditCardAdd.Bind(c);this._mdlCreditCardAdd.Show()},onCreditCardModalSave:function(d,a){var c=a.data;if(!$$CM.isNull(c)){var b=this._creditCardArray.find(function(e){return e.ID==c.ID},this);if(!$$CM.isNull(b)){c.IsModified=$$FORMSU.IsCreditCardModified(b,c)}this._creditCardArray=$$FORMSU.MergeCreditCardChangesToArray(this._creditCardArray,c)}this.bindCreditCardArray(this._creditCardArray);this._mdlCreditCardEdit.Hide()},onCreditCardModalCancel:function(b,a){this._mdlCreditCardEdit.Hide()},onCreditCardAddModalSave:function(c,a){var b=a;this._merchantDAO.GetCreditCardArray(b,null,this._co.creditCardVaultCategoryTypeID)},onGetCreditCardArrayEvent:function(d,a){this._mdlCreditCardAdd.Hide();var b=a.data;if(($$CM.isArray(b)&&b.length>0)&&(!$$CM.isNull(b[0]))){var c=b[0];this._creditCardArray.each(function(e){e.IsDefault=false},this);c.IsModified=true;c.IsDefault=true;this._creditCardArray=$$FORMSU.MergeCreditCardChangesToArray(this._creditCardArray,c)}this.bindCreditCardArray(this._creditCardArray)},onCreditCardAddModalCancel:function(b,a){this._mdlCreditCardAdd.Hide()},onCreditCardAddModalError:function(c,a){var b={title:"Data Error",header:"An error occurred exchanging data with the server",message:a.Message};$$CMD.Alert(b);this.onCreditCardAddModalCancel(c,a)},onCreditCardSelectChanged:function(c,a){var b=a.data;this._creditCardArray.each(function(d){if(d.ID==b.ID){d.IsDefault=true;this._defaultCreditCard=d}else{d.IsDefault=false}},this);this.bindCreditCardArray(this._creditCardArray)},onCreditCardEditClicked:function(c,a){var b=a.data;b.IsExistingCard=true;this._mdlCreditCardEdit.SetTitle("Update Credit Card");this._mdlCreditCardEdit.Bind(b);this._mdlCreditCardEdit.Show()},onCreditCardRemoveClicked:function(d,a){var b=a.data;var c=$A();this._creditCardArray.find(function(e){return e.ID==b.ID},this).IsDeleted=true;this.bindCreditCardArray(this._creditCardArray)},setDefaultCreditCardSelectorRow:function(a){var b=this._ctrCreditCardSelectorRowArray.find(function(c){return c.GetData().ID==a},this);if(!$$CM.isNull(b)){b.ToggleIsDefault(true)}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._pNoCards.Hide();this._divCreditCardList.Hide();this._ctrCreditCardSelectorRowArray=$A();this._divCreditCardList.DestroyChildControls(true);this._pCreditCardAdd.Hide()},BindBillingData:function(a){if(!$$CM.isNull(a)){this._billingData=a}},bindCreditCardArray:function(b){this._divCreditCardList.DestroyChildControls(true);this._creditCardArray=$A();if($$CM.isArray(b)){this._creditCardArray=b.sortBy(function(c){return(99-(c.IsDefault?1:0))+c.ExpirationAsString})}this._ctrCreditCardSelectorRowArray=$A();if(!$$CM.isNull(this._creditCardArray)&&$$CM.isArray(this._creditCardArray)&&this._creditCardArray.length>0){var a="CreditCard_"+this._uniqueID;this._creditCardArray.each(function(c){if(c.IsDeleted!=true){var d=new cm.ui.forms.CreditCardSelectorRow("divCCSCreditCard_"+this._uniqueID+"_"+c.ID,{uniqueID:this._uniqueID,creditCard:c,groupName:a,enableEdit:this._enableEdit});this._divCreditCardList.AddChild(d);d.SelectEvent.subscribe(this.onCreditCardSelectChanged,this);d.EditEvent.subscribe(this.onCreditCardEditClicked,this);d.RemoveEvent.subscribe(this.onCreditCardRemoveClicked,this);if(!$$CM.isNull(this._defaultCreditCard)&&c.IsDefault==true){this._defaultCreditCard=c}this._ctrCreditCardSelectorRowArray.push(d)}},this);this._divCreditCardList.Show()}else{this._pNoCards.Show()}},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if($$CM.isArray(b)){var a=b;this.bindCreditCardArray(a)}if(this._enableEdit==true||(this._enableEdit==false&&this._vaultType==1)){this._pCreditCardAdd.Show()}},GetData:function(){var a=this._creditCardArray;return a},GetDefaultCreditCard:function(){var a=this._creditCardArray.find(function(b){return b.IsDefault==true},this);return a}});cm.ui.forms.CreditCardSelectorRowConfigOptions=Class.create(cm.ConfigOptions,{creditCard:new Object(),groupName:"CreditCardSelectorRow",enableEdit:true});cm.ui.forms.CreditCardSelectorRow=Class.create(cm.ui.Control,{SelectEvent:null,EditEvent:null,RemoveEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.CreditCardSelectorRowConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._creditCard=this._co.creditCard;if($$CM.isNull(this._creditCard)){this._creditCard=new Object()}this._groupName=this._co.groupName;this._enableEdit=this._co.enableEdit},initializeUIElements:function(){this.AddClassName("cmFormRow cmClear w100prct mt0px mb5px");var b="<b>Use card</b>";if(!$$CM.isEmpty(this._creditCard.NumberLastFour)){if(!$$CM.isEmpty(b)){b+=" "}b+="************"+this._creditCard.NumberLastFour}if(!$$CM.isEmpty(this._creditCard.ExpirationAsString)){if(!$$CM.isEmpty(b)){b+=", "}var a=new $$CMDATE(this._creditCard.ExpirationAsString);b+="Expiring in "+a.getMonthName(Number(a.getUTCData().MM),true)+", "+Number(a.getUTCData().YYYY)}this._frbCreditCard=new $$FRB("frbCCSCreditCard_"+this._uniqueID+"_"+this._creditCard.ID,{value:this._creditCard.ID,label:b,name:this._groupName,labelClass:"w430px pt0px"});this.AddChild(this._frbCreditCard);this._divLinks=$$P.div();this.AddChild(this._divLinks);this._divLinks.AddClassName("cmFloatLeft w95px pt2px");this._spEncloseStart=$$P.span(null,"(");this._divLinks.AddChild(this._spEncloseStart);this._aEdit=new $$A("aCCSCreditCardEdit_"+this._uniqueID+"_"+this._creditCard.ID,{text:"Edit"});this._divLinks.AddChild(this._aEdit);this._spSeparator=$$P.span(null,"|");this._divLinks.AddChild(this._spSeparator);this._aRemove=new $$A("aCCSCreditCardRemove_"+this._uniqueID+"_"+this._creditCard.ID,{text:"Remove"});this._divLinks.AddChild(this._aRemove);this._spEncloseEnd=$$P.span(null,")");this._divLinks.AddChild(this._spEncloseEnd);if(this._creditCard.IsDefault!=true){this._spSeparator.Show();this._aRemove.Show()}else{this._frbCreditCard.SetChecked(true);this._spSeparator.Hide();this._aRemove.Hide()}if(this._enableEdit==true||(this._enableEdit==false&&this._vaultType==1)){this._divLinks.Show()}else{this._divLinks.Hide()}},createEvents:function(){this.SelectEvent=new cm.event();this.EditEvent=new cm.event();this.RemoveEvent=new cm.event()},wireEvents:function($super){$super();this._frbCreditCard.ChangeEvent.subscribe(this.onSelectChanged,this);this._aEdit.ClickEvent.subscribe(this.onEditClicked,this);this._aRemove.ClickEvent.subscribe(this.onRemoveClicked,this)},onSelectChanged:function(c,a){var b=this.GetData();this.SelectEvent.fire(c,{data:b})},onEditClicked:function(c,a){var b=this.GetData();this.EditEvent.fire(c,{data:b})},onRemoveClicked:function(c,a){var b=this.GetData();this.RemoveEvent.fire(c,{data:b})},ToggleIsDefault:function(a){this._creditCard.IsDefault=a;this._frbCreditCard.SetChecked(a)},GetData:function(){var a=this._creditCard;return a}});"cm.ui.forms".namespace();cm.ui.forms.CreditCardSelectorUPRConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"<h5>Credit Card</h5>",legendCssClass:"w100prct mb10px",billingData:null,vaultType:0,objectID:0,creditCardGatewayTypeID:0,creditCardCategoryID:0,creditCardTypeIDArray:$A(),disabled:false,disabledText:null,enableEdit:true});cm.ui.forms.CreditCardSelectorUPR=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.CreditCardSelectorUPRConfigOptions()},initializeDAOs:function($super){this._merchantDAO=new cm.dao.Merchant.DAO()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._enumCreditCardGatewayType=FW.Enums.Financial.CreditCardGatewayType;this._enumCreditCardCategory=FW.Enums.Financial.CreditCardCategory;this._enumCreditCardType=FW.Enums.Financial.CreditCardTypeAbbreviated;this._financialSettings=this._co.financialSettings;if($$CM.isNull(this._financialSettings)){this._financialSettings=FW.Data.GetStore("Settings").GetFirst("FinancialSettings")}this._objectID=0;if($$CM.isInteger(this._co.objectID)){this._objectID=this._co.objectID}if(!$$CM.isNull(this._co.billingData)){this._billingData=this._co.billingData}this._vaultType=this._co.vaultType;this._creditCardGatewayTypeID=this._co.creditCardGatewayTypeID;this._creditCardGatewayCategoryID=this._co.creditCardGatewayCategoryID;this._creditCardCategoryID=this._co.creditCardCategoryID;this._creditCardTypeArray=$A();this._creditCardTypeIDArray=$A();if($$CM.isArray(this._co.creditCardTypeIDArray)&&this._co.creditCardTypeIDArray.length>0){var a=this._co.creditCardTypeIDArray;a.each(function(b){var c=this._enumCreditCardType.GetName(b);this._creditCardTypeArray.push({ID:b,Name:c})},this);this._creditCardTypeIDArray=a}this._disabled=this._co.disabled;this._disabledText=this._co.disabledText;this._enableEdit=this._co.enableEdit;if((!$$CM.isArray(this._creditCardTypeIDArray)||this._creditCardTypeIDArray.length<=0)||($$CM.isNull(this._financialSettings)||!this._financialSettings.ProcessesCards)){this._disabled=true;this._disabledText="We do not process credit cards at this time."}this._defaultCreditCard=null;this._creditCardArray=$A();this._ctrCreditCardSelectorRowArray=$A()},initializeUIElements:function(){if(this._disabled==true&&!$$CM.isEmpty(this._disabledText)){var b=$$CM.getCMFormattedText(this._disabledText);b=$$CM.convertToCamperLabelString(b);var a=new cm.ui.forms.SectionMessage("divCCSDisabledText_"+this._uniqueID,{message:b,cssClass:"cmInfo cmClear mtb0px"});this.AddChild(a)}this._fsWrapper=new $$FS("fsCCS_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsWrapper);if(!$$CM.isEmpty(this._co.headerMessage)){var d=$$CM.getCMFormattedText(this._co.headerMessage);d=$$CM.convertToCamperLabelString(d);this._ctrHeaderMessage=new cm.ui.forms.SectionMessage("divCCSSectionMessage_"+this._uniqueID,{message:d,cssClass:"cmInfo cmClear mtb0px"});this._fsWrapper.AddChild(this._ctrHeaderMessage)}if($$CM.isArray(this._creditCardTypeArray)&&this._creditCardTypeArray.length>0){var e=$$P.p("pCCSCreditCardTypes"+this._uniqueID);this._fsWrapper.AddChild(e);e.AddClassName("cmClear mt0px mb10px");this._creditCardTypeArray.each(function(f){var h="/v2/common/images/creditCards/"+f.Name+".png";var g=$$P.img(null,h,{});e.AddChild(g);g.AddClassName("w70px h45px")},this)}this._pNoCards=$$P.p("pCCSNoCreditCards_"+this._uniqueID);this._fsWrapper.AddChild(this._pNoCards);this._pNoCards.UpdateInnerHtml("You currently have no credit cards on file.");this._pNoCards.AddClassName("cmClear mt0px mb10px");this._divCreditCardList=$$P.div("divCCSCreditCardList_"+this._uniqueID);this._fsWrapper.AddChild(this._divCreditCardList);this._divCreditCardList.AddClassName("cmFormRow cmClear w100prct mt0px mb10px");var c=$$P.div();this._fsWrapper.AddChild(c);c.AddClassName("cmClear");this._pCreditCardAdd=$$P.p("pCCSCreditCardAdd_"+this._uniqueID);this._fsWrapper.AddChild(this._pCreditCardAdd);this._pCreditCardAdd.AddClassName("cmClear mt0px mb0px");this._aCreditCardAdd=new $$A("aCCSCreditCardAdd_"+this._uniqueID,{text:"Add a credit card"});this._pCreditCardAdd.AddChild(this._aCreditCardAdd);if(this._disabled==true){this._fsWrapper.Hide()}this.initializeModals()},initializeModals:function(){this._divModals=$$P.div("divCCSModals_"+this._uniqueID);this.AddChild(this._divModals);this._divModals.Hide();this.initializeCreditCardModal()},initializeCreditCardModal:function(){var c={title:"Credit Card",width:704,objectID:this._objectID,creditCardGatewayTypeID:this._creditCardGatewayTypeID,creditCardGatewayCategoryID:this._creditCardGatewayCategoryID,creditCardCategoryID:this._creditCardCategoryID,creditCardTypeIDArray:this._creditCardTypeIDArray,financialSettings:this._financialSettings};this._ctrCreditCardDialog=new cm.ui.merchant.creditcard.CreditCardVaultUPRDialog("ctrCreditCardDialog_"+this._uniqueID,{dialogClass:"cmBaseDialog",draggable:false,showCloseButton:false,vaultConfigOptions:c});this._divModals.AddChild(this._ctrCreditCardDialog);var b=704;var a=(this._financialSettings.RequiresEmail==true)?475:455;this._mdlCreditCardAdd=new cm.ui.merchant.creditcard.CreditCardAddVaultDialog(null,{title:"Add Credit Card",classNames:"modalOverflowNone",width:704,draggable:false,vaultClientScriptResourceUrl:"/ui/merchant/creditcard/vault/JS?r=merchant%2Fcreditcard%2Fvaultclient%2FvaultClient.js",iFrameConfigOptions:{src:null,width:b,height:a},financialSettings:this._financialSettings,});this._divModals.AddChild(this._mdlCreditCardAdd)},createEvents:function($super){$super();this.CreditCardModifiedEvent=new cm.event();this.CreditCardDeletedEvent=new cm.event()},wireEvents:function($super){$super();this._aCreditCardAdd.ClickEvent.subscribe(this.onCreditCardAdd,this);this._ctrCreditCardDialog.SavedEvent.subscribe(this.onCreditCardDialogSaved,this);this._ctrCreditCardDialog.CancelEvent.subscribe(this.onCreditCardDialogCancel,this);this._ctrCreditCardDialog.ErrorEvent.subscribe(this.onCreditCardDialogError,this);this._mdlCreditCardAdd.SavedEvent.subscribe(this.onCreditCardAddModalSave,this);this._mdlCreditCardAdd.CancelEvent.subscribe(this.onCreditCardAddModalCancel,this);this._mdlCreditCardAdd.ErrorEvent.subscribe(this.onCreditCardAddModalError,this);this._merchantDAO.GetCreditCardArrayEvent.subscribe(this.onGetCreditCardArrayEvent,this)},onCreditCardAdd:function(d,b){var c=new Object();c.CreditCardVaultCategoryTypeID=this._creditCardGatewayCategoryID;if($$CM.isNumber(this._objectID,1)){c.ObjectID=this._objectID}if(!$$CM.isNull(this._billingData)){var a=this._billingData.Address;c.Address={Address1:a.AddressLine1,Address2:a.AddressLine2,City:a.City,StateProvince:a.StateProvince,PostalCode:a.PostalCode,Country:a.Country}}this._mdlCreditCardAdd.Bind(c);this._mdlCreditCardAdd.Show()},onCreditCardEdit:function(c,a){var b=a.data;b.IsExistingCard=true;this._ctrCreditCardDialog.SetTitle("Update Credit Card");this._ctrCreditCardDialog.Bind(b);this._ctrCreditCardDialog.Show()},onCreditCardRemove:function(d,a){var b=a.data;var c=$A();this._creditCardArray.find(function(e){return e.ID==b.ID},this).IsDeleted=true;this.bindCreditCardArray(this._creditCardArray);this.CreditCardDeletedEvent.fire(this,{creditCardGatewayTypeID:this._creditCardGatewayTypeID,creditCard:b})},onCreditCardSelect:function(c,a){var b=a.data;this._creditCardArray.each(function(d){if(d.ID==b.ID){d.IsDefault=true;this._defaultCreditCard=d}else{d.IsDefault=false}},this);this.bindCreditCardArray(this._creditCardArray)},onCreditCardDialogSaved:function(d,a){var c=a.data;if(!$$CM.isNull(c)){var b=this._creditCardArray.find(function(e){return e.ID==c.ID},this);if(!$$CM.isNull(b)){c.IsModified=$$FORMSU.IsCreditCardModified(b,c)}this._creditCardArray=$$FORMSU.MergeCreditCardChangesToArray(this._creditCardArray,c)}this.bindCreditCardArray(this._creditCardArray);this._ctrCreditCardDialog.Hide();this.CreditCardModifiedEvent.fire(this,{creditCardGatewayTypeID:this._creditCardGatewayTypeID,creditCard:c})},onCreditCardDialogCancel:function(b,a){this._ctrCreditCardDialog.Hide()},onCreditCardDialogError:function(b,a){},onCreditCardAddModalSave:function(c,a){var b=a;this._merchantDAO.GetCreditCardArray(b,null,this._creditCardGatewayCategoryID)},onGetCreditCardArrayEvent:function(d,a){this._mdlCreditCardAdd.Hide();var b=a.data;if(($$CM.isArray(b)&&b.length>0)&&(!$$CM.isNull(b[0]))){var c=b[0];this._creditCardArray.each(function(e){e.IsDefault=false},this);c.IsModified=true;c.IsDefault=true;this._creditCardArray=$$FORMSU.MergeCreditCardChangesToArray(this._creditCardArray,c)}this.bindCreditCardArray(this._creditCardArray)},onCreditCardAddModalCancel:function(b,a){this._mdlCreditCardAdd.Hide()},onCreditCardAddModalError:function(c,a){var b={title:"Data Error",header:"An error occurred exchanging data with the server",message:a.Message};$$CMD.Alert(b);this.onCreditCardAddModalCancel(c,a)},setDefaultCreditCardSelectorRow:function(a){var b=this._ctrCreditCardSelectorRowArray.find(function(c){return c.GetData().ID==a},this);if(!$$CM.isNull(b)){b.ToggleIsDefault(true)}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._pNoCards.Hide();this._divCreditCardList.Hide();this._ctrCreditCardSelectorRowArray=$A();this._divCreditCardList.DestroyChildControls(true);this._pCreditCardAdd.Hide()},BindBillingData:function(a){if(!$$CM.isNull(a)){this._billingData=a}},bindCreditCardArray:function(c){this._divCreditCardList.DestroyChildControls(true);if($$CM.isArray(c)){if(c.length==1){var b=c[0];b.IsDefault=true;b.IsModified=true;this._creditCardArray=[b]}else{this._creditCardArray=c.sortBy(function(d){return(99-(d.IsDefault?1:0))+d.ExpirationAsString})}}this._ctrCreditCardSelectorRowArray=$A();if(!$$CM.isNull(this._creditCardArray)&&$$CM.isArray(this._creditCardArray)&&this._creditCardArray.length>0){var a="CreditCard_"+this._uniqueID;this._creditCardArray.each(function(d){if(d.IsDeleted!=true){var e=new cm.ui.forms.CreditCardSelectorUPRRow("divCCSCreditCard_"+this._uniqueID+"_"+d.ID,{uniqueID:this._uniqueID,creditCard:d,groupName:a,enableEdit:this._enableEdit});this._divCreditCardList.AddChild(e);e.SelectEvent.subscribe(this.onCreditCardSelect,this);e.EditEvent.subscribe(this.onCreditCardEdit,this);e.RemoveEvent.subscribe(this.onCreditCardRemove,this);if(!$$CM.isNull(this._defaultCreditCard)&&d.IsDefault==true){this._defaultCreditCard=d}this._ctrCreditCardSelectorRowArray.push(e)}},this);this._pNoCards.Hide();this._divCreditCardList.Show()}else{this._pNoCards.Show();this._divCreditCardList.Hide()}},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if($$CM.isArray(b)){var a=b;this.bindCreditCardArray(a)}if(this._enableEdit==true||(this._enableEdit==false&&this._vaultType==1)){this._pCreditCardAdd.Show()}},GetData:function(){var a=this._creditCardArray;return a},GetDefaultCreditCard:function(){var a=this._creditCardArray.find(function(b){return b.IsDefault==true},this);return a}});cm.ui.forms.CreditCardSelectorUPRRowConfigOptions=Class.create(cm.ConfigOptions,{creditCard:new Object(),groupName:"CreditCardSelectorRow",enableEdit:true});cm.ui.forms.CreditCardSelectorUPRRow=Class.create(cm.ui.Control,{SelectEvent:null,EditEvent:null,RemoveEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.CreditCardSelectorUPRRowConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._creditCard=this._co.creditCard;if($$CM.isNull(this._creditCard)){this._creditCard=new Object()}this._groupName=this._co.groupName;this._enableEdit=this._co.enableEdit},initializeUIElements:function(){this.AddClassName("cmFormRow cmClear w100prct mt0px mb5px");var b="<b>Use card</b>";if(!$$CM.isEmpty(this._creditCard.NumberLastFour)){if(!$$CM.isEmpty(b)){b+=" "}b+="************"+this._creditCard.NumberLastFour}if(!$$CM.isEmpty(this._creditCard.ExpirationAsString)){if(!$$CM.isEmpty(b)){b+=", "}var a=new $$CMDATE(this._creditCard.ExpirationAsString);b+="Expiring in "+a.getMonthName(Number(a.getUTCData().MM),true)+", "+Number(a.getUTCData().YYYY)}this._frbCreditCard=new $$FRB("frbCCSCreditCard_"+this._uniqueID+"_"+this._creditCard.ID,{value:this._creditCard.ID,label:b,name:this._groupName,labelClass:"w430px_ w75prct pt0px"});this.AddChild(this._frbCreditCard);this._divLinks=$$P.div();this.AddChild(this._divLinks);this._divLinks.AddClassName("cmFloatRight pt2px");this._spEncloseStart=$$P.span(null,"(");this._divLinks.AddChild(this._spEncloseStart);this._aEdit=new $$A("aCCSCreditCardEdit_"+this._uniqueID+"_"+this._creditCard.ID,{text:"Edit"});this._divLinks.AddChild(this._aEdit);this._spSeparator=$$P.span(null,"|");this._divLinks.AddChild(this._spSeparator);this._aRemove=new $$A("aCCSCreditCardRemove_"+this._uniqueID+"_"+this._creditCard.ID,{text:"Remove"});this._divLinks.AddChild(this._aRemove);this._spEncloseEnd=$$P.span(null,")");this._divLinks.AddChild(this._spEncloseEnd);if(this._creditCard.IsDefault!=true){this._spSeparator.Show();this._aRemove.Show()}else{this._frbCreditCard.SetChecked(true);this._spSeparator.Hide();this._aRemove.Hide()}if(this._enableEdit==true||(this._enableEdit==false&&this._vaultType==1)){this._divLinks.Show()}else{this._divLinks.Hide()}},createEvents:function(){this.SelectEvent=new cm.event();this.EditEvent=new cm.event();this.RemoveEvent=new cm.event()},wireEvents:function($super){$super();this._frbCreditCard.ChangeEvent.subscribe(this.onSelectChanged,this);this._aEdit.ClickEvent.subscribe(this.onEditClicked,this);this._aRemove.ClickEvent.subscribe(this.onRemoveClicked,this)},onSelectChanged:function(c,a){var b=this.GetData();this.SelectEvent.fire(c,{data:b})},onEditClicked:function(c,a){var b=this.GetData();this.EditEvent.fire(c,{data:b})},onRemoveClicked:function(c,a){var b=this.GetData();this.RemoveEvent.fire(c,{data:b})},ToggleIsDefault:function(a){this._creditCard.IsDefault=a;this._frbCreditCard.SetChecked(a)},GetData:function(){var a=this._creditCard;return a}});"cm.ui.forms".namespace();cm.ui.forms.EducationConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Education",legendCssClass:"cmSectionHeader mb20px",schoolNameShowFlag:true,schoolNameRequireFlag:false,levelShowFlag:true,levelRequireFlag:true,majorShowFlag:true,majorRequireFlag:false,graduationDateShowFlag:true,graduationDateRequireFlag:false,springVacationShowFlag:true,springVacationRequireFlag:false,summerVacationShowFlag:true,summerVacationRequireFlag:false,gpaShowFlag:true,gpaRequireFlag:false,careerObjectiveShowFlag:true,careerObjectiveRequireFlag:false,initialTabIndex:1,educationLevelArray:$A()});cm.ui.forms.Education=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.EducationConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._educationLevelArray=$A();if($$CM.isArray(this._cfo.educationLevelArray)&&this._cfo.educationLevelArray.length>0){this._educationLevelArray=this._cfo.educationLevelArray}if(this._educationLevelArray<=0&&$$CM.isArray(cm.dao.Forms.Enums.EducationLevel)&&cm.dao.Forms.Enums.EducationLevel.length>0){this._educationLevelArray=cm.dao.Forms.Enums.EducationLevel}this._inSchoolLevelArray=$A();var a=this._educationLevelArray.findAll(function(c){return c.ID>0&&c.ID>=100},this);if($$CM.isArray(a)){a.each(function(d){var c=d.ID;var e=d.Name.toLowerCase().replace(/_/gi," ");e=e.substring(0,1).toUpperCase()+e.substring(1);this._inSchoolLevelArray.push({ID:c,Name:e})},this)}this._notInSchoolLevelArray=$A();var b=this._educationLevelArray.findAll(function(c){return c.ID>0&&c.ID<100},this);if($$CM.isArray(b)){b.each(function(d){var c=d.ID;var e=d.Name.toLowerCase().replace(/_/gi," ");e=e.substring(0,1).toUpperCase()+e.substring(1);this._notInSchoolLevelArray.push({ID:c,Name:e})},this)}},initializeUIElements:function(){var b=this.ID();var c=this._cfo.initialTabIndex;this._fsEducation=new $$FS("Education",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass+" mb20px"});this.AddChild(this._fsEducation);this._fsEducation.AddClassName("pt10px");this._fsrblbIsCurrentlyEnrolled=new $$FSRBLB("fsrblbSchoolEnrollment",{legendLabel:"Are you currently enrolled in school?",legendCssClass:"cmLegendBasic w100prct",isRequired:true,initialTabIndex:c});this._fsEducation.AddChild(this._fsrblbIsCurrentlyEnrolled);this._fsrblbIsCurrentlyEnrolled.AddClassName("cmFormRow mb20px");this._fsrblbIsCurrentlyEnrolled.SelectionChangedEvent.subscribe(this.onSchoolEnrollmentChanged,this);this._fsrblbIsCurrentlyEnrolled.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Enrollment Status",IsRequired:true,AlwaysEvaluate:true}),this._fsrblbIsCurrentlyEnrolled.SelectionChangedEvent);var c=c+2;this._divEducation=$$P.div("div"+b+"Controls");this._fsEducation.AddChild(this._divEducation);this._divEducation.AddClassName("cmFormRow");this._ftxtSchoolName=new $$FTXT("ftxt"+b+"SchoolName",{label:"School Name",isRequired:this._cfo.schoolNameRequireFlag,maxLength:100});this._divEducation.AddChild(this._ftxtSchoolName);this._ftxtSchoolName.AddClassName("mb5px");if(this._cfo.schoolNameShowFlag==true){this._ftxtSchoolName.Show();if(this._cfo.schoolNameRequireFlag==true){this._ftxtSchoolName.Validator.addEvaluator($$EVAL.STRING({FieldName:"School Name",IsRequired:true}))}}else{this._ftxtSchoolName.Hide()}this._ftxtSchoolName.SetTabIndex(c);this._fddlSchoolLevel=new $$FDDL("fddl"+b+"SchoolLevel",{label:"Current Level",isRequired:this._cfo.levelRequireFlag});this._divEducation.AddChild(this._fddlSchoolLevel);this._fddlSchoolLevel.AddClassName("mb5px");this._fddlSchoolLevel.bindList(this._inSchoolLevelArray,"","Select",true);this._fddlSchoolLevel.SetTabIndex(++c);this._fddlEducationLevel=new $$FDDL("fddl"+b+"EducationLevel",{label:"Highest Level Attained",isRequired:this._cfo.levelRequireFlag});this._divEducation.AddChild(this._fddlEducationLevel);this._fddlEducationLevel.AddClassName("mb5px");this._fddlEducationLevel.bindList(this._notInSchoolLevelArray,"","Select",true);this._fddlEducationLevel.SetTabIndex(++c);if(this._cfo.levelShowFlag==true){if(this._cfo.levelRequireFlag==true){this._fddlSchoolLevel.Validator.addEvaluator($$EVAL.SELECT({FieldName:"School Level Attained",IsRequired:true}));this._fddlEducationLevel.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Education Level Attained",IsRequired:true}))}}this._fddlSchoolLevel.Hide();this._fddlEducationLevel.Hide();this._ftxtMajorOrDegree=new $$FTXT("ftxt"+b+"MajorOrDegree",{label:"Major or Degree",isRequired:this._cfo.majorRequireFlag,maxLength:255});this._divEducation.AddChild(this._ftxtMajorOrDegree);this._ftxtMajorOrDegree.AddClassName("mb5px");if(this._cfo.majorShowFlag==true){this._ftxtMajorOrDegree.Show();if(this._cfo.majorRequireFlag==true){this._ftxtMajorOrDegree.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Major or Degree",IsRequired:true}))}}else{this._ftxtMajorOrDegree.Hide()}this._ftxtMajorOrDegree.SetTabIndex(++c);this._ftxtGraduationDate=new $$FTXT("ftxt"+b+"GraduationDate",{label:"Graduation Date",isRequired:this._cfo.graduationDateRequireFlag,maxLength:50});this._divEducation.AddChild(this._ftxtGraduationDate);this._ftxtGraduationDate.AddClassName("mb5px");if(this._cfo.graduationDateShowFlag==true){this._ftxtGraduationDate.Show();if(this._cfo.graduationDateRequireFlag==true){this._ftxtGraduationDate.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Graduation Date",IsRequired:true}))}}else{this._ftxtGraduationDate.Hide()}this._ftxtGraduationDate.SetTabIndex(++c);this._ftxtSpringVacation=new $$FTXT("ftxt"+b+"SpringVacationDates",{label:"Spring Vacation Dates",isRequired:this._cfo.springVacationRequireFlag});this._divEducation.AddChild(this._ftxtSpringVacation);this._ftxtSpringVacation.AddClassName("mb5px");if(this._cfo.springVacationShowFlag==true){this._ftxtSpringVacation.Show();if(this._cfo.springVacationRequireFlag==true){this._ftxtSpringVacation.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Spring Vacation Dates",IsRequired:true}))}}else{this._ftxtSpringVacation.Hide()}this._ftxtSpringVacation.SetTabIndex(++c);this._ftxtSummerVacation=new $$FTXT("ftxt"+b+"SummerVacationDates",{label:"Summer Vacation Dates",isRequired:this._cfo.summerVacationRequireFlag,maxLength:50});this._divEducation.AddChild(this._ftxtSummerVacation);this._ftxtSummerVacation.AddClassName("mb5px");if(this._cfo.summerVacationShowFlag==true){this._ftxtSummerVacation.Show();if(this._cfo.summerVacationRequireFlag==true){this._ftxtSummerVacation.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Summer Vacation Dates",IsRequired:true}))}}else{this._ftxtSummerVacation.Hide()}this._ftxtSummerVacation.SetTabIndex(++c);this._ftxtCareerObjective=new $$FTXT("ftxt"+b+"CareerObjective",{label:"Career Objective",isRequired:this._cfo.careerObjectiveRequireFlag,maxLength:50});this._divEducation.AddChild(this._ftxtCareerObjective);this._ftxtCareerObjective.AddClassName("mb5px");if(this._cfo.careerObjectiveShowFlag==true){this._ftxtCareerObjective.Show();if(this._cfo.careerObjectiveRequireFlag==true){this._ftxtCareerObjective.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Career Objective",IsRequired:true}))}}else{this._ftxtCareerObjective.Hide()}this._ftxtCareerObjective.SetTabIndex(++c);this._ftxtGPA=new $$FTXT("ftxt"+b+"GPA",{label:"GPA",isRequired:this._cfo.gpaRequireFlag,maxLength:10});this._divEducation.AddChild(this._ftxtGPA);this._ftxtGPA.AddClassName("mb5px");if(this._cfo.gpaShowFlag==true){this._ftxtGPA.Show();if(this._cfo.gpaRequireFlag==true){this._ftxtGPA.Validator.addEvaluator($$EVAL.TEXT({FieldName:"GPA",IsRequired:true}))}}else{this._ftxtGPA.Hide()}this._ftxtGPA.SetTabIndex(++c);var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px");this._divEducation.Hide()},onSchoolEnrollmentChanged:function(){this._fddlSchoolLevel.Hide(false);this._fddlSchoolLevel.Validator.Disable();this._fddlEducationLevel.Hide(false);this._fddlEducationLevel.Validator.Disable();this._ftxtSpringVacation.Hide(false);this._ftxtSpringVacation.Validator.Disable();this._ftxtSummerVacation.Hide(false);this._ftxtSummerVacation.Validator.Disable();var a=this._fsrblbIsCurrentlyEnrolled.GetData();if(a==true){if(this._cfo.levelShowFlag==true){this._fddlSchoolLevel.Show(false);this._fddlSchoolLevel.Validator.Enable()}if(this._cfo.springVacationShowFlag==true){this._ftxtSpringVacation.Show(false);this._ftxtSpringVacation.Validator.Enable()}if(this._cfo.summerVacationShowFlag==true){this._ftxtSummerVacation.Show(false);this._ftxtSummerVacation.Validator.Enable()}}else{if(a==false){if(this._cfo.levelShowFlag==true){this._fddlEducationLevel.Show(false);this._fddlEducationLevel.Validator.Enable()}}}if($$E(this._divEducation).visible()!=true){if(!$$CM.isNull(a)){this._divEducation.Show(false)}}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fsrblbIsCurrentlyEnrolled.Bind(null);this._ftxtSchoolName.Bind(null);this._fddlSchoolLevel.Bind(null);this._fddlEducationLevel.Bind(null);this._ftxtMajorOrDegree.Bind(null);this._ftxtGraduationDate.Bind(null);this._ftxtSpringVacation.Bind(null);this._ftxtSummerVacation.Bind(null);this._ftxtCareerObjective.Bind(null);this._ftxtGPA.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fsrblbIsCurrentlyEnrolled.Bind(a.IsCurrentlyEnrolled);this._ftxtSchoolName.Bind(a.SchoolName);this._fddlSchoolLevel.Bind(a.EducationLevel);this._fddlEducationLevel.Bind(a.EducationLevel);this._ftxtMajorOrDegree.Bind(a.MajorOrDegree);this._ftxtGraduationDate.Bind(a.GraduationDate);this._ftxtSpringVacation.Bind(a.SpringVacation);this._ftxtSummerVacation.Bind(a.SummerVacation);this._ftxtCareerObjective.Bind(a.CareerObjective);this._ftxtGPA.Bind(a.GPA)}this.onSchoolEnrollmentChanged()},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.IsCurrentlyEnrolled=this._fsrblbIsCurrentlyEnrolled.GetData();if(this._cfo.schoolNameShowFlag==true){a.SchoolName=this._ftxtSchoolName.GetData()}else{a.SchoolName=null}a.EducationLevel=null;a.SpringVacation=null;a.SummerVacation=null;if(this._cfo.levelShowFlag==true){if(a.IsCurrentlyEnrolled==true){a.EducationLevel=this._fddlSchoolLevel.GetData();if(this._cfo.springVacationShowFlag==true){a.SpringVacation=this._ftxtSpringVacation.GetData()}if(this._cfo.summerVacationShowFlag==true){a.SummerVacation=this._ftxtSummerVacation.GetData()}}else{if(a.IsCurrentlyEnrolled==false){a.EducationLevel=this._fddlEducationLevel.GetData()}}}else{if(this._cfo.springVacationShowFlag==true){a.SpringVacation=this._ftxtSpringVacation.GetData()}if(this._cfo.summerVacationShowFlag==true){a.SummerVacation=this._ftxtSummerVacation.GetData()}}if(!$$CM.isNumber(a.EducationLevel)){a.EducationLevel=0}if(this._cfo.majorShowFlag==true){a.MajorOrDegree=this._ftxtMajorOrDegree.GetData()}else{a.MajorOrDegree=null}if(this._cfo.graduationDateShowFlag==true){a.GraduationDate=this._ftxtGraduationDate.GetData()}else{a.GraduationDate=null}if(this._cfo.careerObjectiveShowFlag==true){a.CareerObjective=this._ftxtCareerObjective.GetData()}else{a.CareerObjective=null}if(this._cfo.gpaShowFlag==true){a.GPA=this._ftxtGPA.GetData()}else{a.GPA=null}return a}});"cm.ui.forms".namespace();cm.ui.forms.EmergencyContactsConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Emergency Contacts",legendCssClass:"",initialTabIndex:1,required:false,optionalMessage:"In the event of an emergency, please provide two alternate contacts.",optionalMessageCssClass:""});cm.ui.forms.EmergencyContacts=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.EmergencyContactsConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}},initializeUIElements:function(){var a=this.GetConfigOptions().initialTabIndex;this._fsEmergencyContacts=new $$FS("fsEmergencyContacts_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsEmergencyContacts);this._fsEmergencyContacts.AddClassName("pt10px");this._divOptionalMessage=$$P.div("divOptionalMessage_"+this._uniqueID);this._fsEmergencyContacts.AddChild(this._divOptionalMessage);this._divOptionalMessage.AddClassName("cmFormRow mb10px");if(!$$CM.isEmpty(this._co.optionalMessage)&&this._co.optionalMessage!="~"){this._divOptionalMessage.UpdateInnerHtml(this._co.optionalMessage);this._divOptionalMessage.AddClassName(this._co.optionalMessageCssClass)}else{this._divOptionalMessage.Hide()}this._divContactsWrapper=$$P.div("divContactsWrapper_"+this._uniqueID);this._divContactsWrapper.AddClassName("cmFormRow");this._fsEmergencyContacts.AddChild(this._divContactsWrapper);this._spnNameRelationship=$$P.span("spnRelationship_"+this._uniqueID,"Name & Relationship");this._spnNameRelationship.AddClassName("ml110px cmTitleBase w205px pl5px mb5px cmTextTitleBase");this._divContactsWrapper.AddChild(this._spnNameRelationship);this._spnTelephoneNumber=$$P.span("spnTelephone_"+this._uniqueID,"Telephone Number");this._spnTelephoneNumber.AddClassName("cmTitleBase w185px mb5px cmTextTitleBase");this._divContactsWrapper.AddChild(this._spnTelephoneNumber);this._ftxtContact1NameRelation=new $$FTXT("ftxtContact1NameRelation_"+this._uniqueID,{label:"Contact 1",spanWidth:"110",fieldTip:"John Doe (Uncle)",fieldTipClass:"ml113px w185px mb5px",isRequired:this._co.required==true,maxLength:200});this._ftxtContact1NameRelation.GetInputControl().AddClassName("w185px");this._ftxtContact1NameRelation.AddClassName("w60prct");this._divContactsWrapper.AddChild(this._ftxtContact1NameRelation);this._ftxtContact1NameRelation.SetTabIndex(a);if(this._co.required==true){this._ftxtContact1NameRelation.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Contact 1 - Name & Relationship",IsRequired:true}))}this._ftxtContact1PhoneNumber=new $$FTXT("ftxtContact1PhoneNumber_"+this._uniqueID,{spanWidth:"0",fieldTip:"303-555-7724",fieldTipClass:"ml4px w185px mb5px",isRequired:this._co.required==true,maxLength:100});this._ftxtContact1PhoneNumber.GetInputControl().AddClassName("w185px");this._ftxtContact1PhoneNumber.AddClassName("w40prct");this._divContactsWrapper.AddChild(this._ftxtContact1PhoneNumber);this._ftxtContact1PhoneNumber.SetTabIndex(++a);if(this._co.required==true){this._ftxtContact1PhoneNumber.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Contact 1 - Telephone Number",IsRequired:true}))}this._ftxtContact2NameRelation=new $$FTXT("ftxtContact2NameRelation_"+this._uniqueID,{label:"Contact 2",spanWidth:"110",isRequired:this._co.required==true,maxLength:200});this._ftxtContact2NameRelation.GetInputControl().AddClassName("w185px");this._ftxtContact2NameRelation.AddClassName("w60prct");this._divContactsWrapper.AddChild(this._ftxtContact2NameRelation);this._ftxtContact2NameRelation.SetTabIndex(++a);if(this._co.required==true){this._ftxtContact2NameRelation.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Contact 2 - Name & Relationship",IsRequired:true}))}this._ftxtContact2PhoneNumber=new $$FTXT("ftxtContact2PhoneNumber_"+this._uniqueID,{spanWidth:"0",isRequired:this._co.required==true,maxLength:100});this._ftxtContact2PhoneNumber.GetInputControl().AddClassName("w185px");this._ftxtContact2PhoneNumber.AddClassName("w40prct");this._divContactsWrapper.AddChild(this._ftxtContact2PhoneNumber);this._ftxtContact2PhoneNumber.SetTabIndex(++a);if(this._co.required==true){this._ftxtContact2PhoneNumber.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Contact 2 - Telephone Number",IsRequired:true}))}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxtContact1NameRelation.Bind(null);this._ftxtContact1PhoneNumber.Bind(null);this._ftxtContact2NameRelation.Bind(null);this._ftxtContact2PhoneNumber.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){if(!$$CM.isNull(a.EmergencyContact1)){this._ftxtContact1NameRelation.Bind(a.EmergencyContact1.NameRelation);this._ftxtContact1PhoneNumber.Bind(a.EmergencyContact1.PhoneNumber)}if(!$$CM.isNull(a.EmergencyContact2)){this._ftxtContact2NameRelation.Bind(a.EmergencyContact2.NameRelation);this._ftxtContact2PhoneNumber.Bind(a.EmergencyContact2.PhoneNumber)}}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}if($$CM.isNull(a.EmergencyContact1)){a.EmergencyContact1=new Object()}a.EmergencyContact1.NameRelation=this._ftxtContact1NameRelation.GetData();a.EmergencyContact1.PhoneNumber=this._ftxtContact1PhoneNumber.GetData();if($$CM.isNull(a.EmergencyContact2)){a.EmergencyContact2=new Object()}a.EmergencyContact2.NameRelation=this._ftxtContact2NameRelation.GetData();a.EmergencyContact2.PhoneNumber=this._ftxtContact2PhoneNumber.GetData();return a}});"cm.ui.forms".namespace();cm.ui.common.EmploymentConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"",legendCssClass:"cmLegendBasic cmSubSectionHeader w300px",stateArray:$A(),orderIndex:0,required:false});cm.ui.forms.Employment=Class.create(cm.ui.ComplexControl,{RemoveEvent:null,configureDefaultOptions:function(){return new cm.ui.common.EmploymentConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this.Required=this._cfo.required;this.OrderIndex=this._cfo.orderIndex;this.InDB=false;this.EmployerNumber=this.OrderIndex+1;this.EmployerLabel=this._cfo.legendLabel+" #"+this.EmployerNumber},initializeUIElements:function(){this.UniqueKey=this.ID();var b="_"+this.UniqueKey+"_";this._fsEmployment=new $$FS(b,{legendLabel:this.EmployerLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsEmployment);this._fsEmployment.AddClassName("pt10px cmUnderline pb10px mt15px");this._btnRemove=new $$A("aRemove",{text:"Remove"});this._fsEmployment.AddChild(this._btnRemove);this._btnRemove.AddClassName("cmFloatRight");if(this._cfo.required==true){this._btnRemove.Hide()}var a=$$P.div();this._fsEmployment.AddChild(a);a.AddClassName("cmClear");this._divRow1=$$P.div("div"+b+"Row1");this._fsEmployment.AddChild(this._divRow1);this._divRow1.AddClassName("cmFormRow");this._ftxtEmployer=new $$FTXT("ftxt"+b+"Employer",{name:this.EmployerLabel+" - Employer",label:"Employer",isRequired:this._cfo.required==true,maxLength:50});this._divRow1.AddChild(this._ftxtEmployer);if(this._cfo.required==true){this._ftxtEmployer.Validator.addEvaluator($$EVAL.STRING({IsRequired:true}))}this._ftxtPosition=new $$FTXT("ftxt"+b+"Position",{name:this.EmployerLabel+" - Position",label:"Position",maxLength:50});this._divRow1.AddChild(this._ftxtPosition);if(this._cfo.required==true){}this._divRow2=$$P.div("div"+b+"Row2");this._fsEmployment.AddChild(this._divRow2);this._divRow2.AddClassName("cmFormRow");this._ftxtCityState=new $$FTXT("ftxt"+b+"CityState",{name:this.EmployerLabel+" - City, State",label:"City, State",maxLength:50});this._divRow2.AddChild(this._ftxtCityState);if(this._cfo.required==true){}this._ftxtStartEndDates=new $$FTXT("ftxt"+b+"StartDate",{name:this.EmployerLabel+" - Start, End Dates",label:"Start, End Dates",maxLength:50});this._divRow2.AddChild(this._ftxtStartEndDates);if(this._cfo.required==true){}var a=$$P.div();this._fsEmployment.AddChild(a);a.AddClassName("cmClear");this._fsContact=new $$FS(b+"Contact",{legendLabel:"Employer Contact Info",legendCssClass:"cmLegendBasic cmEmphasize mb10px"});this._fsEmployment.AddChild(this._fsContact);this._fsContact.AddClassName("pt10px");this._divContact=$$P.div("div"+b+"Contact");this._fsContact.AddChild(this._divContact);this._divContact.AddClassName("cmFormRow");this._divRow3=$$P.div("div"+b+"Row3");this._divContact.AddChild(this._divRow3);this._divRow3.AddClassName("cmFormRow");this._ftxtContactName=new $$FTXT("ftxt"+b+"ContactName",{name:this.EmployerLabel+" - Name",label:"Name",maxLength:50});this._divRow3.AddChild(this._ftxtContactName);if(this._cfo.required==true){}this._ftxtContactPhone=new $$FTXT("ftxt"+b+"ContactPhone",{name:this.EmployerLabel+" - Phone",label:"Phone",maxLength:50});this._divRow3.AddChild(this._ftxtContactPhone);this._divRow4=$$P.div("div"+b+"Row4");this._divContact.AddChild(this._divRow4);this._divRow4.AddClassName("cmFormRow");this._femailContactEmail=new $$FEMAIL("femail"+b+"ContactEmail",{name:this.EmployerLabel+" - Email",label:"Email",maxLength:100});this._divRow4.AddChild(this._femailContactEmail);this._femailContactEmail.Validator.addEvaluator($$EVAL.EMAIL({}));if(this._cfo.required==true){}this._divDoNotContact=$$P.div("div"+b+"_divDoNotContact");this._fsContact.AddChild(this._divDoNotContact);this._divDoNotContact.AddClassName("cmFormRow w525px");this._fcbDoNotContact=new $$FCB("fcb"+b+"DoNotContact",{value:"",label:"Do not contact this employer",name:b+"DoNotContact"});this._divDoNotContact.AddChild(this._fcbDoNotContact);this._fcbDoNotContact.AddClassName("cmBool w520px");this._fcbDoNotContact.GetTitleControl().RemoveClassName("cmCheckboxTitleBase");this._fcbDoNotContact.GetTitleControl().AddClassName("cmBold w500px");this._fcbDoNotContact.ChangeEvent.subscribe(this.onDoNotContactChanged,this);this._divDoNotContactNotes=$$P.div("div"+b+"DoNotContactNotes");this._fsContact.AddChild(this._divDoNotContactNotes);this._divDoNotContactNotes.AddClassName("cmFormRow w520px");this._ftxaDoNotContactNotes=new $$FTXA("ftxa"+b+"DoNotContactNotes",{name:this.EmployerLabel+" - Reason",label:"Reason",isRequired:true,maxLength:500,fieldTip:"500 Char Max"});this._divDoNotContactNotes.AddChild(this._ftxaDoNotContactNotes);this._ftxaDoNotContactNotes.AddClassName("w520px");this._ftxaDoNotContactNotes.GetInputControl().AddClassName("w392px");this._ftxaDoNotContactNotes.Validator.addEvaluator($$EVAL.STRING({IsRequired:true}));this._ftxaDoNotContactNotes.Hide();this._ftxaDoNotContactNotes.Validator.Disable();var a=$$P.div();this._fsEmployment.AddChild(a);a.AddClassName("cmClear")},createEvents:function(){this.RemoveEvent=new cm.event()},wireEvents:function($super){$super();this._btnRemove.ClickEvent.subscribe(this.onRemoveClicked,this)},RefreshLabels:function(a){this.EmployerNumber=this.OrderIndex+1;this.EmployerLabel=this._cfo.legendLabel+" #"+this.EmployerNumber;this._fsEmployment.GetLegendControl().UpdateInnerHtml(this.EmployerLabel);this._ftxtEmployer.GetConfigOptions().Set("name",this.EmployerLabel+" - Employer");this._ftxaDoNotContactNotes.GetConfigOptions().Set("name",this.EmployerLabel+" - Reason")},onRemoveClicked:function(c,a){var b={title:"Delete Employment Information?",header:"This will permanently delete this employer information.",message:"Are you sure you want to continue?",handlerOk:this.onRemoveConfirmed,scope:this,width:300,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)},onRemoveConfirmed:function(){this.RemoveEvent.fire(this,{uniqueKey:this.UniqueKey})},onDoNotContactChanged:function(b,a){this.toggleDoNotContactNotes(true)},toggleDoNotContactNotes:function(a){var b=this._fcbDoNotContact.GetData();if(b){this._ftxaDoNotContactNotes.Show(a);this._ftxaDoNotContactNotes.Validator.Enable()}else{if($$E(this._ftxaDoNotContactNotes).visible()==true){this._ftxaDoNotContactNotes.Hide(a);this._ftxaDoNotContactNotes.Validator.Disable()}}},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=this.ValidateIncomplete();if(c.IsValid()!=true){b.AppendResult(c)}}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ValidateIncomplete:function(){var b=new cm.validation.ValidationResult("");if(this.Required!=true){this._ftxtEmployer.RemoveClassName("cmValidationError");var a=this._ftxtEmployer.GetData();if($$CM.isEmpty(a)&&this.PartiallyFilled()){b.AddError("<b>"+this.EmployerLabel+" - Employer:</b> Field is required");this._ftxtEmployer.AddClassName("cmValidationError")}}return b},PartiallyFilled:function(){var a=false;if(!$$CM.isEmpty(this._ftxtEmployer.GetData())){return true}if(!$$CM.isEmpty(this._ftxtPosition.GetData())){return true}if(!$$CM.isEmpty(this._ftxtCityState.GetData())){return true}if(!$$CM.isEmpty(this._ftxtStartEndDates.GetData())){return true}if(!$$CM.isEmpty(this._ftxtContactName.GetData())){return true}if(!$$CM.isEmpty(this._ftxtContactPhone.GetData())){return true}if(this._fcbDoNotContact.GetData()==true){return true}return a},ClearFields:function(){this.Validator.Clear();this._ftxtEmployer.Bind(null);this._ftxtPosition.Bind(null);this._ftxtCityState.Bind(null);this._ftxtStartEndDates.Bind(null);this._ftxtContactName.Bind(null);this._ftxtContactPhone.Bind(null);this._femailContactEmail.Bind(null);this._fcbDoNotContact.Bind(null);this._ftxaDoNotContactNotes.Bind(null)},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if(!$$CM.isNull(b)){this._ftxtEmployer.Bind(b.Employer);this._ftxtPosition.Bind(b.Position);this._ftxtCityState.Bind(b.CityState);this._ftxtStartEndDates.Bind(b.StartEndDates);if(!$$CM.isNull(b.ContactData)){var a=b.ContactData;this._ftxtContactName.Bind(a.Name);this._ftxtContactPhone.Bind(a.Phone);this._femailContactEmail.Bind(a.Email);this._fcbDoNotContact.Bind(a.DoNotContact);this._ftxaDoNotContactNotes.Bind(a.DoNotContactNotes);this.toggleDoNotContactNotes(false)}if(!$$CM.isEmpty(b.InDB)&&b.InDB==true){this.InDB=true}}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.Employer=this._ftxtEmployer.GetData();a.Position=this._ftxtPosition.GetData();a.CityState=this._ftxtCityState.GetData();a.StartEndDates=this._ftxtStartEndDates.GetData();if($$CM.isNull(a.ContactData)){a.ContactData=new Object()}a.ContactData.Name=this._ftxtContactName.GetData();a.ContactData.Phone=this._ftxtContactPhone.GetData();a.ContactData.Email=this._femailContactEmail.GetData();a.ContactData.DoNotContact=this._fcbDoNotContact.GetData();if(a.ContactData.DoNotContact==true){a.ContactData.DoNotContactNotes=this._ftxaDoNotContactNotes.GetData()}else{a.ContactData.DoNotContactNotes=""}a.OrderIndex=this.OrderIndex;return a}});"cm.ui.forms".namespace();cm.ui.forms.EmploymentListConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Employment History",legendCssClass:"cmSectionHeader",employmentPositionsDisplayed:0,employmentPositionsRequired:0,employmentPositionsMaximum:5});cm.ui.forms.EmploymentList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.EmploymentListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._employmentPositionsDisplayed=this._cfo.employmentPositionsDisplayed;this._employmentPositionsRequired=this._cfo.employmentPositionsRequired;this._employmentPositionsMaximum=this._cfo.employmentPositionsMaximum;this._ctrEmploymentArray=$A();this._deletedEmploymentDataArray=$A()},getEmploymentConfigOptions:function(){var a=new Object();a.legendLabel="Employment Information";a.legendCssClass="cmLegendBasic cmSubSectionHeader mb15px cmInlineLegend w300px";a.required=false;return a},initializeUIElements:function(){var b=this.ID();this._fsEmploymentContainer=new $$FS("EmploymentContainer",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsEmploymentContainer);this._fsEmploymentContainer.AddClassName("pt10px");this._divEmployments=$$P.div("divEmployments");this._fsEmploymentContainer.AddChild(this._divEmployments);this._divEmployments.AddClassName("cmFormRow");this._divAddEmployer=$$P.div("divAddEmployer");this._fsEmploymentContainer.AddChild(this._divAddEmployer);this._divAddEmployer.AddClassName("cmBtnContainer");this._btnAddEmployer=new $$BTN("btnAddEmployer",{text:"Add Employer"});this._divAddEmployer.AddChild(this._btnAddEmployer);this._btnAddEmployer.AddClassName("cmGoButton cmFloatRight");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px");this.renderEmployments()},wireEvents:function($super){$super();this._btnAddEmployer.ClickEvent.subscribe(this.onAddEmployerClicked,this)},renderEmployments:function(){for(var a=1;a<=this._employmentPositionsDisplayed;a++){var b=(a<=this._employmentPositionsRequired);this.AddEmployer(b,null)}},onAddEmployerClicked:function(){this.AddEmployer(false,null)},AddEmployer:function(e,c){if(this._ctrEmploymentArray.length<this._employmentPositionsMaximum){var d=this._ctrEmploymentArray.length;var b=this.getEmploymentConfigOptions();b.orderIndex=d;b.required=e;var a=new cm.ui.forms.Employment($$CM.uniqueID(),b);this._divEmployments.AddChild(a);a.RemoveEvent.subscribe(this.onEmploymentRemoved,this);this._ctrEmploymentArray.push(a);if(!$$CM.isNull(c)){a.Bind(c)}}this.toggleAddButton()},toggleAddButton:function(){if(this._ctrEmploymentArray.length<this._employmentPositionsMaximum){this._divAddEmployer.Show(false)}else{this._divAddEmployer.Hide(false)}},onEmploymentRemoved:function(d,a){var e=a.uniqueKey;var c=0;var b=$A();this._ctrEmploymentArray.each(function(f){if(f.UniqueKey==e){if(f.InDB==true){var g=f.GetData();g.Deleted=true;this._deletedEmploymentDataArray.push(g)}}else{f.OrderIndex=c;c++;b.push(f)}},this);this._ctrEmploymentArray=b;this.refreshEmploymentControls();this.toggleAddButton()},refreshEmploymentControls:function(){this._divEmployments.ClearChildControls(false);this._ctrEmploymentArray.each(function(a){a.RefreshLabels();this._divEmployments.AddChild(a)},this)},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){this._ctrEmploymentArray.each(function(c){var d=c.Validate(false);if(d.IsValid()!=true){b.AppendResult(d)}},this)}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrEmploymentArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){var b=0;a.each(function(d){if(d.Deleted!=true){var c=null;if(b<this._ctrEmploymentArray.length){c=this._ctrEmploymentArray[b]}if(!$$CM.isNull(c)){c.Bind(d)}else{this.AddEmployer(false,d)}b++}},this)}},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}var c=0;var b=$A();this._ctrEmploymentArray.each(function(d){var e=d.GetData();if(!$$CM.isNull(e)){if(!$$CM.isEmpty(e.Employer)){e.OrderIndex=c;b.push(e);c++}}},this);this._deletedEmploymentDataArray.each(function(d){d.OrderIndex=c;b.push(d);c++},this);a=b;return a}});"cm.ui.forms".namespace();cm.ui.forms.FormsBaseConfigOptions=Class.create(cm.ConfigOptions,{formID:0});cm.ui.forms.FormsBase=Class.create(cm.ui.Controller,{configureDefaultOptions:function(){return new cm.ui.forms.FormsBaseConfigOptions()},initializeDAOs:function(){this.SetControllerDAO(new cm.dao.Forms.DAO())},wireEvents:function($super){$super();if($$CM.isFunction(this.onFormFetched)){this.GetControllerDAO().FormFetchedEvent.subscribe(this.onFormFetched,this)}if($$CM.isFunction(this.onFormModified)){this.GetControllerDAO().FormModifiedEvent.subscribe(this.onFormModified,this)}if($$CM.isFunction(this.onPersonFormFetched)){this.GetControllerDAO().PersonFormFetchedEvent.subscribe(this.onPersonFormFetched,this)}if($$CM.isFunction(this.onPersonFormModified)){this.GetControllerDAO().PersonFormModifiedEvent.subscribe(this.onPersonFormModified,this)}if($$CM.isFunction(this.onSeasonalSettingsDataFetched)){this.GetControllerDAO().SeasonalSettingsDataFetchedEvent.subscribe(this.onSeasonalSettingsDataFetched,this)}if($$CM.isFunction(this.onSeasonalListsDataFetched)){this.GetControllerDAO().SeasonalListsDataFetchedEvent.subscribe(this.onSeasonalListsDataFetched,this)}if($$CM.isFunction(this.onFamilyFinancialFetched)){this.GetControllerDAO().FamilyFinancialFetchedEvent.subscribe(this.onFamilyFinancialFetched,this)}if($$CM.isFunction(this.onApplyPromotionCodeCompleted)){this.GetControllerDAO().ApplyPromotionCodeEvent.subscribe(this.onApplyPromotionCodeCompleted,this)}if($$CM.isFunction(this.onValidatePromotionCodesCompleted)){this.GetControllerDAO().ValidatePromotionCodesEvent.subscribe(this.onValidatePromotionCodesCompleted,this)}},formGet:function(c){var a=this.GetConfigOptions().controllerDataProperty;var b=this.GetConfigOptions().formID;return this.GetControllerDAO().FormGet(a,b,c)},formFetch:function(c,e){var d=this.GetConfigOptions().mvcController;var a=this.GetConfigOptions().controllerDataProperty;var b=this.GetConfigOptions().formID;this.GetControllerDAO().FormFetch(d,c,b,e,{formID:b,seasonID:e,dataProperty:a})},formModify:function(d,f,a){var e=this.GetConfigOptions().mvcController;var b=this.GetConfigOptions().controllerDataProperty;var c=this.GetConfigOptions().formID;this.GetControllerDAO().FormModify(e,d,a,{formID:c,seasonID:f,dataProperty:b})},personFormGet:function(a){var b=this.GetConfigOptions().controllerDataProperty;var c=this.GetConfigOptions().formID;var e=a.seasonID;var d=a.personID;return this.GetControllerDAO().PersonFormGet(b,c,e,d)},personFormFetch:function(a){var e=this.GetConfigOptions().mvcController;var d=a.mvcAction;var b=this.GetConfigOptions().controllerDataProperty;var c=this.GetConfigOptions().formID;var g=a.seasonID;var f=a.personID;var h=a.suppressError;this.GetControllerDAO().PersonFormFetch(e,d,{formID:c,seasonID:g,personID:f,suppressError:h,dataProperty:b})},personFormModify:function(a){var f=this.GetConfigOptions().mvcController;var e=a.mvcAction;var b=a.data;var c=this.GetConfigOptions().controllerDataProperty;var d=this.GetConfigOptions().formID;var h=a.seasonID;var g=a.personID;var i=a.suppressError;this.GetControllerDAO().PersonFormModify(f,e,b,{formID:d,seasonID:h,personID:g,suppressError:i,dataProperty:c})},seasonalSettingsDataGet:function(a){var b="SeasonalSettingsDataArray";var c=this.GetConfigOptions().formID;var d=a.seasonID;return this.GetControllerDAO().SeasonalSettingsDataGet({dataProperty:b,formID:c,seasonID:d})},seasonalSettingsDataFetch:function(a){var e=this.GetConfigOptions().mvcController;var d=a.mvcAction;var b="SeasonalSettingsDataArray";var c=this.GetConfigOptions().formID;var f=a.seasonID;this.GetControllerDAO().SeasonalSettingsDataFetch(e,d,{formID:c,seasonID:f,dataProperty:b})},seasonalListsDataGet:function(a){var b="SeasonalListsDataArray";var c=this.GetConfigOptions().formID;var d=a.seasonID;return this.GetControllerDAO().SeasonalListsDataGet({dataProperty:b,formID:c,seasonID:d})},seasonalListsDataFetch:function(a){var f=this.GetConfigOptions().mvcController;var e=a.mvcAction;var c="SeasonalListsDataArray";var d=this.GetConfigOptions().formID;var h=a.seasonID;var b=a.camperData;var g=a.pricingIdentifierID;var i=a.tokenizedTimestamp;this.GetControllerDAO().SeasonalListsDataFetch(f,e,{formID:d,seasonID:h,dataProperty:c,camperData:b,pricingIdentifierID:g,tokenizedTimestamp:i})},familyFinancialGet:function(a){return this.GetControllerDAO().FamilyFinancialGet(a)},familyFinancialFetch:function(b,a){var c=this.GetConfigOptions().mvcController;this.GetControllerDAO().FamilyFinancialFetch(c,b,a)},applyPromotionCode:function(b,a){var c=this.GetConfigOptions().mvcController;return this.GetControllerDAO().ApplyPromotionCode(c,b,a)},validatePromotionCodes:function(b,a){var c=this.GetConfigOptions().mvcController;return this.GetControllerDAO().ValidatePromotionCodes(c,b,a)}});"cm.ui.forms".namespace();cm.ui.forms.LeadSourceSelectorConfigOptions=Class.create(cm.ConfigOptions,{leadSourceArray:$A(),leadSourceCategoryArray:$A(),ddlLabel:"How did you hear about us?",memoLabel:"Please specify.",isRequired:false,staffMode:false,renderMode:1});cm.ui.forms.LeadSourceSelector=Class.create(cm.ui.ComplexControl,{_leadSourceArray:$A(),_leadSourceCategoryArray:$A(),_optionArray:$A(),configureDefaultOptions:function(){return new cm.ui.forms.LeadSourceSelectorConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._leadSourceArray=this._co.leadSourceArray;this._leadSourceCategoryArray=this._co.leadSourceCategoryArray;this._optionArray=$A();if(this._co.staffMode==false){if((!$$CM.isArray(this._leadSourceArray)||this._leadSourceArray<=0)&&$$CM.isArray(cm.dao.Lists.Data.CamperLeadSourceArray)){this._leadSourceArray=$A(cm.dao.Lists.Data.CamperLeadSourceArray)}if((!$$CM.isArray(this._leadSourceCategoryArray)||this._leadSourceCategoryArray<=0)&&$$CM.isArray(cm.dao.Lists.Data.CamperLeadSourceCategoryArray)){this._leadSourceCategoryArray=$A(cm.dao.Lists.Data.CamperLeadSourceCategoryArray)}if($$CM.isArray(this._leadSourceCategoryArray)){this._leadSourceCategoryArray.sort($$CM.sortByNameProperty)}if(!$$CM.isNull(this._leadSourceCategoryArray)&&this._leadSourceCategoryArray.length>0){this._leadSourceCategoryArray.each(function(b){var a=this._leadSourceArray.filter(function(d){return d.CategoryID==b.CategoryID},this);if($$CM.isArray(a)&&a.length>0){var c=new Object();c.Name=b.Name;c.ItemArray=$A();a.each(function(e){var d=new Object();d.ID=e.ID;d.Name=e.Name;c.ItemArray.push(d)},this);this._optionArray.push(c)}},this)}}else{if(!$$CM.isNull(this._leadSourceArray)&&this._leadSourceArray.length>0){this._leadSourceArray.each(function(b){var a=new Object();a.ID=b.ID;a.Name=b.Name;this._optionArray.push(a)},this)}}},initializeUIElements:function(){this.AddClassName("cmFormRow");if(!$$CM.isEmpty(this._co.classNames)){this.AddClassName(this._co.classNames)}else{this.AddClassName("mb10px")}this._fddlLeadSource=new $$FDDL("fddlLeadSource_"+this._uniqueID,{label:this._co.ddlLabel,isRequired:this._co.isRequired==true});this.AddChild(this._fddlLeadSource);this._fddlLeadSource.AddClassName("cmTopLabel");this._fddlLeadSource.bindList(this._optionArray,"","Select",false);this._fddlLeadSource.ChangeEvent.subscribe(this.onLeadSourceChanged,this);this._divClear=$$P.div();this.AddChild(this._divClear);this._divClear.AddClassName("cmClear");this._divClear.Hide();this._divLeadSourceMemo=$$P.div("divLeadSourceMemo_"+this._uniqueID);this.AddChild(this._divLeadSourceMemo);this._divLeadSourceMemo.AssignStyle("display","inline-block");this._ftxtLeadSourceMemo=new $$FTXT("ftxtLeadSourceMemo_"+this._uniqueID,{label:this._co.memoLabel,inputWidth:"240",isRequired:this._co.isRequired==true,fieldTip:"Explain",fieldTipClass:"ml0px",maxLength:250});this._divLeadSourceMemo.AddChild(this._ftxtLeadSourceMemo);this._ftxtLeadSourceMemo.AddClassName("cmTopLabel");if(this._co.isRequired==true){this._fddlLeadSource.Validator.addEvaluator($$EVAL.SELECT({FieldName:"How did you hear about us",IsRequired:true}));this._ftxtLeadSourceMemo.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Please specify",IsRequired:true}))}if(this._co.renderMode==1){this.AddClassName("w100prct");this._divClear.Hide();this._fddlLeadSource.AddClassName("w50prct mb15px");this._divLeadSourceMemo.AddClassName("w50prct")}if(this._co.renderMode==2){this.AddClassName("w50prct");this._divClear.Show()}this._divLeadSourceMemo.Hide()},onLeadSourceChanged:function(){this._ftxtLeadSourceMemo.Bind(null);this._ftxtLeadSourceMemo.GetFieldTipControl().UpdateInnerHtml("");var a=this.getSelectedLeadSource();if(!$$CM.isNull(a)){if(this._leadSourceRequireFlag==true){this._ftxtLeadSourceMemo.Validator.Clear()}if(a.AskMemo){this._ftxtLeadSourceMemo.GetFieldTipControl().UpdateInnerHtml("Which "+a.Name);if(!$$E(this._divLeadSourceMemo).visible()==true){this._divLeadSourceMemo.Show(true);if(this._leadSourceRequireFlag==true){this._ftxtLeadSourceMemo.Validator.Enable()}}else{this._ftxtLeadSourceMemo.Validator.Disable()}}else{if($$E(this._divLeadSourceMemo).visible()==true){this._divLeadSourceMemo.Hide(true);if(this._leadSourceRequireFlag==true){this._ftxtLeadSourceMemo.Validator.Disable()}}else{this._ftxtLeadSourceMemo.Validator.Disable()}}}else{if($$E(this._divLeadSourceMemo).visible()==true){this._divLeadSourceMemo.Hide(true);this._ftxtLeadSourceMemo.Validator.Disable()}}},getSelectedLeadSource:function(){var b=this._fddlLeadSource.GetData();var a=this.getLeadSourceByID(b);return a},getLeadSourceByID:function(b){var a=null;this._leadSourceArray.each(function(c){if(c.ID==b){a=c}else{if($$CM.isArray(c.ItemArray)&&c.ItemArray.length>0){c.ItemArray.each(function(d){if(d.ID==b){a=d}},this)}}},this);return a},getLeadSourceByName:function(b){var a=null;this._leadSourceArray.each(function(c){if(c.Name==b){a=c}else{if($$CM.isArray(c.ItemArray)&&c.ItemArray.length>0){c.ItemArray.each(function(d){if(d.Name==b){a=d}},this)}}},this);return a},Reset:function(){this._fddlLeadSource.Bind("");this._ftxtLeadSourceMemo.Bind("");this._divLeadSourceMemo.Hide()},onDataUpdated:function(){var a=this.GetBoundData();if(!$$CM.isNull(a)){var b=this.getLeadSourceByName(a.LeadSource);if(!$$CM.isEmpty(b)){this._fddlLeadSource.Bind(b.ID);this._ftxtLeadSourceMemo.Bind(a.Memo);this._ftxtLeadSourceMemo.GetFieldTipControl().UpdateInnerHtml("");if(b.AskMemo==true){this._ftxtLeadSourceMemo.GetFieldTipControl().UpdateInnerHtml("Which "+b.Name)}if(b.AskMemo==true||!$$CM.isEmpty(a.Memo)){this._divLeadSourceMemo.Show(false)}}else{if(!$$CM.isEmpty(a.LeadSource)&&!$$CM.isEmpty(a.Memo)){this._ftxtLeadSourceMemo.Bind(a.LeadSource+" - "+a.Memo);this._divLeadSourceMemo.Show(false)}else{if(!$$CM.isEmpty(a.LeadSource)){this._ftxtLeadSourceMemo.Bind(a.LeadSource);this._divLeadSourceMemo.Show(false)}else{if(!$$CM.isEmpty(a.Memo)){this._ftxtLeadSourceMemo.Bind(a.Memo);this._divLeadSourceMemo.Show(false)}else{this.onLeadSourceChanged(a.Memo)}}}}}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}var b=this.getSelectedLeadSource();if(!$$CM.isNull(b)){a.LeadSource=b.Name}a.Memo=this._ftxtLeadSourceMemo.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.PersonAddressConfigOptions=Class.create(cm.ui.common.AddressConfigOptions,{title:"",titleCssClass:"cmSectionHeader mb20px",instructions:"",instructionsCssClass:"",householdTypeLabel:"What type of address is this?"});cm.ui.forms.PersonAddress=Class.create(cm.ui.ComplexControl,{TypeChangedEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.PersonAddressConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._countryArray=$A();if(!$$CM.isArray(cm.dao.Lists.Data.CountryArray)){this._countryArray=cm.dao.Lists.Data.CountryArray}this._stateArray=$A();if(!$$CM.isArray(cm.dao.Lists.Data.StateArray)){this._stateArray=cm.dao.Lists.Data.StateArray}this._enumEntityTypeFlag=cm.dao.Lists.Enums.EntityTypeFlag.asEnum();this._addressTypeArray=$A();this._addressTypeArray.push({ID:this._enumEntityTypeFlag.GetId("person"),Name:"A place I own or rent"});this._addressTypeArray.push({ID:this._enumEntityTypeFlag.GetId("family"),Name:"My parent/guardian's household"});this._tabIndex=0},initializeUIElements:function(){this.AddClassName("cmFormRow mb0px");if(!$$CM.isEmpty(this._co.title)){this._divTitle=$$P.div("divTitle_"+this._uniqueID);this.AddChild(this._divTitle);this._divTitle.AddClassName("cmFormRow");this._divTitle.UpdateInnerHtml(this._co.title);if(!$$CM.isEmpty(this._co.titleCssClass)){this._divTitle.AddClassName(this._co.titleCssClass)}}if(!$$CM.isEmpty(this._co.instructions)){this._divInstructions=$$P.div("divInstructions_"+this._uniqueID);this.AddChild(this._divInstructions);this._divInstructions.AddClassName("cmFormRow");this._divInstructions.UpdateInnerHtml(this._co.instructions);if(!$$CM.isEmpty(this._co.instructionsCssClass)){this._divInstructions.AddClassName(this._co.instructionsCssClass)}}this._divType=$$P.div("divType_"+this._uniqueID);this.AddChild(this._divType);this._divType.AddClassName("cmFormRow");if(this._co.householdTypeDisabled==true){this._divType.Hide()}var b="What type of address is this?";if(!$$CM.isEmpty(this._co.householdTypeLabel)){b=this._co.householdTypeLabel}this._ddlHouseholdType=new $$FDDL("ddlHouseholdType_"+this._uniqueID,{label:b,isRequired:this._co.required});this._divType.AddChild(this._ddlHouseholdType);this._ddlHouseholdType.AddClassName("mb5px w100prct");this._ddlHouseholdType.GetTitleControl().AddClassName("w100prct");this._ddlHouseholdType.GetInputControl().AddClassName("w245px");this._ddlHouseholdType.bindList(this._addressTypeArray);this._ddlHouseholdType.SetTabIndex(++this._tabIndex);if(this._co.required){this._ddlHouseholdType.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Household Type",IsRequired:this._co.required}))}this._divPrimaryHouseholdSummerAddress=$$P.div("divPrimaryHouseholdSummerAddress_"+this._uniqueID);this.AddChild(this._divPrimaryHouseholdSummerAddress);this._divPrimaryHouseholdSummerAddress.AddClassName("cmFormRow mb0px");this._divPrimaryHouseholdSummerAddress.Hide();this._fsrblbPrimaryHouseholdSummerAddress=new $$FSRBLB("fsrblPrimaryHouseholdSummerAddress",{legendLabel:"Is this address a summer address for the primary household?",legendCssClass:"cmLegendBasic w100prct",isRequired:true,initialTabIndex:++this._tabIndex});this._divPrimaryHouseholdSummerAddress.AddChild(this._fsrblbPrimaryHouseholdSummerAddress);this._fsrblbPrimaryHouseholdSummerAddress.AddClassName("cmFormRow mtb10px");this._fsrblbPrimaryHouseholdSummerAddress.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Primary Household Summer Address Question",IsRequired:true,AlwaysEvaluate:true}),this._fsrblbPrimaryHouseholdSummerAddress.SelectionChangedEvent);var a=$$CM.uniqueID();this._ctrAddress=new $$FADDRESS("divAddress_"+a,this._co);this.AddChild(this._ctrAddress);this._ctrAddress.AddClassName("mb0px")},createEvents:function(){this.TypeChangedEvent=new cm.event()},wireEvents:function($super){$super();this._ddlHouseholdType.ChangeEvent.subscribe(this.onTypeChanged,this)},onTypeChanged:function(){this.TypeChangedEvent.fire(this,{data:this.GetData()})},TogglePrimaryHouseholdSummerAddress:function(a){this._fsrblbPrimaryHouseholdSummerAddress.Bind(a);if(a){this._divPrimaryHouseholdSummerAddress.Show()}else{this._divPrimaryHouseholdSummerAddress.Hide()}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ddlHouseholdType.Bind(null);this._fsrblbPrimaryHouseholdSummerAddress.Bind(false);this._ctrAddress.Bind(null)},onDataUpdated:function(){this.ClearFields();this._originalData=null;var a=this.GetBoundData();if(!$$CM.isNull(a)){this._originalData=$$CM.deepClone(a);this._ddlHouseholdType.Bind(a.TypeID);this._ctrAddress.Bind(a.Address)}},GetHouseholdTypeID:function(){return this._ddlHouseholdType.GetData()},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}if(!$$CM.isInteger(a.EntityID)&&a.EntityID<0){a.EntityID=0}if(this._co.householdTypeDisabled==true){a.HouseholdTypeID=this._enumEntityTypeFlag.GetId("person")}else{a.HouseholdTypeID=this._ddlHouseholdType.GetData()}a.PrimaryHouseholdSummerAddress=false;if($$E(this._fsrblbPrimaryHouseholdSummerAddress).visible()==true){a.PrimaryHouseholdSummerAddress=this._fsrblbPrimaryHouseholdSummerAddress.GetData()}a.Address=this._ctrAddress.GetData();var b=(!$$CM.isNull(this._originalData))?this._originalData.Address:null;a.HasChanges=!$$CM.addressesMatch(b,a.Address);return a}});"cm.ui.forms".namespace();cm.ui.forms.PersonHouseholdConfigOptions=Class.create(cm.ConfigOptions,{title:"Person Household",settings:new Object(),existingStatus:0});cm.ui.forms.PersonHousehold=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.PersonHouseholdConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._settings=this._co.settings;this._existingStatus=this._co.existingStatus;this._countryArray=$A();if(!$$CM.isArray(cm.dao.Lists.Data.CountryArray)){this._countryArray=cm.dao.Lists.Data.CountryArray}this._stateArray=$A();if(!$$CM.isArray(cm.dao.Lists.Data.StateArray)){this._stateArray=cm.dao.Lists.Data.StateArray}this._homePhoneShowFlag=(this._settings.HomePhoneShowFlag&this._existingStatus)==this._existingStatus;this._homePhoneRequireFlag=(this._settings.HomePhoneRequireFlag&this._existingStatus)==this._existingStatus},initializeUIElements:function(){this.AddClassName("");var d=$$CM.uniqueID();this._ctrPermanentAddress=new $$FADDRESS("divPermanentAddress_"+d,{uniqueID:d,legendLabel:"Permanent Address",legendCssClass:"cmSectionHeader mb20px",required:true,countryArray:this._countryArray,stateArray:this._stateArray,groupFieldName:"Permanent Address",initialTabIndex:1,defaultCountry:$$CLIENT.Country});this.AddChild(this._ctrPermanentAddress);this._divPhoneHome=$$P.div("_divPhoneHome");this.AddChild(this._divPhoneHome);this._divPhoneHome.AddClassName("cmFormRow");this._ftxtPhoneHome=new $$FTXT("ftxtContactInfoPhoneHome",{label:"Home Phone",isRequired:this._co.homePhoneRequired,maxLength:15});this._divPhoneHome.AddChild(this._ftxtPhoneHome);this._ftxtPhoneHome.SetTabIndex(8);if(this._co.homePhoneEnabled==true){this._ftxtPhoneHome.Show();if(this._co.homePhoneRequired){this._ftxtPhoneHome.Validator.addEvaluator($$EVAL.STRING({FieldName:"Home Phone",IsRequired:this._co.homePhoneRequired}))}}else{this._ftxtPhoneHome.Hide()}this._fsrblbHasAlternateAddress=new $$FSRBLB("fsrblHasAlternateAddress",{legendLabel:"At any point during the year do you reside at an alternate address?",legendCssClass:"cmLegendBasic w100prct",isRequired:true,initialTabIndex:9});this.AddChild(this._fsrblbHasAlternateAddress);this._fsrblbHasAlternateAddress.AddClassName("cmFormRow mb20px mt20px");this._fsrblbHasAlternateAddress.SelectionChangedEvent.subscribe(this.onHasAlternateAddressChanged,this);this._fsrblbHasAlternateAddress.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Alternate Address Question",IsRequired:true,AlwaysEvaluate:true}),this._fsrblbHasAlternateAddress.SelectionChangedEvent);var a=$$CM.uniqueID();this._ctrAlternateAddress=new $$FADDRESS("divAlternateAddress_"+a,{uniqueID:a,legendLabel:"Alternate Address",legendCssClass:"cmSectionHeader mb20px",required:true,countryArray:this._countryArray,defaultCountry:$$CLIENT.Country,stateArray:this._stateArray,groupFieldName:"Alternate Address",initialTabIndex:11});this.AddChild(this._ctrAlternateAddress);this._ctrAlternateAddress.AddClassName("cmExpand mt10px w510px");this._ctrAlternateAddress.Hide();var b=$$P.div();this.AddChild(b);b.AddClassName("cmFormRow mb10px");this._fsrblMailingPreference=new $$FSRBL("fsrblMailingPreference",{legendLabel:"To which address should we send mailings?",legendCssClass:"cmLegendBasic w100prct",isRequired:true,initialTabIndex:18});this.AddChild(this._fsrblMailingPreference);this._fsrblMailingPreference.AddClassName("cmFormRow mt20px");var c="MailingPreference"+$$CM.uniqueID();this._fsrblMailingPreference.AddFormRadioButton({ID:1,Name:"Permanent",GroupName:c});this._fsrblMailingPreference.AddFormRadioButton({ID:2,Name:"Alternate",GroupName:c});this._fsrblMailingPreference.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Mailing Preference",IsRequired:true,AlwaysEvaluate:true}),this._fsrblMailingPreference.SelectionChangedEvent);var b=$$P.div();this.AddChild(b);b.AddClassName("cmFormRow mb20px")},wireEvents:function($super){$super()},onHasAlternateAddressChanged:function(c,a){var b=this._fsrblbHasAlternateAddress.GetData();if(b==true){if($$E(this._fsrblMailingPreference).visible()==false){this._fsrblMailingPreference.Show(false)}if($$E(this._ctrAlternateAddress).visible()==false){this._ctrAlternateAddress.Show(true);this._ctrAlternateAddress.Validator.Enable(true)}}else{if($$E(this._fsrblMailingPreference).visible()==true){this._fsrblMailingPreference.Hide(false)}if($$E(this._ctrAlternateAddress).visible()==true){this._ctrAlternateAddress.Hide(true);this._ctrAlternateAddress.Validator.Disable(true)}}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrPermanentAddress.Bind(null);this._ftxtPhoneHome.Bind(null);this._fsrblbHasAlternateAddress.Bind(null);this._fsrblMailingPreference.Bind(null);this._ctrAlternateAddress.Bind(null)},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if(!$$CM.isNull(b)){this._ctrPermanentAddress.Bind(b.AddressPermanent);this._ftxtPhoneHome.Bind(b.PhoneHome);var a=$$CM.addressExists(b.AddressAlternate);this._fsrblbHasAlternateAddress.Bind(a);this._ctrAlternateAddress.Bind(b.AddressAlternate);this._fsrblMailingPreference.Bind(b.MailingPreference)}this.onHasAlternateAddressChanged()},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.AddressPermanent=this._ctrPermanentAddress.GetData();a.PhoneHome=this._ftxtPhoneHome.GetData();var b=this._fsrblbHasAlternateAddress.GetData();if(b==true){a.MailingPreference=parseInt(this._fsrblMailingPreference.GetData());a.AddressAlternate=this._ctrAlternateAddress.GetData()}else{a.MailingPreference=1;a.AddressAlternate=null}return a}});"cm.ui.forms".namespace();cm.ui.forms.PersonHouseholdUPRConfigOptions=Class.create(cm.ConfigOptions,{title:"Person Household",existingStatus:0,a1Required:true,a2Required:false});cm.ui.forms.PersonHouseholdUPR=Class.create(cm.ui.ComplexControl,{PrimaryAddressChangedEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.PersonHouseholdUPRConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();this._settings=this._co.settings;if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._existingStatus=this._co.existingStatus;this._countryArray=$A();if(!$$CM.isArray(cm.dao.Lists.Data.CountryArray)){this._countryArray=cm.dao.Lists.Data.CountryArray}this._stateArray=$A();if(!$$CM.isArray(cm.dao.Lists.Data.StateArray)){this._stateArray=cm.dao.Lists.Data.StateArray}this._enumAddressType=cm.dao.Lists.Enums.AddressType.asEnum();this._enumAddressEntityType=cm.dao.Lists.Enums.AddressEntityType.asEnum();this._enumEntityTypeFlag=cm.dao.Lists.Enums.EntityTypeFlag.asEnum();this._tabIndex=0;this._entityAddressGroupName="entityAddress_"+this._uniqueID;this._headerTitle=this._co.headerTitle;this._headerMessage=this._co.headerMessage;this._headerMessageCssClass=this._co.headerMessageCssClass;this._homePhoneEnabled=this._co.homePhoneEnabled;this._homePhoneRequired=this._co.homePhoneRequired;this._a1Required=this._co.a1Required;this._a1HeaderTitle=this._co.a1HeaderTitle;this._a1HeaderTitleCssClass=this._co.a1HeaderTitleCssClass;this._a1HeaderMessage=this._co.a1HeaderMessage;this._a1HeaderMessageCssClass=this._co.a1HeaderMessageCssClass;this._a1LegendLabel=this._co.a1LegendLabel;this._a1LegendLabelCssClass=this._co.a1LegendLabelCssClass;this._a1HouseholdTypeLabel=this._co.a1HouseholdTypeLabel;this._a1HouseholdTypeDisabled=this._co.a1HouseholdTypeDisabled;this._a2Disabled=this._co.a2Disabled;this._a2Required=this._co.a2Required;this._a2HeaderTitle=this._co.a2HeaderTitle;this._a2HeaderTitleCssClass=this._co.a2HeaderTitleCssClass;this._a2HeaderMessage=this._co.a2HeaderMessage;this._a2HeaderMessageCssClass=this._co.a2HeaderMessageCssClass;this._a2LegendLabel=this._co.a2LegendLabel;this._a2LegendLabelCssClass=this._co.a2LegendLabelCssClass;this._a2HouseholdTypeDisabled=this._co.a2HouseholdTypeDisabled;this._atHomeID=this._enumAddressType.GetId("home");this._atVacationID=this._enumAddressType.GetId("summer");if(!(this._atVacationID>0)){this._atVacationID=this._enumAddressType.GetId("vacation")}this._atBusinessID=this._enumAddressType.GetId("business");this._atSchoolID=this._enumAddressType.GetId("school");this._atOtherID=this._enumAddressType.GetId("other")},initializeUIElements:function(){this.AddClassName("cmFormRow");this._headerTitle=$$CM.convertToEntityLabelString(this._headerTitle,this._entityLabelSettings);this._fsAddresses=new $$FS("Addresses_"+this._uniqueID,{legendLabel:this._headerTitle,legendCssClass:"cmHeaderTitle"});this.AddChild(this._fsAddresses);this._fsAddresses.AddClassName("pt10px");if(!$$CM.isEmpty(this._headerMessage)){this._headerMessage=$$CM.convertToEntityLabelString(this._headerMessage,this._entityLabelSettings);this._ctrHeaderMessage=new cm.ui.forms.SectionMessage("ctrHeaderMessage_"+this._uniqueID,{message:this._headerMessage,cssClass:"cmHeaderMessage"});this._fsAddresses.AddChild(this._ctrHeaderMessage);if(!$$CM.isEmpty(this._headerMessageCssClass)){this._ctrHeaderMessage.AddClassName(this._headerMessageCssClass)}}this._divPrimaryAddress=$$P.div("divPrimaryAddress_"+this._uniqueID);this._fsAddresses.AddChild(this._divPrimaryAddress);this._divPrimaryAddress.AddClassName("cmFormRow");var b=$$CM.uniqueID();var c={uniqueID:b,title:this._a1HeaderTitle,titleCssClass:this._a1HeaderTitleCssClass,instructions:this._a1HeaderMessage,instructionsCssClass:this._a1HeaderMessageCssClass,legendLabel:this._a1LegendLabel,legendCssClass:this._a1LegendLabelCssClass,householdTypeLabel:this._a1HouseholdTypeLabel,householdTypeDisabled:this._a1HouseholdTypeDisabled,required:this._a1Required,countryArray:this._countryArray,stateArray:this._stateArray,groupFieldName:"Permanent Address",initialTabIndex:++this._tabIndex,defaultCountry:$$CLIENT.Country};this._ctrPrimaryAddress=new cm.ui.forms.PersonAddress("divPrimaryAddress_"+b,c);this._divPrimaryAddress.AddChild(this._ctrPrimaryAddress);this._ctrPrimaryAddress.TypeChangedEvent.subscribe(this.onTypeChanged,this);this._divEntityAddressListWrapper=$$P.div("divEntityAddressListWrapper_"+this._uniqueID);this._divPrimaryAddress.AddChild(this._divEntityAddressListWrapper);this._divEntityAddressListWrapper.AddClassName("cmFormRow");this._divEntityAddressListWrapper.Hide();this._divEntityAddressListHeader=$$P.div("divEntityAddressListHeader_"+this._uniqueID);this._divEntityAddressListWrapper.AddChild(this._divEntityAddressListHeader);this._divEntityAddressListHeader.AddClassName("cmFormRow mb10px");this._divEntityAddressListHeader.UpdateInnerHtml("<span class='cmBold cmRequiredField'>Please select your primary address. This is the address to which we will send mail.</span>");this._divEntityAddressList=$$P.div("divEntityAddressList_"+this._uniqueID);this._divEntityAddressListWrapper.AddChild(this._divEntityAddressList);this._divEntityAddressList.AddClassName("cmFormRow");this._divEntityAddressAdd=$$P.div("divEntityAddressList_"+this._uniqueID);this._divEntityAddressListWrapper.AddChild(this._divEntityAddressAdd);this._divEntityAddressAdd.AddClassName("cmFormRow");this._btnEntityAddressAdd=new $$BTN("btnEntityAddressAdd_"+this._uniqueID,{text:"Add New Address"});this._divEntityAddressAdd.AddChild(this._btnEntityAddressAdd);this._btnEntityAddressAdd.AddClassName("cmGoButton cmFloatRight");this._btnEntityAddressAdd.ClickEvent.subscribe(this.onEntityAddressEdit,this);this._divPhoneHome=$$P.div("divPhoneHome");this._divPrimaryAddress.AddChild(this._divPhoneHome);this._divPhoneHome.AddClassName("cmFormRow");this._ftxtPhoneHome=new $$FTXT("ftxtContactInfoPhoneHome",{label:"Home Phone",isRequired:this._homePhoneRequired,maxLength:15});this._divPhoneHome.AddChild(this._ftxtPhoneHome);this._ftxtPhoneHome.SetTabIndex(7);this._ftxtPhoneHome.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Home Phone",IsRequired:this._homePhoneRequired}));if(!this._homePhoneEnabled){this._divPhoneHome.Hide();this._ftxtPhoneHome.Hide()}this._fsrblbHasAlternateAddress=new $$FSRBLB("fsrblHasAlternateAddress",{legendLabel:"At any point during the year do you reside at an alternate address?",legendCssClass:"cmLegendBasic w100prct",isRequired:true,initialTabIndex:9});this._fsAddresses.AddChild(this._fsrblbHasAlternateAddress);this._fsrblbHasAlternateAddress.AddClassName("cmFormRow mt10px mb20px_");this._fsrblbHasAlternateAddress.SelectionChangedEvent.subscribe(this.onHasAlternateAddressChanged,this);this._fsrblbHasAlternateAddress.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Alternate Address Question",IsRequired:true,AlwaysEvaluate:true}),this._fsrblbHasAlternateAddress.SelectionChangedEvent);if(this._a2Disabled==true){this._fsrblbHasAlternateAddress.Hide()}this._divAlternateAddress=$$P.div("divAlternateAddress_"+this._uniqueID);this._fsAddresses.AddChild(this._divAlternateAddress);this._divAlternateAddress.AddClassName("cmExpand mt10px mb20px_ w510px");this._divAlternateAddress.Hide();var b=$$CM.uniqueID();var a={uniqueID:b,title:this._a2HeaderTitle,titleCssClass:this._a2HeaderTitleCssClass,instructions:this._a2HeaderMessage,instructionsCssClass:this._a2HeaderMessageCssClass,legendLabel:this._a2LegendLabel,legendCssClass:this._a2LegendLabelCssClass,householdTypeLabel:this._a2HouseholdTypeLabel,householdTypeDisabled:this._a2HouseholdTypeDisabled,required:this._a2Required,countryArray:this._countryArray,defaultCountry:$$CLIENT.Country,stateArray:this._stateArray,groupFieldName:"Alternate Address",initialTabIndex:11};this._ctrAlternateAddress=new cm.ui.forms.PersonAddress("divAlternateAddress_"+b,a);this._divAlternateAddress.AddChild(this._ctrAlternateAddress);this._ctrAlternateAddress.TypeChangedEvent.subscribe(this.onTypeChanged,this);this.initializeModals()},initializeModals:function(){this._divModals=$$P.div("divModals_"+this._uniqueID);this.AddChild(this._divModals);var a=$A();a.push({ID:this._enumAddressType.GetId("Business"),Name:"Business"});a.push({ID:this._enumAddressType.GetId("School"),Name:"School"});a.push({ID:this._enumAddressType.GetId("Other"),Name:"Other"});this._ctrEntityAddressEdit=new cm.ui.common.EntityAddress("ctrEntityAddress_"+this._uniqueID,{disableAddressEntity:true,addressTypeArray:a});this._ctrEntityAddressEdit.SaveEvent.subscribe(this.onEntityAddressSave,this);this._ctrEntityAddressEdit.CancelEvent.subscribe(this.onEntityAddressCancel,this);this._mdlEntityAddressEdit=new cm.ui.dialog.ModalDialog("mdlEntityAddressEdit_"+this._uniqueID,{title:"Entity Address Edit",width:530,draggable:false,dialogClass:"cmEditDialog"});this._divModals.AddChild(this._mdlEntityAddressEdit);this._mdlEntityAddressEdit.AddChild(this._ctrEntityAddressEdit);this._divModals.Hide()},createEvents:function($super){$super();this.PrimaryAddressChangedEvent=new cm.event()},wireEvents:function($super){$super();this.PrimaryAddressChangedEvent.subscribe(this.onPrimaryAddressChanged,this)},onPrimaryAddressChanged:function(c,a){var b=a.data},onHasAlternateAddressChanged:function(c,a){var b=this._fsrblbHasAlternateAddress.GetData();if(b==true){if($$E(this._divAlternateAddress).visible()==false){this._divAlternateAddress.Show(true);this._divAlternateAddress.Validator.Enable(true)}}else{if($$E(this._divAlternateAddress).visible()==true){this._divAlternateAddress.Hide(true);this._divAlternateAddress.Validator.Disable(true)}}},onTypeChanged:function(b,a){if(this._ctrPrimaryAddress.GetHouseholdTypeID()==this._enumEntityTypeFlag.GetId("family")&&this._ctrAlternateAddress.GetHouseholdTypeID()==this._enumEntityTypeFlag.GetId("family")){this._ctrAlternateAddress.TogglePrimaryHouseholdSummerAddress(true)}else{this._ctrAlternateAddress.TogglePrimaryHouseholdSummerAddress(false)}},bindEntityAddressArray:function(c){this._divEntityAddressList.DestroyChildControls(true);this._ctrEntityAddressRowArray=$A();var f=$A();var e=$A();if(!$$CM.isNull(c)){f=c.HouseholdList;e=c.ModifyEntityAddressList;primaryEntityAddressID=c.PrimaryEntityAddressID;if($$CM.isArray(e)&&e.length>0){e.each(function(g){g.SortKey=$$CM.getFormattedOrderIndex(g.TypeID,3)+"_"+$$CM.getFormattedOrderIndex(g.AddressTypeID,3)},this);e=e.sort($$CM.sortBySortKey);this._hasAddresses=true;this._ctrPrimaryAddress.Hide();this._fsrblbHasAlternateAddress.Hide();this._divAlternateAddress.Hide();this._divEntityAddressList.Show();e.each(function(i){if(!$$CM.isNull(i.Address)){var h=new cm.ui.forms.personhouseholdupr.EntityAddressRow("ctrEntityAddressRow_"+$$CM.uniqueID(),{data:i,groupName:this._entityAddressGroupName,cssClassName:"cmFormRow"});this._divEntityAddressList.AddChild(h);this._ctrEntityAddressRowArray.push(h);h.SelectEvent.subscribe(this.onEntityAddressSelect,this);h.EditEvent.subscribe(this.onEntityAddressEdit,this);h.DeleteEvent.subscribe(this.onEntityAddressDelete,this);var g=(Number(i.ID)==Number(primaryEntityAddressID));h.SetChecked(g)}},this)}var b=this._ctrEntityAddressRowArray.find(function(g){return g.IsChecked()==true},this);if($$CM.isNull(b)&&$$CM.isArray(this._ctrEntityAddressRowArray)&&this._ctrEntityAddressRowArray.length>0){var a=this._ctrEntityAddressRowArray.find(function(g){var h=g.GetData();return h.TypeID==this._enumEntityTypeFlag.GetId("family")&&h.AddressTypeID==this._enumAddressType.GetId("home")},this);if(!$$CM.isNull(a)){a.SetChecked(true);var d=a.GetData();if(!$$CM.isNull(d)){c.PrimaryEntityAddressID=d.ID}}}}},onEntityAddressSelect:function(c,a){var b=a.data;this.selectEntityAddress(b);this.PrimaryAddressChangedEvent.fire(this,{data:b})},onEntityAddressEdit:function(d,a){var c=null;if(!$$CM.isNull(a)&&!$$CM.isNull(a.data)){c=a.data}else{var e=this.getTempID();var b="US";if(!$$CM.isNull($$CLIENT.Country)){b=$$CLIENT.Country}c={ID:e,EID:0,EntityID:0,AddressID:e,AddressTypeID:this._enumAddressType.GetId("other"),TypeID:this._enumEntityTypeFlag.GetId("person"),Address:{ID:e,Country:b}}}this.showEntityAddressEdit(c)},onEntityAddressSave:function(c,a){var b=a.data;this.modifyEntityAddress(b);this.hideEntityAddressEdit()},onEntityAddressCancel:function(b,a){this.hideEntityAddressEdit()},onEntityAddressDelete:function(c,a){var b=a.data;this.removeEntityAddress(b)},showEntityAddressEdit:function(b){var a=this.GetBoundData();this._ctrEntityAddressEdit.SetMasterEntityAddressList(a.ModifyEntityAddressList);this._ctrEntityAddressEdit.Bind(b);this._mdlEntityAddressEdit.Show()},hideEntityAddressEdit:function(){this._mdlEntityAddressEdit.Hide()},selectEntityAddress:function(b){if(!$$CM.isNull(b)){var a=this.GetData();a.PrimaryEntityAddressID=b.ID;this.Bind(a)}},modifyEntityAddress:function(b){if(!$$CM.isNull(b)){var a=this.GetData();var c=$A();a.ModifyEntityAddressList.each(function(d){if(d.ID!=b.ID){c.push(d)}},this);c.push(b);a.ModifyEntityAddressList=c;this.Bind(a)}},removeEntityAddress:function(b){if(!$$CM.isNull(b)){var a=this.GetData();var c=$A();a.ModifyEntityAddressList.each(function(d){if(d.ID!=b.ID){c.push(d)}},this);a.ModifyEntityAddressList=c;this.Bind(a)}},getTempID:function(){var b=0;var a=this.GetData();if($$CM.isArray(this._ctrEntityAddressRowArray)){this._ctrEntityAddressRowArray.each(function(c){var d=c.GetData();if(!$$CM.isNull(d)&&d.ID<b){b=d.ID}},this)}return b-1},Validate:function(b){var c=this.Validator.validate();if(this._hasAddresses==true){var a=this._ctrEntityAddressRowArray.find(function(e){return e.IsChecked()==true},this);if($$CM.isNull(a)){var d=new cm.validation.ValidationResult("",null);d.AddError("Please select your primary address to which we will send mail.");c.AppendResult(d)}}if(b==true){this.Validator.ShowErrors(c)}return c},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._hasAddresses=false;this._ctrPrimaryAddress.Bind();this._ftxtPhoneHome.Bind();this._fsrblbHasAlternateAddress.Bind(false);this._ctrAlternateAddress.Bind();this._divEntityAddressList.DestroyChildControls(true);this._ctrEntityAddressRowArray=$A();this._ctrPrimaryAddress.Show();if(this._a2Disabled==true){this._fsrblbHasAlternateAddress.Hide();this._divAlternateAddress.Hide()}else{this._fsrblbHasAlternateAddress.Show();this._divAlternateAddress.Show()}this._divEntityAddressList.Hide()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this.bindEntityAddressArray(a);this._ftxtPhoneHome.Bind(a.PhoneHome)}if(this._hasAddresses!=true){this.onHasAlternateAddressChanged()}else{this._divEntityAddressListWrapper.Show()}},GetPrimaryEntityAddressID:function(){var c=null;if($$CM.isArray(this._ctrEntityAddressRowArray)){var a=this._ctrEntityAddressRowArray.find(function(d){return d.IsChecked()==true},this);if(!$$CM.isNull(a)){var b=a.GetData();if(!$$CM.isNull(b)){c=b.ID}}}return c},GetData:function(){var f=this.GetBoundData();if($$CM.isNull(f)){f=new Object()}if(!$$CM.isArray(f.ModifyEntityAddressList)){f.ModifyEntityAddressList=$A()}if(this._hasAddresses!=true){var j=this._ctrPrimaryAddress.GetData();var k=this._enumEntityTypeFlag.GetId("family");var i=this._enumAddressType.GetId("home");var h=this._enumAddressEntityType.GetId("family");if(Number(j.HouseholdTypeID)==Number(this._enumEntityTypeFlag.GetId("family"))){h=this._enumAddressEntityType.GetId("family1")}else{if(Number(j.HouseholdTypeID)==Number(this._enumEntityTypeFlag.GetId("person"))){h=this._enumAddressEntityType.GetId("person")}}var l=$$CADU.SetEntityAddress(null,j.Address,j.EntityID,k,i,h);l.IsPrimary=true;f.ModifyEntityAddressList.push(l);var g=this._fsrblbHasAlternateAddress.GetData();if(g==true){var c=this._ctrAlternateAddress.GetData();var d=this._enumEntityTypeFlag.GetId("family");var b=this._atVacationID;var a=this._enumAddressEntityType.GetId("family");if(Number(j.HouseholdTypeID)==Number(this._enumEntityTypeFlag.GetId("family"))){if(Number(c.HouseholdTypeID)==Number(this._enumEntityTypeFlag.GetId("family"))){if(c.PrimaryHouseholdSummerAddress==true){b=this._atVacationID;a=this._enumAddressEntityType.GetId("family1")}else{b=this._atHomeID;a=this._enumAddressEntityType.GetId("family2")}}else{b=this._atHomeID}}else{if(Number(c.HouseholdTypeID)==Number(this._enumEntityTypeFlag.GetId("family"))){b=this._enumAddressType.GetId("home");a=this._enumAddressEntityType.GetId("family1")}}if(!(b==this._atVacationID&&$$CM.addressEmptyIgnoreCountry(c.Address))){var e=$$CADU.SetEntityAddress(null,c.Address,c.EntityID,d,b,a);f.ModifyEntityAddressList.push(e)}}}else{f.PrimaryEntityAddressID=this.GetPrimaryEntityAddressID();if(!$$CM.isNumber(f.PrimaryEntityAddressID)||Number(f.PrimaryEntityAddressID)<0){f.ModifyEntityAddressList=$A();if($$CM.isArray(this._ctrEntityAddressRowArray)){this._ctrEntityAddressRowArray.each(function(m){var n=m.GetData();if(!$$CM.isNull(n)){var o=m.IsChecked()==true;if(o){n.IsPrimary=true}f.ModifyEntityAddressList.push(n)}},this)}}}f.PhoneHome=this._ftxtPhoneHome.GetData();f.MailingPreference=1;return f}});"cm.ui.forms.personhouseholdupr".namespace();cm.ui.forms.personhouseholdupr.EntityAddressRow=Class.create(cm.ui.Control,{SelectEvent:null,EditEvent:null,DeleteEvent:null,initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._groupName=this._co.groupName;this._enumAddressType=cm.dao.Lists.Enums.AddressType.asEnum();this._enumAddressEntityType=cm.dao.Lists.Enums.AddressEntityType.asEnum();this._enumEntityTypeFlag=cm.dao.Lists.Enums.EntityTypeFlag.asEnum();if($$CM.isEmpty(this._co.cssClassName)){this._co.cssClassName=""}this._data=this._co.data;this._aetPerson=this._enumAddressEntityType.GetId("person");this._aetFamily=this._enumAddressEntityType.GetId("family");this._aetFamily1=this._enumAddressEntityType.GetId("family1");this._aetFamily2=this._enumAddressEntityType.GetId("family2");this._atHomeID=this._enumAddressType.GetId("home");this._atVacationID=this._enumAddressType.GetId("summer");if(!(this._atVacationID>0)){this._atVacationID=this._enumAddressType.GetId("vacation")}this._atBusinessID=this._enumAddressType.GetId("business");this._atSchoolID=this._enumAddressType.GetId("school");this._atOtherID=this._enumAddressType.GetId("other");this._editable=true;this._deletable=true;if(!$$CM.isNull(this._data)){if(this._data.InUse==true){this._editable=false;this._deletable=false}else{if(this._data.ID>0){this._deletable=false}}}},initializeUIElements:function(){this.AddClassName(this._co.cssClassName);this._divWrapper=$$P.div("divWrapper_"+this._uniqueID);this.AddChild(this._divWrapper);this._divWrapper.AddClassName("cmFormRow");this._divAddress=$$P.div("divAddress_"+this._uniqueID);this._divWrapper.AddChild(this._divAddress);this._divAddress.AddClassName("cmFloatLeft w350px");var a=this.GetAddressLabel();var b="";if(!$$CM.isEmpty((a))){if(this._data.TypeID==this._enumEntityTypeFlag.GetId("person")&&!$$CM.isEmpty(this._data.EntityName)){a+=" ("+this._data.EntityName+")"}b+="<b>"+a+"</b>"}if(!$$CM.isNull((this._data.Address))){if(b.length>0){b+="<br/>"}b+=$$CM.getFormattedAddress(this._data.Address)}this._frbAddress=new $$FRB("frbAddress_"+this._uniqueID+"_"+this._data.AddressID,{value:this._data.AddressID,label:b,name:this._groupName,labelClass:"w100prct pt0px",labelCssClass:"w350px",inputCssClass:"mt4px",spanWidth:300});this._divAddress.AddChild(this._frbAddress);this._divButtons=$$P.div("divButtons_"+this._uniqueID);this._divWrapper.AddChild(this._divButtons);this._divButtons.AddClassName("cmFloatRight w100px");if(this._editable!=true&&this._deletable!=true){this._divButtons.Hide()}this._btnDelete=new $$A("btnDelete_"+this._uniqueID,{text:""});this._divButtons.AddChild(this._btnDelete);this._btnDelete.AddClassName("cmFloatRight cmIconDelete mr5px");if(this._deletable!=true){this._btnDelete.Hide()}this._btnEdit=new $$A("btnEdit_"+this._uniqueID,{text:""});this._divButtons.AddChild(this._btnEdit);this._btnEdit.AddClassName("cmFloatRight cmIconEdit mr5px");if(this._editable!=true){this._btnEdit.Hide()}var c=$$P.div("divSeparator");this.AddChild(c);c.AddClassName("w100prct cmSeparator")},createEvents:function($super){$super();this.SelectEvent=new cm.event();this.EditEvent=new cm.event();this.DeleteEvent=new cm.event()},wireEvents:function($super){$super();this._frbAddress.ChangeEvent.subscribe(this.onSelect,this);this._btnEdit.ClickEvent.subscribe(this.onEdit,this);this._btnDelete.ClickEvent.subscribe(this.onDelete,this)},onSelect:function(c,a){var b=this.GetData();this.SelectEvent.fire(this,{data:b})},onEdit:function(c,a){var b=this.GetData();this.EditEvent.fire(this,{data:b})},onDelete:function(c,a){var b={title:"Confirm",message:"This address will be deleted permanently.  Do you want to continue?",handlerOk:this.onDeleteOK,handlerCancel:this.onDeleteCancel,dialogClass:"alert",scope:this};$$CMD.Confirm(b)},onDeleteOK:function(c,a){var b=this.GetData();this.DeleteEvent.fire(this,{data:b})},onDeleteCancel:function(b,a){},IsChecked:function(){return this._frbAddress.IsChecked()},SetChecked:function(a){this._frbAddress.SetChecked(a)},GetAddressLabel:function(){var a="";var b=this.GetData();if(!$$CM.isNull(b)){if(this._data.AddressEntityTypeID==this._aetPerson){a+=""}else{if(this._data.AddressEntityTypeID==this._aetFamily){a+="Principal Household: "}else{if(this._data.AddressEntityTypeID==this._aetFamily1){a+="Primary Childhood: "}else{if(this._data.AddressEntityTypeID==this._aetFamily2){a+="Alternate Childhood: "}}}}if((this._data.AddressTypeID&this._atHomeID)==this._atHomeID){a+="Home Address"}else{if((this._data.AddressTypeID&this._atVacationID)==this._atVacationID){a+="Summer Address"}else{if((this._data.AddressTypeID&this._atBusinessID)==this._atBusinessID){a+="Business Address"}else{if((this._data.AddressTypeID&this._atSchoolID)==this._atSchoolID){a+="School Address"}else{if(!$$CM.isEmpty(this._data.Label)){a+=this._data.Label}}}}}}return a},GetData:function(){var a=this._data;return a}});"cm.ui.forms".namespace();cm.ui.common.PreviousExperienceConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"",legendCssClass:"cmSectionHeader",organizationName:"Camp",employmentOrganizationExperienceRequireFlag:false});cm.ui.forms.PreviousExperience=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.common.PreviousExperienceConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._organizationNameLowerCase="camp";this._organizationNameTitleCase="Camp";if(!$$CM.isEmpty(this._cfo.organizationName)){var a=this._cfo.organizationName;this._organizationNameLowerCase=a.toLowerCase();this._organizationNameTitleCase=this._organizationNameLowerCase.substring(0,1).toUpperCase()+this._organizationNameLowerCase.substring(1)}},initializeUIElements:function(){var b=this.ID();this.AddClassName("w100prct");this._fsPreviousExperience=new $$FS(b,{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsPreviousExperience);this._fsPreviousExperience.AddClassName("pt10px");this._fsrblbHasOrganizationalExperience=new $$FSRBLB("fsrbl"+b+"HasOrganizationalExperience",{legendLabel:"Have you ever worked at or attended another "+this._organizationNameLowerCase+"?",legendCssClass:"cmLegendBasic w100prct",isRequired:this._cfo.employmentOrganizationExperienceRequireFlag});this._fsPreviousExperience.AddChild(this._fsrblbHasOrganizationalExperience);this._fsrblbHasOrganizationalExperience.AddClassName("cmFormRow mb10px");this._fsrblbHasOrganizationalExperience.SelectionChangedEvent.subscribe(this.onHasOrganizationalExperienceChanged,this);if(this._cfo.employmentOrganizationExperienceRequireFlag){this._fsrblbHasOrganizationalExperience.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Previous "+this._organizationNameTitleCase+" Experience",IsRequired:true,AlwaysEvaluate:true}),this._fsrblbHasOrganizationalExperience.SelectionChangedEvent)}this._divPreviousExperienceNotes=$$P.div("div"+b+"PreviousExperienceNotes");this._fsPreviousExperience.AddChild(this._divPreviousExperienceNotes);this._divPreviousExperienceNotes.AddClassName("cmFormRow w525px");this._ftxaOrganizationalExperienceNotes=new $$FTXA("_ftxa"+b+"HasOrganizationalExperienceNotes",{label:"Please provide details",isRequired:this._cfo.employmentOrganizationExperienceRequireFlag,maxLength:500,fieldTip:"500 Char Max"});this._divPreviousExperienceNotes.AddChild(this._ftxaOrganizationalExperienceNotes);this._ftxaOrganizationalExperienceNotes.AddClassName("cmInputLabel w525px");this._ftxaOrganizationalExperienceNotes.GetTitleControl().AddClassName("cmInputText w505px cmTopLabel");this._ftxaOrganizationalExperienceNotes.GetInputControl().AddClassName("w505px");this._ftxaOrganizationalExperienceNotes.GetFieldTipControl().AssignStyle("margin-left","0px");if(this._cfo.employmentOrganizationExperienceRequireFlag){this._ftxaOrganizationalExperienceNotes.Validator.addEvaluator($$EVAL.TEXT({FieldName:this._organizationNameTitleCase+" Experience Details",IsRequired:true}));this._ftxaOrganizationalExperienceNotes.Validator.Disable()}this._ftxaOrganizationalExperienceNotes.Hide();var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mb20px")},onHasOrganizationalExperienceChanged:function(b,a){this.toggleOrganizationalExperienceNotes(true)},toggleOrganizationalExperienceNotes:function(a){var b=this._fsrblbHasOrganizationalExperience.GetData();if(b==true){this._ftxaOrganizationalExperienceNotes.Show(a);if(this._cfo.employmentOrganizationExperienceRequireFlag){this._ftxaOrganizationalExperienceNotes.Validator.Enable()}}else{if($$E(this._ftxaOrganizationalExperienceNotes).visible()==true){this._ftxaOrganizationalExperienceNotes.Hide(a);if(this._cfo.employmentOrganizationExperienceRequireFlag){this._ftxaOrganizationalExperienceNotes.Validator.Disable()}}}},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fsrblbHasOrganizationalExperience.Bind(null);this._ftxaOrganizationalExperienceNotes.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fsrblbHasOrganizationalExperience.Bind(a.HasOrganizationalExperience);this._ftxaOrganizationalExperienceNotes.Bind(a.OrganizationalExperienceNotes);this.toggleOrganizationalExperienceNotes(false)}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.HasOrganizationalExperience=this._fsrblbHasOrganizationalExperience.GetData();if(a.HasOrganizationalExperience==true){a.OrganizationalExperienceNotes=this._ftxaOrganizationalExperienceNotes.GetData()}else{a.OrganizationalExperienceNotes=""}return a}});"cm.ui.forms".namespace();cm.ui.forms.PromotionAssignmentWidgetConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Promotions & Coupons",legendCssClass:"",optionalMessage:null,optionalMessageCssClass:null,initialTabIndex:0});cm.ui.forms.PromotionAssignmentWidget=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.PromotionAssignmentWidgetConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._title=this._co.legendLabel;this._titleCssClass=this._co.legendCssClass;this._headerMessage=this._co.optionalMessage;this._headerMessageCssClass=this._co.optionalMessageCssClass;this._promotionAssignmentArray=$A()},initializeUIElements:function(){var a=this.GetConfigOptions().initialTabIndex;this._fsWrapper=new $$FS("fsWrapper_"+this._uniqueID,{cssClass:"mt10px",legendLabel:this._title,legendCssClass:this._titleCssClass});this.AddChild(this._fsWrapper);if(!$$CM.isEmpty(this._headerMessage)){this._ctrHeaderMessage=new cm.ui.forms.SectionMessage("divHeaderMessage_"+this._uniqueID,{message:this._headerMessage,cssClass:"cmClear mt10px mb20px"});this._fsWrapper.AddChild(this._ctrHeaderMessage);if(!$$CM.isEmpty(this._headerMessageCssClass)){this._ctrHeaderMessage.AddClassName(this._headerMessageCssClass)}}this._divAddPromotionAssignment=$$P.div("divAddPromotionAssignment_"+this._uniqueID);this._fsWrapper.AddChild(this._divAddPromotionAssignment);this._divAddPromotionAssignment.AddClassName("cmFormRow");this._btnAddPromotionAssignment=new $$BTN("btnAddPromotionAssignment_"+this._uniqueID,{text:"Add Promo Code"});this._divAddPromotionAssignment.AddChild(this._btnAddPromotionAssignment);this._btnAddPromotionAssignment.AddClassName("cmGoButton cmFloatRight");this._ctrPromotionAssignmentEdit=new cm.ui.forms.PromotionAssignmentEdit("ctrPromotionAssignmentEdit_"+this._uniqueID,{});this._fsWrapper.AddChild(this._ctrPromotionAssignmentEdit);this._ctrPromotionAssignmentEdit.Hide();this._ctrPromotionAssignmentEdit.CancelEvent.subscribe(this.onPromotionAssignmentCancel,this);this._ctrPromotionAssignmentEdit.SaveEvent.subscribe(this.onPromotionAssignmentSave,this);this._divPromotionAssignments=$$P.div("divPromotionAssignments_"+this._uniqueID);this._fsWrapper.AddChild(this._divPromotionAssignments);this._divPromotionAssignments.AddClassName("cmFormRow");this._divPromotionAssignments.Hide();this._pPromotionAssignmentsMessage=$$P.p("pPromotionAssignmentsMessage_"+this._uniqueID);this._divPromotionAssignments.AddChild(this._pPromotionAssignmentsMessage);this._pPromotionAssignmentsMessage.AddClassName("mb10px cmFloatLeft");this._pPromotionAssignmentsMessage.UpdateInnerHtml("You've applied the following promotions");this._divPromotionAssignmentList=$$P.div("divPromotionAssignmentList_"+this._uniqueID);this._divPromotionAssignments.AddChild(this._divPromotionAssignmentList);this._divPromotionAssignmentList.AddClassName("cmFormRow")},createEvents:function($super){$super();this.PromotionAssignmentEditEvent=new cm.event();this.PromotionAssignmentCancelEvent=new cm.event();this.PromotionAssignmentSaveEvent=new cm.event();this.PromotionAssignmentDeleteEvent=new cm.event()},wireEvents:function($super){$super();this._btnAddPromotionAssignment.ClickEvent.subscribe(this.onPromotionAssignmentAdd,this)},onPromotionAssignmentAdd:function(b,a){this.togglePromotionAssignmentEdit(true)},onPromotionAssignmentCancel:function(b,a){this.togglePromotionAssignmentEdit(false);this.PromotionAssignmentCancelEvent.fire(this,{})},onPromotionAssignmentSave:function(c,a){var b=this._ctrPromotionAssignmentEdit.GetData();this.PromotionAssignmentSaveEvent.fire(this,{data:b})},onPromotionAssignmentDelete:function(c,a){var b=null;if(!$$CM.isNull(c)){b=c.GetData()}this.PromotionAssignmentDeleteEvent.fire(this,{data:b})},togglePromotionAssignmentEdit:function(a){if(a){var b=this.GetPersonArray();this._ctrPromotionAssignmentEdit.BindApplicantArray(b);this._divAddPromotionAssignment.Hide(true);this._ctrPromotionAssignmentEdit.Show(true)}else{this._ctrPromotionAssignmentEdit.Bind();this._divAddPromotionAssignment.Show(true);this._ctrPromotionAssignmentEdit.Hide(true)}this._btnAddPromotionAssignment.SetEnabled(!a);this._divPromotionAssignments.SetEnabled(!a);this.PromotionAssignmentEditEvent.fire(this,{edit:a})},renderPromotionAssignmentArray:function(c){this._divPromotionAssignmentList.DestroyChildControls(true);this._ctrPromotionAssignmentArray=$A();if($$CM.isArray(c)&&c.length>0){this._divPromotionAssignments.Show();var a="cmOdd";var b=0;c.each(function(e){var d=new cm.ui.forms.PromotionAssignment("",{cssClassName:a,index:++b,data:e});this._divPromotionAssignmentList.AddChild(d);this._ctrPromotionAssignmentArray.push(d);d.DeleteEvent.subscribe(this.onPromotionAssignmentDelete,this);if(a=="cmEven"){a="cmOdd"}else{a="cmEven"}},this)}else{this._divPromotionAssignments.Hide()}},BindPersonArray:function(a){this._personArray=$A();if($$CM.isArray(a)){this._personArray=a;this._ctrPromotionAssignmentEdit.BindApplicantArray(this._personArray)}},GetPersonArray:function(){if(!$$CM.isArray(this._personArray)){this._personArray=$A()}return this._personArray},ClearFields:function(){this.Validator.Clear()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();this.renderPromotionAssignmentArray(a);this.togglePromotionAssignmentEdit(false)},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}return a}});cm.ui.forms.PromotionAssignment=Class.create(cm.ui.Control,{initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._cssClassName=this._co.cssClassName;this._index=this._co.index;this._data={};if(!$$CM.isNull(this._co.data)){this._data=this._co.data}var e="";var b="";if(this._data.EntityID>0){if(this._data.EntityTypeFlagID==1){var d=$$FAPU.GetPerson(this._data.EntityID);if(!$$CM.isNull(d)&&!$$CM.isNull(d.Name)){b=d.Name.FullName}}else{if(this._data.EntityTypeFlagID==2){b="Family"}}}if(!$$CM.isEmpty(b)){e+="<b>"+b+"</b> | "}if(!$$CM.isEmpty(this._data.Name)&&!$$CM.isEmpty(this._data.PromotionCode)){e+=this._data.Name+" ("+this._data.PromotionCode+")"}if(!$$CM.isEmpty(this._data.ExpiresAsString)){var a=new $$CMDATE(this._data.ExpiresAsString);var c=a.getFormattedDate(true,true,false,false,false);e+=" <div class='cmSubtle mt2px'>Valid thru "+c+"</span>"}this._promotionDetails=e},initializeUIElements:function(){this.AddClassName("cmFormRow p5px w515px");if(!$$CM.isEmpty(this._cssClassName)){this.AddClassName(this._cssClassName)}this._divIndex=$$P.div();this.AddChild(this._divIndex);this._divIndex.AddClassName("cmFloatLeft w25px cmBold");this._divIndex.UpdateInnerHtml(this._index+".");this._divDetails=$$P.div();this.AddChild(this._divDetails);this._divDetails.AddClassName("cmFloatLeft w470px");this._divDetails.UpdateInnerHtml(this._promotionDetails);this._divButtons=$$P.div();this.AddChild(this._divButtons);this._divButtons.AddClassName("cmFloatRight w20px");if(this._data.InUse!=true&&this._data.InDB!=true){this._lnkDelete=new $$A("lnkDelete_"+this._uniqueID,{text:"",classNames:"cmIconDelete cmFloatRight mr0px"});this._divButtons.AddChild(this._lnkDelete);this._lnkDelete.ClickEvent.subscribe(this.onDelete,this)}},createEvents:function($super){$super();this.DeleteEvent=new cm.event()},wireEvents:function($super){$super()},onDelete:function(d,a){var c=this.GetData();var b={title:"Alert",message:"Your promotion will be deleted permanently. Are you sure you want to continue?",handlerOk:this.onDelete_confirm,handlerCancel:this.onDelete_cancel,cssClass:"cmAlertDialog",scope:this,args:{data:c}};$$CMD.Confirm(b)},onDelete_confirm:function(c,a){if(!$$CM.isNull(a)&&!$$CM.isNull(a.data)){var b=a.data;this.DeleteEvent.fire(this,{data:b})}},onDelete_cancel:function(b,a){},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},GetData:function(){return this._data}});cm.ui.forms.PromotionAssignmentEdit=Class.create(cm.ui.ComplexControl,{initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}},initializeUIElements:function(){this.AddClassName("cmPromotionAssignmentWidget");this._divWrapper=$$P.div();this.AddChild(this._divWrapper);this._divWrapper.AddClassName("controls");this._h3Title=$$P.h3();this._divWrapper.AddChild(this._h3Title);this._h3Title.AddClassName("mt0px mb10px");this._h3Title.UpdateInnerHtml("Promotion/Coupon");this._divControls=$$P.div();this._divWrapper.AddChild(this._divControls);this._divControls.AddClassName("cmFormRow");this._ftxtCode=new $$FTXT("ftxtCode_"+this._uniqueID,{label:"Code",maxLength:25,isRequired:true});this._divControls.AddChild(this._ftxtCode);this._ftxtCode.GetTitleControl().AddClassName("w50px");this._ftxtCode.GetInputControl().AddClassName("w100px");this._ftxtCode.AddClassName("w40prct");this._ftxtCode.Validator.addEvaluator($$EVAL.TEXT({FieldName:"Code",IsRequired:true}));this._fddlApplicant=new $$FDDL("fddlApplicant_"+this._uniqueID,{label:"Applicant",isRequired:true});this._divControls.AddChild(this._fddlApplicant);this._fddlApplicant.GetTitleControl().AddClassName("w75px");this._fddlApplicant.GetInputControl().AddClassName("w225px");this._fddlApplicant.AddClassName("w60prct");this._fddlApplicant.Validator.addEvaluator($$EVAL.SELECT({FieldName:"Applicant",IsRequired:true}));this._divButtons=$$P.div();this._divWrapper.AddChild(this._divButtons);this._divButtons.AddClassName("cmFormRow mt10px");this._btnCancel=new $$BTN("btnCancel_"+this._uniqueID,{text:"Cancel",classNames:"cmCancelDeleteButton"});this._divButtons.AddChild(this._btnCancel);this._btnSave=new $$BTN("btnSave_"+this._uniqueID,{text:"Save",classNames:"cmGoButton cmFloatRight"});this._divButtons.AddChild(this._btnSave)},createEvents:function($super){$super();this.CancelEvent=new cm.event();this.SaveEvent=new cm.event()},wireEvents:function($super){$super();this._ftxtCode.BlurEvent.subscribe(this.onBlur,this);this._fddlApplicant.BlurEvent.subscribe(this.onBlur,this);this._btnCancel.ClickEvent.subscribe(this.onCancel,this);this._btnSave.ClickEvent.subscribe(this.onSave,this)},onBlur:function(b,a){this._ftxtCode.RemoveClassName("cmValidationError");this._fddlApplicant.RemoveClassName("cmValidationError")},onCancel:function(b,a){this.CancelEvent.fire(this,{})},onSave:function(c,a){if(this.IsValid(true)){var b=this.GetData();this.SaveEvent.fire(this,{data:b})}},BindApplicantArray:function(a){this._applicantArray=$A();if($$CM.isArray(a)){a.each(function(c){var b=c.Name.FullName;this._applicantArray.push({ID:c.PersonID,Name:b})},this)}this._fddlApplicant.bindList(this._applicantArray,"Select","Select an Applicant")},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ftxtCode.SetEnabled(true);this._ftxtCode.Bind()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){}},GetData:function(){var a={};a.Code=this._ftxtCode.GetData();a.PersonID=this._fddlApplicant.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.PromotionsWidgetConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Promotions & Coupons",legendCssClass:"",optionalMessage:null,optionalMessageCssClass:null,initialTabIndex:0});cm.ui.forms.PromotionsWidget=Class.create(cm.ui.ComplexControl,{ApplyPromotionCodeEvent:null,configureDefaultOptions:function(){return new cm.ui.forms.PromotionsWidgetConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}this._promotionAssignmentArray=$A()},initializeUIElements:function(){var a=this.GetConfigOptions().initialTabIndex;this._fsWrapper=new $$FS("divWrapper_"+this._uniqueID,{legendLabel:this._co.legendLabel,legendCssClass:this._co.legendCssClass});this.AddChild(this._fsWrapper);this._fsWrapper.AddClassName("pt10px");this._divPromotionCodeWrapper=$$P.div("divPromotionCodeWrapper_"+this._uniqueID);this._fsWrapper.AddChild(this._divPromotionCodeWrapper);this._divPromotionCodeWrapper.AddClassName("cmFormRow");this._promoCodeOptionalMessage=new cm.ui.forms.SectionMessage("promoCodeOptionalMessage_"+this._uniqueID,{message:this._co.optionalMessage,cssClass:this._co.optionalMessageCssClass+" mt0px"});this._divPromotionCodeWrapper.AddChild(this._promoCodeOptionalMessage);this._divPromotionCode=$$P.div("divPromotionCode_"+this._uniqueID);this._divPromotionCodeWrapper.AddChild(this._divPromotionCode);this._divPromotionCode.AddClassName("cmFormRow");this._ftxtPromotionCode=new $$FTXT("ftxtPromotionCode_"+this._uniqueID,{label:"Promotional Code/Coupon",spanWidth:"200",maxLength:25});this._divPromotionCode.AddChild(this._ftxtPromotionCode);this._ftxtPromotionCode.GetTitleControl().AddClassName("w200px");this._ftxtPromotionCode.GetInputControl().AddClassName("w150px");this._ftxtPromotionCode.AddClassName("w365px");this._btnApplyPromotionCode=new $$BTN("btnApplyPromotionCode_"+this._uniqueID,{text:"Apply Promotion"});this._divPromotionCode.AddChild(this._btnApplyPromotionCode);this._btnApplyPromotionCode.AddClassName("cmGoButton mt1px");this._divPromotionListWrapper=$$P.div("divPromotionListWrapper_"+this._uniqueID);this._fsWrapper.AddChild(this._divPromotionListWrapper);this._divPromotionListWrapper.AddClassName("cmFormRow");this._divPromotionListWrapper.Hide();this._pPromotionListMessage=$$P.p("pPromotionListMessage_"+this._uniqueID);this._divPromotionListWrapper.AddChild(this._pPromotionListMessage);this._pPromotionListMessage.AddClassName("mb10px cmFloatLeft");this._pPromotionListMessage.UpdateInnerHtml("You've applied the following promotions");this._divPromotionList=$$P.div("divPromotionList_"+this._uniqueID);this._divPromotionListWrapper.AddChild(this._divPromotionList);this._divPromotionList.AddClassName("cmFormRow")},createEvents:function($super){$super();this.ApplyPromotionCodeEvent=new cm.event()},wireEvents:function($super){$super();this._ftxtPromotionCode.FocusEvent.subscribe(this.onPromotionCodeFocus,this);this._btnApplyPromotionCode.ClickEvent.subscribe(this.onApplyPromotionCode,this)},onPromotionCodeFocus:function(b,a){this._ftxtPromotionCode.RemoveClassName("cmValidationError")},onApplyPromotionCode:function(c,a){if(this.IsValid(true)){var b=this._ftxtPromotionCode.GetData();this.ApplyPromotionCodeEvent.fire(this,{promotionCode:b,scope:this,callback:this.onApplyPromotionCode_callback})}},onApplyPromotionCode_callback:function(a){if(!$$CM.isNull(a)){var f=a.IsValid;var g=a.Message;if(f==true){var h=a;var j=this._promotionAssignmentArray.find(function(k){return k.PromotionCode==h.PromotionCode},this);if($$CM.isNull(j)){var c=h.EntityTypeFlagID;var i=this._promotionAssignmentArray.find(function(k){return k.EntityTypeFlagID==c},this);if($$CM.isNull(i)){this._promotionAssignmentArray.push(h);this.RenderPromotionArray();this._ftxtPromotionCode.Bind()}else{var d="person";if(c==2){d="family"}var b={title:"Promotion Code Error",header:"",message:"You've already selected one <b>"+d+"</b> promotion code. Please enter different promotion code.",width:550};$$CMD.Alert(b)}}else{var b={title:"Promotion Code Error",header:"",message:"You've already selected this promotion code. Please enter different promotion code.",width:550};$$CMD.Alert(b)}}else{var e=(!$$CM.isEmpty(g))?g:"You've entered invalid promotion code, or it is not applicable based on your selection. Please enter valid promotion code.";var b={title:"Promotion Code Error",header:"",message:e,width:550};$$CMD.Alert(b)}}},onApplyPromotionCodeCompleted:function(a){var f=a.data.IsValid;var g=a.data.Message;var h=a.data.PromotionAssignment;if(f==true){if(!$$CM.isNull(h)){var j=this._promotionAssignmentArray.find(function(k){return k.PromotionCode==h.PromotionCode},this);if($$CM.isNull(j)){var c=h.EntityTypeFlagID;var i=this._promotionAssignmentArray.find(function(k){return k.EntityTypeFlagID==c},this);if($$CM.isNull(i)){this._promotionAssignmentArray.push(h);this.RenderPromotionArray();this._ftxtPromotionCode.Bind()}else{var d="camper";if(c==2){d="family"}var b={title:"Promotion Code Error",header:"",message:"You've already selected one <b>"+d+"</b> promotion code. Please enter different promotion code.",width:550};$$CMD.Alert(b)}}else{var b={title:"Promotion Code Error",header:"",message:"You've already selected this promotion code. Please enter different promotion code.",width:550};$$CMD.Alert(b)}}}else{var e=(!$$CM.isEmpty(g))?g:"You've entered invalid promotion code, or it is not applicable based on your selection. Please enter valid promotion code.";var b={title:"Promotion Code Error",header:"",message:e,width:550};$$CMD.Alert(b)}},onValidatePromotionCodesCompleted:function(a){var c=$A();var g=a.data;var d="";if($$CM.isArray(g)){var i=g.findAll(function(j){return j.IsValid==true},this);var h=g.findAll(function(j){return j.IsValid!=true},this);if(h.length>0){if(h.length!=1){d="The promotional codes/coupons you've entered are no longer valid"}else{d="The promotional code/coupon you've entered is no longer valid"}h.each(function(m){var l=null;var k=m.PromotionAssignment;if(!$$CM.isNull(k)){l=k.PromotionCode.toUpperCase()}var j="";if(!$$CM.isEmpty(l)){j+="<b>"+l+"</b> - "}if(!$$CM.isEmpty(m.Message)){j+=m.Message}else{j+="is invalid"}c.push(j)},this);var f=this._promotionAssignmentArray.findAll(function(j){return j.InDB==true},this);i.each(function(j){if(!$$CM.isNull(j.PromotionAssignment)){f.push(j.PromotionAssignment)}},this);this._promotionAssignmentArray=f;this.RenderPromotionArray()}}else{d="Validating promotional/coupon codes failed."}if(c.length>0){var e="<div class='cmformRow mb10px cmBold'>"+d+"</div>";e+='<ul class="mt0px mb0px pl15px">';c.each(function(j){e+="<li>"+j+"</li>"});e+="</ul>";var b={title:"Promotional/Coupon Code(s) Validation",header:"",message:e,width:500};$$CMD.Alert(b)}},RenderPromotionArray:function(){this._divPromotionList.DestroyChildControls(true);if($$CM.isArray(this._promotionAssignmentArray)&&this._promotionAssignmentArray.length>0){if(this._promotionAssignmentArray.length<2){this._divPromotionCodeWrapper.Show()}else{this._divPromotionCodeWrapper.Hide()}this._divPromotionListWrapper.Show();var a="cmOdd";var b=1;this._promotionAssignmentArray.each(function(i){if(a=="cmEven"){a="cmOdd"}else{a="cmEven"}var e=$$P.div();this._divPromotionList.AddChild(e);e.AddClassName("cmFormRow p5px w515px");e.AddClassName(a);var g=$$P.div();e.AddChild(g);g.AddClassName("cmFloatLeft");var j="<b>"+b+".</b> ";if(!$$CM.isEmpty(i.Name)&&!$$CM.isEmpty(i.PromotionCode)){j+=i.Name+" ("+i.PromotionCode+")"}if(!$$CM.isEmpty(i.ExpiresAsString)){var d=new $$CMDATE(i.ExpiresAsString);var h=d.getFormattedDate(false,true,false,false,false);j+=" | Valid thru "+h}g.UpdateInnerHtml(j);var f=$$P.div();e.AddChild(f);f.AddClassName("cmFloatRight w100px");var c=new $$A("btnPromotionRemove",{text:"Remove",promotionAssignment:i});f.AddChild(c);c.AddClassName("cmFloatRight");c.ClickEvent.subscribe(this.onPromotionRemoveClicked,this);if(i.InDB==true){c.Hide()}b++},this)}else{this._divPromotionCodeWrapper.Show();this._divPromotionListWrapper.Hide()}},onPromotionRemoveClicked:function(d,a){var b=null;if(!$$CM.isNull(d)){b=d.GetConfigOptions().promotionAssignment}if(!$$CM.isNull(b)){var c=$A();this._promotionAssignmentArray.each(function(e){if(e.PromotionCode!=b.PromotionCode){c.push(e)}},this);this._promotionAssignmentArray=c;this.RenderPromotionArray()}},Validate:function(b){var c=new cm.validation.ValidationResult("Promotional Code/Coupon",null);this._ftxtPromotionCode.RemoveClassName("cmValidationError");var a=this._ftxtPromotionCode.GetData();if($$CM.isEmpty(a)){c.AddError("Field is required");this._ftxtPromotionCode.AddClassName("cmValidationError")}if(b==true){this.Validator.ShowErrors(c)}return c},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._promotionAssignmentArray=$A();this._divPromotionList.DestroyChildControls(true);this._ftxtPromotionCode.Bind()},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){this._promotionAssignmentArray=a}this.RenderPromotionArray()},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}a=this._promotionAssignmentArray;return a}});"cm.ui.forms".namespace();cm.ui.common.ReferenceConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"",legendCssClass:"cmLegendBasic cmSubSectionHeader mb10px cmInlineLegend w300px",required:false,phoneRequireFlag:false,emailRequireFlag:false,addressShowFlag:false,existingStatus:0});cm.ui.forms.Reference=Class.create(cm.ui.ComplexControl,{RemoveEvent:null,configureDefaultOptions:function(){return new cm.ui.common.ReferenceConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._countryArray=cm.dao.Lists.Data.CountryArray;this._stateArray=cm.dao.Lists.Data.StateArray;this._phoneRequireFlag=this._cfo.phoneRequireFlag;this._emailRequireFlag=this._cfo.emailRequireFlag;this._addressShowFlag=this._cfo.addressShowFlag;this._existingStatus=this._cfo.existingStatus;this.OrderIndex=this._cfo.orderIndex;this.Required=this._cfo.required;this.InDB=false;this.FileExists=false;this.ReferenceNumber=this.OrderIndex+1;this.ReferenceLabel=this._cfo.legendLabel+" #"+this.ReferenceNumber},initializeUIElements:function(){this.UniqueKey=this.ID();var c="_"+this.UniqueKey+"_";this._fsReference=new $$FS(c,{legendLabel:this.ReferenceLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsReference);this._fsReference.AddClassName("pt10px pb10px mb20px cmUnderline");this._btnRemove=new $$A("aRemove",{text:"Remove"});this._fsReference.AddChild(this._btnRemove);this._btnRemove.AddClassName("cmFloatRight");if(this._cfo.required==true){this._btnRemove.Hide()}var b=$$P.div();this._fsReference.AddChild(b);b.AddClassName("cmClear");this._divGeneralFields=$$P.div("div"+c+"GeneralFields");this._fsReference.AddChild(this._divGeneralFields);this._divGeneralFields.AddClassName("cmFormRow");this._ftxtFirstName=new $$FTXT("ftxt"+c+"FirstName",{name:this.ReferenceLabel+" - First Name",label:"First Name",isRequired:this.Required==true,maxLength:50});this._divGeneralFields.AddChild(this._ftxtFirstName);this._ftxtFirstName.AddClassName("mb5px");this._ftxtFirstName.Validator.addEvaluator($$EVAL.STRING({IsRequired:this.Required==true}));this._ftxtLastName=new $$FTXT("ftxt"+c+"LastName",{name:this.ReferenceLabel+" - Last Name",label:"Last Name",isRequired:this.Required==true,maxLength:50});this._divGeneralFields.AddChild(this._ftxtLastName);this._ftxtLastName.AddClassName("mb5px");this._ftxtLastName.Validator.addEvaluator($$EVAL.STRING({IsRequired:this.Required==true}));this._ftxtRelationship=new $$FTXT("ftxt"+c+"Relationship",{name:this.ReferenceLabel+" - Relationship",label:"Relationship",isRequired:this.Required==true,maxLength:50});this._divGeneralFields.AddChild(this._ftxtRelationship);this._ftxtRelationship.AddClassName("mb5px");this._ftxtRelationship.Validator.addEvaluator($$EVAL.STRING({IsRequired:this.Required==true}));this._ftxtEmail=new $$FEMAIL("ftxt"+c+"Email",{name:this.ReferenceLabel+" - Email",label:"Email",isRequired:(this.Required==true&&this._emailRequireFlag==true),maxLength:100});this._divGeneralFields.AddChild(this._ftxtEmail);this._ftxtEmail.AddClassName("mb5px");this._ftxtEmail.Validator.addEvaluator($$EVAL.EMAIL({IsRequired:(this.Required==true&&this._emailRequireFlag==true)}));this._ftxtPhone=new $$FTXT("ftxt"+c+"Phone",{name:this.ReferenceLabel+" - Phone",label:"Phone",isRequired:(this.Required==true&&this._phoneRequireFlag==true),maxLength:50});this._divGeneralFields.AddChild(this._ftxtPhone);this._ftxtPhone.AddClassName("mb5px");this._ftxtPhone.Validator.addEvaluator($$EVAL.STRING({IsRequired:(this.Required==true&&this._phoneRequireFlag==true)}));this._ftxtYearsKnown=new $$FTXT("ftxt"+c+"YearsKnown",{name:this.ReferenceLabel+" - Years Known",label:"Years Known",maxLength:50});this._divGeneralFields.AddChild(this._ftxtYearsKnown);this._ftxtYearsKnown.AddClassName("mb5px");this._ftxtCompany=new $$FTXT("ftxt"+c+"Company",{name:this.ReferenceLabel+" - Company",label:"Company",maxLength:50});this._divGeneralFields.AddChild(this._ftxtCompany);this._ftxtCompany.AddClassName("mb5px");this._ftxtTitle=new $$FTXT("ftxt"+c+"Title",{name:this.ReferenceLabel+" - Title",label:"Title",maxLength:50});this._divGeneralFields.AddChild(this._ftxtTitle);this._ftxtTitle.AddClassName("mb5px");var a=$$CM.uniqueID();this._ctrAddress=new $$FADDRESS("divAddress_"+a,{uniqueID:a,required:false,countryArray:this._countryArray,stateArray:this._stateArray,defaultCountry:this.Required==true?$$CLIENT.Country:""});this._fsReference.AddChild(this._ctrAddress);if(this._addressShowFlag!=true){this._ctrAddress.Hide()}this._divDoNotContact=$$P.div("div"+c+"DoNotContact");this._fsReference.AddChild(this._divDoNotContact);this._divDoNotContact.AddClassName("cmFormRow");this._fcbDoNotContact=new $$FCB("fcb"+c+"DoNotContact",{value:"",name:this.ReferenceLabel+" - Do not contact this reference yet",label:"Do not contact this reference yet",name:c+"DoNotContact"});this._divDoNotContact.AddChild(this._fcbDoNotContact);this._fcbDoNotContact.AddClassName("cmBool w520px");this._fcbDoNotContact.GetTitleControl().RemoveClassName("cmCheckboxTitleBase");this._fcbDoNotContact.GetTitleControl().AddClassName("cmBold w500px");this._fcbDoNotContact.ChangeEvent.subscribe(this.onDoNotContactChanged,this);this._divContactNotes=$$P.div("div"+c+"DoNotContactNotes");this._fsReference.AddChild(this._divContactNotes);this._divContactNotes.AddClassName("cmFormRow w520px");this._ftxaDoNotContactNotes=new $$FTXA("ftxa"+c+"DoNotContactNotes",{name:this.ReferenceLabel+" - Reason",label:"Reason",isRequired:true,maxLength:3000,fieldTip:"3000 Char Max"});this._divContactNotes.AddChild(this._ftxaDoNotContactNotes);this._ftxaDoNotContactNotes.AddClassName("cmInputLabel w520px");this._ftxaDoNotContactNotes.GetInputControl().AddClassName("w390px");this._ftxaDoNotContactNotes.Validator.addEvaluator($$EVAL.STRING({IsRequired:true}));this._ftxaDoNotContactNotes.Hide();this._ftxaDoNotContactNotes.Validator.Disable();var b=$$P.div();this._fsReference.AddChild(b);b.AddClassName("cmClear");this.SetTabIndex()},createEvents:function(){this.RemoveEvent=new cm.event()},wireEvents:function($super){$super();this._btnRemove.ClickEvent.subscribe(this.onRemoveClicked,this)},RefreshLabels:function(a){this.ReferenceNumber=this.OrderIndex+1;this.ReferenceLabel=this._cfo.legendLabel+" #"+this.ReferenceNumber;this._fsReference.GetLegendControl().UpdateInnerHtml(this.ReferenceLabel);this._ftxtFirstName.GetConfigOptions().Set("name",this.ReferenceLabel+" - First Name");this._ftxtLastName.GetConfigOptions().Set("name",this.ReferenceLabel+" - Last Name");this._ftxtRelationship.GetConfigOptions().Set("name",this.ReferenceLabel+" - Relationship");this._ftxaDoNotContactNotes.GetConfigOptions().Set("name",this.ReferenceLabel+" - Reason");this.SetTabIndex()},SetTabIndex:function(a){var a=(this.OrderIndex*18)+1;this._btnRemove.SetTabIndex(a);this._ftxtFirstName.SetTabIndex(++a);this._ftxtLastName.SetTabIndex(++a);this._ftxtRelationship.SetTabIndex(++a);this._ftxtEmail.SetTabIndex(++a);this._ftxtPhone.SetTabIndex(++a);this._ftxtYearsKnown.SetTabIndex(++a);this._ftxtCompany.SetTabIndex(++a);this._ftxtTitle.SetTabIndex(++a);this._ctrAddress.SetTabIndex(++a);a=a+7;this._fcbDoNotContact.SetTabIndex(++a);this._ftxaDoNotContactNotes.SetTabIndex(++a)},onRemoveClicked:function(c,a){var b={title:"Delete Reference?",header:"This will permanently delete this reference.",message:"Are you sure you want to continue?",handlerOk:this.onRemoveConfirmed,scope:this,width:300,cssClass:"cmAlertDialog"};$$CMD.Confirm(b)},onRemoveConfirmed:function(){this.RemoveEvent.fire(this,{uniqueKey:this.UniqueKey})},onDoNotContactChanged:function(b,a){this.toggleDoNotContactNotes(true)},toggleDoNotContactNotes:function(a){var b=this._fcbDoNotContact.GetData();if(b==true){this._ftxaDoNotContactNotes.Show(a);this._ftxaDoNotContactNotes.Validator.Enable()}else{if($$E(this._ftxaDoNotContactNotes).visible()==true){this._ftxaDoNotContactNotes.Hide(a);this._ftxaDoNotContactNotes.Validator.Disable()}}},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=this.ValidateIncomplete();if(c.IsValid()!=true){b.AppendResult(c)}}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ValidateIncomplete:function(){var b=true;b=(this.InDB!=true);var g=new cm.validation.ValidationResult("");if(this.Required!=true){var c=this._ftxtFirstName.GetData();this._ftxtFirstName.RemoveClassName("cmValidationError");if($$CM.isEmpty(c)&&this.PartiallyFilled()&&b){g.AddError("<b>"+this.ReferenceLabel+" - First Name:</b> Field is required");this._ftxtFirstName.AddClassName("cmValidationError")}var d=this._ftxtLastName.GetData();this._ftxtLastName.RemoveClassName("cmValidationError");if($$CM.isEmpty(d)&&this.PartiallyFilled()&&b){g.AddError("<b>"+this.ReferenceLabel+" - Last Name:</b> Field is required");this._ftxtLastName.AddClassName("cmValidationError")}var f=this._ftxtRelationship.GetData();this._ftxtRelationship.RemoveClassName("cmValidationError");if($$CM.isEmpty(f)&&this.PartiallyFilled()){g.AddError("<b>"+this.ReferenceLabel+" - Relationship:</b> Field is required");this._ftxtRelationship.AddClassName("cmValidationError")}if(this._emailRequireFlag==true){var a=this._ftxtEmail.GetData();this._ftxtEmail.RemoveClassName("cmValidationError");if($$CM.isEmpty(a)&&this.PartiallyFilled()&&b){g.AddError("<b>"+this.ReferenceLabel+" - Email:</b> Field is required");this._ftxtEmail.AddClassName("cmValidationError")}}if(this._phoneRequireFlag==true){var e=this._ftxtPhone.GetData();this._ftxtPhone.RemoveClassName("cmValidationError");if($$CM.isEmpty(e)&&this.PartiallyFilled()&&b&&!this.FileExists){g.AddError("<b>"+this.ReferenceLabel+" - Phone:</b> Field is required");this._ftxtPhone.AddClassName("cmValidationError")}}}return g},PartiallyFilled:function(){var b=false;if(!$$CM.isEmpty(this._ftxtFirstName.GetData())){return true}if(!$$CM.isEmpty(this._ftxtLastName.GetData())){return true}if(!$$CM.isEmpty(this._ftxtRelationship.GetData())){return true}if(!$$CM.isEmpty(this._ftxtEmail.GetData())){return true}if(!$$CM.isEmpty(this._ftxtPhone.GetData())){return true}if(!$$CM.isEmpty(this._ftxtYearsKnown.GetData())){return true}if(!$$CM.isEmpty(this._ftxtCompany.GetData())){return true}if(!$$CM.isEmpty(this._ftxtTitle.GetData())){return true}if(this._addressShowFlag==true){var a=this._ctrAddress.GetData();if(!$$CM.isEmpty(a.AddressLine1)){return true}if(!$$CM.isEmpty(a.AddressLine2)){return true}if(!$$CM.isEmpty(a.City)){return true}if(!$$CM.isEmpty(a.StateProvince)){return true}if(!$$CM.isEmpty(a.PostalCode)){return true}if(!$$CM.isEmpty(a.Zip)){return true}if(!$$CM.isEmpty(a.Country)){return true}}if(this._fcbDoNotContact.GetData()==true){return true}return b},ClearFields:function(){this.Validator.Clear();this._ftxtFirstName.Bind(null);this._ftxtLastName.Bind(null);this._ftxtPhone.Bind(null);this._ftxtEmail.Bind(null);this._ftxtRelationship.Bind(null);this._ftxtYearsKnown.Bind(null);this._ftxtCompany.Bind(null);this._ftxtTitle.Bind(null);this._ctrAddress.Bind(null);this._fcbDoNotContact.Bind(null);this._ftxaDoNotContactNotes.Bind(null)},onDataUpdated:function(){this.ClearFields();this.InDB=false;this.FileExists=false;var a=this.GetBoundData();if(!$$CM.isNull(a)){this._ftxtFirstName.Bind(a.FirstName);this._ftxtLastName.Bind(a.LastName);this._ftxtPhone.Bind(a.Phone);this._ftxtEmail.Bind(a.Email);this._ftxtRelationship.Bind(a.Relationship);this._ftxtYearsKnown.Bind(a.YearsKnown);this._ftxtCompany.Bind(a.Company);this._ftxtTitle.Bind(a.Title);this._ctrAddress.Bind(a.Address);this._fcbDoNotContact.Bind(a.DoNotContact);this._ftxaDoNotContactNotes.Bind(a.DoNotContactNotes);if(a.InDB==true){this.InDB=true}if(!$$CM.isEmpty(a.FileName)){this.FileExists=true}if(this.FileExists){this._btnRemove.Hide()}}this.toggleDoNotContactNotes(false);this.toggleRestrictions(a)},toggleRestrictions:function(a){var b=true;b=(this.InDB!=true);if(b||(!$$CM.isNull(a)&&$$CM.isEmpty(a.FirstName))){this._ftxtFirstName.SetEnabled(true)}else{this._ftxtFirstName.SetEnabled(false);this._ftxtFirstName.Validator.Disable()}if(b||(!$$CM.isNull(a)&&$$CM.isEmpty(a.LastName))){this._ftxtLastName.SetEnabled(true)}else{this._ftxtLastName.SetEnabled(false);this._ftxtLastName.Validator.Disable()}if(b||(!$$CM.isNull(a)&&$$CM.isEmpty(a.Email))){this._ftxtEmail.SetEnabled(true)}else{this._ftxtEmail.SetEnabled(false);this._ftxtEmail.Validator.Disable()}if((b&&!this.FileExists)||(!$$CM.isNull(a)&&$$CM.isEmpty(a.Phone))){this._ftxtPhone.SetEnabled(true)}else{this._ftxtPhone.SetEnabled(false);this._ftxtPhone.Validator.Disable()}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}if($$CM.isNull(a.IsChecked)){a.IsChecked=false}a.FirstName=this._ftxtFirstName.GetData();a.LastName=this._ftxtLastName.GetData();a.Phone=this._ftxtPhone.GetData();a.Email=this._ftxtEmail.GetData();a.Relationship=this._ftxtRelationship.GetData();a.YearsKnown=this._ftxtYearsKnown.GetData();a.Company=this._ftxtCompany.GetData();a.Title=this._ftxtTitle.GetData();if(this._addressShowFlag==true){a.Address=this._ctrAddress.GetData()}a.DoNotContact=this._fcbDoNotContact.GetData();if(a.DoNotContact==true){a.DoNotContactNotes=this._ftxaDoNotContactNotes.GetData()}else{a.DoNotContactNotes=""}a.OrderIndex=this.OrderIndex;return a}});"cm.ui.forms".namespace();cm.ui.forms.ReferenceListConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"References",legendCssClass:"cmSectionHeader",referencesDisplayed:0,referencesRequired:0,referencesMaximum:6,phoneRequireFlag:true,emailRequireFlag:true,addressShowFlag:false,existingStatus:0});cm.ui.forms.ReferenceList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.ReferenceListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._referencesDisplayed=this._cfo.referencesDisplayed;this._referencesRequired=this._cfo.referencesRequired;this._referencesMaximum=this._cfo.referencesMaximum;this._phoneRequireFlag=this._cfo.phoneRequireFlag;this._emailRequireFlag=this._cfo.emailRequireFlag;this._addressShowFlag=this._cfo.addressShowFlag;this._existingStatus=this._cfo.existingStatus;this._ctrReferenceArray=$A();this._deletedReferenceDataArray=$A()},getReferenceConfigOptions:function(){var a={legendLabel:"Reference Information",legendCssClass:"cmLegendBasic cmSubSectionHeader mb15px cmInlineLegend w300px",required:false,phoneRequireFlag:this._cfo.phoneRequireFlag,emailRequireFlag:this._cfo.emailRequireFlag,addressShowFlag:this._cfo.addressShowFlag,countryArray:this._cfo.countryArray,stateArray:this._cfo.stateArray,existingStatus:this._existingStatus};return a},initializeUIElements:function(){var b=this.ID();this._fsReferenceContainer=new $$FS("ReferenceContainer",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass});this.AddChild(this._fsReferenceContainer);this._fsReferenceContainer.AddClassName("pt10px");this._divReferences=$$P.div("divReferences");this._fsReferenceContainer.AddChild(this._divReferences);this._divReferences.AddClassName("cmFormRow");this._divAddReference=$$P.div("divAddReference");this._fsReferenceContainer.AddChild(this._divAddReference);this._divAddReference.AddClassName("");this._btnAddReference=new $$BTN("btnAddReference",{text:"Add Reference"});this._divAddReference.AddChild(this._btnAddReference);this._btnAddReference.AddClassName("cmGoButton cmFloatRight");var a=$$P.div();this.AddChild(a);a.AddClassName("cmFormRow mtb10px");this.renderReferences()},wireEvents:function($super){$super();this._btnAddReference.ClickEvent.subscribe(this.onAddReferenceClicked,this)},renderReferences:function(){for(var a=1;a<=this._referencesDisplayed;a++){var b=(a<=this._referencesRequired);this.AddReference(b,null)}},onAddReferenceClicked:function(){this.AddReference(false,null)},AddReference:function(e,d){if(this._ctrReferenceArray.length<this._referencesMaximum){var b=this._ctrReferenceArray.length;var c=this.getReferenceConfigOptions();c.orderIndex=b;c.required=e;var a=new cm.ui.forms.Reference($$CM.uniqueID(),c);this._divReferences.AddChild(a);a.RemoveEvent.subscribe(this.onReferenceRemoved,this);this._ctrReferenceArray.push(a);if(!$$CM.isNull(d)){a.Bind(d)}}this.toggleAddButton()},toggleAddButton:function(){if(this._ctrReferenceArray.length<this._referencesMaximum){this._divAddReference.Show(false)}else{this._divAddReference.Hide(false)}},onReferenceRemoved:function(d,a){var e=a.uniqueKey;var c=0;var b=$A();this._ctrReferenceArray.each(function(f){if(f.UniqueKey==e){if(f.InDB==true){var g=f.GetData();g.Deleted=true;this._deletedReferenceDataArray.push(g)}}else{f.OrderIndex=c;c++;b.push(f)}},this);this._ctrReferenceArray=b;this.refreshReferenceControls();this.toggleAddButton()},refreshReferenceControls:function(){this._divReferences.ClearChildControls(false);this._ctrReferenceArray.each(function(a){a.RefreshLabels();this._divReferences.AddChild(a)},this)},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){this._ctrReferenceArray.each(function(c){var d=c.Validate(false);if(d.IsValid()!=true){b.AppendResult(d)}},this)}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrReferenceArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){a.each(function(c){c.SortKey=(!$$CM.isEmpty(c.FileName))?(0+"_"+c.OrderIndex):(1+"_"+c.OrderIndex)},this);a=a.sort($$CM.sortBySortKey);var b=0;a.each(function(d){if(d.Deleted!=true){var c=null;if(b<this._ctrReferenceArray.length){c=this._ctrReferenceArray[b]}if(!$$CM.isNull(c)){c.Bind(d)}else{this.AddReference(false,d)}b++}},this)}},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}var b=0;var c=$A();this._ctrReferenceArray.each(function(d){var e=d.GetData();if(!$$CM.isNull(e)){if(!$$CM.isEmpty(e.FirstName)&&!$$CM.isEmpty(e.LastName)&&!$$CM.isEmpty(e.Relationship)){e.OrderIndex=b;c.push(e);b++}}},this);this._deletedReferenceDataArray.each(function(d){d.OrderIndex=b;c.push(d);b++},this);a=c;return a}});"cm.ui.forms".namespace();cm.ui.forms.SectionBlockConfigOptions=Class.create(cm.ConfigOptions,{expandable:true,cssClass:"cmFormRow mtb0px",headerCssClass:"cmFormRow mtb0px",dividerCssClass:"cmFormRow mtb0px",contentCssClass:"cmFormRow mtb0px"});cm.ui.forms.SectionBlock=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.forms.CertificationConfigOptions()},initializeData:function($super){$super();this._co=this.GetConfigOptions();if(!$$CM.isEmpty(this._co.uniqueID)){this._uniqueID=this._co.uniqueID}else{this._uniqueID=$$CM.uniqueID()}if($$CM.isEmpty(this._co.cssClass)){this._co.cssClass="cmFormRow mtb0px"}if($$CM.isEmpty(this._co.headerCssClass)){this._co.headerCssClass="cmFormRow mtb0px"}if($$CM.isEmpty(this._co.dividerCssClass)){this._co.dividerCssClass="cmFormRow mtb0px"}if($$CM.isEmpty(this._co.contentCssClass)){this._co.contentCssClass="cmFormRow mtb0px"}},initializeUIElements:function(){this.AddClassName(this._co.cssClass);this._divHeader=$$P.div("divHeader_"+this._uniqueID);this.AddChild(this._divHeader);this._divHeader.AddClassName(this._co.headerCssClass);this._divDivider=$$P.div("divDivider_"+this._uniqueID);this.AddChild(this._divDivider);this._divDivider.AddClassName(this._co.dividerCssClass);this.ToggleExpandable(this._co.expandable);this._lnkExpandCollapse=new $$A("",{text:"expand"});this._divDivider.AddChild(this._lnkExpandCollapse);this._lnkExpandCollapse.AddClassName("cmExpandIcon fs11px");this._divContent=$$P.div("divContent_"+this._uniqueID);this.AddChild(this._divContent);this._divContent.AddClassName(this._co.contentCssClass);this._divContent.Hide()},wireEvents:function($super){$super();this._lnkExpandCollapse.ClickEvent.subscribe(this.onExpandCollapse,this,true)},ToggleExpandable:function(a){if(a==true){this._divDivider.Show()}else{this._divDivider.Hide()}},onExpandCollapse:function(b,a){if(this._isExpanded==true){this.Collapse(true)}else{this.Expand(true)}},Expand:function(a){this._lnkExpandCollapse.Hide();var b={expanded:true,animate:a};this._divContent.Show(a,1000,"blind",{direction:"vertical"},this.onAnimationCompleted,this,b);if(a!=true){this.onAnimationCompleted(b)}},Collapse:function(a){this._lnkExpandCollapse.Hide();var b={expanded:false,animate:a};this._divContent.Hide(a,1000,"blind",{direction:"vertical"},this.onAnimationCompleted,this,b);if(a!=true){this.onAnimationCompleted(b)}},onAnimationCompleted:function(a){if(a.expanded==true){this._isExpanded=true;this._lnkExpandCollapse.RemoveClassName("cmExpandIcon");this._lnkExpandCollapse.AddClassName("cmCollapseIcon");this._lnkExpandCollapse.UpdateInnerHtml("collapse")}else{this._isExpanded=false;this._lnkExpandCollapse.RemoveClassName("cmCollapseIcon");this._lnkExpandCollapse.AddClassName("cmExpandIcon");this._lnkExpandCollapse.UpdateInnerHtml("expand")}this._lnkExpandCollapse.Show(false)},AddHeaderControl:function(a){if(!$$CM.isNull(a)){this._divHeader.AddChild(a)}},ClearHeader:function(){this._divHeader.DestroyChildControls(true)},AddContentControl:function(a){if(!$$CM.isNull(a)){this._divContent.AddChild(a)}},ClearContent:function(){this._divContent.DestroyChildControls(true)}});"cm.ui.forms".namespace();cm.ui.forms.SectionMessageConfigOptions=Class.create(cm.ConfigOptions,{message:"",cssClass:""});cm.ui.forms.SectionMessage=Class.create(cm.ui.Control,{configureDefaultOptions:function(){return new cm.ui.forms.CertificationConfigOptions()},initializeUIElements:function(){this._co=this.GetConfigOptions();this.AddClassName(this._co.cssClass);this.UpdateInnerHtml(this._co.message)}});"cm.ui.forms".namespace();cm.ui.forms.SkillConfigOptions=Class.create(cm.ConfigOptions,{definition:new Object(),skillLevelArray:$A()});cm.ui.forms.Skill=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.SkillConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._definition=this._cfo.definition;this._skillLevelArray=this._cfo.skillLevelArray;this.InDB=false},initializeUIElements:function(){var a=this.ID();this.AddClassName("cmFormRow");this._fsrblSkillLevel=new $$FSRBL(a+"SkillLevel",{legendLabel:this._definition.Name,legendCssClass:"cmLegendBasic cmLegendLeft w200px pt5px",isRequired:true});this._fsrblSkillLevel.AddClassName("w100prct");this.AddChild(this._fsrblSkillLevel);var b=a+"SkillLevel"+$$CM.uniqueID();this._skillLevelArray.each(function(c){this._fsrblSkillLevel.AddFormRadioButton({ID:c.ID,Name:c.Name,GroupName:b})},this);this._fsrblSkillLevel.Validator.addEvaluator($$EVAL.GROUP({FieldName:this._definition.Name+" - Skill Level",IsRequired:true,AlwaysEvaluate:true}),this._fsrblSkillLevel.SelectionChangedEvent)},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._fsrblSkillLevel.Bind(null)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if(!$$CM.isNull(a)){this._fsrblSkillLevel.Bind(a.SkillLevel);if(!$$CM.isEmpty(a.InDB)&&a.InDB==true){this.InDB=true}}else{this._fsrblSkillLevel.Bind(0)}},GetData:function(){var a=this.GetBoundData();if($$CM.isNull(a)){a=new Object()}a.SkillID=parseInt(this._definition.ID);var b=this._fsrblSkillLevel.GetData();if($$CM.isNumber(b)){a.SkillLevel=parseInt(b)}else{a.SkillLevel=0}return a}});"cm.ui.forms".namespace();cm.ui.forms.SkillListConfigOptions=Class.create(cm.ConfigOptions,{legendLabel:"Skills",legendCssClass:"cmSectionHeader",skillArray:$A(),skillLevelArray:$A()});cm.ui.forms.SkillList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.SkillListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._skillArray=this._cfo.skillArray;this._skillLevelArray=this._cfo.skillLevelArray;this._ctrSkillArray=$A()},initializeUIElements:function(){var c=this.ID();var a=this.GetConfigOptions();this._fsSkillList=new $$FS("SkillList",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass+" mb20px"});this.AddChild(this._fsSkillList);this._fsSkillList.AddClassName("pt10px");this._skillArray.each(function(e){var d=new cm.ui.forms.Skill("Skill"+e.ID,{definition:e,skillLevelArray:this._skillLevelArray});this._fsSkillList.AddChild(d);this._ctrSkillArray.push(d)},this);var b=$$P.div();this.AddChild(b);b.AddClassName("cmFormRow mb20px")},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrSkillArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){this._ctrSkillArray.each(function(b){var c=a.find(function(d){return d.SkillID==parseInt(b._definition.ID)},this);b.Bind(c)},this)}},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}var b=$A();this._ctrSkillArray.each(function(c){var d=c.GetData();if(!$$CM.isNull(d)){b.push(d)}},this);a=b;return a}});"cm.ui.forms".namespace();cm.ui.forms.PositionTypeConfigOptions=Class.create(cm.ConfigOptions,{definition:new Object(),groupName:"PositionType"});cm.ui.forms.PositionType=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.PositionTypeConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._definition=new Object();if(!$$CM.isNull(this._cfo.definition)){this._definition=this._cfo.definition}this._definition.GroupName=this._cfo.groupName;this.InDB=false},initializeUIElements:function(){var d=this.ID();var a=this._definition;this.AddClassName("cmFormRow mb20px");this._divLeft=$$P.div("divLeft"+a.ID);this.AddChild(this._divLeft);this._divLeft.AddClassName("w150px cmFloatLeft");this._fcbPositionType=new $$FCB("fcb"+a.GroupName+"_"+a.ID,{value:a.ID,label:a.Name,name:a.GroupName});this._divLeft.AddChild(this._fcbPositionType);this._fcbPositionType.AddClassName("cmBool w150px mt0px pt0px");this._fcbPositionType.GetTitleControl().RemoveClassName("cmCheckboxTitleBase");this._fcbPositionType.GetTitleControl().AddClassName("cmBold w125px pl5px mt0px pt0px");this._fcbPositionType.GetInputControl().AddClassName("pt0px");this._divRight=$$P.div("divRight"+a.ID);this.AddChild(this._divRight);this._divRight.AddClassName("w360px cmFloatLeft pl10px");this._divDescription=$$P.div("divDescriptionAbbreviated"+a.ID);this._divRight.AddChild(this._divDescription);this._spDescription=$$P.span();this._divDescription.AddChild(this._spDescription);var b="";var c="";if(!$$CM.isEmpty(a.Description)){b=a.Description;if(b.length>=160){c=b.substring(0,160)}else{c=b}}this._spDescription.UpdateInnerHtml(c);this._spDescription.AddClassName("cmFloatLeft");this._lnkDescriptionShowMore=new $$A("lnkDescriptionShowMore"+a.ID,{text:"...more"});this._divDescription.AddChild(this._lnkDescriptionShowMore);this._lnkDescriptionShowMore.AddClassName("cmFloatLeft");this._lnkDescriptionShowMore.ClickEvent.subscribe(this.onDescriptionShowMoreClicked,this);if(b.length<=160){this._lnkDescriptionShowMore.Hide()}},onDescriptionShowMoreClicked:function(){var a=this._definition.Description;this._spDescription.UpdateInnerHtml(a);this._lnkDescriptionShowMore.Hide()},onDescriptionShowLessClicked:function(){var a=definition.Description.substring(0,160);this._spDescription.UpdateInnerHtml(a);this._lnkDescriptionShowMore.Show()},IsChecked:function(){return this._fcbPositionType.GetData()},Validate:function(a){var b=this.Validator.validate();if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear()},onDataUpdated:function(){this.ClearFields();var b=this.GetBoundData();if(!$$CM.isNull(b)){var a=(b==this._definition.ID);this._fcbPositionType.SetChecked(a);if(!$$CM.isEmpty(b.InDB)&&b.InDB==true){this.InDB=true}}},GetData:function(){var a=new Object();a.ID=this._definition.ID;a.Applicable=this._fcbPositionType.GetData();return a}});"cm.ui.forms".namespace();cm.ui.forms.PositionTypeListConfigOptions=Class.create(cm.ConfigOptions,{settings:new Object(),existingStatus:0,legendLabel:"Staff Positions",legendCssClass:"",positionTypeArray:$A(),positionsMaximumSelected:1});cm.ui.forms.PositionTypeList=Class.create(cm.ui.ComplexControl,{configureDefaultOptions:function(){return new cm.ui.forms.PositionTypeListConfigOptions()},initializeData:function($super){$super();this._cfo=this.GetConfigOptions();this._positionTypeArray=$A();if($$CM.isArray(this._cfo.positionTypeArray)){this._positionTypeArray=this._cfo.positionTypeArray}if(!$$CM.isArray(this._positionTypeArray)){this._positionTypeArray=this._positionTypeArray.sort($$CM.sortByOrderIndex)}this._ctrPositionTypeArray=$A()},initializeUIElements:function(){var a=this.ID();if($$CM.isArray(this._positionTypeArray)){this._fsPositionTypes=new $$FS("PositionTypeList",{legendLabel:this._cfo.legendLabel,legendCssClass:this._cfo.legendCssClass+" mb20px"});this.AddChild(this._fsPositionTypes);this._fsPositionTypes.AddClassName("pt10px");this._positionTypeArray.each(function(c){var d=true;if(d==true){var b=new cm.ui.forms.PositionType(a+"_"+c.ID,{definition:c,groupName:"PositionType"});this._fsPositionTypes.AddChild(b);this._ctrPositionTypeArray.push(b)}},this)}},ValidateMinimumRequriement:function(){var b=new cm.validation.ValidationResult("");var a=this.GetData();if(!$$CM.isArray(a)||a.length<=0){b.AddError("You must choose at least one <b>staff position</b>")}else{if(a.length>this._cfo.positionsMaximumSelected){b.AddError("You have selected <b>"+a.length+"</b> positions. The most you may select is <b>"+this._cfo.positionsMaximumSelected+"</b>.")}}return b},Validate:function(a){var b=this.Validator.validate();if(b.IsValid()==true){var c=this.ValidateMinimumRequriement();b.AppendResult(c)}if(a==true){this.Validator.ShowErrors(b)}return b},IsValid:function(a){var b=this.Validate(a);return b.IsValid()},ClearFields:function(){this.Validator.Clear();this._ctrPositionTypeArray.each(function(a){a.Bind(null)},this)},onDataUpdated:function(){this.ClearFields();var a=this.GetBoundData();if($$CM.isArray(a)){this._ctrPositionTypeArray.each(function(b){var c=a.find(function(d){return d+""==b._definition.ID},this);b.Bind(c)},this)}},GetData:function(){var a=this.GetBoundData();if(!$$CM.isArray(a)){a=$A()}var b=$A();this._ctrPositionTypeArray.each(function(c){if(c.IsChecked()){var d=c.GetData();if(!$$CM.isNull(d)&&d.Applicable==true){b.push(d.ID)}}},this);a=b;return a}});"cm.ui.forms".namespace();$$FORMSU=cm.ui.forms.Utility={MergeCreditCardChangesToArray:function(c,b){if(!$$CM.isArray(c)){c=$A()}if(!$$CM.isNull(b)){var a=c.find(function(d){return d.ID==b.ID},this);if(!$$CM.isNull(a)){c.remove(a)}c.push(b)}return c},IsCreditCardModified:function(e,d){var a=false;if(!$$CM.isNull(e)&&!$$CM.isNull(d)){if(e.FirstName!=d.FirstName){a=true}if(e.LastName!=d.LastName){a=true}if(!$$CM.isNull(e.ExpirationAsString)&&!$$CM.isNull(d.ExpirationAsString)){var c=moment.utc(e.ExpirationAsString,"YYYY-MM-DD");var b=moment.utc(d.ExpirationAsString,"YYYY-MM-DD");if(c.year()!=b.year()||c.month()!=b.month()){a=true}}if(!$$CM.addressesMatch(e.Address,d.Address,true)){a=true}}return a}};