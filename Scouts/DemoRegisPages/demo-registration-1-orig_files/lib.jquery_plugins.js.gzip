/*
 * jQuery contextMenu - Plugin for simple contextMenu handling
 *
 * Version: 1.5.24
 *
 * Authors: Rodney Rehm, Addy Osmani (patches for FF)
 * Web: http://medialize.github.com/jQuery-contextMenu/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *   GPL v3 http://opensource.org/licenses/GPL-3.0
 *
 */
(function(a,p){a.support.htmlMenuitem=("HTMLMenuItemElement" in window);a.support.htmlCommand=("HTMLCommandElement" in window);a.support.eventSelectstart=("onselectstart" in document.documentElement);var b=null,h=false,c=a(window),d=0,l={},k={},o={},e={selector:null,appendTo:null,trigger:"right",autoHide:false,delay:200,determinePosition:function(r){if(a.ui&&a.ui.position){r.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none")}else{var s=this.offset();s.top+=this.outerHeight();s.left+=this.outerWidth()/2-r.outerWidth()/2;r.css(s)}},position:function(v,B,C){var r=this,u;if(!B&&!C){v.determinePosition.call(this,v.$menu);return}else{if(B==="maintain"&&C==="maintain"){u=v.$menu.position()}else{var z=v.$trigger.parents().andSelf().filter(function(){return a(this).css("position")=="fixed"}).length;if(z){C-=c.scrollTop();B-=c.scrollLeft()}u={top:C,left:B}}}var s=c.scrollTop()+c.height(),w=c.scrollLeft()+c.width(),t=v.$menu.height(),A=v.$menu.width();if(u.top+t>s){u.top-=t}if(u.left+A>w){u.left-=A}v.$menu.css(u)},positionSubmenu:function(r){if(a.ui&&a.ui.position){r.css("display","block").position({my:"left top",at:"right top",of:this,collision:"fit"}).css("display","")}else{var s={top:0,left:this.outerWidth()};r.css(s)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop},callback:null,items:{}},g={timer:null,pageX:null,pageY:null},q=function(r){var t=0,s=r;while(true){t=Math.max(t,parseInt(s.css("z-index"),10)||0);s=s.parent();if(!s||!s.length||"html body".indexOf(s.prop("nodeName").toLowerCase())>-1){break}}return t},f={abortevent:function(r){r.preventDefault();r.stopImmediatePropagation()},contextmenu:function(t){var r=a(this);t.preventDefault();t.stopImmediatePropagation();if(t.data.trigger!="right"&&t.originalEvent){return}if(!r.hasClass("context-menu-disabled")){b=r;if(t.data.build){var s=t.data.build(b,t);if(s===false){return}t.data=a.extend(true,{},e,t.data,s||{});if(!t.data.items||a.isEmptyObject(t.data.items)){if(window.console){(console.error||console.log)("No items specified to show in contextMenu")}throw new Error("No Items sepcified")}t.data.$trigger=b;m.create(t.data)}m.show.call(r,t.data,t.pageX,t.pageY)}},click:function(r){r.preventDefault();r.stopImmediatePropagation();a(this).trigger(a.Event("contextmenu",{data:r.data,pageX:r.pageX,pageY:r.pageY}))},mousedown:function(s){var r=a(this);if(b&&b.length&&!b.is(r)){b.data("contextMenu").$menu.trigger("contextmenu:hide")}if(s.button==2){b=r.data("contextMenuActive",true)}},mouseup:function(s){var r=a(this);if(r.data("contextMenuActive")&&b&&b.length&&b.is(r)&&!r.hasClass("context-menu-disabled")){s.preventDefault();s.stopImmediatePropagation();b=r;r.trigger(a.Event("contextmenu",{data:s.data,pageX:s.pageX,pageY:s.pageY}))}r.removeData("contextMenuActive")},mouseenter:function(u){var t=a(this),s=a(u.relatedTarget),r=a(document);if(s.is(".context-menu-list")||s.closest(".context-menu-list").length){return}if(b&&b.length){return}g.pageX=u.pageX;g.pageY=u.pageY;g.data=u.data;r.on("mousemove.contextMenuShow",f.mousemove);g.timer=setTimeout(function(){g.timer=null;r.off("mousemove.contextMenuShow");b=t;t.trigger(a.Event("contextmenu",{data:g.data,pageX:g.pageX,pageY:g.pageY}))},u.data.delay)},mousemove:function(r){g.pageX=r.pageX;g.pageY=r.pageY},mouseleave:function(s){var r=a(s.relatedTarget);if(r.is(".context-menu-list")||r.closest(".context-menu-list").length){return}try{clearTimeout(g.timer)}catch(s){}g.timer=null},layerClick:function(t){var r=a(this),w=r.data("contextMenuRoot"),u=false,s=t.button,B=t.pageX,C=t.pageY,A,v,z;t.preventDefault();t.stopImmediatePropagation();r.on("mouseup",function(){u=true});setTimeout(function(){var x,y;if((w.trigger=="left"&&s==0)||(w.trigger=="right"&&s==2)){if(document.elementFromPoint){w.$layer.hide();A=document.elementFromPoint(B-c.scrollLeft(),C-c.scrollTop());w.$layer.show();z=[];for(var D in l){z.push(D)}A=a(A).closest(z.join(", "));if(A.length){if(A.is(w.$trigger[0])){w.position.call(w.$trigger,w,B,C);return}}}else{v=w.$trigger.offset();x=a(window);v.top+=x.scrollTop();if(v.top<=t.pageY){v.left+=x.scrollLeft();if(v.left<=t.pageX){v.bottom=v.top+w.$trigger.outerHeight();if(v.bottom>=t.pageY){v.right=v.left+w.$trigger.outerWidth();if(v.right>=t.pageX){w.position.call(w.$trigger,w,B,C);return}}}}}}y=function(E){if(E){E.preventDefault();E.stopImmediatePropagation()}w.$menu.trigger("contextmenu:hide");if(A&&A.length){setTimeout(function(){A.contextMenu({x:B,y:C})},50)}};if(u){y()}else{r.on("mouseup",y)}},50)},keyStop:function(r,s){if(!s.isInput){r.preventDefault()}r.stopPropagation()},key:function(u){var x=b.data("contextMenu")||{},r=x.$menu.children(),t;switch(u.keyCode){case 9:case 38:f.keyStop(u,x);if(x.isInput){if(u.keyCode==9&&u.shiftKey){u.preventDefault();x.$selected&&x.$selected.find("input, textarea, select").blur();x.$menu.trigger("prevcommand");return}else{if(u.keyCode==38&&x.$selected.find("input, textarea, select").prop("type")=="checkbox"){u.preventDefault();return}}}else{if(u.keyCode!=9||u.shiftKey){x.$menu.trigger("prevcommand");return}}case 40:f.keyStop(u,x);if(x.isInput){if(u.keyCode==9){u.preventDefault();x.$selected&&x.$selected.find("input, textarea, select").blur();x.$menu.trigger("nextcommand");return}else{if(u.keyCode==40&&x.$selected.find("input, textarea, select").prop("type")=="checkbox"){u.preventDefault();return}}}else{x.$menu.trigger("nextcommand");return}break;case 37:f.keyStop(u,x);if(x.isInput||!x.$selected||!x.$selected.length){break}if(!x.$selected.parent().hasClass("context-menu-root")){var s=x.$selected.parent().parent();x.$selected.trigger("contextmenu:blur");x.$selected=s;return}break;case 39:f.keyStop(u,x);if(x.isInput||!x.$selected||!x.$selected.length){break}var v=x.$selected.data("contextMenu")||{};if(v.$menu&&x.$selected.hasClass("context-menu-submenu")){x.$selected=null;v.$selected=null;v.$menu.trigger("nextcommand");return}break;case 35:case 36:if(x.$selected&&x.$selected.find("input, textarea, select").length){return}else{(x.$selected&&x.$selected.parent()||x.$menu).children(":not(.disabled, .not-selectable)")[u.keyCode==36?"first":"last"]().trigger("contextmenu:focus");u.preventDefault();return}break;case 13:f.keyStop(u,x);if(x.isInput){if(x.$selected&&!x.$selected.is("textarea, select")){u.preventDefault();return}break}x.$selected&&x.$selected.trigger("mouseup");return;case 32:case 33:case 34:f.keyStop(u,x);return;case 27:f.keyStop(u,x);x.$menu.trigger("contextmenu:hide");return;default:var w=(String.fromCharCode(u.keyCode)).toUpperCase();if(x.accesskeys[w]){x.accesskeys[w].$node.trigger(x.accesskeys[w].$menu?"contextmenu:focus":"mouseup");return}break}u.stopPropagation();x.$selected&&x.$selected.trigger(u)},prevItem:function(w){w.stopPropagation();var x=a(this).data("contextMenu")||{};if(x.$selected){var v=x.$selected;x=x.$selected.parent().data("contextMenu")||{};x.$selected=v}var r=x.$menu.children(),t=!x.$selected||!x.$selected.prev().length?r.last():x.$selected.prev(),u=t;while(t.hasClass("disabled")||t.hasClass("not-selectable")){if(t.prev().length){t=t.prev()}else{t=r.last()}if(t.is(u)){return}}if(x.$selected){f.itemMouseleave.call(x.$selected.get(0),w)}f.itemMouseenter.call(t.get(0),w);var s=t.find("input, textarea, select");if(s.length){s.focus()}},nextItem:function(w){w.stopPropagation();var x=a(this).data("contextMenu")||{};if(x.$selected){var v=x.$selected;x=x.$selected.parent().data("contextMenu")||{};x.$selected=v}var r=x.$menu.children(),t=!x.$selected||!x.$selected.next().length?r.first():x.$selected.next(),u=t;while(t.hasClass("disabled")||t.hasClass("not-selectable")){if(t.next().length){t=t.next()}else{t=r.first()}if(t.is(u)){return}}if(x.$selected){f.itemMouseleave.call(x.$selected.get(0),w)}f.itemMouseenter.call(t.get(0),w);var s=t.find("input, textarea, select");if(s.length){s.focus()}},focusInput:function(t){var r=a(this).closest(".context-menu-item"),s=r.data(),u=s.contextMenu,v=s.contextMenuRoot;v.$selected=u.$selected=r;v.isInput=u.isInput=true},blurInput:function(t){var r=a(this).closest(".context-menu-item"),s=r.data(),u=s.contextMenu,v=s.contextMenuRoot;v.isInput=u.isInput=false},menuMouseenter:function(r){var s=a(this).data().contextMenuRoot;s.hovering=true},menuMouseleave:function(r){var s=a(this).data().contextMenuRoot;if(s.$layer&&s.$layer.is(r.relatedTarget)){s.hovering=false}},itemMouseenter:function(t){var r=a(this),s=r.data(),u=s.contextMenu,v=s.contextMenuRoot;v.hovering=true;if(t&&v.$layer&&v.$layer.is(t.relatedTarget)){t.preventDefault();t.stopImmediatePropagation()}(u.$menu?u:v).$menu.children(".hover").trigger("contextmenu:blur");if(r.hasClass("disabled")||r.hasClass("not-selectable")){u.$selected=null;return}r.trigger("contextmenu:focus")},itemMouseleave:function(t){var r=a(this),s=r.data(),u=s.contextMenu,v=s.contextMenuRoot;if(v!==u&&v.$layer&&v.$layer.is(t.relatedTarget)){v.$selected&&v.$selected.trigger("contextmenu:blur");t.preventDefault();t.stopImmediatePropagation();v.$selected=u.$selected=u.$node;return}r.trigger("contextmenu:blur")},itemClick:function(u){var r=a(this),t=r.data(),w=t.contextMenu,x=t.contextMenuRoot,v=t.contextMenuKey,s;if(!w.items[v]||r.hasClass("disabled")||r.hasClass("context-menu-submenu")){return}u.preventDefault();u.stopImmediatePropagation();if(a.isFunction(x.callbacks[v])){s=x.callbacks[v]}else{if(a.isFunction(x.callback)){s=x.callback}else{return}}if(s.call(x.$trigger,v,x)!==false){x.$menu.trigger("contextmenu:hide")}else{if(x.$menu.parent().length){m.update.call(x.$trigger,x)}}},inputClick:function(r){r.stopImmediatePropagation()},hideMenu:function(s,r){var t=a(this).data("contextMenuRoot");m.hide.call(t.$trigger,t,r&&r.force)},focusItem:function(t){t.stopPropagation();var r=a(this),s=r.data(),u=s.contextMenu,v=s.contextMenuRoot;r.addClass("hover").siblings(".hover").trigger("contextmenu:blur");u.$selected=v.$selected=r;if(u.$node){v.positionSubmenu.call(u.$node,u.$menu)}},blurItem:function(t){t.stopPropagation();var r=a(this),s=r.data(),u=s.contextMenu,v=s.contextMenuRoot;r.removeClass("hover");u.$selected=null}},m={show:function(u,w,z){var r=a(this),t,s={};a("#context-menu-layer").trigger("mousedown");u.$trigger=r;if(u.events.show.call(r,u)===false){b=null;return}m.update.call(r,u);u.position.call(r,u,w,z);if(u.zIndex){s.zIndex=q(r)+u.zIndex}m.layer.call(u.$menu,u,s.zIndex);u.$menu.find("ul").css("zIndex",s.zIndex+1);u.$menu.css(s)[u.animation.show](u.animation.duration);r.data("contextMenu",u);a(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key);if(u.autoHide){var v=r.position();v.right=v.left+r.outerWidth();v.bottom=v.top+this.outerHeight();a(document).on("mousemove.contextMenuAutoHide",function(x){if(u.$layer&&!u.hovering&&(!(x.pageX>=v.left&&x.pageX<=v.right)||!(x.pageY>=v.top&&x.pageY<=v.bottom))){u.$menu.trigger("contextmenu:hide")}})}},hide:function(u,t){var r=a(this);if(!u){u=r.data("contextMenu")||{}}if(!t&&u.events&&u.events.hide.call(r,u)===false){return}if(u.$layer){setTimeout((function(v){return function(){v.remove()}})(u.$layer),10);try{delete u.$layer}catch(s){u.$layer=null}}b=null;u.$menu.find(".hover").trigger("contextmenu:blur");u.$selected=null;a(document).off(".contextMenuAutoHide").off("keydown.contextMenu");u.$menu&&u.$menu[u.animation.hide](u.animation.duration,function(){if(u.build){u.$menu.remove();a.each(u,function(w,x){switch(w){case"ns":case"selector":case"build":case"trigger":return true;default:u[w]=p;try{delete u[w]}catch(v){}return true}})}})},create:function(r,s){if(s===p){s=r}r.$menu=a('<ul class="context-menu-list '+(r.className||"")+'"></ul>').data({contextMenu:r,contextMenuRoot:s});a.each(["callbacks","commands","inputs"],function(t,u){r[u]={};if(!s[u]){s[u]={}}});s.accesskeys||(s.accesskeys={});a.each(r.items,function(A,z){var v=a('<li class="context-menu-item '+(z.className||"")+'"></li>'),u=null,t=null;z.$node=v.data({contextMenu:r,contextMenuRoot:s,contextMenuKey:A});if(z.accesskey){var x=n(z.accesskey);for(var y=0,w;w=x[y];y++){if(!s.accesskeys[w]){s.accesskeys[w]=z;z._name=z.name.replace(new RegExp("("+w+")","i"),'<span class="context-menu-accesskey">$1</span>');break}}}if(typeof z=="string"){v.addClass("context-menu-separator not-selectable")}else{if(z.type&&o[z.type]){o[z.type].call(v,z,r,s);a.each([r,s],function(B,C){C.commands[A]=z;if(a.isFunction(z.callback)){C.callbacks[A]=z.callback}})}else{if(z.type=="html"){v.addClass("context-menu-html not-selectable")}else{if(z.type){u=a("<label></label>").appendTo(v);a("<span></span>").html(z._name||z.name).appendTo(u);v.addClass("context-menu-input");r.hasTypes=true;a.each([r,s],function(B,C){C.commands[A]=z;C.inputs[A]=z})}else{if(z.items){z.type="sub"}}}switch(z.type){case"text":t=a('<input type="text" value="1" name="context-menu-input-'+A+'" value="">').val(z.value||"").appendTo(u);break;case"textarea":t=a('<textarea name="context-menu-input-'+A+'"></textarea>').val(z.value||"").appendTo(u);if(z.height){t.height(z.height)}break;case"checkbox":t=a('<input type="checkbox" value="1" name="context-menu-input-'+A+'" value="">').val(z.value||"").prop("checked",!!z.selected).prependTo(u);break;case"radio":t=a('<input type="radio" value="1" name="context-menu-input-'+z.radio+'" value="">').val(z.value||"").prop("checked",!!z.selected).prependTo(u);break;case"select":t=a('<select name="context-menu-input-'+A+'">').appendTo(u);if(z.options){a.each(z.options,function(C,B){a("<option></option>").val(C).text(B).appendTo(t)});t.val(z.selected)}break;case"sub":a("<span></span>").html(z._name||z.name).appendTo(v);z.appendTo=z.$node;m.create(z,s);v.data("contextMenu",z).addClass("context-menu-submenu");z.callback=null;break;case"html":a(z.html).appendTo(v);break;default:a.each([r,s],function(B,C){C.commands[A]=z;if(a.isFunction(z.callback)){C.callbacks[A]=z.callback}});a("<span></span>").html(z._name||z.name||"").appendTo(v);break}if(z.type&&z.type!="sub"&&z.type!="html"){t.on("focus",f.focusInput).on("blur",f.blurInput);if(z.events){t.on(z.events,r)}}if(z.icon){v.addClass("icon icon-"+z.icon)}}}z.$input=t;z.$label=u;v.appendTo(r.$menu);if(!r.hasTypes&&a.support.eventSelectstart){v.on("selectstart.disableTextSelect",f.abortevent)}});if(!r.$node){r.$menu.css("display","none").addClass("context-menu-root")}r.$menu.appendTo(r.appendTo||document.body)},update:function(s,t){var r=this;if(t===p){t=s;s.$menu.find("ul").andSelf().css({position:"static",display:"block"}).each(function(){var u=a(this);u.width(u.css("position","absolute").width()).css("position","static")}).css({position:"",display:""})}s.$menu.children().each(function(){var u=a(this),x=u.data("contextMenuKey"),w=s.items[x],v=(a.isFunction(w.disabled)&&w.disabled.call(r,x,t))||w.disabled===true;u[v?"addClass":"removeClass"]("disabled");if(w.type){u.find("input, select, textarea").prop("disabled",v);switch(w.type){case"text":case"textarea":w.$input.val(w.value||"");break;case"checkbox":case"radio":w.$input.val(w.value||"").prop("checked",!!w.selected);break;case"select":w.$input.val(w.selected||"");break}}if(w.$menu){m.update.call(r,w,t)}})},layer:function(s,t){var r=s.$layer=a('<div id="context-menu-layer" style="position:fixed; z-index:'+t+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:c.height(),width:c.width(),display:"block"}).data("contextMenuRoot",s).insertBefore(this).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);if(!a.support.fixedPosition){r.css({position:"absolute",height:a(document).height()})}return r}};function n(w){var v=w.split(/\s+/),u=[];for(var r=0,s;s=v[r];r++){s=s[0].toUpperCase();u.push(s)}return u}a.fn.contextMenu=function(s){if(s===p){this.first().trigger("contextmenu")}else{if(s.x&&s.y){this.first().trigger(a.Event("contextmenu",{pageX:s.x,pageY:s.y}))}else{if(s==="hide"){var r=this.data("contextMenu").$menu;r&&r.trigger("contextmenu:hide")}else{if(s){this.removeClass("context-menu-disabled")}else{if(!s){this.addClass("context-menu-disabled")}}}}}return this};a.contextMenu=function(v,w){if(typeof v!="string"){w=v;v="create"}if(typeof w=="string"){w={selector:w}}else{if(w===p){w={}}}var u=a.extend(true,{},e,w||{}),r=a(document);switch(v){case"create":if(!u.selector){throw new Error("No selector specified")}if(u.selector.match(/.context-menu-(list|item|input)($|\s)/)){throw new Error('Cannot bind to selector "'+u.selector+'" as it contains a reserved className')}if(!u.build&&(!u.items||a.isEmptyObject(u.items))){throw new Error("No Items sepcified")}d++;u.ns=".contextMenu"+d;l[u.selector]=u.ns;k[u.ns]=u;if(!u.trigger){u.trigger="right"}if(!h){r.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on({"mouseup.contextMenu":f.itemClick,"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave},".context-menu-item");h=true}r.on("contextmenu"+u.ns,u.selector,u,f.contextmenu);switch(u.trigger){case"hover":r.on("mouseenter"+u.ns,u.selector,u,f.mouseenter).on("mouseleave"+u.ns,u.selector,u,f.mouseleave);break;case"left":r.on("click"+u.ns,u.selector,u,f.click);break}if(!u.build){m.create(u)}break;case"destroy":if(!u.selector){r.off(".contextMenu .contextMenuAutoHide");a.each(l,function(x,y){r.off(y)});l={};k={};d=0;h=false;a("#context-menu-layer, .context-menu-list").remove()}else{if(l[u.selector]){var s=a(".context-menu-list").filter(":visible");if(s.length&&s.data().contextMenuRoot.$trigger.is(u.selector)){s.trigger("contextmenu:hide",{force:true})}try{if(k[l[u.selector]].$menu){k[l[u.selector]].$menu.remove()}delete k[l[u.selector]]}catch(t){k[l[u.selector]]=null}r.off(l[u.selector])}}break;case"html5":if((!a.support.htmlCommand&&!a.support.htmlMenuitem)||(typeof w=="boolean"&&w)){a('menu[type="context"]').each(function(){if(this.id){a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}}).css("display","none")}break;default:throw new Error('Unknown operation "'+v+'"')}return this};a.contextMenu.setInputValues=function(s,r){if(r===p){r={}}a.each(s.inputs,function(u,t){switch(t.type){case"text":case"textarea":t.value=r[u]||"";break;case"checkbox":t.selected=r[u]?true:false;break;case"radio":t.selected=(r[t.radio]||"")==t.value?true:false;break;case"select":t.selected=r[u]||"";break}})};a.contextMenu.getInputValues=function(s,r){if(r===p){r={}}a.each(s.inputs,function(u,t){switch(t.type){case"text":case"textarea":case"select":r[u]=t.$input.val();break;case"checkbox":r[u]=t.$input.prop("checked");break;case"radio":if(t.$input.prop("checked")){r[t.radio]=t.value}break}});return r};function i(r){return(r.id&&a('label[for="'+r.id+'"]').val())||r.name}function j(t,r,s){if(!s){s=0}r.each(function(){var u=a(this),x=this,y=this.nodeName.toLowerCase(),w,v;if(y=="label"&&u.find("input, textarea, select").length){w=u.text();u=u.children().first();x=u.get(0);y=x.nodeName.toLowerCase()}switch(y){case"menu":v={name:u.attr("label"),items:{}};s=j(v.items,u.children(),s);break;case"a":case"button":v={name:u.text(),disabled:!!u.attr("disabled"),callback:(function(){return function(){u.click()}})()};break;case"menuitem":case"command":switch(u.attr("type")){case p:case"command":case"menuitem":v={name:u.attr("label"),disabled:!!u.attr("disabled"),callback:(function(){return function(){u.click()}})()};break;case"checkbox":v={type:"checkbox",disabled:!!u.attr("disabled"),name:u.attr("label"),selected:!!u.attr("checked")};break;case"radio":v={type:"radio",disabled:!!u.attr("disabled"),name:u.attr("label"),radio:u.attr("radiogroup"),value:u.attr("id"),selected:!!u.attr("checked")};break;default:v=p}break;case"hr":v="-------";break;case"input":switch(u.attr("type")){case"text":v={type:"text",name:w||i(x),disabled:!!u.attr("disabled"),value:u.val()};break;case"checkbox":v={type:"checkbox",name:w||i(x),disabled:!!u.attr("disabled"),selected:!!u.attr("checked")};break;case"radio":v={type:"radio",name:w||i(x),disabled:!!u.attr("disabled"),radio:!!u.attr("name"),value:u.val(),selected:!!u.attr("checked")};break;default:v=p;break}break;case"select":v={type:"select",name:w||i(x),disabled:!!u.attr("disabled"),selected:u.val(),options:{}};u.children().each(function(){v.options[this.value]=a(this).text()});break;case"textarea":v={type:"textarea",name:w||i(x),disabled:!!u.attr("disabled"),value:u.val()};break;case"label":break;default:v={type:"html",html:u.clone(true)};break}if(v){s++;t["key"+s]=v}});return s}a.contextMenu.fromMenu=function(s){var r=a(s),t={};j(t,r.children());return t};a.contextMenu.defaults=e;a.contextMenu.types=o})(jQuery);jQuery.cookie=function(h,m,j){if(typeof m!="undefined"){j=j||{};if(m===null){m="";j.expires=-1}var f="";if(j.expires&&(typeof j.expires=="number"||j.expires.toUTCString)){var d;if(typeof j.expires=="number"){d=new Date();d.setTime(d.getTime()+(j.expires*24*60*60*1000))}else{d=j.expires}f="; expires="+d.toUTCString()}var k=j.path?"; path="+(j.path):"";var e=j.domain?"; domain="+(j.domain):"";var l=j.secure?"; secure":"";document.cookie=[h,"=",encodeURIComponent(m),f,k,e,l].join("")}else{var c=null;if(document.cookie&&document.cookie!=""){var b=document.cookie.split(";");for(var g=0;g<b.length;g++){var a=jQuery.trim(b[g]);if(a.substring(0,h.length+1)==(h+"=")){c=decodeURIComponent(a.substring(h.length+1));break}}}return c}};
/*
 * hoverIntent r7 // 2013.03.11 // jQuery 1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2013 Brian Cherne
 */
(function(a){a.fn.hoverIntent=function(h,i,l){var b={interval:100,sensitivity:7,timeout:0};if(typeof h==="object"){b=a.extend(b,h)}else{if(a.isFunction(i)){b=a.extend(b,{over:h,out:i,selector:l})}else{b=a.extend(b,{over:h,out:h,selector:i})}}var d,e,j,k;var m=function(n){d=n.pageX;e=n.pageY};var c=function(n,o){o.hoverIntent_t=clearTimeout(o.hoverIntent_t);if((Math.abs(j-d)+Math.abs(k-e))<b.sensitivity){a(o).off("mousemove.hoverIntent",m);o.hoverIntent_s=1;return b.over.apply(o,[n])}else{j=d;k=e;o.hoverIntent_t=setTimeout(function(){c(n,o)},b.interval)}};var f=function(n,o){o.hoverIntent_t=clearTimeout(o.hoverIntent_t);o.hoverIntent_s=0;return b.out.apply(o,[n])};var g=function(n){var o=jQuery.extend({},n);var p=this;if(p.hoverIntent_t){p.hoverIntent_t=clearTimeout(p.hoverIntent_t)}if(n.type=="mouseenter"){j=o.pageX;k=o.pageY;a(p).on("mousemove.hoverIntent",m);if(p.hoverIntent_s!=1){p.hoverIntent_t=setTimeout(function(){c(o,p)},b.interval)}}else{a(p).off("mousemove.hoverIntent",m);if(p.hoverIntent_s==1){p.hoverIntent_t=setTimeout(function(){f(o,p)},b.timeout)}}};return this.on({"mouseenter.hoverIntent":g,"mouseleave.hoverIntent":g},b.selector)}})(jQuery);(function(b){b.Jcrop=function(ab,ax){function aJ(c){return Math.round(c)+"px"}function aL(c){return az.baseClass+"-"+c}function aN(){return b.fx.step.hasOwnProperty("backgroundColor")}function aP(d){var e=b(d).offset();return[e.left,e.top]}function aR(c){return[c.pageX-aB[0],c.pageY-aB[1]]}function aT(c){typeof c!="object"&&(c={}),az=b.extend(az,c),b.each(["onChange","onSelect","onRelease","onDblClick"],function(d,e){typeof az[e]!="function"&&(az[e]=function(){})})}function aV(e,h,i){aB=aP(aA),af.setCursor(e==="move"?e:e+"-resize");if(e==="move"){return af.activateHandlers(aZ(h),a9,i)}var j=a.getFixed(),k=a1(e),l=a.getCorner(a1(k));a.setPressed(a.getCorner(k)),a.setCurrent(l),af.activateHandlers(aX(e,j),a9,i)}function aX(c,d){return function(e){if(!az.aspectRatio){switch(c){case"e":e[1]=d.y2;break;case"w":e[1]=d.y2;break;case"n":e[0]=d.x2;break;case"s":e[0]=d.x2}}else{switch(c){case"e":e[1]=d.y+1;break;case"w":e[1]=d.y+1;break;case"n":e[0]=d.x+1;break;case"s":e[0]=d.x+1}}a.setCurrent(e),ae.update()}}function aZ(c){var d=c;return ag.watchKeys(),function(e){a.moveOffset([e[0]-d[0],e[1]-d[1]]),d=e,ae.update()}}function a1(c){switch(c){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function a3(c){return function(d){return az.disabled?!1:c==="move"&&!az.allowMove?!1:(aB=aP(aA),bv=!0,aV(c,aR(d)),d.stopPropagation(),d.preventDefault(),!1)}}function a5(f,g,h){var i=f.width(),j=f.height();i>g&&g>0&&(i=g,j=g/f.width()*f.height()),j>h&&h>0&&(j=h,i=h/f.height()*f.width()),a6=f.width()/i,a8=f.height()/j,f.width(i).height(j)}function a7(c){return{x:c.x*a6,y:c.y*a8,x2:c.x2*a6,y2:c.y2*a8,w:c.w*a6,h:c.h*a8}}function a9(c){var d=a.getFixed();d.w>az.minSelect[0]&&d.h>az.minSelect[1]?(ae.enableHandles(),ae.done()):ae.release(),af.setCursor(az.allowSelect?"crosshair":"default")}function bu(c){if(az.disabled){return !1}if(!az.allowSelect){return !1}bv=!0,aB=aP(aA),ae.disableHandles(),af.setCursor("crosshair");var d=aR(c);return a.setPressed(d),ae.update(),af.activateHandlers(bw,a9,c.type.substring(0,5)==="touch"),ag.watchKeys(),c.stopPropagation(),c.preventDefault(),!1}function bw(c){a.setCurrent(c),ae.update()}function by(){var c=b("<div></div>").addClass(aL("tracker"));return aF&&c.css({opacity:0,backgroundColor:"white"}),c}function ah(c){aG.removeClass().addClass(aL("holder")).addClass(c)}function ai(d,v){function M(){window.setTimeout(N,E)}var w=d[0]/a6,x=d[1]/a8,y=d[2]/a6,z=d[3]/a8;if(bx){return}var A=a.flipCoords(w,x,y,z),B=a.getFixed(),C=[B.x,B.y,B.x2,B.y2],D=C,E=az.animationDelay,F=A[0]-C[0],G=A[1]-C[1],H=A[2]-C[2],I=A[3]-C[3],J=0,K=az.swingSpeed;w=D[0],x=D[1],y=D[2],z=D[3],ae.animMode(!0);var L,N=function(){return function(){J+=(100-J)/K,D[0]=Math.round(w+J/100*F),D[1]=Math.round(x+J/100*G),D[2]=Math.round(y+J/100*H),D[3]=Math.round(z+J/100*I),J>=99.8&&(J=100),J<100?(ak(D),M()):(ae.done(),ae.animMode(!1),typeof v=="function"&&v.call(aw))}}();M()}function aj(c){ak([c[0]/a6,c[1]/a8,c[2]/a6,c[3]/a8]),az.onSelect.call(aw,a7(a.getFixed())),ae.enableHandles()}function ak(c){a.setPressed([c[0],c[1]]),a.setCurrent([c[2],c[3]]),ae.update()}function al(){return a7(a.getFixed())}function am(){return a.getFixed()}function an(c){aT(c),av()}function ao(){az.disabled=!0,ae.disableHandles(),ae.setCursor("default"),af.setCursor("default")}function ap(){az.disabled=!1,av()}function aq(){ae.done(),af.activateHandlers(null,null)}function ar(){aG.remove(),aa.show(),aa.css("visibility","visible"),b(ab).removeData("Jcrop")}function at(d,e){ae.release(),ao();var f=new Image;f.onload=function(){var c=f.width,i=f.height,j=az.boxWidth,k=az.boxHeight;aA.width(c).height(i),aA.attr("src",d),aI.attr("src",d),a5(aA,j,k),aC=aA.width(),aE=aA.height(),aI.width(aC).height(aE),aS.width(aC+aQ*2).height(aE+aQ*2),aG.width(aC).height(aE),ad.resize(aC,aE),ap(),typeof e=="function"&&e.call(aw)},f.src=d}function au(d,f,g){var h=f||az.bgColor;az.bgFade&&aN()&&az.fadeTime&&!g?d.animate({backgroundColor:h},{queue:!1,duration:az.fadeTime}):d.css("backgroundColor",h)}function av(c){az.allowResize?c?ae.enableOnly():ae.enableHandles():ae.disableHandles(),af.setCursor(az.allowSelect?"crosshair":"default"),ae.setCursor(az.allowMove?"move":"default"),az.hasOwnProperty("trueSize")&&(a6=az.trueSize[0]/aC,a8=az.trueSize[1]/aE),az.hasOwnProperty("setSelect")&&(aj(az.setSelect),ae.done(),delete az.setSelect),ad.refresh(),az.bgColor!=aU&&(au(az.shade?ad.getShades():aG,az.shade?az.shadeColor||az.bgColor:az.bgColor),aU=az.bgColor),aW!=az.bgOpacity&&(aW=az.bgOpacity,az.shade?ad.refresh():ae.setBgOpacity(aW)),aY=az.maxSize[0]||0,a0=az.maxSize[1]||0,a2=az.minSize[0]||0,a4=az.minSize[1]||0,az.hasOwnProperty("outerImage")&&(aA.attr("src",az.outerImage),delete az.outerImage),ae.refresh()}var az=b.extend({},b.Jcrop.defaults),aB,aD=navigator.userAgent.toLowerCase(),aF=/msie/.test(aD),aH=/msie [1-6]\./.test(aD);typeof ab!="object"&&(ab=b(ab)[0]),typeof ax!="object"&&(ax={}),aT(ax);var bA={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},aa=b(ab),ac=!0;if(ab.tagName=="IMG"){if(aa[0].width!=0&&aa[0].height!=0){aa.width(aa[0].width),aa.height(aa[0].height)}else{var ay=new Image;ay.src=aa[0].src,aa.width(ay.width),aa.height(ay.height)}var aA=aa.clone().removeAttr("id").css(bA).show();aA.width(aa.width()),aA.height(aa.height()),aa.after(aA).hide()}else{aA=aa.css(bA).show(),ac=!1,az.shade===null&&(az.shade=!0)}a5(aA,az.boxWidth,az.boxHeight);var aC=aA.width(),aE=aA.height(),aG=b("<div />").width(aC).height(aE).addClass(aL("holder")).css({position:"relative",backgroundColor:az.bgColor}).insertAfter(aa).append(aA);az.addClass&&aG.addClass(az.addClass);var aI=b("<div />"),aK=b("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),aM=b("<div />").width("100%").height("100%").css("zIndex",320),aO=b("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var c=a.getFixed();az.onDblClick.call(aw,c)}).insertBefore(aA).append(aK,aM);ac&&(aI=b("<img />").attr("src",aA.attr("src")).css(bA).width(aC).height(aE),aK.append(aI)),aH&&aO.css({overflowY:"hidden"});var aQ=az.boundary,aS=by().width(aC+aQ*2).height(aE+aQ*2).css({position:"absolute",top:aJ(-aQ),left:aJ(-aQ),zIndex:290}).mousedown(bu),aU=az.bgColor,aW=az.bgOpacity,aY,a0,a2,a4,a6,a8,bt=!0,bv,bx,bz;aB=aP(aA);var bB=function(){function c(){var h={},i=["touchstart","touchmove","touchend"],j=document.createElement("div"),k;try{for(k=0;k<i.length;k++){var l=i[k];l="on"+l;var m=l in j;m||(j.setAttribute(l,"return;"),m=typeof j[l]=="function"),h[i[k]]=m}return h.touchstart&&h.touchend&&h.touchmove}catch(n){return !1}}function d(){return az.touchSupport===!0||az.touchSupport===!1?az.touchSupport:c()}return{createDragger:function(e){return function(f){return az.disabled?!1:e==="move"&&!az.allowMove?!1:(aB=aP(aA),bv=!0,aV(e,aR(bB.cfilter(f)),!0),f.stopPropagation(),f.preventDefault(),!1)}},newSelection:function(e){return bu(bB.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:c,support:d()}}(),a=function(){function w(c){c=C(c),s=d=c[0],t=r=c[1]}function x(c){c=C(c),u=c[0]-s,v=c[1]-t,s=c[0],t=c[1]}function y(){return[u,v]}function z(c){var e=c[0],h=c[1];0>d+e&&(e-=e+d),0>r+h&&(h-=h+r),aE<t+h&&(h+=aE-(t+h)),aC<s+e&&(e+=aC-(s+e)),d+=e,s+=e,r+=h,t+=h}function A(c){var e=B();switch(c){case"ne":return[e.x2,e.y];case"nw":return[e.x,e.y];case"se":return[e.x2,e.y2];case"sw":return[e.x,e.y2]}}function B(){if(!az.aspectRatio){return E()}var c=az.aspectRatio,e=az.minSize[0]/a6,o=az.maxSize[0]/a6,p=az.maxSize[1]/a8,q=s-d,G=t-r,H=Math.abs(q),I=Math.abs(G),J=H/I,K,L,M,N;return o===0&&(o=aC*10),p===0&&(p=aE*10),J<c?(L=t,M=I*c,K=q<0?d-M:M+d,K<0?(K=0,N=Math.abs((K-d)/c),L=G<0?r-N:N+r):K>aC&&(K=aC,N=Math.abs((K-d)/c),L=G<0?r-N:N+r)):(K=s,N=H/c,L=G<0?r-N:r+N,L<0?(L=0,M=Math.abs((L-r)*c),K=q<0?d-M:M+d):L>aE&&(L=aE,M=Math.abs(L-r)*c,K=q<0?d-M:M+d)),K>d?(K-d<e?K=d+e:K-d>o&&(K=d+o),L>r?L=r+(K-d)/c:L=r-(K-d)/c):K<d&&(d-K<e?K=d-e:d-K>o&&(K=d-o),L>r?L=r+(d-K)/c:L=r-(d-K)/c),K<0?(d-=K,K=0):K>aC&&(d-=K-aC,K=aC),L<0?(r-=L,L=0):L>aE&&(r-=L-aE,L=aE),F(D(d,r,K,L))}function C(c){return c[0]<0&&(c[0]=0),c[1]<0&&(c[1]=0),c[0]>aC&&(c[0]=aC),c[1]>aE&&(c[1]=aE),[Math.round(c[0]),Math.round(c[1])]}function D(i,j,k,l){var m=i,n=k,o=j,p=l;return k<i&&(m=k,n=i),l<j&&(o=l,p=j),[m,o,n,p]}function E(){var c=s-d,e=t-r,h;return aY&&Math.abs(c)>aY&&(s=c>0?d+aY:d-aY),a0&&Math.abs(e)>a0&&(t=e>0?r+a0:r-a0),a4/a8&&Math.abs(e)<a4/a8&&(t=e>0?r+a4/a8:r-a4/a8),a2/a6&&Math.abs(c)<a2/a6&&(s=c>0?d+a2/a6:d-a2/a6),d<0&&(s-=d,d-=d),r<0&&(t-=r,r-=r),s<0&&(d-=s,s-=s),t<0&&(r-=t,t-=t),s>aC&&(h=s-aC,d-=h,s-=h),t>aE&&(h=t-aE,r-=h,t-=h),d>aC&&(h=d-aE,t-=h,r-=h),r>aE&&(h=r-aE,t-=h,r-=h),F(D(d,r,s,t))}function F(c){return{x:c[0],y:c[1],x2:c[2],y2:c[3],w:c[2]-c[0],h:c[3]-c[1]}}var d=0,r=0,s=0,t=0,u,v;return{flipCoords:D,setPressed:w,setCurrent:x,getOffset:y,moveOffset:z,getCorner:A,getFixed:B}}(),ad=function(){function r(c,e){q.left.css({height:aJ(e)}),q.right.css({height:aJ(e)})}function s(){return t(a.getFixed())}function t(c){q.top.css({left:aJ(c.x),width:aJ(c.w),height:aJ(c.y)}),q.bottom.css({top:aJ(c.y2),left:aJ(c.x),width:aJ(c.w),height:aJ(aE-c.y2)}),q.right.css({left:aJ(c.x2),width:aJ(aC-c.x2)}),q.left.css({width:aJ(c.x)})}function u(){return b("<div />").css({position:"absolute",backgroundColor:az.shadeColor||az.bgColor}).appendTo(i)}function v(){d||(d=!0,i.insertBefore(aA),s(),ae.setBgOpacity(1,0,1),aI.hide(),w(az.shadeColor||az.bgColor,1),ae.isAwake()?y(az.bgOpacity,1):y(1,1))}function w(c,e){au(A(),c,e)}function x(){d&&(i.remove(),aI.show(),d=!1,ae.isAwake()?ae.setBgOpacity(az.bgOpacity,1,1):(ae.setBgOpacity(1,1,1),ae.disableHandles()),au(aG,0,1))}function y(c,f){d&&(az.bgFade&&!f?i.animate({opacity:1-c},{queue:!1,duration:az.fadeTime}):i.css({opacity:1-c}))}function z(){az.shade?v():x(),ae.isAwake()&&y(az.bgOpacity)}function A(){return i.children()}var d=!1,i=b("<div />").css({position:"absolute",zIndex:240,opacity:0}),q={top:u(),left:u().height(aE),right:u().height(aE),bottom:u()};return{update:s,updateRaw:t,getShades:A,setBgColor:w,enable:v,disable:x,resize:r,refresh:z,opacity:y}}(),ae=function(){function O(e){var f=b("<div />").css({position:"absolute",opacity:az.borderOpacity}).addClass(aL(e));return aK.append(f),f}function P(e,f){var g=b("<div />").mousedown(a3(e)).css({cursor:e+"-resize",position:"absolute",zIndex:f}).addClass("ord-"+e);return bB.support&&g.bind("touchstart.jcrop",bB.createDragger(e)),aM.append(g),g}function R(c){var f=az.handleSize,g=P(c,s++).css({opacity:az.handleOpacity}).addClass(aL("handle"));return f&&g.width(f).height(f),g}function T(c){return P(c,s++).addClass("jcrop-dragbar")}function U(c){var e;for(e=0;e<c.length;e++){J[c[e]]=T(c[e])}}function V(e){var f,g;for(g=0;g<e.length;g++){switch(e[g]){case"n":f="hline";break;case"s":f="hline bottom";break;case"e":f="vline right";break;case"w":f="vline"}y[e[g]]=O(f)}}function W(c){var e;for(e=0;e<c.length;e++){H[c[e]]=R(c[e])}}function X(c,e){az.shade||aI.css({top:aJ(-e),left:aJ(-c)}),aO.css({top:aJ(e),left:aJ(c)})}function Y(c,e){aO.width(Math.round(c)).height(Math.round(e))}function Z(){var c=a.getFixed();a.setPressed([c.x,c.y]),a.setCurrent([c.x2,c.y2]),ba()}function ba(c){if(i){return bb(c)}}function bb(e){var f=a.getFixed();Y(f.w,f.h),X(f.x,f.y),az.shade&&ad.updateRaw(f),i||d(),e?az.onSelect.call(aw,a7(f)):az.onChange.call(aw,a7(f))}function bc(f,g,h){if(!i&&!g){return}az.bgFade&&!h?aA.animate({opacity:f},{queue:!1,duration:az.fadeTime}):aA.css("opacity",f)}function d(){aO.show(),az.shade?ad.opacity(aW):bc(aW,!0),i=!0}function j(){I(),aO.hide(),az.shade?ad.opacity(1):bc(1),i=!1,az.onRelease.call(aw)}function u(){N&&aM.show()}function D(){N=!0;if(az.allowResize){return aM.show(),!0}}function I(){N=!1,aM.hide()}function K(c){c?(bx=!0,I()):(bx=!1,D())}function Q(){K(!1),Z()}var i,s=370,y={},H={},J={},N=!1;az.dragEdges&&b.isArray(az.createDragbars)&&U(az.createDragbars),b.isArray(az.createHandles)&&W(az.createHandles),az.drawBorders&&b.isArray(az.createBorders)&&V(az.createBorders),b(document).bind("touchstart.jcrop-ios",function(c){b(c.currentTarget).hasClass("jcrop-tracker")&&c.stopPropagation()});var S=by().mousedown(a3("move")).css({cursor:"move",position:"absolute",zIndex:360});return bB.support&&S.bind("touchstart.jcrop",bB.createDragger("move")),aK.append(S),I(),{updateVisible:ba,update:bb,release:j,refresh:Z,isAwake:function(){return i},setCursor:function(c){S.css("cursor",c)},enableHandles:D,enableOnly:function(){N=!0},showHandles:u,disableHandles:I,animMode:K,setBgOpacity:bc,done:Q}}(),af=function(){function p(c){aS.css({zIndex:450}),c?b(document).bind("touchmove.jcrop",u).bind("touchend.jcrop",v):o&&b(document).bind("mousemove.jcrop",r).bind("mouseup.jcrop",s)}function q(){aS.css({zIndex:290}),b(document).unbind(".jcrop")}function r(c){return d(aR(c)),!1}function s(c){return c.preventDefault(),c.stopPropagation(),bv&&(bv=!1,m(aR(c)),ae.isAwake()&&az.onSelect.call(aw,a7(a.getFixed())),q(),d=function(){},m=function(){}),!1}function t(c,f,g){return bv=!0,d=c,m=f,p(g),!1}function u(c){return d(aR(bB.cfilter(c))),!1}function v(c){return s(bB.cfilter(c))}function w(c){aS.css("cursor",c)}var d=function(){},m=function(){},o=az.trackDocument;return o||aS.mousemove(r).mouseup(s).mouseout(s),aA.before(aS),{activateHandlers:t,setCursor:w}}(),ag=function(){function j(){az.keySupport&&(d.show(),d.focus())}function k(c){d.hide()}function l(e,f,g){az.allowMove&&(a.moveOffset([f,g]),ae.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function m(c){if(c.ctrlKey||c.metaKey){return !0}bz=c.shiftKey?!0:!1;var e=bz?10:1;switch(c.keyCode){case 37:l(c,-e,0);break;case 39:l(c,e,0);break;case 38:l(c,0,-e);break;case 40:l(c,0,e);break;case 27:az.allowSelect&&ae.release();break;case 9:return !0}return !1}var d=b('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),h=b("<div />").css({position:"absolute",overflow:"hidden"}).append(d);return az.keySupport&&(d.keydown(m).blur(k),aH||!az.fixedSupport?(d.css({position:"absolute",left:"-20px"}),h.append(d).insertBefore(aA)):d.insertBefore(aA)),{watchKeys:j}}();bB.support&&aS.bind("touchstart.jcrop",bB.newSelection),aM.hide(),av(!0);var aw={setImage:at,animateTo:ai,setSelect:aj,setOptions:an,tellSelect:al,tellScaled:am,setClass:ah,disable:ao,enable:ap,cancel:aq,release:ae.release,destroy:ar,focus:ag.watchKeys,getBounds:function(){return[aC*a6,aE*a8]},getWidgetSize:function(){return[aC,aE]},getScaleFactor:function(){return[a6,a8]},getOptions:function(){return az},ui:{holder:aG,selection:aO}};return aF&&aG.bind("selectstart",function(){return !1}),aa.data("Jcrop",aw),aw},b.fn.Jcrop=function(a,e){var f;return this.each(function(){if(b(this).data("Jcrop")){if(a==="api"){return b(this).data("Jcrop")}b(this).data("Jcrop").setOptions(a)}else{this.tagName=="IMG"?b.Jcrop.Loader(this,function(){b(this).css({display:"block",visibility:"hidden"}),f=b.Jcrop(this,a),b.isFunction(e)&&e.call(f)}):(b(this).css({display:"block",visibility:"hidden"}),f=b.Jcrop(this,a),b.isFunction(e)&&e.call(f))}}),this},b.Jcrop.Loader=function(a,h,i){function l(){k.complete?(j.unbind(".jcloader"),b.isFunction(h)&&h.call(k)):window.setTimeout(l,50)}var j=b(a),k=j[0];j.bind("load.jcloader",l).bind("error.jcloader",function(c){j.unbind(".jcloader"),b.isFunction(i)&&i.call(k)}),k.complete&&b.isFunction(h)&&(j.unbind(".jcloader"),h.call(k))},b.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:!1,borderOpacity:0.4,handleOpacity:0.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);(function(a){var b=(function(){return false===a.support.boxModel&&a.support.objectAll&&a.support.leadingWhitespace})();a.jGrowl=function(c,d){if(a("#jGrowl").size()==0){a('<div id="jGrowl"></div>').addClass((d&&d.position)?d.position:a.jGrowl.defaults.position).appendTo("body")}a("#jGrowl").jGrowl(c,d)};a.fn.jGrowl=function(d,e){if(a.isFunction(this.each)){var c=arguments;return this.each(function(){if(a(this).data("jGrowl.instance")==undefined){a(this).data("jGrowl.instance",a.extend(new a.fn.jGrowl(),{notifications:[],element:null,interval:null}));a(this).data("jGrowl.instance").startup(this)}if(a.isFunction(a(this).data("jGrowl.instance")[d])){a(this).data("jGrowl.instance")[d].apply(a(this).data("jGrowl.instance"),a.makeArray(c).slice(1))}else{a(this).data("jGrowl.instance").create(d,e)}})}};a.extend(a.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:false,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3000,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:true,closeTemplate:"&times;",closerTemplate:"<div>[ close all ]</div>",log:function(){},beforeOpen:function(){},afterOpen:function(){},open:function(){},beforeClose:function(){},close:function(){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(c,d){var d=a.extend({},this.defaults,d);if(typeof d.speed!=="undefined"){d.openDuration=d.speed;d.closeDuration=d.speed}this.notifications.push({message:c,options:d});d.log.apply(this.element,[this.element,c,d])},render:function(d){var f=this;var c=d.message;var e=d.options;e.themeState=(e.themeState=="")?"":"ui-state-"+e.themeState;var d=a("<div/>").addClass("jGrowl-notification "+e.themeState+" ui-corner-all"+((e.group!=undefined&&e.group!="")?" "+e.group:"")).append(a("<div/>").addClass("jGrowl-close").html(e.closeTemplate)).append(a("<div/>").addClass("jGrowl-header").html(e.header)).append(a("<div/>").addClass("jGrowl-message").html(c)).data("jGrowl",e).addClass(e.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){a(this).parent().trigger("jGrowl.beforeClose")}).parent();a(d).bind("mouseover.jGrowl",function(){a("div.jGrowl-notification",f.element).data("jGrowl.pause",true)}).bind("mouseout.jGrowl",function(){a("div.jGrowl-notification",f.element).data("jGrowl.pause",false)}).bind("jGrowl.beforeOpen",function(){if(e.beforeOpen.apply(d,[d,c,e,f.element])!==false){a(this).trigger("jGrowl.open")}}).bind("jGrowl.open",function(){if(e.open.apply(d,[d,c,e,f.element])!==false){if(e.glue=="after"){a("div.jGrowl-notification:last",f.element).after(d)}else{a("div.jGrowl-notification:first",f.element).before(d)}a(this).animate(e.animateOpen,e.openDuration,e.easing,function(){if(a.support.opacity===false){this.style.removeAttribute("filter")}if(a(this).data("jGrowl")!==null){a(this).data("jGrowl").created=new Date()}a(this).trigger("jGrowl.afterOpen")})}}).bind("jGrowl.afterOpen",function(){e.afterOpen.apply(d,[d,c,e,f.element])}).bind("jGrowl.beforeClose",function(){if(e.beforeClose.apply(d,[d,c,e,f.element])!==false){a(this).trigger("jGrowl.close")}}).bind("jGrowl.close",function(){a(this).data("jGrowl.pause",true);a(this).animate(e.animateClose,e.closeDuration,e.easing,function(){if(a.isFunction(e.close)){if(e.close.apply(d,[d,c,e,f.element])!==false){a(this).remove()}}else{a(this).remove()}})}).trigger("jGrowl.beforeOpen");if(e.corners!=""&&a.fn.corner!=undefined){a(d).corner(e.corners)}if(a("div.jGrowl-notification:parent",f.element).size()>1&&a("div.jGrowl-closer",f.element).size()==0&&this.defaults.closer!==false){a(this.defaults.closerTemplate).addClass("jGrowl-closer "+this.defaults.themeState+" ui-corner-all").addClass(this.defaults.theme).appendTo(f.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){a(this).siblings().trigger("jGrowl.beforeClose");if(a.isFunction(f.defaults.closer)){f.defaults.closer.apply(a(this).parent()[0],[a(this).parent()[0]])}})}},update:function(){a(this.element).find("div.jGrowl-notification:parent").each(function(){if(a(this).data("jGrowl")!=undefined&&a(this).data("jGrowl").created!==undefined&&(a(this).data("jGrowl").created.getTime()+parseInt(a(this).data("jGrowl").life))<(new Date()).getTime()&&a(this).data("jGrowl").sticky!==true&&(a(this).data("jGrowl.pause")==undefined||a(this).data("jGrowl.pause")!==true)){a(this).trigger("jGrowl.beforeClose")}});if(this.notifications.length>0&&(this.defaults.pool==0||a(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)){this.render(this.notifications.shift())}if(a(this.element).find("div.jGrowl-notification:parent").size()<2){a(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){a(this).remove()})}},startup:function(c){this.element=a(c).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){a(c).data("jGrowl.instance").update()},parseInt(this.defaults.check));if(b){a(this.element).addClass("ie6")}},shutdown:function(){a(this.element).removeClass("jGrowl").find("div.jGrowl-notification").trigger("jGrowl.close").parent().empty();clearInterval(this.interval)},close:function(){a(this.element).find("div.jGrowl-notification").each(function(){a(this).trigger("jGrowl.beforeClose")})}});a.jGrowl.defaults=a.fn.jGrowl.prototype.defaults})(jQuery);(function(b){b.fn.jNice=function(g){var i=this;var h=b.browser.safari;b(document).mousedown(a);b("select").each(function(){var j=b(this).attr("name");b(this).attr("id",j)});b("select#gender").change(function(){var j="";b("select#gender option:selected").each(function(){j+=b(this).text()});b(this).siblings(".jNiceSelectWrapper").children("div").children(".jNiceSelectText").text(j)});b("select#secQuestion1").change(function(){var j="";b("select#secQuestion1 option:selected").each(function(){j+=b(this).text()});b(this).siblings(".jNiceSelectWrapper").children("div").children(".jNiceSelectText").text(j)});b("select#secQuestion2").change(function(){var j="";b("select#secQuestion2 option:selected").each(function(){j+=b(this).text()});b(this).siblings(".jNiceSelectWrapper").children("div").children(".jNiceSelectText").text(j)});return this.each(function(){b("select",this).each(function(j){c(this,j)})})};var d=function(){b(".jNiceSelectWrapper ul:visible").hide()};var a=function(g){if(b(g.target).parents(".jNiceSelectWrapper").length===0){d()}};var c=function(i,j){var g=b(i);j=j||g.css("zIndex")*1;j=(j)?j:0;g.wrap(b('<div class="jNiceWrapper"></div>').css({zIndex:100-j}));var k=g.width()+6;g.addClass("jNiceHidden").after('<div class="jNiceSelectWrapper"><div><span class="jNiceSelectText"></span><span class="jNiceSelectOpen"></span></div><ul></ul></div>');var h=b(i).siblings(".jNiceSelectWrapper").css({width:k+"px"});b(".jNiceSelectText, .jNiceSelectWrapper ul",h).width(k-b(".jNiceSelectOpen",h).width());if(b.browser.msie&&b.browser.version<7){g.after(b('<iframe src="javascript:\'\';" marginwidth="0" marginheight="0" align="bottom" scrolling="no" tabIndex="-1" frameborder="0"></iframe>').css({height:g.height()+4+"px"}))}f(i);b("div",h).click(function(){var l=b(this).siblings("ul");if(l.css("display")=="none"){d()}l.slideToggle("fast");var m=(b("a.selected",l).offset().top-l.offset().top);l.animate({scrollTop:m});return false});g.keydown(function(l){var m=this.selectedIndex;switch(l.keyCode){case 40:if(m<this.options.length-1){m+=1}break;case 38:if(m>0){m-=1}break;default:return;break}b("ul a",h).removeClass("selected").eq(m).addClass("selected");b("span:eq(0)",h).html(b("option:eq("+m+")",g).attr("selected","selected").text());return false}).focus(function(){h.addClass("jNiceFocus")}).blur(function(){h.removeClass("jNiceFocus")})};var f=function(j){var g=b(j);var i=g.siblings(".jNiceSelectWrapper");var h=i.find("ul").find("li").remove().end().hide();b("option",g).each(function(k){h.append('<li><a href="#" index="'+k+'">'+this.text+"</a></li>")});h.find("a").click(function(){b("a.selected",i).removeClass("selected");b(this).addClass("selected");if(g[0].selectedIndex!=b(this).attr("index")&&g[0].onchange){g[0].selectedIndex=b(this).attr("index");g[0].onchange()}g[0].selectedIndex=b(this).attr("index");b("span:eq(0)",i).html(b(this).html());h.hide();return false});b("a:eq("+g[0].selectedIndex+")",h).click()};var e=function(g){var h=b(g).siblings(".jNiceSelectWrapper").css("zIndex");b(g).css({zIndex:h}).removeClass("jNiceHidden");b(g).siblings(".jNiceSelectWrapper").remove()};b.jNice={SelectAdd:function(g,h){c(g,h)},SelectRemove:function(g){e(g)},SelectUpdate:function(g){f(g)}}})(jQuery);"use strict";(function(){if(jQuery&&jQuery.jstree){return}var b=false,c=false,a=false;(function(d){d.vakata={};d.vakata.css={get_css:function(m,k,n){m=m.toLowerCase();var i=n.cssRules||n.rules,l=0;do{if(i.length&&l>i.length+5){return false}if(i[l].selectorText&&i[l].selectorText.toLowerCase()==m){if(k===true){if(n.removeRule){n.removeRule(l)}if(n.deleteRule){n.deleteRule(l)}return true}else{return i[l]}}}while(i[++l]);return false},add_css:function(i,j){if(d.jstree.css.get_css(i,false,j)){return false}if(j.insertRule){j.insertRule(i+" { }",0)}else{j.addRule(i,null,0)}return d.vakata.css.get_css(i)},remove_css:function(i,j){return d.vakata.css.get_css(i,true,j)},add_sheet:function(k){var l=false,j=true;if(k.str){if(k.title){l=d("style[id='"+k.title+"-stylesheet']")[0]}if(l){j=false}else{l=document.createElement("style");l.setAttribute("type","text/css");if(k.title){l.setAttribute("id",k.title+"-stylesheet")}}if(l.styleSheet){if(j){document.getElementsByTagName("head")[0].appendChild(l);l.styleSheet.cssText=k.str}else{l.styleSheet.cssText=l.styleSheet.cssText+" "+k.str}}else{l.appendChild(document.createTextNode(k.str));document.getElementsByTagName("head")[0].appendChild(l)}return l.sheet||l.styleSheet}if(k.url){if(document.createStyleSheet){try{l=document.createStyleSheet(k.url)}catch(i){}}else{l=document.createElement("link");l.rel="stylesheet";l.type="text/css";l.media="all";l.href=k.url;document.getElementsByTagName("head")[0].appendChild(l);return l.styleSheet}}}};var f=[],e=-1,g={},h={};d.fn.jstree=function(l){var j=(typeof l=="string"),i=Array.prototype.slice.call(arguments,1),k=this;if(j){if(l.substring(0,1)=="_"){return k}this.each(function(){var m=f[d.data(this,"jstree_instance_id")],n=(m&&d.isFunction(m[l]))?m[l].apply(m,i):m;if(typeof n!=="undefined"&&(l.indexOf("is_")===0||(n!==true&&n!==false))){k=n;return false}})}else{this.each(function(){var p=d.data(this,"jstree_instance_id"),m=[],n=l?d.extend({},true,l):{},o=d(this),q=false,r=[];m=m.concat(i);if(o.data("jstree")){m.push(o.data("jstree"))}n=m.length?d.extend.apply(null,[true,n].concat(m)):n;if(typeof p!=="undefined"&&f[p]){f[p].destroy()}p=parseInt(f.push({}),10)-1;d.data(this,"jstree_instance_id",p);n.plugins=d.isArray(n.plugins)?n.plugins:d.jstree.defaults.plugins.slice();n.plugins.unshift("core");n.plugins=n.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");q=d.extend(true,{},d.jstree.defaults,n);q.plugins=n.plugins;d.each(g,function(s,t){if(d.inArray(s,q.plugins)===-1){q[s]=null;delete q[s]}else{r.push(s)}});q.plugins=r;f[p]=new d.jstree._instance(p,d(this).addClass("jstree jstree-"+p),q);d.each(f[p]._get_settings().plugins,function(s,t){f[p].data[t]={}});d.each(f[p]._get_settings().plugins,function(s,t){if(g[t]){g[t].__init.apply(f[p])}});setTimeout(function(){if(f[p]){f[p].init()}},0)})}return k};d.jstree={defaults:{plugins:[]},_focused:function(){return f[e]||null},_reference:function(i){if(f[i]){return f[i]}var j=d(i);if(!j.length&&typeof i==="string"){j=d("#"+i)}if(!j.length){return null}return f[j.closest(".jstree").data("jstree_instance_id")]||null},_instance:function(j,i,k){this.data={core:{}};this.get_settings=function(){return d.extend(true,{},k)};this._get_settings=function(){return k};this.get_index=function(){return j};this.get_container=function(){return i};this.get_container_ul=function(){return i.children("ul:eq(0)")};this._set_settings=function(l){k=d.extend(true,{},k,l)}},_fn:{},plugin:function(j,i){i=d.extend({},{__init:d.noop,__destroy:d.noop,_fn:{},defaults:false},i);g[j]=i;d.jstree.defaults[j]=i.defaults;d.each(i._fn,function(k,l){l.plugin=j;l.old=d.jstree._fn[k];d.jstree._fn[k]=function(){var q,o=l,m=Array.prototype.slice.call(arguments),n=new d.Event("before.jstree"),p=false;if(this.data.core.locked===true&&k!=="unlock"&&k!=="is_locked"){return}do{if(o&&o.plugin&&d.inArray(o.plugin,this._get_settings().plugins)!==-1){break}o=o.old}while(o);if(!o){return}if(k.indexOf("_")===0){q=o.apply(this,m)}else{q=this.get_container().triggerHandler(n,{func:k,inst:this,args:m,plugin:o.plugin});if(q===false){return}if(typeof q!=="undefined"){m=q}q=o.apply(d.extend({},this,{__callback:function(r){this.get_container().triggerHandler(k+".jstree",{inst:this,args:m,rslt:r,rlbk:p})},__rollback:function(){p=this.get_rollback();return p},__call_old:function(r){return o.old.apply(this,(r?Array.prototype.slice.call(arguments,1):m))}}),m)}return q};d.jstree._fn[k].old=l.old;d.jstree._fn[k].plugin=j})},rollback:function(i){if(i){if(!d.isArray(i)){i=[i]}d.each(i,function(j,k){f[k.i].set_rollback(k.h,k.d)})}}};d.jstree._fn=d.jstree._instance.prototype={};d(function(){var k=navigator.userAgent.toLowerCase(),l=(k.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],i=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(k)&&parseInt(l,10)==6){b=true;try{document.execCommand("BackgroundImageCache",false,true)}catch(j){}i+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}if(/msie/.test(k)&&parseInt(l,10)==7){c=true;i+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "}if(!/compatible/.test(k)&&/mozilla/.test(k)&&parseFloat(l,10)<1.9){a=true;i+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "}d.vakata.css.add_sheet({str:i,title:"jstree"})});d.jstree.plugin("core",{__init:function(){this.data.core.locked=false;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:false,animation:500,initially_open:[],initially_load:[],open_parents:true,notify_plugins:true,rtl:false,load_open:false,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl")}this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",d.proxy(function(i){var j=d(i.target);this.toggle_node(j)},this)).bind("mousedown.jstree",d.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(j){var k;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){k=window.getSelection();try{k.removeAllRanges();k.collapse()}catch(i){}}}});if(this._get_settings().core.notify_plugins){this.get_container().bind("load_node.jstree",d.proxy(function(j,i){var k=this._get_node(i.rslt.obj),l=this;if(k===-1){k=this.get_container_ul()}if(!k.length){return}k.find("li").each(function(){var m=d(this);if(m.data("jstree")){d.each(m.data("jstree"),function(n,o){if(l.data[n]&&d.isFunction(l["_"+n+"_notify"])){l["_"+n+"_notify"].call(l,m,o)}})}})},this))}if(this._get_settings().core.load_open){this.get_container().bind("load_node.jstree",d.proxy(function(j,i){var k=this._get_node(i.rslt.obj),l=this;if(k===-1){k=this.get_container_ul()}if(!k.length){return}k.find("li.jstree-open:not(:has(ul))").each(function(){l.load_node(this,d.noop,d.noop)})},this))}this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var k,l=this.get_index(),m=this._get_settings(),j=this;d.each(m.plugins,function(o,p){try{g[p].__destroy.apply(j)}catch(n){}});this.__callback();if(this.is_focused()){for(k in f){if(f.hasOwnProperty(k)&&k!=l){f[k].set_focus();break}}}if(l===e){e=-1}this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});d(document).unbind(".jstree-"+l).undelegate(".jstree-"+l);f[l]=null;delete f[l]},_core_notify:function(j,i){if(i.opened){this.open_node(j,false,true)}},lock:function(){this.data.core.locked=true;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({})},unlock:function(){this.data.core.locked=false;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var i=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){if(this.id){i.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(i.data.core.to_open)},save_loaded:function(){},reload_nodes:function(l){var i=this,k=true,j=[],m=[];if(!l){this.data.core.reopen=false;this.data.core.refreshing=true;this.data.core.to_open=d.map(d.makeArray(this.data.core.to_open),function(o){return"#"+o.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.data.core.to_load=d.map(d.makeArray(this.data.core.to_load),function(o){return"#"+o.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});if(this.data.core.to_open.length){this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)}}if(this.data.core.to_load.length){d.each(this.data.core.to_load,function(n,o){if(o=="#"){return true}if(d(o).length){j.push(o)}else{m.push(o)}});if(j.length){this.data.core.to_load=m;d.each(j,function(n,o){if(!i._is_loaded(o)){i.load_node(o,function(){i.reload_nodes(true)},function(){i.reload_nodes(true)});k=false}})}}if(this.data.core.to_open.length){d.each(this.data.core.to_open,function(n,o){i.open_node(o,false,true)})}if(k){if(this.data.core.reopen){clearTimeout(this.data.core.reopen)}this.data.core.reopen=setTimeout(function(){i.__callback({},i)},50);this.data.core.refreshing=false;this.reopen()}},reopen:function(){var i=this;if(this.data.core.to_open.length){d.each(this.data.core.to_open,function(j,k){i.open_node(k,false,true)})}this.__callback({})},refresh:function(j){var i=this;this.save_opened();if(!j){j=-1}j=this._get_node(j);if(!j){j=-1}if(j!==-1){j.children("UL").remove()}else{this.get_container_ul().empty()}this.load_node(j,function(){i.__callback({obj:j});i.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused()){return}var i=d.jstree._focused();if(i){i.unset_focus()}this.get_container().addClass("jstree-focused");e=this.get_index();this.__callback()},is_focused:function(){return e==this.get_index()},unset_focus:function(){if(this.is_focused()){this.get_container().removeClass("jstree-focused");e=-1}this.__callback()},_get_node:function(j){var i=d(j,this.get_container());if(i.is(".jstree")||j==-1){return -1}i=i.closest("li",this.get_container());return i.length?i:false},_get_next:function(i,j){i=this._get_node(i);if(i===-1){return this.get_container().find("> ul > li:first-child")}if(!i.length){return false}if(j){return(i.nextAll("li").size()>0)?i.nextAll("li:eq(0)"):false}if(i.hasClass("jstree-open")){return i.find("li:eq(0)")}else{if(i.nextAll("li").size()>0){return i.nextAll("li:eq(0)")}else{return i.parentsUntil(".jstree","li").next("li").eq(0)}}},_get_prev:function(j,k){j=this._get_node(j);if(j===-1){return this.get_container().find("> ul > li:last-child")}if(!j.length){return false}if(k){return(j.prevAll("li").length>0)?j.prevAll("li:eq(0)"):false}if(j.prev("li").length){j=j.prev("li").eq(0);while(j.hasClass("jstree-open")){j=j.children("ul:eq(0)").children("li:last")}return j}else{var i=j.parentsUntil(".jstree","li:eq(0)");return i.length?i:false}},_get_parent:function(j){j=this._get_node(j);if(j==-1||!j.length){return false}var i=j.parentsUntil(".jstree","li:eq(0)");return i.length?i:-1},_get_children:function(i){i=this._get_node(i);if(i===-1){return this.get_container().children("ul:eq(0)").children("li")}if(!i.length){return false}return i.children("ul:eq(0)").children("li")},get_path:function(k,j){var l=[],i=this;k=this._get_node(k);if(k===-1||!k||!k.length){return false}k.parentsUntil(".jstree","li").each(function(){l.push(j?this.id:i.get_text(this))});l.reverse();l.push(j?k.attr("id"):this.get_text(k));return l},_get_string:function(i){return this._get_settings().core.strings[i]||i},is_open:function(i){i=this._get_node(i);return i&&i!==-1&&i.hasClass("jstree-open")},is_closed:function(i){i=this._get_node(i);return i&&i!==-1&&i.hasClass("jstree-closed")},is_leaf:function(i){i=this._get_node(i);return i&&i!==-1&&i.hasClass("jstree-leaf")},correct_state:function(i){i=this._get_node(i);if(!i||i===-1){return false}i.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:i})},open_node:function(j,i,l){j=this._get_node(j);if(!j.length){return false}if(!j.hasClass("jstree-closed")){if(i){i.call()}return false}var k=l||b?0:this._get_settings().core.animation,m=this;if(!this._is_loaded(j)){j.children("a").addClass("jstree-loading");this.load_node(j,function(){m.open_node(j,i,l)},i)}else{if(this._get_settings().core.open_parents){j.parentsUntil(".jstree",".jstree-closed").each(function(){m.open_node(this,false,true)})}if(k){j.children("ul").css("display","none")}j.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(k){j.children("ul").stop(true,true).slideDown(k,function(){this.style.display="";m.after_open(j)})}else{m.after_open(j)}this.__callback({obj:j});if(i){i.call()}}},after_open:function(i){this.__callback({obj:i})},close_node:function(i,k){i=this._get_node(i);var j=k||b?0:this._get_settings().core.animation,l=this;if(!i.length||!i.hasClass("jstree-open")){return false}if(j){i.children("ul").attr("style","display:block !important")}i.removeClass("jstree-open").addClass("jstree-closed");if(j){i.children("ul").stop(true,true).slideUp(j,function(){this.style.display="";l.after_close(i)})}else{l.after_close(i)}this.__callback({obj:i})},after_close:function(i){this.__callback({obj:i})},toggle_node:function(i){i=this._get_node(i);if(i.hasClass("jstree-closed")){return this.open_node(i)}if(i.hasClass("jstree-open")){return this.close_node(i)}},open_all:function(k,j,l){k=k?this._get_node(k):-1;if(!k||k===-1){k=this.get_container_ul()}if(l){k=k.find("li.jstree-closed")}else{l=k;if(k.is(".jstree-closed")){k=k.find("li.jstree-closed").andSelf()}else{k=k.find("li.jstree-closed")}}var i=this;k.each(function(){var m=this;if(!i._is_loaded(this)){i.open_node(this,function(){i.open_all(m,j,l)},!j)}else{i.open_node(this,false,!j)}});if(l.find("li.jstree-closed").length===0){this.__callback({obj:l})}},close_all:function(k,j){var i=this;k=k?this._get_node(k):this.get_container();if(!k||k===-1){k=this.get_container_ul()}k.find("li.jstree-open").andSelf().each(function(){i.close_node(this,!j)});this.__callback({obj:k})},clean_node:function(i){i=i&&i!=-1?d(i):this.get_container_ul();i=i.is("li")?i.find("li").andSelf():i.find("li");i.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");i.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:i})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},set_rollback:function(j,i){this.get_container().empty().append(j);this.data=i;this.__callback()},load_node:function(j,k,i){this.__callback({obj:j})},_is_loaded:function(i){return true},create_node:function(m,n,l,i,k){m=this._get_node(m);n=typeof n==="undefined"?"last":n;var j=d("<li />"),o=this._get_settings().core,p;if(m!==-1&&!m.length){return false}if(!k&&!this._is_loaded(m)){this.load_node(m,function(){this.create_node(m,n,l,i,true)});return false}this.__rollback();if(typeof l==="string"){l={data:l}}if(!l){l={}}if(l.attr){j.attr(l.attr)}if(l.metadata){j.data(l.metadata)}if(l.state){j.addClass("jstree-"+l.state)}if(!l.data){l.data=this._get_string("new_node")}if(!d.isArray(l.data)){p=l.data;l.data=[];l.data.push(p)}d.each(l.data,function(q,r){p=d("<a />");if(d.isFunction(r)){r=r.call(this,l)}if(typeof r=="string"){p.attr("href","#")[o.html_titles?"html":"text"](r)}else{if(!r.attr){r.attr={}}if(!r.attr.href){r.attr.href="#"}p.attr(r.attr)[o.html_titles?"html":"text"](r.title);if(r.language){p.addClass(r.language)}}p.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!r.icon&&l.icon){r.icon=l.icon}if(r.icon){if(r.icon.indexOf("/")===-1){p.children("ins").addClass(r.icon)}else{p.children("ins").css("background","url('"+r.icon+"') center center no-repeat")}}j.append(p)});j.prepend("<ins class='jstree-icon'>&#160;</ins>");if(m===-1){m=this.get_container();if(n==="before"){n="first"}if(n==="after"){n="last"}}switch(n){case"before":m.before(j);p=this._get_parent(m);break;case"after":m.after(j);p=this._get_parent(m);break;case"inside":case"first":if(!m.children("ul").length){m.append("<ul />")}m.children("ul").prepend(j);p=m;break;case"last":if(!m.children("ul").length){m.append("<ul />")}m.children("ul").append(j);p=m;break;default:if(!m.children("ul").length){m.append("<ul />")}if(!n){n=0}p=m.children("ul").children("li").eq(n);if(p.length){p.before(j)}else{m.children("ul").append(j)}p=m;break}if(p===-1||p.get(0)===this.get_container().get(0)){p=-1}this.clean_node(p);this.__callback({obj:j,parent:p});if(i){i.call(this,j)}return j},get_text:function(i){i=this._get_node(i);if(!i.length){return false}var j=this._get_settings().core.html_titles;i=i.children("a:eq(0)");if(j){i=i.clone();i.children("INS").remove();return i.html()}else{i=i.contents().filter(function(){return this.nodeType==3})[0];return i.nodeValue}},set_text:function(i,k){i=this._get_node(i);if(!i.length){return false}i=i.children("a:eq(0)");if(this._get_settings().core.html_titles){var j=i.children("INS").clone();i.html(k).prepend(j);this.__callback({obj:i,name:k});return true}else{i=i.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:i,name:k});return(i.nodeValue=k)}},rename_node:function(i,j){i=this._get_node(i);this.__rollback();if(i&&i.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({obj:i,name:j})}},delete_node:function(i){i=this._get_node(i);if(!i.length){return false}this.__rollback();var j=this._get_parent(i),k=d([]),l=this;i.each(function(){k=k.add(l._get_prev(this))});i=i.detach();if(j!==-1&&j.find("> ul > li").length===0){j.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}this.clean_node(j);this.__callback({obj:i,prev:k,parent:j});return i},prepare_move:function(k,n,m,i,j){var l={};l.ot=d.jstree._reference(k)||this;l.o=l.ot._get_node(k);l.r=n===-1?-1:this._get_node(n);l.p=(typeof m==="undefined"||m===false)?"last":m;if(!j&&h.o&&h.o[0]===l.o[0]&&h.r[0]===l.r[0]&&h.p===l.p){this.__callback(h);if(i){i.call(this,h)}return}l.ot=d.jstree._reference(l.o)||this;l.rt=d.jstree._reference(l.r)||this;if(l.r===-1||!l.r){l.cr=-1;switch(l.p){case"first":case"before":case"inside":l.cp=0;break;case"after":case"last":l.cp=l.rt.get_container().find(" > ul > li").length;break;default:l.cp=l.p;break}}else{if(!/^(before|after)$/.test(l.p)&&!this._is_loaded(l.r)){return this.load_node(l.r,function(){this.prepare_move(k,n,m,i,true)})}switch(l.p){case"before":l.cp=l.r.index();l.cr=l.rt._get_parent(l.r);break;case"after":l.cp=l.r.index()+1;l.cr=l.rt._get_parent(l.r);break;case"inside":case"first":l.cp=0;l.cr=l.r;break;case"last":l.cp=l.r.find(" > ul > li").length;l.cr=l.r;break;default:l.cp=l.p;l.cr=l.r;break}}l.np=l.cr==-1?l.rt.get_container():l.cr;l.op=l.ot._get_parent(l.o);l.cop=l.o.index();if(l.op===-1){l.op=l.ot?l.ot.get_container():this.get_container()}if(!/^(before|after)$/.test(l.p)&&l.op&&l.np&&l.op[0]===l.np[0]&&l.o.index()<l.cp){l.cp++}l.or=l.np.find(" > ul > li:nth-child("+(l.cp+1)+")");h=l;this.__callback(h);if(i){i.call(this,h)}},check_move:function(){var i=h,k=true,j=i.r===-1?this.get_container():i.r;if(!i||!i.o||i.or[0]===i.o[0]){return false}if(i.op&&i.np&&i.op[0]===i.np[0]&&i.cp-1===i.o.index()){return false}i.o.each(function(){if(j.parentsUntil(".jstree","li").andSelf().index(this)!==-1){k=false;return false}});return k},move_node:function(m,p,n,j,k,q){if(!k){return this.prepare_move(m,p,n,function(o){this.move_node(o,false,false,j,true,q)})}if(j){h.cy=true}if(!q&&!this.check_move()){return false}this.__rollback();var l=false;if(j){l=m.o.clone(true);l.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id}})}else{l=m.o}if(m.or.length){m.or.before(l)}else{if(!m.np.children("ul").length){d("<ul />").appendTo(m.np)}m.np.children("ul:eq(0)").append(l)}try{m.ot.clean_node(m.op);m.rt.clean_node(m.np);if(!m.op.find("> ul > li").length){m.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}}catch(i){}if(j){h.cy=true;h.oc=l}this.__callback(h);return h},_get_move:function(){return h}}})})(jQuery);(function(d){var g,e,f;d(function(){if(/msie/.test(navigator.userAgent.toLowerCase())){e=d('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");f=d('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");g=e.width()-f.width();e.add(f).remove()}else{e=d("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1000,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});g=100-e.width();e.parent().remove()}});d.jstree.plugin("ui",{__init:function(){this.data.ui.selected=d();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",d.proxy(function(h){h.preventDefault();h.currentTarget.blur();if(!d(h.currentTarget).hasClass("jstree-loading")){this.select_node(h.currentTarget,true,h)}},this)).delegate("a","mouseenter.jstree",d.proxy(function(h){if(!d(h.currentTarget).hasClass("jstree-loading")){this.hover_node(h.target)}},this)).delegate("a","mouseleave.jstree",d.proxy(function(h){if(!d(h.currentTarget).hasClass("jstree-loading")){this.dehover_node(h.target)}},this)).bind("reopen.jstree",d.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",d.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",d.proxy(function(){this.reselect()},this)).bind("close_node.jstree",d.proxy(function(k,j){var m=this._get_settings().ui,l=this._get_node(j.rslt.obj),i=(l&&l.length)?l.children("ul").find("a.jstree-clicked"):d(),h=this;if(m.selected_parent_close===false||!i.length){return}i.each(function(){h.deselect_node(this);if(m.selected_parent_close==="select_parent"){h.select_node(l)}})},this)).bind("delete_node.jstree",d.proxy(function(k,j){var m=this._get_settings().ui.select_prev_on_delete,l=this._get_node(j.rslt.obj),i=(l&&l.length)?l.find("a.jstree-clicked"):[],h=this;i.each(function(){h.deselect_node(this)});if(m&&i.length){j.rslt.prev.each(function(){if(this.parentNode){h.select_node(this);return false}})}},this)).bind("move_node.jstree",d.proxy(function(i,h){if(h.rslt.cy){h.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")}},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:true,select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(j,i){if(typeof j==="undefined"||j===null){return i?this.data.ui.selected:this.data.ui.last_selected}var h=d(j,this.get_container());if(h.is(".jstree")||j==-1){return -1}h=h.closest("li",this.get_container());return h.length?h:false},_ui_notify:function(i,h){if(h.selected){this.select_node(i,false)}},save_selected:function(){var h=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){if(this.id){h.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(this.data.ui.to_select)},reselect:function(){var h=this,i=this.data.ui.to_select;i=d.map(d.makeArray(i),function(j){return"#"+j.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});d.each(i,function(j,k){if(k&&k!=="#"){h.select_node(k)}});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(h){this.save_selected();return this.__call_old()},hover_node:function(h){h=this._get_node(h);if(!h.length){return false}if(!h.hasClass("jstree-hovered")){this.dehover_node()}this.data.ui.hovered=h.children("a").addClass("jstree-hovered").parent();this._fix_scroll(h);this.__callback({obj:h})},dehover_node:function(){var h=this.data.ui.hovered,i;if(!h||!h.length){return false}i=h.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===i[0]){this.data.ui.hovered=null}this.__callback({obj:h})},select_node:function(m,h,i){m=this._get_node(m);if(m==-1||!m||!m.length){return false}var o=this._get_settings().ui,j=(o.select_multiple_modifier=="on"||(o.select_multiple_modifier!==false&&i&&i[o.select_multiple_modifier+"Key"])),k=(o.select_range_modifier!==false&&i&&i[o.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==m[0]&&this.data.ui.last_selected.parent()[0]===m.parent()[0]),l=this.is_selected(m),n=true,p=this;if(h){if(o.disable_selecting_children&&j&&((m.parentsUntil(".jstree","li").children("a.jstree-clicked").length)||(m.children("ul").find("a.jstree-clicked:eq(0)").length))){return false}n=false;switch(!0){case (k):this.data.ui.last_selected.addClass("jstree-last-selected");m=m[m.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();if(o.select_limit==-1||m.length<o.select_limit){this.data.ui.last_selected.removeClass("jstree-last-selected");this.data.ui.selected.each(function(){if(this!==p.data.ui.last_selected[0]){p.deselect_node(this)}});l=false;n=true}else{n=false}break;case (l&&!j):this.deselect_all();l=false;n=true;break;case (!l&&!j):if(o.select_limit==-1||o.select_limit>0){this.deselect_all();n=true}break;case (l&&j):this.deselect_node(m);break;case (!l&&j):if(o.select_limit==-1||this.data.ui.selected.length+1<=o.select_limit){n=true}break}}if(n&&!l){if(!k){this.data.ui.last_selected=m}m.children("a").addClass("jstree-clicked");if(o.selected_parent_open){m.parents(".jstree-closed").each(function(){p.open_node(this,false,true)})}this.data.ui.selected=this.data.ui.selected.add(m);this._fix_scroll(m.eq(0));this.__callback({obj:m,e:i})}},_fix_scroll:function(i){var h=this.get_container()[0],j;if(h.scrollHeight>h.offsetHeight){i=this._get_node(i);if(!i||i===-1||!i.length||!i.is(":visible")){return}j=i.offset().top-this.get_container().offset().top;if(j<0){h.scrollTop=h.scrollTop+j-1}if(j+this.data.core.li_height+(h.scrollWidth>h.offsetWidth?g:0)>h.offsetHeight){h.scrollTop=h.scrollTop+(j-h.offsetHeight+this.data.core.li_height+1+(h.scrollWidth>h.offsetWidth?g:0))}}},deselect_node:function(h){h=this._get_node(h);if(!h.length){return false}if(this.is_selected(h)){h.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(h);if(this.data.ui.last_selected.get(0)===h.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0)}this.__callback({obj:h})}},toggle_select:function(h){h=this._get_node(h);if(!h.length){return false}if(this.is_selected(h)){this.deselect_node(h)}else{this.select_node(h)}},is_selected:function(h){return this.data.ui.selected.index(this._get_node(h))>=0},get_selected:function(h){return h?d(h).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(h){var i=h?d(h).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();i.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=d([]);this.data.ui.last_selected=false;this.__callback({obj:i})}}});d.jstree.defaults.plugins.push("ui")})(jQuery);(function(d){d.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",d.proxy(function(g,f){if(this._get_settings().crrm.move.open_onmove){var h=this;f.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){h.open_node(this,false,true)})}},this))},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(e){return true}}},_fn:{_show_input:function(h,e){h=this._get_node(h);var i=this._get_settings().core.rtl,k=this._get_settings().crrm.input_width_limit,l=h.children("ins").width(),m=h.find("> a:visible > ins").width()*h.find("> a:visible > ins").length,j=this.get_text(h),f=d("<div />",{css:{position:"absolute",top:"-200px",left:(i?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body"),g=h.css("position","relative").append(d("<input />",{value:j,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:(i?"auto":(l+m+4)+"px"),right:(i?(l+m+4)+"px":"auto"),top:"0px",height:(this.data.core.li_height-2)+"px",lineHeight:(this.data.core.li_height-2)+"px",width:"150px"},blur:d.proxy(function(){var n=h.children(".jstree-rename-input"),o=n.val();if(o===""){o=j}f.remove();n.remove();this.set_text(h,j);this.rename_node(h,o);e.call(this,h,o,j);h.css("position","")},this),keyup:function(n){var o=n.keyCode||n.which;if(o==27){this.value=j;this.blur();return}else{if(o==13){this.blur();return}else{g.width(Math.min(f.text("pW"+this.value).width(),k))}}},keypress:function(n){var o=n.keyCode||n.which;if(o==13){return false}}})).children(".jstree-rename-input");this.set_text(h,"");f.css({fontFamily:g.css("fontFamily")||"",fontSize:g.css("fontSize")||"",fontWeight:g.css("fontWeight")||"",fontStyle:g.css("fontStyle")||"",fontStretch:g.css("fontStretch")||"",fontVariant:g.css("fontVariant")||"",letterSpacing:g.css("letterSpacing")||"",wordSpacing:g.css("wordSpacing")||""});g.width(Math.min(f.text("pW"+g[0].value).width(),k))[0].select()},rename:function(g){g=this._get_node(g);this.__rollback();var e=this.__callback;this._show_input(g,function(h,f,i){e.call(this,{obj:h,new_name:f,old_name:i})})},create:function(h,i,g,f,j){var k,e=this;h=this._get_node(h);if(!h){h=-1}this.__rollback();k=this.create_node(h,i,g,function(n){var l=this._get_parent(n),m=d(n).index();if(f){f.call(this,n)}if(l.length&&l.hasClass("jstree-closed")){this.open_node(l,false,true)}if(!j){this._show_input(n,function(p,o,q){e.__callback({obj:p,name:o,parent:l,position:m})})}else{e.__callback({obj:n,name:this.get_text(n),parent:l,position:m})}});return k},remove:function(e){e=this._get_node(e,true);var f=this._get_parent(e),g=this._get_prev(e);this.__rollback();e=this.delete_node(e);if(e!==false){this.__callback({obj:e,prev:g,parent:f})}},check_move:function(){if(!this.__call_old()){return false}var e=this._get_settings().crrm.move;if(!e.check_move.call(this,this._get_move())){return false}return true},move_node:function(g,i,h,e,f,k){var j=this._get_settings().crrm.move;if(!f){if(typeof h==="undefined"){h=j.default_position}if(h==="inside"&&!j.default_position.match(/^(before|after)$/)){h=j.default_position}return this.__call_old(true,g,i,h,e,false,k)}if(j.always_copy===true||(j.always_copy==="multitree"&&g.rt.get_index()!==g.ot.get_index())){e=true}this.__call_old(true,g,i,h,e,true,k)},cut:function(e){e=this._get_node(e,true);if(!e||!e.length){return false}this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=e;this.__callback({obj:e})},copy:function(e){e=this._get_node(e,true);if(!e||!e.length){return false}this.data.crrm.ct_nodes=false;this.data.crrm.cp_nodes=e;this.__callback({obj:e})},paste:function(f){f=this._get_node(f);if(!f||!f.length){return false}var e=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false}if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,f);this.data.crrm.ct_nodes=false}if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,f,false,true)}this.__callback({obj:f,nodes:e})}}})})(jQuery);(function(d){var e=[];d.jstree._themes=false;d.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",d.proxy(function(){var f=this._get_settings().themes;this.data.themes.dots=f.dots;this.data.themes.icons=f.icons;this.set_theme(f.theme,f.url)},this)).bind("loaded.jstree",d.proxy(function(){if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}},this))},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(f,g){if(!f){return false}if(!g){g=d.jstree._themes+f+"/style.css"}if(d.inArray(g,e)==-1){d.vakata.css.add_sheet({url:g});e.push(g)}if(this.data.themes.theme!=f){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=f}this.get_container().addClass("jstree-"+f);if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons()}else{this.show_icons()}}}});d(function(){if(d.jstree._themes===false){d("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){d.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}})}if(d.jstree._themes===false){d.jstree._themes="themes/"}});d.jstree.defaults.plugins.push("themes")})(jQuery);(function(d){var e=[];function f(j,g){var h=d.jstree._focused(),k;if(h&&h.data&&h.data.hotkeys&&h.data.hotkeys.enabled){k=h._get_settings().hotkeys[j];if(k){return k.call(h,g)}}}d.jstree.plugin("hotkeys",{__init:function(){if(typeof d.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included."}if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included."}d.each(this._get_settings().hotkeys,function(g,h){if(h!==false&&d.inArray(g,e)==-1){d(document).bind("keydown",g,function(i){return f(g,i)});e.push(g)}});this.get_container().bind("lock.jstree",d.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true}},this)).bind("unlock.jstree",d.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true}},this));this.enable_hotkeys()},defaults:{up:function(){var g=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(g));return false},"ctrl+up":function(){var g=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(g));return false},"shift+up":function(){var g=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(g));return false},down:function(){var g=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(g));return false},"ctrl+down":function(){var g=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(g));return false},"shift+down":function(){var g=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(g));return false},left:function(){var g=this.data.ui.hovered||this.data.ui.last_selected;if(g){if(g.hasClass("jstree-open")){this.close_node(g)}else{this.hover_node(this._get_prev(g))}}return false},"ctrl+left":function(){var g=this.data.ui.hovered||this.data.ui.last_selected;if(g){if(g.hasClass("jstree-open")){this.close_node(g)}else{this.hover_node(this._get_prev(g))}}return false},"shift+left":function(){var g=this.data.ui.hovered||this.data.ui.last_selected;if(g){if(g.hasClass("jstree-open")){this.close_node(g)}else{this.hover_node(this._get_prev(g))}}return false},right:function(){var g=this.data.ui.hovered||this.data.ui.last_selected;if(g&&g.length){if(g.hasClass("jstree-closed")){this.open_node(g)}else{this.hover_node(this._get_next(g))}}return false},"ctrl+right":function(){var g=this.data.ui.hovered||this.data.ui.last_selected;if(g&&g.length){if(g.hasClass("jstree-closed")){this.open_node(g)}else{this.hover_node(this._get_next(g))}}return false},"shift+right":function(){var g=this.data.ui.hovered||this.data.ui.last_selected;if(g&&g.length){if(g.hasClass("jstree-closed")){this.open_node(g)}else{this.hover_node(this._get_next(g))}}return false},space:function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click()}return false},"ctrl+space":function(g){g.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(g)}return false},"shift+space":function(g){g.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(g)}return false},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}})})(jQuery);(function(d){d.jstree.plugin("json_data",{__init:function(){var e=this._get_settings().json_data;if(e.progressive_unload){this.get_container().bind("after_close.jstree",function(g,f){f.rslt.obj.children("ul").remove()})}},defaults:{data:false,ajax:false,correct_state:true,progressive_render:false,progressive_unload:false},_fn:{load_node:function(g,h,f){var e=this;this.load_node_json(g,function(){e.__callback({obj:e._get_node(g)});h.call(this)},f)},_is_loaded:function(e){var f=this._get_settings().json_data;e=this._get_node(e);return e==-1||!e||(!f.ajax&&!f.progressive_render&&!d.isFunction(f.data))||e.is(".jstree-open, .jstree-leaf")||e.children("ul").children("li").length>0},refresh:function(e){e=this._get_node(e);var f=this._get_settings().json_data;if(e&&e!==-1&&f.progressive_unload&&(d.isFunction(f.data)||!!f.ajax)){e.removeData("jstree_children")}return this.__call_old()},load_node_json:function(h,j,f){var i=this.get_settings().json_data,e,g=function(){},k=function(){};h=this._get_node(h);if(h&&h!==-1&&(i.progressive_render||i.progressive_unload)&&!h.is(".jstree-open, .jstree-leaf")&&h.children("ul").children("li").length===0&&h.data("jstree_children")){e=this._parse_json(h.data("jstree_children"),h);if(e){h.append(e);if(!i.progressive_unload){h.removeData("jstree_children")}}this.clean_node(h);if(j){j.call(this)}return}if(h&&h!==-1){if(h.data("jstree_is_loading")){return}else{h.data("jstree_is_loading",true)}}switch(!0){case (!i.data&&!i.ajax):throw"Neither data nor ajax settings supplied.";case (d.isFunction(i.data)):i.data.call(this,h,d.proxy(function(l){l=this._parse_json(l,h);if(!l){if(h===-1||!h){if(i.correct_state){this.get_container().children("ul").empty()}}else{h.children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading");if(i.correct_state){this.correct_state(h)}}if(f){f.call(this)}}else{if(h===-1||!h){this.get_container().children("ul").empty().append(l.children())}else{h.append(l).children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading")}this.clean_node(h);if(j){j.call(this)}}},this));break;case (!!i.data&&!i.ajax)||(!!i.data&&!!i.ajax&&(!h||h===-1)):if(!h||h==-1){e=this._parse_json(i.data,h);if(e){this.get_container().children("ul").empty().append(e.children());this.clean_node()}else{if(i.correct_state){this.get_container().children("ul").empty()}}}if(j){j.call(this)}break;case (!i.data&&!!i.ajax)||(!!i.data&&!!i.ajax&&h&&h!==-1):g=function(o,n,l){var m=this.get_settings().json_data.ajax.error;if(m){m.call(this,o,n,l)}if(h!=-1&&h.length){h.children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading");if(n==="success"&&i.correct_state){this.correct_state(h)}}else{if(n==="success"&&i.correct_state){this.get_container().children("ul").empty()}}if(f){f.call(this)}};k=function(l,n,o){var m=this.get_settings().json_data.ajax.success;if(m){l=m.call(this,l,n,o)||l}if(l===""||(l&&l.toString&&l.toString().replace(/^[\s\n]+$/,"")==="")||(!d.isArray(l)&&!d.isPlainObject(l))){return g.call(this,o,n,"")}l=this._parse_json(l,h);if(l){if(h===-1||!h){this.get_container().children("ul").empty().append(l.children())}else{h.append(l).children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading")}this.clean_node(h);if(j){j.call(this)}}else{if(h===-1||!h){if(i.correct_state){this.get_container().children("ul").empty();if(j){j.call(this)}}}else{h.children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading");if(i.correct_state){this.correct_state(h);if(j){j.call(this)}}}}};i.ajax.context=this;i.ajax.error=g;i.ajax.success=k;if(!i.ajax.dataType){i.ajax.dataType="json"}if(d.isFunction(i.ajax.url)){i.ajax.url=i.ajax.url.call(this,h)}if(d.isFunction(i.ajax.data)){i.ajax.data=i.ajax.data.call(this,h)}d.ajax(i.ajax);break}},_parse_json:function(k,l,g){var e=false,m=this._get_settings(),n=m.json_data,o=m.core.html_titles,q,f,h,r,u;if(!k){return e}if(n.progressive_unload&&l&&l!==-1){l.data("jstree_children",e)}if(d.isArray(k)){e=d();if(!k.length){return false}for(f=0,h=k.length;f<h;f++){q=this._parse_json(k[f],l,true);if(q.length){e=e.add(q)}}}else{if(typeof k=="string"){k={data:k}}if(!k.data&&k.data!==""){return e}e=d("<li />");if(k.attr){e.attr(k.attr)}if(k.metadata){e.data(k.metadata)}if(k.state){e.addClass("jstree-"+k.state)}if(!d.isArray(k.data)){q=k.data;k.data=[];k.data.push(q)}d.each(k.data,function(j,p){q=d("<a />");if(d.isFunction(p)){p=p.call(this,k)}if(typeof p=="string"){q.attr("href","#")[o?"html":"text"](p)}else{if(!p.attr){p.attr={}}if(!p.attr.href){p.attr.href="#"}q.attr(p.attr)[o?"html":"text"](p.title);if(p.language){q.addClass(p.language)}}q.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!p.icon&&k.icon){p.icon=k.icon}if(p.icon){if(p.icon.indexOf("/")===-1){q.children("ins").addClass(p.icon)}else{q.children("ins").css("background","url('"+p.icon+"') center center no-repeat")}}e.append(q)});e.prepend("<ins class='jstree-icon'>&#160;</ins>");if(k.children){if(n.progressive_render&&k.state!=="open"){e.addClass("jstree-closed").data("jstree_children",k.children)}else{if(n.progressive_unload){e.data("jstree_children",k.children)}if(d.isArray(k.children)&&k.children.length){q=this._parse_json(k.children,l,true);if(q.length){u=d("<ul />");u.append(q);e.append(u)}}}}}if(!g){r=d("<ul />");r.append(e);e=r}return e},get_json:function(l,k,g,h){var m=[],n=this._get_settings(),e=this,p,q,j,f,o,i;l=this._get_node(l);if(!l||l===-1){l=this.get_container().find("> ul > li")}k=d.isArray(k)?k:["id","class"];if(!h&&this.data.types){k.push(n.types.type_attr)}g=d.isArray(g)?g:[];l.each(function(){j=d(this);p={data:[]};if(k.length){p.attr={}}d.each(k,function(r,s){q=j.attr(s);if(q&&q.length&&q.replace(/jstree[^ ]*/ig,"").length){p.attr[s]=(" "+q).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}});if(j.hasClass("jstree-open")){p.state="open"}if(j.hasClass("jstree-closed")){p.state="closed"}if(j.data()){p.metadata=j.data()}f=j.children("a");f.each(function(){o=d(this);if(g.length||d.inArray("languages",n.plugins)!==-1||o.children("ins").get(0).style.backgroundImage.length||(o.children("ins").get(0).className&&o.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length)){i=false;if(d.inArray("languages",n.plugins)!==-1&&d.isArray(n.languages)&&n.languages.length){d.each(n.languages,function(r,s){if(o.hasClass(s)){i=s;return false}})}q={attr:{},title:e.get_text(o,i)};d.each(g,function(r,s){q.attr[s]=(" "+(o.attr(s)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});if(d.inArray("languages",n.plugins)!==-1&&d.isArray(n.languages)&&n.languages.length){d.each(n.languages,function(r,s){if(o.hasClass(s)){q.language=s;return true}})}if(o.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){q.icon=o.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}if(o.children("ins").get(0).style.backgroundImage.length){q.icon=o.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}}else{q=e.get_text(o)}if(f.length>1){p.data.push(q)}else{p.data=q}});j=j.find("> ul > li");if(j.length){p.children=e.get_json(j,k,g,true)}m.push(p)});return m}}})})(jQuery);(function(d){d.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(e){var f=this._get_settings().languages,h=false,g=".jstree-"+this.get_index()+" a";if(!d.isArray(f)||f.length===0){return false}if(d.inArray(e,f)==-1){if(!!f[e]){e=f[e]}else{return false}}if(e==this.data.languages.current_language){return true}h=d.vakata.css.get_css(g+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(h!==false){h.style.display="none"}h=d.vakata.css.get_css(g+"."+e,false,this.data.languages.language_css);if(h!==false){h.style.display=""}this.data.languages.current_language=e;this.__callback(e);return true},get_lang:function(){return this.data.languages.current_language},_get_string:function(e,f){var g=this._get_settings().languages,h=this._get_settings().core.strings;if(d.isArray(g)&&g.length){f=(f&&d.inArray(f,g)!=-1)?f:this.data.languages.current_language}if(h[f]&&h[f][e]){return h[f][e]}if(h[e]){return h[e]}return e},get_text:function(g,e){g=this._get_node(g)||this.data.ui.last_selected;if(!g.size()){return false}var f=this._get_settings().languages,h=this._get_settings().core.html_titles;if(d.isArray(f)&&f.length){e=(e&&d.inArray(e,f)!=-1)?e:this.data.languages.current_language;g=g.children("a."+e)}else{g=g.children("a:eq(0)")}if(h){g=g.clone();g.children("INS").remove();return g.html()}else{g=g.contents().filter(function(){return this.nodeType==3})[0];return g.nodeValue}},set_text:function(g,j,e){g=this._get_node(g)||this.data.ui.last_selected;if(!g.size()){return false}var f=this._get_settings().languages,h=this._get_settings().core.html_titles,i;if(d.isArray(f)&&f.length){e=(e&&d.inArray(e,f)!=-1)?e:this.data.languages.current_language;g=g.children("a."+e)}else{g=g.children("a:eq(0)")}if(h){i=g.children("INS").clone();g.html(j).prepend(i);this.__callback({obj:g,name:j,lang:e});return true}else{g=g.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:g,name:j,lang:e});return(g.nodeValue=j)}},_load_css:function(){var e=this._get_settings().languages,h="/* languages css */",g=".jstree-"+this.get_index()+" a",f;if(d.isArray(e)&&e.length){this.data.languages.current_language=e[0];for(f=0;f<e.length;f++){h+=g+"."+e[f]+" {";if(e[f]!=this.data.languages.current_language){h+=" display:none; "}h+=" } "}this.data.languages.language_css=d.vakata.css.add_sheet({str:h,title:"jstree-languages"})}},create_node:function(g,h,f,e){var i=this.__call_old(true,g,h,f,function(m){var k=this._get_settings().languages,j=m.children("a"),l;if(d.isArray(k)&&k.length){for(l=0;l<k.length;l++){if(!j.is("."+k[l])){m.append(j.eq(0).clone().removeClass(k.join(" ")).addClass(k[l]))}}j.not("."+k.join(", .")).remove()}if(e){e.call(this,m)}});return i}}})})(jQuery);(function(d){d.jstree.plugin("cookies",{__init:function(){if(typeof d.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included."}var e=this._get_settings().cookies,f;if(!!e.save_loaded){f=d.cookie(e.save_loaded);if(f&&f.length){this.data.core.to_load=f.split(",")}}if(!!e.save_opened){f=d.cookie(e.save_opened);if(f&&f.length){this.data.core.to_open=f.split(",")}}if(!!e.save_selected){f=d.cookie(e.save_selected);if(f&&f.length&&this.data.ui){this.data.ui.to_select=f.split(",")}}this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",d.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",d.proxy(function(g){if(this._get_settings().cookies.auto_save){this.save_cookie((g.handleObj.namespace+g.handleObj.type).replace("jstree",""))}},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(e){if(this.data.core.refreshing){return}var f=this._get_settings().cookies;if(!e){if(f.save_loaded){this.save_loaded();d.cookie(f.save_loaded,this.data.core.to_load.join(","),f.cookie_options)}if(f.save_opened){this.save_opened();d.cookie(f.save_opened,this.data.core.to_open.join(","),f.cookie_options)}if(f.save_selected&&this.data.ui){this.save_selected();d.cookie(f.save_selected,this.data.ui.to_select.join(","),f.cookie_options)}return}switch(e){case"open_node":case"close_node":if(!!f.save_opened){this.save_opened();d.cookie(f.save_opened,this.data.core.to_open.join(","),f.cookie_options)}if(!!f.save_loaded){this.save_loaded();d.cookie(f.save_loaded,this.data.core.to_load.join(","),f.cookie_options)}break;case"select_node":case"deselect_node":if(!!f.save_selected&&this.data.ui){this.save_selected();d.cookie(f.save_selected,this.data.ui.to_select.join(","),f.cookie_options)}break}}}})})(jQuery);(function(d){d.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",d.proxy(function(g,f){var h=this._get_node(f.rslt.obj);h=h===-1?this.get_container().children("ul"):h.children("ul");this.sort(h)},this)).bind("rename_node.jstree create_node.jstree create.jstree",d.proxy(function(g,f){this.sort(f.rslt.obj.parent())},this)).bind("move_node.jstree",d.proxy(function(g,f){var h=f.rslt.np==-1?this.get_container():f.rslt.np;this.sort(h.children("ul"))},this))},defaults:function(e,f){return this.get_text(e)>this.get_text(f)?1:-1},_fn:{sort:function(e){var f=this._get_settings().sort,g=this;e.append(d.makeArray(e.children("li")).sort(d.proxy(f,g)));e.find("> li > ul").each(function(){g.sort(d(this))});this.clean_node(e)}}})})(jQuery);(function(d){var j=false,k=false,h=false,i=false,l=false,n=false,e=false,f=false,g=false;d.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(o,m,q){if(d.vakata.dnd.is_drag){d.vakata.drag_stop({})}try{o.currentTarget.unselectable="on";o.currentTarget.onselectstart=function(){return false};if(o.currentTarget.style){o.currentTarget.style.MozUserSelect="none"}}catch(p){}d.vakata.dnd.init_x=o.pageX;d.vakata.dnd.init_y=o.pageY;d.vakata.dnd.user_data=m;d.vakata.dnd.is_down=true;d.vakata.dnd.helper=d("<div id='vakata-dragged' />").html(q);d(document).bind("mousemove",d.vakata.dnd.drag);d(document).bind("mouseup",d.vakata.dnd.drag_stop);return false},drag:function(o){if(!d.vakata.dnd.is_down){return}if(!d.vakata.dnd.is_drag){if(Math.abs(o.pageX-d.vakata.dnd.init_x)>5||Math.abs(o.pageY-d.vakata.dnd.init_y)>5){d.vakata.dnd.helper.appendTo("body");d.vakata.dnd.is_drag=true;d(document).triggerHandler("drag_start.vakata",{event:o,data:d.vakata.dnd.user_data})}else{return}}if(o.type==="mousemove"){var m=d(document),q=m.scrollTop(),p=m.scrollLeft();if(o.pageY-q<20){if(n&&e==="down"){clearInterval(n);n=false}if(!n){e="up";n=setInterval(function(){d(document).scrollTop(d(document).scrollTop()-d.vakata.dnd.scroll_spd)},150)}}else{if(n&&e==="up"){clearInterval(n);n=false}}if(d(window).height()-(o.pageY-q)<20){if(n&&e==="up"){clearInterval(n);n=false}if(!n){e="down";n=setInterval(function(){d(document).scrollTop(d(document).scrollTop()+d.vakata.dnd.scroll_spd)},150)}}else{if(n&&e==="down"){clearInterval(n);n=false}}if(o.pageX-p<20){if(l&&f==="right"){clearInterval(l);l=false}if(!l){f="left";l=setInterval(function(){d(document).scrollLeft(d(document).scrollLeft()-d.vakata.dnd.scroll_spd)},150)}}else{if(l&&f==="left"){clearInterval(l);l=false}}if(d(window).width()-(o.pageX-p)<20){if(l&&f==="left"){clearInterval(l);l=false}if(!l){f="right";l=setInterval(function(){d(document).scrollLeft(d(document).scrollLeft()+d.vakata.dnd.scroll_spd)},150)}}else{if(l&&f==="right"){clearInterval(l);l=false}}}d.vakata.dnd.helper.css({left:(o.pageX+d.vakata.dnd.helper_left)+"px",top:(o.pageY+d.vakata.dnd.helper_top)+"px"});d(document).triggerHandler("drag.vakata",{event:o,data:d.vakata.dnd.user_data})},drag_stop:function(m){if(l){clearInterval(l)}if(n){clearInterval(n)}d(document).unbind("mousemove",d.vakata.dnd.drag);d(document).unbind("mouseup",d.vakata.dnd.drag_stop);d(document).triggerHandler("drag_stop.vakata",{event:m,data:d.vakata.dnd.user_data});d.vakata.dnd.helper.remove();d.vakata.dnd.init_x=0;d.vakata.dnd.init_y=0;d.vakata.dnd.user_data={};d.vakata.dnd.is_down=false;d.vakata.dnd.is_drag=false}};d(function(){var m="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";d.vakata.css.add_sheet({str:m,title:"vakata"})});d.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false,mto:false};this.get_container().bind("mouseenter.jstree",d.proxy(function(p){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){if(this.data.themes){h.attr("class","jstree-"+this.data.themes.theme);if(i){i.attr("class","jstree-"+this.data.themes.theme)}d.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}if(p.currentTarget===p.target&&d.vakata.dnd.user_data.obj&&d(d.vakata.dnd.user_data.obj).length&&d(d.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==p.target){var q=d.jstree._reference(p.target),o;if(q.data.dnd.foreign){o=q._get_settings().dnd.drag_check.call(this,{o:j,r:q.get_container(),is_root:true});if(o===true||o.inside===true||o.before===true||o.after===true){d.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}else{q.prepare_move(j,q.get_container(),"last");if(q.check_move()){d.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}}}},this)).bind("mouseup.jstree",d.proxy(function(p){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree&&p.currentTarget===p.target&&d.vakata.dnd.user_data.obj&&d(d.vakata.dnd.user_data.obj).length&&d(d.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==p.target){var q=d.jstree._reference(p.currentTarget),o;if(q.data.dnd.foreign){o=q._get_settings().dnd.drag_check.call(this,{o:j,r:q.get_container(),is_root:true});if(o===true||o.inside===true||o.before===true||o.after===true){q._get_settings().dnd.drag_finish.call(this,{o:j,r:q.get_container(),is_root:true})}}else{q.move_node(j,q.get_container(),"last",p[q._get_settings().dnd.copy_modifier+"Key"])}}},this)).bind("mouseleave.jstree",d.proxy(function(o){if(o.relatedTarget&&o.relatedTarget.id&&o.relatedTarget.id==="jstree-marker-line"){return false}if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(d.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){d.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}}},this)).bind("mousemove.jstree",d.proxy(function(p){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){var o=this.get_container()[0];if(p.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(d.proxy(function(){this.scrollLeft+=d.vakata.dnd.scroll_spd},o),100)}else{if(p.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(d.proxy(function(){this.scrollLeft-=d.vakata.dnd.scroll_spd},o),100)}else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}}}if(p.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(d.proxy(function(){this.scrollTop+=d.vakata.dnd.scroll_spd},o),100)}else{if(p.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(d.proxy(function(){this.scrollTop-=d.vakata.dnd.scroll_spd},o),100)}else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}}}}},this)).bind("scroll.jstree",d.proxy(function(o){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree&&h&&i){h.hide();i.hide()}},this)).delegate("a","mousedown.jstree",d.proxy(function(o){if(o.which===1){this.start_drag(o.currentTarget,o);return false}},this)).delegate("a","mouseenter.jstree",d.proxy(function(o){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){this.dnd_enter(o.currentTarget)}},this)).delegate("a","mousemove.jstree",d.proxy(function(o){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){if(!k||!k.length||k.children("a")[0]!==o.currentTarget){this.dnd_enter(o.currentTarget)}if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=d(o.target).offset()}this.data.dnd.w=(o.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height}this.dnd_show()}},this)).delegate("a","mouseleave.jstree",d.proxy(function(o){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){if(o.relatedTarget&&o.relatedTarget.id&&o.relatedTarget.id==="jstree-marker-line"){return false}if(h){h.hide()}if(i){i.hide()}this.data.dnd.mto=setTimeout((function(p){return function(){p.dnd_leave(o)}})(this),0)}},this)).delegate("a","mouseup.jstree",d.proxy(function(o){if(d.vakata.dnd.is_drag&&d.vakata.dnd.user_data.jstree){this.dnd_finish(o)}},this));d(document).bind("drag_stop.vakata",d.proxy(function(){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.i1=false;this.data.dnd.i2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(h){h.css({top:"-2000px"})}if(i){i.css({top:"-2000px"})}},this)).bind("drag_start.vakata",d.proxy(function(p,o){if(o.data.jstree){var q=d(o.event.target);if(q.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(q)}}},this));var m=this._get_settings().dnd;if(m.drag_target){d(document).delegate(m.drag_target,"mousedown.jstree-"+this.get_index(),d.proxy(function(p){j=p.target;d.vakata.dnd.drag_start(p,{jstree:true,obj:p.target},"<ins class='jstree-icon'></ins>"+d(p.target).text());if(this.data.themes){if(h){h.attr("class","jstree-"+this.data.themes.theme)}if(i){i.attr("class","jstree-"+this.data.themes.theme)}d.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}d.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var o=this.get_container();this.data.dnd.cof=o.offset();this.data.dnd.cw=parseInt(o.width(),10);this.data.dnd.ch=parseInt(o.height(),10);this.data.dnd.foreign=true;p.preventDefault()},this))}if(m.drop_target){d(document).delegate(m.drop_target,"mouseenter.jstree-"+this.get_index(),d.proxy(function(o){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:j,r:d(o.target),e:o})){d.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}},this)).delegate(m.drop_target,"mouseleave.jstree-"+this.get_index(),d.proxy(function(o){if(this.data.dnd.active){d.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}},this)).delegate(m.drop_target,"mouseup.jstree-"+this.get_index(),d.proxy(function(o){if(this.data.dnd.active&&d.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{o:j,r:d(o.target),e:o})}},this))}},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(m){return true},drop_finish:d.noop,drag_target:".jstree-draggable",drag_finish:d.noop,drag_check:function(m){return{after:false,before:false,inside:true}}},_fn:{dnd_prepare:function(){if(!k||!k.length){return}this.data.dnd.off=k.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+k.width()}if(this.data.dnd.foreign){var m=this._get_settings().dnd.drag_check.call(this,{o:j,r:k});this.data.dnd.after=m.after;this.data.dnd.before=m.before;this.data.dnd.inside=m.inside;this.data.dnd.prepared=true;return this.dnd_show()}this.prepare_move(j,k,"before");this.data.dnd.before=this.check_move();this.prepare_move(j,k,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(k)){this.prepare_move(j,k,"inside");this.data.dnd.inside=this.check_move()}else{this.data.dnd.inside=false}this.data.dnd.prepared=true;return this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared){return}var m=["before","inside","after"],q=false,s=this._get_settings().core.rtl,p;if(this.data.dnd.w<this.data.core.li_height/3){m=["before","inside","after"]}else{if(this.data.dnd.w<=this.data.core.li_height*2/3){m=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]}else{m=["after","inside","before"]}}d.each(m,d.proxy(function(o,r){if(this.data.dnd[r]){d.vakata.dnd.helper.children("ins").attr("class","jstree-ok");q=r;return false}},this));if(q===false){d.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}p=s?(this.data.dnd.off.right-18):(this.data.dnd.off.left+10);switch(q){case"before":h.css({left:p+"px",top:(this.data.dnd.off.top-6)+"px"}).show();if(i){i.css({left:(p+8)+"px",top:(this.data.dnd.off.top-1)+"px"}).show()}break;case"after":h.css({left:p+"px",top:(this.data.dnd.off.top+this.data.core.li_height-6)+"px"}).show();if(i){i.css({left:(p+8)+"px",top:(this.data.dnd.off.top+this.data.core.li_height-1)+"px"}).show()}break;case"inside":h.css({left:p+(s?-4:4)+"px",top:(this.data.dnd.off.top+this.data.core.li_height/2-5)+"px"}).show();if(i){i.hide()}break;default:h.hide();if(i){i.hide()}break}g=q;return q},dnd_open:function(){this.data.dnd.to2=false;this.open_node(k,d.proxy(this.dnd_prepare,this),true)},dnd_finish:function(m){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{o:j,r:k,p:g})}}else{this.dnd_prepare();this.move_node(j,k,g,m[this._get_settings().dnd.copy_modifier+"Key"])}j=false;k=false;h.hide();if(i){i.hide()}},dnd_enter:function(m){if(this.data.dnd.mto){clearTimeout(this.data.dnd.mto);this.data.dnd.mto=false}var o=this._get_settings().dnd;this.data.dnd.prepared=false;k=this._get_node(m);if(o.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}this.data.dnd.to1=setTimeout(d.proxy(this.dnd_prepare,this),o.check_timeout)}else{this.dnd_prepare()}if(o.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(k&&k.length&&k.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout(d.proxy(this.dnd_open,this),o.open_timeout)}}else{if(k&&k.length&&k.hasClass("jstree-closed")){this.dnd_open()}}},dnd_leave:function(m){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;d.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");h.hide();if(i){i.hide()}if(k&&k[0]===m.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false}}},start_drag:function(q,p){j=this._get_node(q);if(this.data.ui&&this.is_selected(j)){j=this._get_node(null,true)}var o=j.length>1?this._get_string("multiple_selection"):this.get_text(j),m=this.get_container();if(!this._get_settings().core.html_titles){o=o.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")}d.vakata.dnd.drag_start(p,{jstree:true,obj:j},"<ins class='jstree-icon'></ins>"+o);if(this.data.themes){if(h){h.attr("class","jstree-"+this.data.themes.theme)}if(i){i.attr("class","jstree-"+this.data.themes.theme)}d.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}this.data.dnd.cof=m.offset();this.data.dnd.cw=parseInt(m.width(),10);this.data.dnd.ch=parseInt(m.height(),10);this.data.dnd.active=true}}});d(function(){var m="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";d.vakata.css.add_sheet({str:m,title:"jstree"});h=d("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(o){h.hide();i.hide();o.preventDefault();o.stopImmediatePropagation();return false}).appendTo("body");i=d("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(o){if(k&&k.length){k.children("a").trigger(o);o.preventDefault();o.stopImmediatePropagation();return false}}).bind("mouseleave",function(o){var p=d(o.relatedTarget);if(p.is(".jstree")||p.closest(".jstree").length===0){if(k&&k.length){k.children("a").trigger(o);h.hide();i.hide();o.preventDefault();o.stopImmediatePropagation();return false}}}).appendTo("body");d(document).bind("drag_start.vakata",function(p,o){if(o.data.jstree){h.show();if(i){i.show()}}});d(document).bind("drag_stop.vakata",function(p,o){if(o.data.jstree){h.hide();if(i){i.hide()}}})})})(jQuery);(function(d){d.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;if(this.data.ui&&this.data.checkbox.noui){this.select_node=this.deselect_node=this.deselect_all=d.noop;this.get_selected=this.get_checked}this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",d.proxy(function(g,f){this._prepare_checkboxes(f.rslt.obj)},this)).bind("loaded.jstree",d.proxy(function(f){this._prepare_checkboxes()},this)).delegate((this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox"),"click.jstree",d.proxy(function(f){f.preventDefault();if(this._get_node(f.target).hasClass("jstree-checked")){this.uncheck_node(f.target)}else{this.check_node(f.target)}if(this.data.ui&&this.data.checkbox.noui){this.save_selected();if(this.data.cookies){this.save_cookie("select_node")}}else{f.stopImmediatePropagation();return false}},this))},defaults:{override_ui:false,two_state:false,real_checkboxes:false,checked_parent_open:true,real_checkboxes_names:function(e){return[("check_"+(e[0].id||Math.ceil(Math.random()*10000))),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(f,e){if(e.checked){this.check_node(f,false)}},_prepare_checkboxes:function(g){g=!g||g==-1?this.get_container().find("> ul > li"):this._get_node(g);if(g===false){return}var f,e=this,j,k=this._get_settings().checkbox.two_state,h=this._get_settings().checkbox.real_checkboxes,i=this._get_settings().checkbox.real_checkboxes_names;g.each(function(){j=d(this);f=j.is("li")&&(j.hasClass("jstree-checked")||(h&&j.children(":checked").length))?"jstree-checked":"jstree-unchecked";j.find("li").andSelf().each(function(){var l=d(this),m;l.children("a"+(e.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(k?"jstree-unchecked":f);if(h){if(!l.children(":checkbox").length){m=i.call(e,l);l.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+m[0]+"' name='"+m[0]+"' value='"+m[1]+"' />")}else{l.children(":checkbox").addClass("jstree-real-checkbox")}}if(!k){if(f==="jstree-checked"||l.hasClass("jstree-checked")||l.children(":checked").length){l.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",true)}}else{if(l.hasClass("jstree-checked")||l.children(":checked").length){l.addClass("jstree-checked").children(":checkbox").prop("checked",true)}}})});if(!k){g.find(".jstree-checked").parent().parent().each(function(){e._repair_state(this)})}},change_state:function(f,h){f=this._get_node(f);var e=false,g=this._get_settings().checkbox.real_checkboxes;if(!f||f===-1){return false}h=(h===false||h===true)?h:f.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state){if(h){f.removeClass("jstree-checked").addClass("jstree-unchecked");if(g){f.children(":checkbox").prop("checked",false)}}else{f.removeClass("jstree-unchecked").addClass("jstree-checked");if(g){f.children(":checkbox").prop("checked",true)}}}else{if(h){e=f.find("li").andSelf();if(!e.filter(".jstree-checked, .jstree-undetermined").length){return false}e.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(g){e.children(":checkbox").prop("checked",false)}}else{e=f.find("li").andSelf();if(!e.filter(".jstree-unchecked, .jstree-undetermined").length){return false}e.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(g){e.children(":checkbox").prop("checked",true)}if(this.data.ui){this.data.ui.last_selected=f}this.data.checkbox.last_selected=f}f.parentsUntil(".jstree","li").each(function(){var i=d(this);if(h){if(i.children("ul").children("li.jstree-checked, li.jstree-undetermined").length){i.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(g){i.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false)}return false}else{i.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(g){i.children(":checkbox").prop("checked",false)}}}else{if(i.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length){i.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(g){i.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false)}return false}else{i.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(g){i.children(":checkbox").prop("checked",true)}}}})}if(this.data.ui&&this.data.checkbox.noui){this.data.ui.selected=this.get_checked()}this.__callback(f);return true},check_node:function(e){if(this.change_state(e,false)){e=this._get_node(e);if(this._get_settings().checkbox.checked_parent_open){var f=this;e.parents(".jstree-closed").each(function(){f.open_node(this,false,true)})}this.__callback({obj:e})}},uncheck_node:function(e){if(this.change_state(e,true)){this.__callback({obj:this._get_node(e)})}},check_all:function(){var e=this,f=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");f.each(function(){e.change_state(this,false)});this.__callback()},uncheck_all:function(){var e=this,f=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");f.each(function(){e.change_state(this,true)});this.__callback()},is_checked:function(e){e=this._get_node(e);return e.length?e.is(".jstree-checked"):false},get_checked:function(f,e){f=!f||f===-1?this.get_container():this._get_node(f);return e||this._get_settings().checkbox.two_state?f.find(".jstree-checked"):f.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(f,e){f=!f||f===-1?this.get_container():this._get_node(f);return e||this._get_settings().checkbox.two_state?f.find(".jstree-unchecked"):f.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(h){h=this._get_node(h);if(!h.length){return}if(this._get_settings().checkbox.two_state){h.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",true);return}var i=this._get_settings().checkbox.real_checkboxes,e=h.find("> ul > .jstree-checked").length,f=h.find("> ul > .jstree-undetermined").length,g=h.find("> ul > li").length;if(g===0){if(h.hasClass("jstree-undetermined")){this.change_state(h,false)}}else{if(e===0&&f===0){this.change_state(h,true)}else{if(e===g){this.change_state(h,false)}else{h.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(i){h.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",false)}}}}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var e=this,f=this.data.ui.to_select;f=d.map(d.makeArray(f),function(g){return"#"+g.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();d.each(f,function(g,h){e.check_node(h)});this.__callback()}else{this.__call_old()}},save_loaded:function(){var e=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){if(this.id){e.data.core.to_load.push("#"+this.id)}})}}});d(function(){var e=".jstree .jstree-real-checkbox { display:none; } ";d.vakata.css.add_sheet({str:e,title:"jstree"})})})(jQuery);(function(d){d.vakata.xslt=function(l,n,g){var i="",k,m,h,j;if(document.recalc){k=document.createElement("xml");m=document.createElement("xml");k.innerHTML=l;m.innerHTML=n;d("body").append(k).append(m);setTimeout((function(p,q,o){return function(){o.call(null,p.transformNode(q.XMLDocument));setTimeout((function(r,s){return function(){d(r).remove();d(s).remove()}})(p,q),200)}})(k,m,g),100);return true}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor==="undefined"){l=new DOMParser().parseFromString(l,"text/xml");n=new DOMParser().parseFromString(n,"text/xml")}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor!=="undefined"){h=new XSLTProcessor();j=d.isFunction(h.transformDocument)?(typeof window.XMLSerializer!=="undefined"):true;if(!j){return false}l=new DOMParser().parseFromString(l,"text/xml");n=new DOMParser().parseFromString(n,"text/xml");if(d.isFunction(h.transformDocument)){i=document.implementation.createDocument("","",null);h.transformDocument(l,n,i,null);g.call(null,new XMLSerializer().serializeToString(i));return true}else{h.importStylesheet(n);i=h.transformToFragment(l,document);g.call(null,d("<div />").append(i).html());return true}}return false};var f={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},e=function(g){return g.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};d.jstree.plugin("xml_data",{defaults:{data:false,ajax:false,xsl:"flat",clean_node:false,correct_state:true,get_skip_empty:false,get_include_preamble:true},_fn:{load_node:function(i,j,h){var g=this;this.load_node_xml(i,function(){g.__callback({obj:g._get_node(i)});j.call(this)},h)},_is_loaded:function(g){var h=this._get_settings().xml_data;g=this._get_node(g);return g==-1||!g||(!h.ajax&&!d.isFunction(h.data))||g.is(".jstree-open, .jstree-leaf")||g.children("ul").children("li").size()>0},load_node_xml:function(i,k,g){var j=this.get_settings().xml_data,h=function(){},l=function(){};i=this._get_node(i);if(i&&i!==-1){if(i.data("jstree_is_loading")){return}else{i.data("jstree_is_loading",true)}}switch(!0){case (!j.data&&!j.ajax):throw"Neither data nor ajax settings supplied.";case (d.isFunction(j.data)):j.data.call(this,i,d.proxy(function(m){this.parse_xml(m,d.proxy(function(n){if(n){n=n.replace(/ ?xmlns="[^"]*"/ig,"");if(n.length>10){n=d(n);if(i===-1||!i){this.get_container().children("ul").empty().append(n.children())}else{i.children("a.jstree-loading").removeClass("jstree-loading");i.append(n);i.removeData("jstree_is_loading")}if(j.clean_node){this.clean_node(i)}if(k){k.call(this)}}else{if(i&&i!==-1){i.children("a.jstree-loading").removeClass("jstree-loading");i.removeData("jstree_is_loading");if(j.correct_state){this.correct_state(i);if(k){k.call(this)}}}else{if(j.correct_state){this.get_container().children("ul").empty();if(k){k.call(this)}}}}}},this))},this));break;case (!!j.data&&!j.ajax)||(!!j.data&&!!j.ajax&&(!i||i===-1)):if(!i||i==-1){this.parse_xml(j.data,d.proxy(function(m){if(m){m=m.replace(/ ?xmlns="[^"]*"/ig,"");if(m.length>10){m=d(m);this.get_container().children("ul").empty().append(m.children());if(j.clean_node){this.clean_node(i)}if(k){k.call(this)}}}else{if(j.correct_state){this.get_container().children("ul").empty();if(k){k.call(this)}}}},this))}break;case (!j.data&&!!j.ajax)||(!!j.data&&!!j.ajax&&i&&i!==-1):h=function(p,o,m){var n=this.get_settings().xml_data.ajax.error;if(n){n.call(this,p,o,m)}if(i!==-1&&i.length){i.children("a.jstree-loading").removeClass("jstree-loading");i.removeData("jstree_is_loading");if(o==="success"&&j.correct_state){this.correct_state(i)}}else{if(o==="success"&&j.correct_state){this.get_container().children("ul").empty()}}if(g){g.call(this)}};l=function(m,o,p){m=p.responseText;var n=this.get_settings().xml_data.ajax.success;if(n){m=n.call(this,m,o,p)||m}if(m===""||(m&&m.toString&&m.toString().replace(/^[\s\n]+$/,"")==="")){return h.call(this,p,o,"")}this.parse_xml(m,d.proxy(function(q){if(q){q=q.replace(/ ?xmlns="[^"]*"/ig,"");if(q.length>10){q=d(q);if(i===-1||!i){this.get_container().children("ul").empty().append(q.children())}else{i.children("a.jstree-loading").removeClass("jstree-loading");i.append(q);i.removeData("jstree_is_loading")}if(j.clean_node){this.clean_node(i)}if(k){k.call(this)}}else{if(i&&i!==-1){i.children("a.jstree-loading").removeClass("jstree-loading");i.removeData("jstree_is_loading");if(j.correct_state){this.correct_state(i);if(k){k.call(this)}}}else{if(j.correct_state){this.get_container().children("ul").empty();if(k){k.call(this)}}}}}},this))};j.ajax.context=this;j.ajax.error=h;j.ajax.success=l;if(!j.ajax.dataType){j.ajax.dataType="xml"}if(d.isFunction(j.ajax.url)){j.ajax.url=j.ajax.url.call(this,i)}if(d.isFunction(j.ajax.data)){j.ajax.data=j.ajax.data.call(this,i)}d.ajax(j.ajax);break}},parse_xml:function(i,g){var h=this._get_settings().xml_data;d.vakata.xslt(i,f[h.xsl],g)},get_xml:function(t,n,m,i,j){var o="",p=this._get_settings(),g=this,q,r,l,h,k;if(!t){t="flat"}if(!j){j=0}n=this._get_node(n);if(!n||n===-1){n=this.get_container().find("> ul > li")}m=d.isArray(m)?m:["id","class"];if(!j&&this.data.types&&d.inArray(p.types.type_attr,m)===-1){m.push(p.types.type_attr)}i=d.isArray(i)?i:[];if(!j){if(p.xml_data.get_include_preamble){o+='<?xml version="1.0" encoding="UTF-8"?>'}o+="<root>"}n.each(function(){o+="<item";l=d(this);d.each(m,function(s,w){var u=l.attr(w);if(!p.xml_data.get_skip_empty||typeof u!=="undefined"){o+=" "+w+'="'+e((" "+(u||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}});if(l.hasClass("jstree-open")){o+=' state="open"'}if(l.hasClass("jstree-closed")){o+=' state="closed"'}if(t==="flat"){o+=' parent_id="'+e(j)+'"'}o+=">";o+="<content>";h=l.children("a");h.each(function(){q=d(this);k=false;o+="<name";if(d.inArray("languages",p.plugins)!==-1){d.each(p.languages,function(s,u){if(q.hasClass(u)){o+=' lang="'+e(u)+'"';k=u;return false}})}if(i.length){d.each(i,function(s,v){var u=q.attr(v);if(!p.xml_data.get_skip_empty||typeof u!=="undefined"){o+=" "+v+'="'+e((" "+u||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}})}if(q.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){o+=' icon="'+e(q.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}if(q.children("ins").get(0).style.backgroundImage.length){o+=' icon="'+e(q.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'}o+=">";o+="<![CDATA["+g.get_text(q,k)+"]]>";o+="</name>"});o+="</content>";r=l[0].id||true;l=l.find("> ul > li");if(l.length){r=g.get_xml(t,l,m,i,r)}else{r=""}if(t=="nest"){o+=r}o+="</item>";if(t=="flat"){o+=r}});if(!j){o+="</root>"}return o}}})})(jQuery);(function(d){d.expr[":"].jstree_contains=function(e,f,g){return(e.textContent||e.innerText||"").toLowerCase().indexOf(g[3].toLowerCase())>=0};d.expr[":"].jstree_title_contains=function(e,f,g){return(e.getAttribute("title")||"").toLowerCase().indexOf(g[3].toLowerCase())>=0};d.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=d();if(this._get_settings().search.show_only_matches){this.get_container().bind("search.jstree",function(g,f){d(this).children("ul").find("li").hide().removeClass("jstree-last");f.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){d(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){d(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})}},defaults:{ajax:false,search_method:"jstree_contains",show_only_matches:false},_fn:{search:function(h,g){if(d.trim(h)===""){this.clear_search();return}var f=this.get_settings().search,j=this,e=function(){},i=function(){};this.data.search.str=h;if(!g&&f.ajax!==false&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=true;e=function(){};i=function(k,m,n){var l=this.get_settings().search.ajax.success;if(l){k=l.call(this,k,m,n)||k}this.data.search.to_open=k;this._search_open()};f.ajax.context=this;f.ajax.error=e;f.ajax.success=i;if(d.isFunction(f.ajax.url)){f.ajax.url=f.ajax.url.call(this,h)}if(d.isFunction(f.ajax.data)){f.ajax.data=f.ajax.data.call(this,h)}if(!f.ajax.data){f.ajax.data={search_string:h}}if(!f.ajax.dataType||/^json/.exec(f.ajax.dataType)){f.ajax.dataType="json"}d.ajax(f.ajax);return}if(this.data.search.result.length){this.clear_search()}this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(f.search_method)+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){j.open_node(this,false,true)});this.__callback({nodes:this.data.search.result,str:h})},clear_search:function(e){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=d()},_search_open:function(h){var e=this,g=true,f=[],i=[];if(this.data.search.to_open.length){d.each(this.data.search.to_open,function(j,k){if(k=="#"){return true}if(d(k).length&&d(k).is(".jstree-closed")){f.push(k)}else{i.push(k)}});if(f.length){this.data.search.to_open=i;d.each(f,function(j,k){e.open_node(k,function(){e._search_open(true)})});g=false}}if(g){this.search(this.data.search.str,true)}}}})})(jQuery);(function(d){d.vakata.context={hide_on_mouseleave:false,cnt:d("<div id='vakata-contextmenu' />"),vis:false,tgt:false,par:false,func:false,data:false,rtl:false,show:function(k,l,n,o,e,i,j){d.vakata.context.rtl=!!j;var g=d.vakata.context.parse(k),f,m;if(!g){return}d.vakata.context.vis=true;d.vakata.context.tgt=l;d.vakata.context.par=i||l||null;d.vakata.context.data=e||null;d.vakata.context.cnt.html(g).css({visibility:"hidden",display:"block",left:0,top:0});if(d.vakata.context.hide_on_mouseleave){d.vakata.context.cnt.one("mouseleave",function(h){d.vakata.context.hide()})}f=d.vakata.context.cnt.height();m=d.vakata.context.cnt.width();if(n+m>d(document).width()){n=d(document).width()-(m+5);d.vakata.context.cnt.find("li > ul").addClass("right")}if(o+f>d(document).height()){o=o-(f+l[0].offsetHeight);d.vakata.context.cnt.find("li > ul").addClass("bottom")}d.vakata.context.cnt.css({left:n,top:o}).find("li:has(ul)").bind("mouseenter",function(p){var s=d(document).width(),q=d(document).height(),r=d(this).children("ul").show();if(s!==d(document).width()){r.toggleClass("right")}if(q!==d(document).height()){r.toggleClass("bottom")}}).bind("mouseleave",function(h){d(this).children("ul").hide()}).end().css({visibility:"visible"}).show();d(document).triggerHandler("context_show.vakata")},hide:function(){d.vakata.context.vis=false;d.vakata.context.cnt.attr("class","").css({visibility:"hidden"});d(document).triggerHandler("context_hide.vakata")},parse:function(f,e){if(!f){return false}var g="",h=false,i=true;if(!e){d.vakata.context.func={}}g+="<ul>";d.each(f,function(j,k){if(!k){return true}d.vakata.context.func[j]=k.action;if(!i&&k.separator_before){g+="<li class='vakata-separator vakata-separator-before'></li>"}i=false;g+="<li class='"+(k._class||"")+(k._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(k.icon&&k.icon.indexOf("/")===-1){g+=" class='"+k.icon+"' "}if(k.icon&&k.icon.indexOf("/")!==-1){g+=" style='background:url("+k.icon+") center center no-repeat;' "}g+=">&#160;</ins><a href='#' rel='"+j+"'>";if(k.submenu){g+="<span style='float:"+(d.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"}g+=k.label+"</a>";if(k.submenu){h=d.vakata.context.parse(k.submenu,true);if(h){g+=h}}g+="</li>";if(k.separator_after){g+="<li class='vakata-separator vakata-separator-after'></li>";i=true}});g=g.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");g+="</ul>";d(document).triggerHandler("context_parse.vakata");return g.length>10?g:false},exec:function(e){if(d.isFunction(d.vakata.context.func[e])){d.vakata.context.func[e].call(d.vakata.context.data,d.vakata.context.par);return true}else{return false}}};d(function(){var e="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";d.vakata.css.add_sheet({str:e,title:"vakata"});d.vakata.context.cnt.delegate("a","click",function(f){f.preventDefault()}).delegate("a","mouseup",function(f){if(!d(this).parent().hasClass("jstree-contextmenu-disabled")&&d.vakata.context.exec(d(this).attr("rel"))){d.vakata.context.hide()}else{d(this).blur()}}).delegate("a","mouseover",function(){d.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");d(document).bind("mousedown",function(f){if(d.vakata.context.vis&&!d.contains(d.vakata.context.cnt[0],f.target)){d.vakata.context.hide()}});if(typeof d.hotkeys!=="undefined"){d(document).bind("keydown","up",function(f){if(d.vakata.context.vis){var g=d.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!g.length){g=d.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()}g.addClass("vakata-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","down",function(f){if(d.vakata.context.vis){var g=d.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!g.length){g=d.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()}g.addClass("vakata-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","right",function(f){if(d.vakata.context.vis){d.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","left",function(f){if(d.vakata.context.vis){d.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","esc",function(f){d.vakata.context.hide();f.preventDefault()}).bind("keydown","space",function(f){d.vakata.context.cnt.find(".vakata-hover").last().children("a").click();f.preventDefault()})}});d.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",d.proxy(function(f){f.preventDefault();if(!d(f.currentTarget).hasClass("jstree-loading")){this.show_contextmenu(f.currentTarget,f.pageX,f.pageY)}},this)).delegate("a","click.jstree",d.proxy(function(f){if(this.data.contextmenu){d.vakata.context.hide()}},this)).bind("destroy.jstree",d.proxy(function(){if(this.data.contextmenu){d.vakata.context.hide()}},this));d(document).bind("context_hide.vakata",d.proxy(function(){this.data.contextmenu=false},this))},defaults:{select_node:false,show_at_node:true,items:{create:{separator_before:false,separator_after:true,label:"Create",action:function(e){this.create(e)}},rename:{separator_before:false,separator_after:false,label:"Rename",action:function(e){this.rename(e)}},remove:{separator_before:false,icon:false,separator_after:false,label:"Delete",action:function(e){if(this.is_selected(e)){this.remove()}else{this.remove(e)}}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(e){this.cut(e)}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(e){this.copy(e)}},paste:{separator_before:false,icon:false,separator_after:false,label:"Paste",action:function(e){this.paste(e)}}}}}},_fn:{show_contextmenu:function(h,k,l){h=this._get_node(h);var j=this.get_settings().contextmenu,e=h.children("a:visible:eq(0)"),g=false,f=false;if(j.select_node&&this.data.ui&&!this.is_selected(h)){this.deselect_all();this.select_node(h,true)}if(j.show_at_node||typeof k==="undefined"||typeof l==="undefined"){g=e.offset();k=g.left;l=g.top+this.data.core.li_height}f=h.data("jstree")&&h.data("jstree").contextmenu?h.data("jstree").contextmenu:j.items;if(d.isFunction(f)){f=f.call(this,h)}this.data.contextmenu=true;d.vakata.context.show(f,e,k,l,this,h,this._get_settings().core.rtl);if(this.data.themes){d.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}}})})(jQuery);(function(d){d.jstree.plugin("types",{__init:function(){var e=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",d.proxy(function(){var i=e.types,g=e.type_attr,h="",f=this;d.each(i,function(j,k){d.each(k,function(l,m){if(!/^(max_depth|max_children|icon|valid_children)$/.test(l)){f.data.types.attach_to.push(l)}});if(!k.icon){return true}if(k.icon.image||k.icon.position){if(j=="default"){h+=".jstree-"+f.get_index()+" a > .jstree-icon { "}else{h+=".jstree-"+f.get_index()+" li["+g+'="'+j+'"] > a > .jstree-icon { '}if(k.icon.image){h+=" background-image:url("+k.icon.image+"); "}if(k.icon.position){h+=" background-position:"+k.icon.position+"; "}else{h+=" background-position:0 0; "}h+="} "}});if(h!==""){d.vakata.css.add_sheet({str:h,title:"jstree-types"})}},this)).bind("before.jstree",d.proxy(function(h,g){var j,k,i=this._get_settings().types.use_data?this._get_node(g.args[0]):false,f=i&&i!==-1&&i.length?i.data("jstree"):false;if(f&&f.types&&f.types[g.func]===false){h.stopImmediatePropagation();return false}if(d.inArray(g.func,this.data.types.attach_to)!==-1){if(!g.args[0]||(!g.args[0].tagName&&!g.args[0].jquery)){return}j=this._get_settings().types.types;k=this._get_type(g.args[0]);if(((j[k]&&typeof j[k][g.func]!=="undefined")||(j["default"]&&typeof j["default"][g.func]!=="undefined"))&&this._check(g.func,g.args[0])===false){h.stopImmediatePropagation();return false}}},this));if(b){this.get_container().bind("load_node.jstree set_type.jstree",d.proxy(function(h,g){var i=g&&g.rslt&&g.rslt.obj&&g.rslt.obj!==-1?this._get_node(g.rslt.obj).parent():this.get_container_ul(),f=false,j=this._get_settings().types;d.each(j.types,function(k,l){if(l.icon&&(l.icon.image||l.icon.position)){f=k==="default"?i.find("li > a > .jstree-icon"):i.find("li["+j.type_attr+"='"+k+"'] > a > .jstree-icon");if(l.icon.image){f.css("backgroundImage","url("+l.icon.image+")")}f.css("backgroundPosition",l.icon.position||"0 0")}})},this))}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:false,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(f,e){if(e.type&&this._get_settings().types.use_data){this.set_type(e.type,f)}},_get_type:function(e){e=this._get_node(e);return(!e||!e.length)?false:e.attr(this._get_settings().types.type_attr)||"default"},set_type:function(g,e){e=this._get_node(e);var f=(!e.length||!g)?false:e.attr(this._get_settings().types.type_attr,g);if(f){this.__callback({obj:e,type:g})}return f},_check:function(j,h,i){h=this._get_node(h);var m=false,l=this._get_type(h),f=0,e=this,k=this._get_settings().types,g=false;if(h===-1){if(!!k[j]){m=k[j]}else{return}}else{if(l===false){return}g=k.use_data?h.data("jstree"):false;if(g&&g.types&&typeof g.types[j]!=="undefined"){m=g.types[j]}else{if(!!k.types[l]&&typeof k.types[l][j]!=="undefined"){m=k.types[l][j]}else{if(!!k.types["default"]&&typeof k.types["default"][j]!=="undefined"){m=k.types["default"][j]}}}}if(d.isFunction(m)){m=m.call(this,h)}if(j==="max_depth"&&h!==-1&&i!==false&&k.max_depth!==-2&&m!==0){h.children("a:eq(0)").parentsUntil(".jstree","li").each(function(n){if(k.max_depth!==-1&&k.max_depth-(n+1)<=0){m=0;return false}f=(n===0)?m:e._check(j,this,false);if(f!==-1&&f-(n+1)<=0){m=0;return false}if(f>=0&&(f-(n+1)<m||m<0)){m=f-(n+1)}if(k.max_depth>=0&&(k.max_depth-(n+1)<m||m<0)){m=k.max_depth-(n+1)}})}return m},check_move:function(){if(!this.__call_old()){return false}var g=this._get_move(),j=g.rt._get_settings().types,h=g.rt._check("max_children",g.cr),i=g.rt._check("max_depth",g.cr),l=g.rt._check("valid_children",g.cr),e=0,f=1,k;if(l==="none"){return false}if(d.isArray(l)&&g.ot&&g.ot._get_type){g.o.each(function(){if(d.inArray(g.ot._get_type(this),l)===-1){f=false;return false}});if(f===false){return false}}if(j.max_children!==-2&&h!==-1){e=g.cr===-1?this.get_container().find("> ul > li").not(g.o).length:g.cr.find("> ul > li").not(g.o).length;if(e+g.o.length>h){return false}}if(j.max_depth!==-2&&i!==-1){f=0;if(i===0){return false}if(typeof g.o.d==="undefined"){k=g.o;while(k.length>0){k=k.find("> ul > li");f++}g.o.d=f}if(i-g.o.d<0){return false}}return true},create_node:function(k,m,h,e,g,o){if(!o&&(g||this._is_loaded(k))){var l=(typeof m=="string"&&m.match(/^before|after$/i)&&k!==-1)?this._get_parent(k):this._get_node(k),n=this._get_settings().types,i=this._check("max_children",l),j=this._check("max_depth",l),q=this._check("valid_children",l),f;if(typeof h==="string"){h={data:h}}if(!h){h={}}if(q==="none"){return false}if(d.isArray(q)){if(!h.attr||!h.attr[n.type_attr]){if(!h.attr){h.attr={}}h.attr[n.type_attr]=q[0]}else{if(d.inArray(h.attr[n.type_attr],q)===-1){return false}}}if(n.max_children!==-2&&i!==-1){f=l===-1?this.get_container().find("> ul > li").length:l.find("> ul > li").length;if(f+1>i){return false}}if(n.max_depth!==-2&&j!==-1&&(j-1)<0){return false}}return this.__call_old(true,k,m,h,e,g,o)}}})})(jQuery);(function(d){d.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(g,h,f){var e=this;this.load_node_html(g,function(){e.__callback({obj:e._get_node(g)});h.call(this)},f)},_is_loaded:function(e){e=this._get_node(e);return e==-1||!e||(!this._get_settings().html_data.ajax&&!d.isFunction(this._get_settings().html_data.data))||e.is(".jstree-open, .jstree-leaf")||e.children("ul").children("li").size()>0},load_node_html:function(h,j,f){var e,i=this.get_settings().html_data,g=function(){},k=function(){};h=this._get_node(h);if(h&&h!==-1){if(h.data("jstree_is_loading")){return}else{h.data("jstree_is_loading",true)}}switch(!0){case (d.isFunction(i.data)):i.data.call(this,h,d.proxy(function(l){if(l&&l!==""&&l.toString&&l.toString().replace(/^[\s\n]+$/,"")!==""){l=d(l);if(!l.is("ul")){l=d("<ul />").append(l)}if(h==-1||!h){this.get_container().children("ul").empty().append(l.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{h.children("a.jstree-loading").removeClass("jstree-loading");h.append(l).children("ul").find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");h.removeData("jstree_is_loading")}this.clean_node(h);if(j){j.call(this)}}else{if(h&&h!==-1){h.children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading");if(i.correct_state){this.correct_state(h);if(j){j.call(this)}}}else{if(i.correct_state){this.get_container().children("ul").empty();if(j){j.call(this)}}}}},this));break;case (!i.data&&!i.ajax):if(!h||h==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(j){j.call(this)}break;case (!!i.data&&!i.ajax)||(!!i.data&&!!i.ajax&&(!h||h===-1)):if(!h||h==-1){e=d(i.data);if(!e.is("ul")){e=d("<ul />").append(e)}this.get_container().children("ul").empty().append(e.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(j){j.call(this)}break;case (!i.data&&!!i.ajax)||(!!i.data&&!!i.ajax&&h&&h!==-1):h=this._get_node(h);g=function(o,n,l){var m=this.get_settings().html_data.ajax.error;if(m){m.call(this,o,n,l)}if(h!=-1&&h.length){h.children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading");if(n==="success"&&i.correct_state){this.correct_state(h)}}else{if(n==="success"&&i.correct_state){this.get_container().children("ul").empty()}}if(f){f.call(this)}};k=function(l,n,o){var m=this.get_settings().html_data.ajax.success;if(m){l=m.call(this,l,n,o)||l}if(l===""||(l&&l.toString&&l.toString().replace(/^[\s\n]+$/,"")==="")){return g.call(this,o,n,"")}if(l){l=d(l);if(!l.is("ul")){l=d("<ul />").append(l)}if(h==-1||!h){this.get_container().children("ul").empty().append(l.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{h.children("a.jstree-loading").removeClass("jstree-loading");h.append(l).children("ul").find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");h.removeData("jstree_is_loading")}this.clean_node(h);if(j){j.call(this)}}else{if(h&&h!==-1){h.children("a.jstree-loading").removeClass("jstree-loading");h.removeData("jstree_is_loading");if(i.correct_state){this.correct_state(h);if(j){j.call(this)}}}else{if(i.correct_state){this.get_container().children("ul").empty();if(j){j.call(this)}}}}};i.ajax.context=this;i.ajax.error=g;i.ajax.success=k;if(!i.ajax.dataType){i.ajax.dataType="html"}if(d.isFunction(i.ajax.url)){i.ajax.url=i.ajax.url.call(this,h)}if(d.isFunction(i.ajax.data)){i.ajax.data=i.ajax.data.call(this,h)}d.ajax(i.ajax);break}}}});d.jstree.defaults.plugins.push("html_data")})(jQuery);(function(d){d.jstree.plugin("themeroller",{__init:function(){var e=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(f){if(!d(f.currentTarget).hasClass("jstree-loading")){d(this).addClass(e.item_h)}}).delegate("a","mouseleave.jstree",function(){d(this).removeClass(e.item_h)}).bind("init.jstree",d.proxy(function(g,f){f.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(f.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",d.proxy(function(g,f){this._themeroller(f.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",d.proxy(function(f){this._themeroller()},this)).bind("close_node.jstree",d.proxy(function(g,f){this._themeroller(f.rslt.obj)},this)).bind("delete_node.jstree",d.proxy(function(g,f){this._themeroller(f.rslt.parent)},this)).bind("correct_state.jstree",d.proxy(function(g,f){f.rslt.obj.children("ins.jstree-icon").removeClass(e.opened+" "+e.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(e.item_clsd,"").replace(e.item_open,"").replace(e.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(e.item_open+" "+e.item_clsd).addClass(e.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",d.proxy(function(g,f){f.rslt.obj.children("a").addClass(e.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",d.proxy(function(g,f){this.get_container().find("a."+e.item_a).removeClass(e.item_a).end().find("a.jstree-clicked").addClass(e.item_a)},this)).bind("dehover_node.jstree",d.proxy(function(g,f){f.rslt.obj.children("a").removeClass(e.item_h)},this)).bind("hover_node.jstree",d.proxy(function(g,f){this.get_container().find("a."+e.item_h).not(f.rslt.obj).removeClass(e.item_h);f.rslt.obj.children("a").addClass(e.item_h)},this)).bind("move_node.jstree",d.proxy(function(g,f){this._themeroller(f.rslt.o);this._themeroller(f.rslt.op)},this))},__destroy:function(){var f=this._get_settings().themeroller,e=["ui-icon"];d.each(f,function(g,h){h=h.split(" ");if(h.length){e=e.concat(h)}});this.get_container().removeClass("ui-widget-content").find("."+e.join(", .")).removeClass(e.join(" "))},_fn:{_themeroller:function(e){var f=this._get_settings().themeroller;e=!e||e==-1?this.get_container_ul():this._get_node(e).parent();e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(f.opened).addClass("ui-icon "+f.closed).end().children("a").addClass(f.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(f.item_clsd,"").replace(f.item_open,"").replace(f.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(f.item_leaf+" "+f.item_open).addClass(f.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(f.closed).addClass("ui-icon "+f.opened).end().children("a").addClass(f.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(f.item_clsd,"").replace(f.item_open,"").replace(f.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(f.item_leaf+" "+f.item_clsd).addClass(f.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(f.closed+" ui-icon "+f.opened).end().children("a").addClass(f.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(f.item_clsd,"").replace(f.item_open,"").replace(f.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(f.item_clsd+" "+f.item_open).addClass(f.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});d(function(){var e=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";d.vakata.css.add_sheet({str:e,title:"jstree"})})})(jQuery);(function(d){d.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",d.proxy(function(g,f){var h=[],j=true,i,k;if(f.func=="move_node"){if(f.args[4]===true){if(f.args[0].o&&f.args[0].o.length){f.args[0].o.children("a").each(function(){h.push(d(this).text().replace(/^\s+/g,""))});j=this._check_unique(h,f.args[0].np.find("> ul > li").not(f.args[0].o),"move_node")}}}if(f.func=="create_node"){if(f.args[4]||this._is_loaded(f.args[0])){i=this._get_node(f.args[0]);if(f.args[1]&&(f.args[1]==="before"||f.args[1]==="after")){i=this._get_parent(f.args[0]);if(!i||i===-1){i=this.get_container()}}if(typeof f.args[2]==="string"){h.push(f.args[2])}else{if(!f.args[2]||!f.args[2].data){h.push(this._get_string("new_node"))}else{h.push(f.args[2].data)}}j=this._check_unique(h,i.find("> ul > li"),"create_node")}}if(f.func=="rename_node"){h.push(f.args[1]);k=this._get_node(f.args[0]);i=this._get_parent(k);if(!i||i===-1){i=this.get_container()}j=this._check_unique(h,i.find("> ul > li").not(k),"rename_node")}if(!j){g.stopPropagation();return false}},this))},defaults:{error_callback:d.noop},_fn:{_check_unique:function(g,h,f){var e=[];h.children("a").each(function(){e.push(d(this).text().replace(/^\s+/g,""))});if(!e.length||!g.length){return true}e=e.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if((e.length+g.length)!=e.concat(g).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length){this._get_settings().unique.error_callback.call(null,g,h,f);return false}return true},check_move:function(){if(!this.__call_old()){return false}var f=this._get_move(),e=[];if(f.o&&f.o.length){f.o.children("a").each(function(){e.push(d(this).text().replace(/^\s+/g,""))});return this._check_unique(e,f.np.find("> ul > li").not(f.o),"check_move")}return true}}})})(jQuery);(function(d){d.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui){throw"jsTree wholerow: jsTree UI plugin not included."}this.data.wholerow.html=false;this.data.wholerow.to=false;this.get_container().bind("init.jstree",d.proxy(function(g,f){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",d.proxy(function(g,f){this._prepare_wholerow_span(f&&f.rslt&&f.rslt.obj?f.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",d.proxy(function(g,f){if(this.data.to){clearTimeout(this.data.to)}this.data.to=setTimeout((function(h,e){return function(){h._prepare_wholerow_ul(e)}})(this,f&&f.rslt&&f.rslt.obj?f.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",d.proxy(function(g,f){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",d.proxy(function(g,f){f.rslt.obj.each(function(){var e=f.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((d(this).offset().top-f.inst.get_container().offset().top+f.inst.get_container()[0].scrollTop)/f.inst.data.core.li_height),10))+")");e.children("a").attr("class",f.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",d.proxy(function(g,f){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(g.type==="hover_node"){var h=this.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((f.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height),10))+")");h.children("a").attr("class",f.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(f){var g=d(f.currentTarget);if(f.target.tagName==="A"||(f.target.tagName==="INS"&&g.closest("li").is(".jstree-open, .jstree-closed"))){return}g.closest("li").children("a:visible:eq(0)").click();f.stopImmediatePropagation()}).delegate("li","mouseover.jstree",d.proxy(function(f){f.stopImmediatePropagation();if(d(f.currentTarget).children(".jstree-hovered, .jstree-clicked").length){return false}this.hover_node(f.currentTarget);return false},this)).delegate("li","mouseleave.jstree",d.proxy(function(f){if(d(f.currentTarget).children("a").hasClass("jstree-hovered").length){return}this.dehover_node(f.currentTarget)},this));if(c||b){d.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})}},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(e){e=!e||e==-1?this.get_container().find("> ul > li"):this._get_node(e);if(e===false){return}e.each(function(){d(this).find("li").andSelf().each(function(){var f=d(this);if(f.children(".jstree-wholerow-span").length){return true}f.prepend("<span class='jstree-wholerow-span' style='width:"+(f.parentsUntil(".jstree","li").length*18)+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var f=this.get_container().children("ul").eq(0),e=f.html();f.addClass("jstree-wholerow-real");if(this.data.wholerow.last_html!==e){this.data.wholerow.last_html=e;this.get_container().children(".jstree-wholerow").remove();this.get_container().append(f.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(f.parent()[0].scrollWidth).css("top",(f.height()+(c?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end())}}}});d(function(){var e=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";if(a){e+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } "}if(c||b){e+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } "}d.vakata.css.add_sheet({str:e,title:"jstree"})})})(jQuery);(function(d){var e=["getChildren","getChildrenCount","getAttr","getName","getProps"],f=function(h,g){var i=true;h=h||{};g=[].concat(g);d.each(g,function(j,k){if(!d.isFunction(h[k])){i=false;return false}});return i};d.jstree.plugin("model",{__init:function(){if(!this.data.json_data){throw"jsTree model: jsTree json_data plugin not included."}this._get_settings().json_data.data=function(h,g){var i=(h==-1)?this._get_settings().model.object:h.data("jstree_model");if(!f(i,e)){return g.call(null,false)}if(this._get_settings().model.async){i.getChildren(d.proxy(function(j){this.model_done(j,g)},this))}else{this.model_done(i.getChildren(),g)}}},defaults:{object:false,id_prefix:false,async:false},_fn:{model_done:function(i,h){var j=[],k=this._get_settings(),g=this;if(!d.isArray(i)){i=[i]}d.each(i,function(l,m){var n=m.getProps()||{};n.attr=m.getAttr()||{};if(m.getChildrenCount()){n.state="closed"}n.data=m.getName();if(!d.isArray(n.data)){n.data=[n.data]}if(g.data.types&&d.isFunction(m.getType)){n.attr[k.types.type_attr]=m.getType()}if(n.attr.id&&k.model.id_prefix){n.attr.id=k.model.id_prefix+n.attr.id}if(!n.metadata){n.metadata={}}n.metadata.jstree_model=m;j.push(n)});h.call(null,j)}}})})(jQuery)})();(function(a){var b=(function(){var e={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",menuArrowClass:"sf-arrows"},i=(function(){var c=/iPhone|iPad|iPod/i.test(navigator.userAgent);if(c){a(window).load(function(){a("body").children().on("click",a.noop)})}return c})(),q=(function(){var c=document.documentElement.style;return("behavior" in c&&"fill" in c&&/iemobile/i.test(navigator.userAgent))})(),n=function(c,s){var r=e.menuClass;if(s.cssArrows){r+=" "+e.menuArrowClass}c.toggleClass(r)},l=function(c,r){return c.find("li."+r.pathClass).slice(0,r.pathLevels).addClass(r.hoverClass+" "+e.bcClass).filter(function(){return(a(this).children(r.popUpSelector).hide().show().length)}).removeClass(r.pathClass)},m=function(c){c.children("a").toggleClass(e.anchorClass)},o=function(c){var r=c.css("ms-touch-action");r=(r==="pan-y")?"auto":"pan-y";c.css("ms-touch-action",r)},d=function(c,r){var s="li:has("+r.popUpSelector+")";if(a.fn.hoverIntent&&!r.disableHI){c.hoverIntent(k,j,s)}else{c.on("mouseenter.superfish",s,k).on("mouseleave.superfish",s,j)}var t="MSPointerDown.superfish";if(!i){t+=" touchend.superfish"}if(q){t+=" mousedown.superfish"}c.on("focusin.superfish","li",k).on("focusout.superfish","li",j).on(t,"a",r,p)},p=function(s){var c=a(this),r=c.siblings(s.data.popUpSelector);if(r.length>0&&r.is(":hidden")){c.one("click.superfish",false);if(s.type==="MSPointerDown"){c.trigger("focus")}else{a.proxy(k,c.parent("li"))()}}},k=function(){var c=a(this),r=h(c);clearTimeout(r.sfTimer);c.siblings().superfish("hide").end().superfish("show")},j=function(){var c=a(this),r=h(c);if(i){a.proxy(f,c,r)()}else{clearTimeout(r.sfTimer);r.sfTimer=setTimeout(a.proxy(f,c,r),r.delay)}},f=function(c){c.retainPath=(a.inArray(this[0],c.$path)>-1);this.superfish("hide");if(!this.parents("."+c.hoverClass).length){c.onIdle.call(g(this));if(c.$path.length){a.proxy(k,c.$path)()}}},g=function(c){return c.closest("."+e.menuClass)},h=function(c){return g(c).data("sf-options")};return{hide:function(s){if(this.length){var c=this,u=h(c);if(!u){return this}var t=(u.retainPath===true)?u.$path:"",r=c.find("li."+u.hoverClass).add(this).not(t).removeClass(u.hoverClass).children(u.popUpSelector),v=u.speedOut;if(s){r.show();v=0}u.retainPath=false;u.onBeforeHide.call(r);r.stop(true,true).animate(u.animationOut,v,function(){var w=a(this);u.onHide.call(w)})}return this},show:function(){var s=h(this);if(!s){return this}var c=this.addClass(s.hoverClass),r=c.children(s.popUpSelector);s.onBeforeShow.call(r);r.stop(true,true).animate(s.animation,s.speed,function(){s.onShow.call(r)});return this},destroy:function(){return this.each(function(){var r=a(this),s=r.data("sf-options"),c;if(!s){return false}c=r.find(s.popUpSelector).parent("li");clearTimeout(s.sfTimer);n(r,s);m(c);o(r);r.off(".superfish").off(".hoverIntent");c.children(s.popUpSelector).attr("style",function(t,u){return u.replace(/display[^;]+;?/g,"")});s.$path.removeClass(s.hoverClass+" "+e.bcClass).addClass(s.pathClass);r.find("."+s.hoverClass).removeClass(s.hoverClass);s.onDestroy.call(r);r.removeData("sf-options")})},init:function(c){return this.each(function(){var s=a(this);if(s.data("sf-options")){return false}var t=a.extend({},a.fn.superfish.defaults,c),r=s.find(t.popUpSelector).parent("li");t.$path=l(s,t);s.data("sf-options",t);n(s,t);m(r);o(s);d(s,t);r.not("."+e.bcClass).superfish("hide",true);t.onInit.call(this)})}}})();a.fn.superfish=function(d,c){if(b[d]){return b[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return b.init.apply(this,arguments)}else{return a.error("Method "+d+" does not exist on jQuery.fn.superfish")}}};a.fn.superfish.defaults={popUpSelector:"ul,.sf-mega",hoverClass:"sfHover",pathClass:"overrideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},animationOut:{opacity:"hide"},speed:"normal",speedOut:"fast",cssArrows:true,disableHI:false,onInit:a.noop,onBeforeShow:a.noop,onShow:a.noop,onBeforeHide:a.noop,onHide:a.noop,onIdle:a.noop,onDestroy:a.noop};a.fn.extend({hideSuperfishUl:b.hide,showSuperfishUl:b.show})})(jQuery);(function(a){a.fn.tokenInput=function(d,b){var c=a.extend({url:d,hintText:"Type in the first 3 letters of the user's first or last name.",noResultsText:"No results",searchingText:"Searching...",searchDelay:300,minChars:1,tokenLimit:null,jsonContainer:null,method:"GET",contentType:"json",queryParam:"q",onResult:null,cancelStaleRequests:true,ignoreIDArray:b.ignoreIDArray},b);c.classes=a.extend({tokenList:"token-input-list",token:"token-input-token",tokenValueSpan:"token-input-token-value-span",tokenAlternate:"token-input-token-alternate",tokenIcon:"token-input-token-icon",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"},b.classes);return this.each(function(){var e=new a.TokenList(this,c)})};a.TokenList=function(q,G){var x={BEFORE:0,AFTER:1,END:2};var v={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188};var z=[];var N=0;var c=new a.TokenList.Cache();var L;var r=a('<input type="text">').css({outline:"none"}).focus(function(){if(G.tokenLimit==null||G.tokenLimit!=N){I()}}).blur(function(){}).keydown(function(S){var U;var T;switch(S.keyCode){case v.LEFT:case v.RIGHT:case v.UP:case v.DOWN:if(!a(this).val()){U=s.prev();T=s.next();if((U.length&&U.get(0)===D)||(T.length&&T.get(0)===D)){if(S.keyCode==v.LEFT||S.keyCode==v.UP){g(a(D),x.BEFORE)}else{g(a(D),x.AFTER)}}else{if((S.keyCode==v.LEFT||S.keyCode==v.UP)&&U.length){B(a(U.get(0)))}else{if((S.keyCode==v.RIGHT||S.keyCode==v.DOWN)&&T.length){B(a(T.get(0)))}}}}else{var R=null;if(S.keyCode==v.DOWN||S.keyCode==v.RIGHT){R=a(C).next()}else{R=a(C).prev()}if(R.length){A(R)}return false}break;case v.BACKSPACE:U=s.prev();if(!a(this).val().length){if(D){e(a(D))}else{if(U.length){B(a(U.get(0)))}}return false}else{if(a(this).val().length==1){l()}else{setTimeout(function(){h(false)},5)}}break;case v.TAB:case v.RETURN:case v.COMMA:if(C){b(a(C));return false}break;case v.ESC:l();return true;break;default:if(u(S.keyCode)){setTimeout(function(){h(false)},5)}break}});var k=a(q).hide().focus(function(){r.focus()}).blur(function(){r.blur()});var D=null;var C=null;var O=a("<ul />").addClass(G.classes.tokenList).insertAfter(k).click(function(R){var S=j(R,"li");if(S&&S.get(0)!=s.get(0)){M(S);return false}else{var T=j(R,"div");if(T){S=T.parent()}if(S&&S.get(0)!=s.get(0)&&a.data(S.get(0),"tokeninput")){M(S);return false}else{r.focus();if(D){g(a(D),x.END)}}}}).mouseover(function(R){var S=j(R,"li");if(S&&D!==this){S.addClass(G.classes.highlightedToken)}}).mouseout(function(R){var S=j(R,"li");if(S&&D!==this){S.removeClass(G.classes.highlightedToken)}}).mousedown(function(R){var S=j(R,"li");if(S){return false}});var i=a("<div>").addClass(G.classes.dropdown).insertAfter(O).hide();var s=a("<li />").addClass(G.classes.inputToken).appendTo(O).append(r);var P={};var Q=null;p();function H(R){c.clear();G.url=R}function F(R){c.clear();G.ignoreIDArray=R}var o={};if(G.ignoreIDArray&&G.ignoreIDArray.length>0){G.ignoreIDArray.each(function(R){o[R]=R},this)}function d(){c.clear();var R=jQuery(".token-input-token-cm");$A(R).each(function(S){e(jQuery(S))})}function p(){li_data=G.prePopulate;if(li_data&&li_data.length){for(var V=0;V<li_data.length;V++){var Z=null;var X=false;var Y=li_data[V].Name;if(li_data[V].FirstName!=null&&li_data[V].LastName!=null){Y=li_data[V].FirstName;if(li_data[V].NickName!=null&&li_data[V].NickName.length>0){if(li_data[V].FirstName.toLowerCase()!=li_data[V].NickName.toLowerCase()&&li_data[V].NickName.toLowerCase()!=""){Y+=" ("+li_data[V].NickName+")"}}if(li_data[V].LastName!=""){Y+=" "+li_data[V].LastName}}if(li_data[V].isAlternate==true){X=true;Z=a("<li><span id='icon_"+li_data[V].ID+"_"+G.tokenizerID+"' style='display:none'  class='"+G.classes.tokenIcon+"'></span><div class='"+G.classes.tokenValueSpan+"'><p>"+Y+"</p></div> </li>").addClass(G.classes.tokenAlternate).insertBefore(s)}else{if(li_data[V]!=null&&li_data[V].IncludeDetails!=null&&li_data[V].IncludeDetails=="True"){var R="";if(li_data[V].Age!=null&&li_data[V].Age!=""&&!isNaN(li_data[V].Age)&&parseInt(li_data[V].Age,10)>0){R="("+li_data[V].Age+")"}var U="";Z=a("<li><span id='icon_"+li_data[V].ID+"_"+G.tokenizerID+"' style='display:none'  class='"+G.classes.tokenIcon+"'></span><div class='"+G.classes.tokenValueSpan+"'><p>"+Y+"<i>&nbsp;&nbsp;"+U+R+"</i></p></div> </li>").addClass(G.classes.token).insertBefore(s)}else{Z=a("<li><span id='icon_"+li_data[V].ID+"_"+G.tokenizerID+"' style='display:none'  class='"+G.classes.tokenIcon+"'></span><div class='"+G.classes.tokenValueSpan+"'><p>"+Y+"</p></div> </li>").addClass(G.classes.token).insertBefore(s)}}P[li_data[V].ID]=Z;a("<span>x</span>").addClass(G.classes.tokenDelete).appendTo(Z).click(function(){e(a(this).parent());return false});var T={};if(!(Object.isUndefined(li_data[V].data)||li_data[V].data==null)){T=li_data[V].data}a.data(Z.get(0),"tokeninput",{id:li_data[V].ID,name:li_data[V].Name,isAlternate:X,data:T});r.val("").focus();l();var W=li_data[V].ID+",";k.val(k.val()+W)}}var S={input_box:r,hide_dropdown:l,select_token:B,set_alternateClass:E,showIcon:K,deselect_token:g,toggle_select_token:M,delete_token:e,insert_token:t,tokenElementHash:P,position:x,setURL:H,setIgnoreIDArray:F,clearTokens:d};G.tokenizerLoadedDelegate(G.parentContainer,S);G.dataChangedDelegate(G.parentContainer)}function u(R){if((R>=48&&R<=90)||(R>=96&&R<=111)||(R>=186&&R<=192)||(R>=219&&R<=222)){return true}else{return false}}function j(T,S){var U=a(T.target);var R=null;if(U.is(S)){R=U}else{if(U.parent(S).length){R=U.parent(S+":first")}}return R}function t(T,Y,U,V){var X=null;if(U==true){U=true;X=a("<li><span id='icon_"+T+"_"+G.tokenizerID+"' style='display:none' class='"+G.classes.tokenIcon+"'></span><div class='"+G.classes.tokenValueSpan+"'><p>"+Y+"</p></div> </li>").addClass(G.classes.tokenAlternate).insertBefore(s)}else{if(V.data!=null&&V.data.IncludeDetails!=null&&V.data.IncludeDetails=="True"){var W=V.data.FirstName;if(V.data.NickName!=null&&V.data.NickName.length>0){if(V.data.FirstName.toLowerCase()!=V.data.NickName.toLowerCase()&&V.data.NickName.toLowerCase()!=""){W+=" ("+V.data.NickName+")"}}if(V.data.LastName!=""){W+=" "+V.data.LastName}var R="";if(V.data.Age!=null&&V.data.Age!=""&&!isNaN(V.data.Age)&&parseInt(V.data.Age,10)>0){R="("+V.data.Age+")"}var S="";X=a("<li><span id='icon_"+V.id+"_"+G.tokenizerID+"' style='display:none'  class='"+G.classes.tokenIcon+"'></span><div class='"+G.classes.tokenValueSpan+"'><p>"+W+"<i>&nbsp;&nbsp;"+S+R+"</i></p></div> </li>").addClass(G.classes.token).insertBefore(s)}else{var W=V.name;if(V.data!=null&&V.data.FirstName!=null&&V.data.LastName!=null){W=V.data.FirstName;if(V.data.NickName!=null&&V.data.NickName.length>0){if(V.data.FirstName.toLowerCase()!=V.data.NickName.toLowerCase()&&V.data.NickName.toLowerCase()!=""){W+=" ("+V.data.NickName+")"}}if(V.data.LastName!=""){W+=" "+V.data.LastName}}X=a("<li><span id='icon_"+V.id+"_"+G.tokenizerID+"' style='display:none'  class='"+G.classes.tokenIcon+"'></span><div class='"+G.classes.tokenValueSpan+"'><p>"+W+"</p></div> </li>").addClass(G.classes.token).insertBefore(s)}}a("<span>x</span>").addClass(G.classes.tokenDelete).appendTo(X).click(function(){e(a(this).parent());return false});a.data(X.get(0),"tokeninput",{id:T,name:Y,isAlternate:U,data:V.data});P[T]=X;G.dataChangedDelegate(G.parentContainer);G.tokenInsertedDelegate(G.parentContainer,T);return X}function b(T){if(T==null){return}var U=a.data(T.get(0),"tokeninput");if(U==null){return}var S=false;if(Object.isUndefined(U.isAlternate)||U.isAlternate==null){S=false}else{S=U.isAlternate}if(!P[U.id]&&!o[U.id]){var V=t(U.id,U.name,S,U);r.val("").focus();l();var R=U.id+",";k.val(k.val()+R);N++;if(G.tokenLimit!=null&&G.tokenLimit>=N){r.hide();l()}}}function B(S){var R=a.data(S.get(0),"tokeninput");S.addClass(G.classes.selectedToken);D=S.get(0);r.val("");l();G.tokenSelectedDelegate(G.parentContainer,R.id)}function g(S,R){S.removeClass(G.classes.selectedToken);D=null;if(R==x.BEFORE){s.insertBefore(S)}else{if(R==x.AFTER){s.insertAfter(S)}else{s.appendTo(O)}}}function M(R){if(D==R.get(0)){g(R,x.END)}else{if(D){g(a(D),x.END)}B(R)}}function K(T,S){var R=a.data(T.get(0),"tokeninput");if(S==true){a("#icon_"+R.id+"_"+G.tokenizerID).show()}else{a("#icon_"+R.id+"_"+G.tokenizerID).hide()}}function E(T,S){if(S==true){T.removeClass(G.classes.token);T.addClass(G.classes.tokenAlternate)}else{T.removeClass(G.classes.tokenAlternate);T.addClass(G.classes.token)}var R=a.data(T.get(0),"tokeninput");a.data(T.get(0),"tokeninput",{id:R.id,name:R.name,isAlternate:S,data:R.data})}function e(U){var V=a.data(U.get(0),"tokeninput");U.remove();D=null;var T=k.val();var S=T.indexOf(V.id+",");var R=T.indexOf(",",S)+1;if(R>=T.length){k.val(T.slice(0,S))}else{k.val(T.slice(0,S)+T.slice(R,T.length))}N--;if(G.tokenLimit!=null){r.show().val("").focus()}delete P[V.id];G.tokenDeletedDelegate(G.parentContainer,V);G.dataChangedDelegate(G.parentContainer)}function l(){i.hide().empty();C=null}function J(){i.removeClass("token-input-dropdown-cm-scroll");i.html("<p>"+G.searchingText+"</p>").show()}function I(){i.removeClass("token-input-dropdown-cm-scroll");i.html("<p>"+G.hintText+"</p>").show()}function m(){i.hide()}function n(S,R){return S.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+R+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function w(ag,ai){if(ai.length){i.addClass("token-input-dropdown-cm-scroll");i.empty();var Y=a("<ul>").appendTo(i).mouseover(function(am){A(j(am,"li"))}).mousedown(function(am){b(j(am,"li"));return false}).mousedown(function(am){b(j(am,"li div"));return false}).mousedown(function(am){b(j(am,"li span"));return false}).hide();for(var ab in ai){if(ai.hasOwnProperty(ab)&&ai[ab]!=null){var V={};if(!(Object.isUndefined(ai[ab].data)||ai[ab].data==null)){V=ai[ab].data}else{V=ai[ab]}var af=V.name;if(V.FirstName!=null&&V.LastName!=null){af=V.FirstName;if(V.NickName!=null&&V.NickName.length>0){if(V.FirstName.toLowerCase()!=V.NickName.toLowerCase()&&V.NickName.toLowerCase()!=""){af+=" ("+V.NickName+")"}}if(V.LastName!=""){af+=" "+V.LastName}}if(V!=null&&V.IncludeDetails!=null&&V.IncludeDetails=="True"){var R="";if(V.Age!=null&&V.Age!=""&&!isNaN(V.Age)&&parseInt(V.Age,10)>0){R="("+V.Age+")"}var S="";if(V.Bunk!=null){S=V.Bunk}var W="";if(V.Division!=null){W=V.Division}var T="";if(V.City!=null){T=V.City}var ak="";if(V.State!=null){ak=V.State}var aa="";if(V.Grade!=null&&V.Grade!=""){aa=V.Grade}var ae=T;if(ae!=""){ae=ae+", "+ak}else{ae=ae+ak}if(ae!=""&&W!=""){ae=ae+" / "+W}else{ae=ae+W}if(ae!=""&&aa!=""){ae=ae+" / "+aa}else{ae=ae+aa}var Z="{";for(var ab=0;ab<32;ab++){Z+=Math.floor(Math.random()*15).toString(15)+(ab==8||ab==12||ab==16||ab==20?"-":"")}Z+="}";var ah=Z;var ac="";if(V.ProfilePhotoURL!=null&&V.ProfilePhotoURL!=""){ac=V.ProfilePhotoURL+"?v="+ah}else{if(V.Gender==null||Number(V.Gender)==0){ac="/CMinder/PersonUser/avatars/missDefault.pngx"}else{ac="/CMinder/PersonUser/avatars/mrDefault.pngx"}}var U="<div class='photoDetails'><img src='"+ac+"' class='photo' /></div><div style='font-size: 12px;' class='innerDetails'><span>"+n(af,ag)+"</span><span class='age inverseOnSelect'>&nbsp;&nbsp;"+R+"</span><div><div style='font-size: 10px;color:#666;' class='inverseOnSelect'><span>"+ae+"</span><span class='cmFloatRight'>"+S+"</span></div>";var al=a("<li />").appendTo(Y);al.append(U)}else{var al=a("<li>"+n(af,ag)+"</li>").appendTo(Y)}if(ab%2){al.addClass(G.classes.dropdownItem)}else{al.addClass(G.classes.dropdownItem2)}if(ab==0){A(al)}var ad=true;if(!(Object.isUndefined(V.isAlternate)||V.isAlternate==null)){ad=V.isAlternate}a.data(al.get(0),"tokeninput",{id:V.id,name:V.name,isAlternate:ad,data:V});var X=a(al).find("div");$A(X).each(function(am){a.data(jQuery(am).get(0),"tokeninput",{id:V.id,name:V.name,isAlternate:ad,data:V})},this);var aj=a(al).find("span");$A(aj).each(function(am){a.data(jQuery(am).get(0),"tokeninput",{id:V.id,name:V.name,isAlternate:ad,data:V})},this)}}i.show();Y.slideDown("fast")}else{i.html("<p>"+G.noResultsText+"</p>").show()}}function A(R){if(R){if(C){f(a(C))}R.addClass(G.classes.selectedDropdownItem);C=R.get(0)}}function f(R){R.removeClass(G.classes.selectedDropdownItem);C=null}function h(R){var S=r.val().toLowerCase();if(S&&S.length){if(D){g(a(D),x.AFTER)}if(S.length>=G.minChars){J();if(R){y(S)}else{clearTimeout(L);L=setTimeout(function(){y(S)},G.searchDelay)}}else{l()}}}function y(W){var R=c.get(W);if(R){w(W,R)}else{var X=G.url.indexOf("?")<0?"?":"&";var S=function(Y){if(a.isFunction(G.onResult)){Y=G.onResult.call(this,Y)}c.add(W,G.jsonContainer?Y[G.jsonContainer]:Y);w(W,G.jsonContainer?Y[G.jsonContainer]:Y)};if(G.cancelStaleRequests==true){if(Q!=null&&Q.abort!=null){Q.abort()}}var T=G.url+X+G.queryParam+"="+W;var U=$A();if(G.ignoreIDArray&&G.ignoreIDArray.length>0){G.ignoreIDArray.each(function(Y){U.push(Y)},this)}if(P){Object.getOwnPropertyNames(P).each(function(Y){U.push(Number(Y))},this)}var V="";if(U.length>0){V="&ignoreIDs="+U.join(",")}T+=V;if(G.method=="POST"){Q=a.post(T,{},S,G.contentType)}else{Q=a.get(T,{},S,G.contentType)}}}};a.TokenList.Cache=function(d){var e=a.extend({max_size:50},d);var b={};var f=0;var c=function(){b={};f=0};this.add=function(g,h){if(f>e.max_size){c()}if(!b[g]){f++}b[g]=h};this.get=function(g){return b[g]};this.clear=function(){c()}}})(jQuery);