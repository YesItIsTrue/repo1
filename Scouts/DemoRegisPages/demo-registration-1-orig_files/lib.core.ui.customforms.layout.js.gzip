"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.LayoutHandler=Class.create({_sectors:$A(),_canvas:null,SectorHoverEvent:null,SectorExitEvent:null,initialize:function(){this._sectors=$A();this._canvas=null;this.SectorHoverEvent=new cm.event();this.SectorExitEvent=new cm.event()},Initialize:function(a){this._canvas=a;this.initializeCanvas(a)},Detach:function(a){this.onDetach(a)},GetCanvas:function(){return this._canvas},GetSectors:function(){return this._sectors},GetSector:function(a,b){if($A(arguments).length<2){return this.getDefaultSector()}return this._sectors.find(function(c){return c.Layout.X==a&&c.Layout.Y==b},this)},GetObjects:function(){var b=$A();this.GetSectors().each(function(c){c.ChildControls().each(function(d){b.push(d)},this)},this);var a=this;b.sort(function(c,d){return a.doSort(c,d)});return b},Update:function(){this.doUpdate()},Show:function(){this.doShow()},Hide:function(){this.doHide()},Remove:function(a){a._owner=null;this.doRemove(a)},Add:function(a){a._owner=this.GetCanvas();this.doAdd(a);$$E(a).id=$$CM.rawGuid()},Reset:function(){this.doReset()},CreateSector:function(d,e,c,a){var b=new cm.ui.customforms.layout.LayoutSector(null,{x:d,y:e,w:c,h:a});this._sectors.push(b);this.onSectorCreated(b);return b},DestroySector:function(b,c){var a=this.GetSector(b,c);if(!$$CM.isNull(a)){while(a.ChildControls().length>0){this.GetCanvas().RemoveObject(a.ChildControls().first())}this._sectors.remove(a)}},DestroySectors:function(){this._sectors.each(function(a){this.DestroySector(a.Layout.X,a.Layout.Y)},this)},IsOnThisCanvas:function(a){return a._owner==this.GetCanvas()},SetEnabled:function(a){},initializeCanvas:function(a){},doShow:function(){},doHide:function(){},doUpdate:function(){},doRemove:function(a){},doAdd:function(a){},doReset:function(){},onDetach:function(a){},doSort:function(c,d){return 0},onSectorCreated:function(a){},getDefaultSector:function(){return null},GetParameters:function(){return""},SetParameters:function(a){}});$$LAYOUT={FLOW:function(){return new cm.ui.customforms.layout.FlowLayout()},TABLE:function(a){return new cm.ui.customforms.layout.TableLayout(a)},GRID:function(){return new cm.ui.customforms.layout.GridLayout()},PAGE:function(){return new cm.ui.customforms.layout.PageLayout()},PERMISSION:function(){return new cm.ui.customforms.layout.PermissionLayout()},TABS:function(){return new cm.ui.customforms.layout.TabLayout()}};"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.FlowLayout=Class.create(cm.ui.customforms.layout.LayoutHandler,{_mainSector:null,initialize:function($super,a){if(!$$CM.isNull(a)){this._columns=a}else{this._columns=1}if(this._columns<=0||this._columns>=3){this._columns=1}$super()},initializeCanvas:function(a){this.DestroySectors();for(var c=0;c<this._columns;c++){var b=this.CreateSector(c,0);b.AddClassName("cmBorderBox");w=(100/this._columns);if(c>0){w="49.5";b.AssignStyle("margin-left","0.5%")}b.AssignStyle("width",w+"%");a.AddChild(b)}},onSectorCreated:function(a){a.AddClassName("cmLayoutHandler-Flow")},doAdd:function(a){var c=a.Layout.X;var d=a.Layout.Y;if(c>=this._columns){c=0}var b=this.GetSector(c,0);b.AddChild(a)},doRemove:function(a){var c=a.Layout.X;var d=a.Layout.Y;if(c>=this._columns){c=0}var b=this.GetSector(c,0);b.RemoveChildControl(a)},doSort:function(c,d){return((c.Layout.Y*this._columns)+c.Layout.X)-((d.Layout.Y*this._columns)+d.Layout.X)},getDefaultSector:function(){return this.GetSector(0,0)}});"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.GridLayout=Class.create(cm.ui.customforms.layout.LayoutHandler,{_mainSector:null,initializeCanvas:function(a){this._mainSector=this.CreateSector();a.AddChild(this._mainSector)},doAdd:function(a){this._mainSector.AddChild(a)},doRemove:function(a){this._mainSector.RemoveChildControl(a)},getDefaultSector:function(){return this._mainSector}});"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.PageLayout=Class.create(cm.ui.customforms.layout.LayoutHandler,{_currentPage:0,_pages:$A(),doUpdate:function(){this._pages=$A();this.GetSectors().each(function(b){var a=b.ChildControls().select(function(c){return c.IsApplicable==true}).length>0;if(a==true){this._pages.push(b)}},this)},GetPage:function(a){if(a>0&&a<this._pages.length){return this._pages[a-1]}else{return null}},GetPages:function(a){if(a==true){return this._pages}else{return this.GetSectors()}},GetPageCount:function(){return this._pages.length},GetCurrentPage:function(){return this._currentPage},PageNext:function(){var b=this._pages[this._currentPage];b.Hide();if(this._currentPage<this._pages.length-1){this._currentPage++}var a=this._pages[this._currentPage];a.Show()},PagePrev:function(){var b=this._pages[this._currentPage];b.Hide();if(this._currentPage>0){this._currentPage--}var a=this._pages[this._currentPage];a.Show()},initializeCanvas:function(a){this._currentPage=0},doReset:function(a){this._sectors=$A()},doAdd:function(b){var d=b.Layout.X;var c=this.GetSector(0,0);for(var a=0;a<=d;a++){if($$CM.isNull(this.GetSector(a,0))){c=this.CreateSector(a,0)}else{c=this.GetSector(a,0)}}c.AddChild(b)},doRemove:function(a){var c=a.Layout.X;var b=this.GetSector(c,0);if(!$$CM.isNull(b)){b.RemoveChildControl(a)}},doSort:function(c,d){return(((c.Layout.X+1)*c.Layout.Y)-((d.Layout.X+1)*d.Layout.Y))},onSectorCreated:function(a){a.AddClassName("cmLayoutHandler-Page");this.GetCanvas().AddChild(a);if(this.GetSectors().length>1){a.Hide()}}});"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.PermissionLayout=Class.create(cm.ui.customforms.layout.FlowLayout,{initializeCanvas:function($super,a){a.AddClassName("cmLayoutHandler-PermissionFrame");this._div=$$P.div(null,null,{classNames:"cmFloatLeft"});this._div.AddClassName("cmLayoutHandler-PermissionFrame");a.AddChild(this._div);this._essayBlock=new cm.ui.framework.model.ScrollingTextBox();this._div.AddChild(this._essayBlock);this._essayBlock.SetConfig(CFG_ENABLED,true);this._essayBlock.Reload();this._rblPermission=Framework.Object.Render(CLS_RADIOLIST,$A());this._rblPermission.AddClassName("permissionBlock");this._div.AddChild(this._rblPermission);this.DestroySectors();this._mainSector=this.CreateSector(0,0);this._div.AddChild(this._mainSector);this._sigPermission=new cm.ui.framework.model.Signature();this._div.AddChild(this._sigPermission);this._sigPermission.SetConfig(CFG_LABEL,"Signature");this._sigPermission.SetConfig(CFG_ENABLED,true);this._sigPermission.Reload();this._sigPermission.Validator.addEvaluator($$EVAL.TEXT({IsRequired:true}))},onSectorCreated:function($super,a){$super(a);a.AddClassName("cmLayoutHandler-Permission")},GetData:function(){return{PermissionStatus:this._rblPermission.GetData(),Signature:this._sigPermission.GetData(true)}},Bind:function(a){this._rblPermission.Bind(a.PermissionStatus);this._sigPermission.Bind(a.Signature)},SetEssay:function(a){this._essayBlock.Bind(a)},SetPermissionOptions:function(a,c){var b=new cm.dao.CustomForms.DAO();var e=b.GetEnum("PermissionStatus");var d=$A([{ID:FW.Enums.PermissionStatus.Accepted,Name:a},{ID:FW.Enums.PermissionStatus.Denied,Name:c}]);this._rblPermission.SetConfig(111,false);this._rblPermission.SetConfig(107,d);this._rblPermission.Reload();this._rblPermission.Validator.Clear();this._rblPermission.Validator.addEvaluator($$EVAL.GROUP({FieldName:"Accept/Decline",IsRequired:true}))}});"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.TableLayout=Class.create(cm.ui.customforms.layout.LayoutHandler,{_rows:$A(),_columns:2,_colWidth:0,initialize:function($super,a){if(!$$CM.isNull(a)){this._columnOverride=a}$super()},createRow:function(){var b=$$P.div(null,null,{classNames:"cmSectorRow cmBorderBox cmFloatLeft w100prct"});for(var a=0;a<this._columns;a++){var c=this.CreateSector(a,this._rows.length);c.AssignStyle("width",this._colWidth+"%");b.AddChild(c)}this._rows.push(b);this.GetCanvas().AddChild(b)},initializeCanvas:function(a){this._rows=$A();if($$CM.isNull(this._columnOverride)){var b=a.GetConfigOptions().columns;if($$CM.isNull(b)){b=2}this._columns=b}else{this._columns=this._columnOverride}this.calculateColumnWidth();this.createRow();delete this._columnOverride},doAdd:function(a){var c=a.Layout.X;var d=a.Layout.Y;var b=this.GetSector(c,d);if(c>=this._columns){c=this._columns-1}if($$CM.isNull(b)||this.isSectorOccupied(b)){this.createRow();b=this.GetSector(c,this._rows.length-1)}b.AddChild(a)},doRemove:function(a){var c=a.Layout.X;var d=a.Layout.Y;var b=this.GetSector(c,d);b.RemoveChildControl(a);this.Update()},calculateColumnWidth:function(){this._colWidth=100/this._columns},isSectorOccupied:function(a){return a.ChildControls().length>0},onSectorCreated:function(a){a.AddClassName("cmLayoutHandler-Table")}});"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.LayoutSectorConfigOptions=Class.create(cm.ConfigOptions,{x:0,y:0,w:0,h:0});cm.ui.customforms.layout.LayoutSector=Class.create(cm.ui.Control,{Layout:null,initializeData:function(){var a=this.GetConfigOptions();this.Layout={X:a.x,Y:a.y,Width:a.w,Height:a.h}},initializeUIElements:function(){this.AddClassName("cmLayoutSector")},configureDefaultOptions:function(){return new cm.ui.customforms.layout.LayoutSectorConfigOptions()},GetHandler:function(){var a=this;while(a instanceof cm.ui.customforms.layout.LayoutHandler!=true){a=a.Parent}return a}});"cm.ui.customforms.layout".namespace();cm.ui.customforms.layout.TabLayout=Class.create(cm.ui.customforms.layout.LayoutHandler,{_tabArray:$A(),initializeCanvas:function(a){this.Reset()},doReset:function($super){$super();this._sectors=$A();var a=this.GetCanvas();try{a.RemoveChildControl(this._tabs)}catch(b){}this._tabs=new $$TABS("tabLayout",{classNames:"cmLayoutHandler-Tabs cmBorderBox"});this.doSetTabs();a.AddChild(this._tabs)},doUpdate:function(){var b=$A();var a=this._tabs.GetSelectedTab();this.GetSectors().each(function(d){var c=!$$CM.isNull(d.ChildControls().find(function(e){return e.IsApplicable==true}));if(c!=true){this._tabs.HideTab(d.Layout.X);if(a==d.Layout.X){this._tabs.SetTab(this._tabs.GetFirstVisibleTabIndex())}}else{this._tabs.ShowTab(d.Layout.X)}},this)},SetEnabled:function(a){this._tabs.SetEnabled(a);if(a==true){$$JQ(this._tabs).find(".ui-tabs-nav").sortable("enable")}else{$$JQ(this._tabs).find(".ui-tabs-nav").sortable("disable")}},SetParameters:function(a){var b=$A(["New Tab"]);if(!$$CM.isEmpty(a)){b=JSON.parse(a)}this._tabArray=b},doAdd:function(b){var d=b.Layout.X;var c=this.GetSector(0,0);for(var a=0;a<=d;a++){if($$CM.isNull(this.GetSector(a,0))){c=this.CreateSector(a,0)}else{c=this.GetSector(a,0)}}c.AddChild(b)},doRemove:function(b){var d=b.Layout.X;var c=this.GetSector(d,0);if(!$$CM.isNull(c)){try{c.RemoveChildControl(b)}catch(a){}}},doSort:function(c,d){return(((c.Layout.X+1)*c.Layout.Y)-((d.Layout.X+1)*d.Layout.Y))},doSetTabs:function(){if(!$$CM.isArray(this._tabArray)||this._tabArray.length<=0){this._tabArray=$A(["New Tab"])}this._tabArray.each(function(a){this.CreateSector(this._tabs.GetTabs().length,0);this._tabs.SetTitle(this._tabArray.indexOf(a),a)},this)},onSectorCreated:function(a){this._tabs.AddTab("New Tab",a);a.AddClassName("cmLayoutHandler-Tabs cmBorderBox")}});